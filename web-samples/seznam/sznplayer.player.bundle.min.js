var SznPlayer=function(e){"use strict";const t="11.2.8",i="application/vnd.seznam-cz.spl+json";let s=0;function n(e){const t="object"==typeof e?e:e.prototype;let i=[],s=t;do{i=i.concat(Object.getOwnPropertyNames(s))}while(s=Object.getPrototypeOf(s));return i.filter(function(e){return"function"==typeof t[e]&&0!==e.indexOf("_")})}var o={generateId(e="pdg"){s=s<1e7?s:0;let t=e+"t"+Date.now()+"c"+s;return s++,t},decorate(e,t,i="_$origin"){let s=Object.keys(t);e[i]={};for(let n of s)e[n]&&(e[i][n]=e[n]),e[n]=t[n]},undecorate(e,t,i="_$origin"){let s=Object.keys(t);for(let t of s)e[i][t]?e[t]=e[i][t]:delete e[t];delete e[i]},formatTime(e){isFinite(e)||(e=0);const t=[];let i=Math.floor(e/3600),s=Math.floor((e-3600*i)/60),n=Math.round(e-(3600*i+60*s));return 60==n&&(n=0,60==(s+=1)&&(s=0,i+=1)),i&&t.push(i<10?`0${i}`:i),t.push(s<10?`0${s}`:s),t.push(n<10?`0${n}`:n),t.join(":")},formatPx(e){const t=parseInt(e,10);return String(t)===String(e)?t+"px":null==e?"":String(e)},getUrlScheme(e){const t=e.split("//");return 1===t.length?"":t[0].replace(":","")},addParameterToUrlHash(e,t,i){let s=e.indexOf("#")>-1?"&":"#";return`${e}${s}${t}=${i}`},getFileExt(e){if(!e||"string"!=typeof e)return"";let t=e,i=t.indexOf("?");i>-1&&(t=t.slice(0,i));let s=t.indexOf("#");s>-1&&(t=t.slice(0,s));let n=t.lastIndexOf(".");return n<1?"":t.slice(n+1).toLowerCase()},getTypeByFileExt:e=>"m3u8"===e||"m3u"===e?"application/vnd.apple.mpegurl":"mp4"===e?"video/mp4":"webm"===e?"video/webm":"mp3"===e?"audio/mpeg":"",cutText:(e,t)=>e.length>t?e.substring(0,t-3)+"...":e,getElement:e=>"object"==typeof e&&1===e.nodeType?e:"string"==typeof e?window.document.querySelector(e):null,replaceElement(e,t){e.parentNode.replaceChild(t,e)},calculateBandwidth:(e,t)=>Math.round(8*e/(t/1e3)),clone:e=>null===e||"object"!=typeof e?e:JSON.parse(JSON.stringify(e)),hasInterface(e,t){if(!e||"object"!=typeof e)throw new Error('Argument "imp" must be an object.');if(!t||"function"!=typeof t)throw new Error('Argument "itf" must be a class.');if(e instanceof t)return!0;for(var i=n(t),s=n(e),o=0,r=i.length;o<r;o++)if(-1===s.indexOf(i[o]))return!1;return!0},getOwnMethods(e){const t="object"==typeof e?e:e.prototype;return Object.getOwnPropertyNames(t).filter(function(e){return"function"==typeof t[e]&&0!==e.indexOf("_")})},getCookie(e){try{const t=decodeURIComponent(document.cookie).split(";");for(let i=0;i<t.length;i++){const s=t[i];if(s.split("=")[0].trim()===e)return s.split("=").slice(1).join("=").trim()}}catch(e){}return""},getNow:()=>window.performance?performance.now():Date.now()};const r=["requestFullscreen","mozRequestFullScreen","webkitRequestFullscreen","webkitEnterFullscreen","webkitEnterFullScreen","msRequestFullscreen"],a=["exitFullscreen","mozCancelFullScreen","webkitExitFullscreen","webkitExitFullScreen","msExitFullscreen"],l=["fullscreenElement","mozFullScreenElement","webkitFullscreenElement","webkitDisplayingFullscreen","msFullscreenElement"],h=navigator.userAgent,_=navigator.vendor;let d=null;const u={muted:null,unmuted:null},c={navigationUI:"hide"};var p={getScreenResolution(){let e=window.devicePixelRatio||1;return{width:Math.max(window.screen.width,window.screen.height)*e,height:Math.min(window.screen.width,window.screen.height)*e,ratio:e}},isBuggyFullscreen(){const e=/AppleWebKit\/([\d.]+)/i.exec(h),t=/Chrome\/([\d.]+)/i.exec(h);return-1!=h.search(/android/i)&&!/Windows Phone/i.test(h)&&e&&parseFloat(e[1])<=537.36&&t&&parseFloat(t[1])<=37||this.isIE11()},isBuggyFmp4(){const e=/Chrome\/([\d.]+)/i.exec(h);return-1!=h.search(/android/i)&&!/Windows Phone/i.test(h)&&e&&parseFloat(e[1])<41||this.isSamsungBrowser()},isBuggyPip(){const e=/AppleWebKit\/([\d.]+)/i.exec(h),t=/Chrome\/([\d.]+)/i.exec(h);return e&&t&&70==parseFloat(t[1])},isBuggyCustomUi(){const e=/AppleWebKit\/([\d.]+)/i.exec(h);return-1!=h.search(/android/i)&&!/Windows Phone/i.test(h)&&e&&parseFloat(e[1])<537.36},getFSChangeEventName(e,t=null,i=!1){if(null!==t){if(void 0!==t.webkitDisplayingFullscreen)return i?"webkitendfullscreen":"webkitbeginfullscreen"}else if(!(this.isIPad()||this.isIPod()||this.isIPhone())){if(void 0!==e.onfullscreenchange)return"fullscreenchange";if(void 0!==e.onmozfullscreenchange)return"mozfullscreenchange";if(void 0!==e.onwebkitfullscreenchange)return"webkitfullscreenchange";if(void 0!==e.onmsfullscreenchange)return"MSFullscreenChange"}return""},getFSRequestMethod(e,t){for(let i=0,s=r.length;i<s;i++){const s=r[i];if("function"==typeof e[s]&&!(this.isIPad()||this.isIPod()||this.isIPhone()))return()=>{e[s](c)};if("function"==typeof t[s])return()=>{t[s](c)}}return null},getFSExitMethod(e,t){for(let i=0,s=a.length;i<s;i++){const s=a[i];if("function"==typeof e[s]&&!(this.isIPad()||this.isIPod()||this.isIPhone()))return()=>{e[s]()};if("function"==typeof t[s])return()=>{t[s]()}}return null},getFSStateIndicator(e,t,i){for(let s=0,n=l.length;s<n;s++){const n=l[s];if(void 0!==e[n]&&!(this.isIPad()||this.isIPod()||this.isIPhone()))return e[n]===t;if(void 0!==i[n])return i[n]}return!1},getPipRequestMethod(e,t){return t.webkitSupportsPresentationMode&&"function"==typeof t.webkitSetPresentationMode&&(this.isMac()||this.isIPad())?()=>{t.webkitSetPresentationMode("picture-in-picture")}:!e.pictureInPictureEnabled||t.disablePictureInPicture||this.isBuggyPip()?null:()=>t.requestPictureInPicture()},getPipExitMethod:(e,t)=>t.webkitSupportsPresentationMode&&"function"==typeof t.webkitSetPresentationMode?()=>{t.webkitSetPresentationMode("inline")}:e.pictureInPictureEnabled&&!t.disablePictureInPicture?()=>e.exitPictureInPicture():null,getPipStateMethod:e=>e.webkitSupportsPresentationMode&&e.webkitPresentationMode?()=>"picture-in-picture"==e.webkitPresentationMode:null,getPipEnterEventName:(e,t)=>t.webkitSupportsPresentationMode?"webkitpresentationmodechanged":e.pictureInPictureEnabled?"enterpictureinpicture":"",getPipLeaveEventName:(e,t)=>t.webkitSupportsPresentationMode?"webkitpresentationmodechanged":e.pictureInPictureEnabled?"leavepictureinpicture":"",getNow:()=>"performance"in window?"now"in window.performance?window.performance.now():window.performance.webkitNow():(new Date).getTime(),isIPhone:()=>/iPhone/.test(h)&&!window.MSStream,isIPad:()=>/iPad/.test(h)&&!window.MSStream,isIPod:()=>/iPod/.test(h)&&!window.MSStream,getIosVersion(){if(/iPhone|iPad|iPod/.test(h)){const e=h.match(/OS\s([0-9_]+)/);if(e)return parseInt(e[1].split("_")[0],10)}return null},isSamsungBrowser:()=>/SamsungBrowser/.test(h)&&!window.MSStream,isSznBrowser:()=>/SznProhlizec/.test(h)&&!window.MSStream,isEdgeBrowser:()=>/Edge\/\d+.\d+/.test(h),isAndroid4(){const e=h.includes("Android")&&!h.includes("Windows Phone"),t=h.match(/Android\s([0-9\.]+)/);return!!(e&&t&&t[1])&&parseInt(t[1].split(".")[0],10)<5},isSmallScreen(){let e=Math.min(window.screen.width,window.screen.height);return/Android|iPhone|iPod|BlackBerry|Windows Phone/.test(h)&&e<500},isTouch:()=>"ontouchstart"in window&&/Android|webOS|iPhone|iPad|iPod|BlackBerry|Windows Phone/.test(h),isAutoplayAllowed(e=null){const t=!(!e||void 0===e.muted)&&!!e.muted;if(u.unmuted||t&&u.muted)return Promise.resolve(!0);d||((d=window.document.createElement("video")).setAttribute("playsinline","playsinline"),d.src="data:video/mp4;base64,AAAAIGZ0eXBpc29tAAACAGlzb21pc28yYXZjMW1wNDEAAAAIZnJlZQAAArptZGF03gIATGF2YzU2LjYwLjEwMABCIAjBGDgAAAJxBgX//23cRem95tlIt5Ys2CDZI+7veDI2NCAtIGNvcmUgMTQ4IHIyNjQzIDVjNjU3MDQgLSBILjI2NC9NUEVHLTQgQVZDIGNvZGVjIC0gQ29weWxlZnQgMjAwMy0yMDE1IC0gaHR0cDovL3d3dy52aWRlb2xhbi5vcmcveDI2NC5odG1sIC0gb3B0aW9uczogY2FiYWM9MCByZWY9MyBkZWJsb2NrPTE6MDowIGFuYWx5c2U9MHgxOjB4MTExIG1lPWhleCBzdWJtZT03IHBzeT0xIHBzeV9yZD0xLjAwOjAuMDAgbWl4ZWRfcmVmPTEgbWVfcmFuZ2U9MTYgY2hyb21hX21lPTEgdHJlbGxpcz0xIDh4OGRjdD0wIGNxbT0wIGRlYWR6b25lPTIxLDExIGZhc3RfcHNraXA9MSBjaHJvbWFfcXBfb2Zmc2V0PS0yIHRocmVhZHM9MiBsb29rYWhlYWRfdGhyZWFkcz0xIHNsaWNlZF90aHJlYWRzPTAgbnI9MCBkZWNpbWF0ZT0xIGludGVybGFjZWQ9MCBibHVyYXlfY29tcGF0PTAgY29uc3RyYWluZWRfaW50cmE9MCBiZnJhbWVzPTAgd2VpZ2h0cD0wIGtleWludD0yNTAga2V5aW50X21pbj0yNSBzY2VuZWN1dD00MCBpbnRyYV9yZWZyZXNoPTAgcmNfbG9va2FoZWFkPTQwIHJjPWNyZiBtYnRyZWU9MSBjcmY9MjMuMCBxY29tcD0wLjYwIHFwbWluPTAgcXBtYXg9NjkgcXBzdGVwPTQgaXBfcmF0aW89MS40MCBhcT0xOjEuMDAAgAAAABZliIQK8mKAAKe8nJyddddddddddddeIRAEYIwcIRAEYIwcAAAE721vb3YAAABsbXZoZAAAAAAAAAAAAAAAAAAAA+gAAABGAAEAAAEAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAIWdHJhawAAAFx0a2hkAAAAAwAAAAAAAAAAAAAAAQAAAAAAAAAoAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAQAAAAABAAAAAQAAAAAAAJGVkdHMAAAAcZWxzdAAAAAAAAAABAAAAKAAAAAAAAQAAAAABjm1kaWEAAAAgbWRoZAAAAAAAAAAAAAAAAAAAMgAAAAIAVcQAAAAAAC1oZGxyAAAAAAAAAAB2aWRlAAAAAAAAAAAAAAAAVmlkZW9IYW5kbGVyAAAAATltaW5mAAAAFHZtaGQAAAABAAAAAAAAAAAAAAAkZGluZgAAABxkcmVmAAAAAAAAAAEAAAAMdXJsIAAAAAEAAAD5c3RibAAAAJVzdHNkAAAAAAAAAAEAAACFYXZjMQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAABAAEAASAAAAEgAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABj//wAAAC9hdmNDAULACv/hABdnQsAK2QQmwEQAAAMABAAAAwDIPEiZIAEABWjLg8sgAAAAGHN0dHMAAAAAAAAAAQAAAAEAAAIAAAAAHHN0c2MAAAAAAAAAAQAAAAEAAAABAAAAAQAAABRzdHN6AAAAAAAAAo8AAAABAAAAFHN0Y28AAAAAAAAAAQAAAEcAAAIDdHJhawAAAFx0a2hkAAAAAwAAAAAAAAAAAAAAAgAAAAAAAABGAAAAAAAAAAAAAAABAQAAAAABAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAJGVkdHMAAAAcZWxzdAAAAAAAAAABAAAALgAABAAAAQAAAAABe21kaWEAAAAgbWRoZAAAAAAAAAAAAAAAAAAArEQAAAwAVcQAAAAAAC1oZGxyAAAAAAAAAABzb3VuAAAAAAAAAAAAAAAAU291bmRIYW5kbGVyAAAAASZtaW5mAAAAEHNtaGQAAAAAAAAAAAAAACRkaW5mAAAAHGRyZWYAAAAAAAAAAQAAAAx1cmwgAAAAAQAAAOpzdGJsAAAAanN0c2QAAAAAAAAAAQAAAFptcDRhAAAAAAAAAAEAAAAAAAAAAAACABAAAAAArEQAAAAAADZlc2RzAAAAAAOAgIAlAAIABICAgBdAFQAAAAAB9AAAAA+zBYCAgAUSEFblAAaAgIABAgAAABhzdHRzAAAAAAAAAAEAAAADAAAEAAAAAChzdHNjAAAAAAAAAAIAAAABAAAAAQAAAAEAAAACAAAAAgAAAAEAAAAgc3RzegAAAAAAAAAAAAAAAwAAABcAAAAGAAAABgAAABhzdGNvAAAAAAAAAAIAAAAwAAAC1gAAAGJ1ZHRhAAAAWm1ldGEAAAAAAAAAIWhkbHIAAAAAAAAAAG1kaXJhcHBsAAAAAAAAAAAAAAAALWlsc3QAAAAlqXRvbwAAAB1kYXRhAAAAAQAAAABMYXZmNTYuNDAuMTAx"),d.muted=t;let i=null;const s=new Promise((e,t)=>{i=e});let n=setTimeout(()=>{i(!1)},500);const o=d.play();return null!==o&&"object"==typeof o?o.then(()=>{t?u.muted=!0:u.unmuted=!0,clearTimeout(n),i(!0)},()=>{clearTimeout(n),i(!1)}):(clearTimeout(n),i(this.isIE())),s},isIE11:()=>!!(h.includes("MSIE")||h.includes("Trident")||h.includes("IEMobile"))&&h.includes("rv:11"),isIE(){return!this.isWindowsPhone()&&(h.includes("MSIE")||h.includes("Trident")||h.includes("Edge"))},isMac:()=>h.includes("Macintosh"),isSafari:()=>!h.includes("Chrome")&&(h.includes("Safari")&&"string"==typeof _&&_.includes("Apple Computer")),isInIframe(){try{return window.self!==window.top}catch(e){return!0}},isWindowsPhone:()=>h.includes("Windows Phone"),isAirPlayPossible:e=>!!window.WebKitPlaybackTargetAvailabilityEvent,getAirPlayTargetPickerMethod:e=>"webkitShowPlaybackTargetPicker"in e&&"function"==typeof e.webkitShowPlaybackTargetPicker?()=>{e.webkitShowPlaybackTargetPicker()}:null,getAirPlayAvailabilityChangeEventName:e=>"onwebkitplaybacktargetavailabilitychanged"in e?"webkitplaybacktargetavailabilitychanged":"",getAirPlayPlaybackChangeEventName:e=>"onwebkitcurrentplaybacktargetiswirelesschanged"in e?"webkitcurrentplaybacktargetiswirelesschanged":"",getAirPlayStateIndicator:e=>"webkitCurrentPlaybackTargetIsWireless"in e&&e.webkitCurrentPlaybackTargetIsWireless};var m={UNSPECIFIED:"ERROR_UNSPECIFIED",GENERAL:"ERROR_GENERAL",SETTING:"ERROR_SETTING",NETWORK:"ERROR_NETWORK",SOURCE:"ERROR_SOURCE",SOURCE_TECH:"ERROR_SOURCE_TECH",SOURCE_SPL:"ERROR_SOURCE_SPL",SOURCE_UNPLAYABLE:"ERROR_SOURCE_UNPLAYABLE",AD_VPAID_SOURCE:"ERROR_AD_VPAID_SOURCE",TEXTSOURCE:"ERROR_TEXTSOURCE",MEDIA:"ERROR_MEDIA",PRELOAD:"ERROR_PRELOAD",AD:"ERROR_AD",AD_IM:"ERROR_AD_IM",AD_IM_REQUEST:"ERROR_AD_IM_REQUEST",ANALYTICS:"ERROR_ANALYTICS",NORMALIZATION:"ERROR_NORMALIZATION",createSourceName:function(e){return e.replace(/\\/g,"/").replace(/^\//,"").replace(/\.js$/,"").replace(/\//g,".")},ErrorFactory:class{constructor(e){this._name=e}createError(e,t){const i=new Error(t);return i.category=e,i.source=this._name,i}},STRINGS:{STATUS_401:"Došlo k chybě v zabezpečení obsahu.",STATUS_403:"K přehrání tohoto obsahu nemáte oprávnění.",STATUS_404:"Tento obsah neexistuje.",STATUS_410:"Tento obsah již není dostupný.",DEFAULT:"Obsah se nepodařilo přehrát.",TECH:"Obsah není možné ve vašem zařízení přehrát."}};function g(){}function E(){E.init.call(this)}function T(e){return void 0===e._maxListeners?E.defaultMaxListeners:e._maxListeners}function f(e,t,i,s){var n,o,r,a;if("function"!=typeof i)throw new TypeError('"listener" argument must be a function');if((o=e._events)?(o.newListener&&(e.emit("newListener",t,i.listener?i.listener:i),o=e._events),r=o[t]):(o=e._events=new g,e._eventsCount=0),r){if("function"==typeof r?r=o[t]=s?[i,r]:[r,i]:s?r.unshift(i):r.push(i),!r.warned&&(n=T(e))&&n>0&&r.length>n){r.warned=!0;var l=new Error("Possible EventEmitter memory leak detected. "+r.length+" "+t+" listeners added. Use emitter.setMaxListeners() to increase limit");l.name="MaxListenersExceededWarning",l.emitter=e,l.type=t,l.count=r.length,a=l,"function"==typeof console.warn?console.warn(a):console.log(a)}}else r=o[t]=i,++e._eventsCount;return e}function y(e,t,i){var s=!1;function n(){e.removeListener(t,n),s||(s=!0,i.apply(e,arguments))}return n.listener=i,n}function v(e){var t=this._events;if(t){var i=t[e];if("function"==typeof i)return 1;if(i)return i.length}return 0}function A(e,t){for(var i=new Array(t);t--;)i[t]=e[t];return i}g.prototype=Object.create(null),E.EventEmitter=E,E.usingDomains=!1,E.prototype.domain=void 0,E.prototype._events=void 0,E.prototype._maxListeners=void 0,E.defaultMaxListeners=10,E.init=function(){this.domain=null,E.usingDomains&&(void 0).active&&(void 0).Domain,this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=new g,this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},E.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||isNaN(e))throw new TypeError('"n" argument must be a positive number');return this._maxListeners=e,this},E.prototype.getMaxListeners=function(){return T(this)},E.prototype.emit=function(e){var t,i,s,n,o,r,a,l="error"===e;if(r=this._events)l=l&&null==r.error;else if(!l)return!1;if(a=this.domain,l){if(t=arguments[1],!a){if(t instanceof Error)throw t;var h=new Error('Uncaught, unspecified "error" event. ('+t+")");throw h.context=t,h}return t||(t=new Error('Uncaught, unspecified "error" event')),t.domainEmitter=this,t.domain=a,t.domainThrown=!1,a.emit("error",t),!1}if(!(i=r[e]))return!1;var _="function"==typeof i;switch(s=arguments.length){case 1:!function(e,t,i){if(t)e.call(i);else for(var s=e.length,n=A(e,s),o=0;o<s;++o)n[o].call(i)}(i,_,this);break;case 2:!function(e,t,i,s){if(t)e.call(i,s);else for(var n=e.length,o=A(e,n),r=0;r<n;++r)o[r].call(i,s)}(i,_,this,arguments[1]);break;case 3:!function(e,t,i,s,n){if(t)e.call(i,s,n);else for(var o=e.length,r=A(e,o),a=0;a<o;++a)r[a].call(i,s,n)}(i,_,this,arguments[1],arguments[2]);break;case 4:!function(e,t,i,s,n,o){if(t)e.call(i,s,n,o);else for(var r=e.length,a=A(e,r),l=0;l<r;++l)a[l].call(i,s,n,o)}(i,_,this,arguments[1],arguments[2],arguments[3]);break;default:for(n=new Array(s-1),o=1;o<s;o++)n[o-1]=arguments[o];!function(e,t,i,s){if(t)e.apply(i,s);else for(var n=e.length,o=A(e,n),r=0;r<n;++r)o[r].apply(i,s)}(i,_,this,n)}return!0},E.prototype.addListener=function(e,t){return f(this,e,t,!1)},E.prototype.on=E.prototype.addListener,E.prototype.prependListener=function(e,t){return f(this,e,t,!0)},E.prototype.once=function(e,t){if("function"!=typeof t)throw new TypeError('"listener" argument must be a function');return this.on(e,y(this,e,t)),this},E.prototype.prependOnceListener=function(e,t){if("function"!=typeof t)throw new TypeError('"listener" argument must be a function');return this.prependListener(e,y(this,e,t)),this},E.prototype.removeListener=function(e,t){var i,s,n,o,r;if("function"!=typeof t)throw new TypeError('"listener" argument must be a function');if(!(s=this._events))return this;if(!(i=s[e]))return this;if(i===t||i.listener&&i.listener===t)0==--this._eventsCount?this._events=new g:(delete s[e],s.removeListener&&this.emit("removeListener",e,i.listener||t));else if("function"!=typeof i){for(n=-1,o=i.length;o-- >0;)if(i[o]===t||i[o].listener&&i[o].listener===t){r=i[o].listener,n=o;break}if(n<0)return this;if(1===i.length){if(i[0]=void 0,0==--this._eventsCount)return this._events=new g,this;delete s[e]}else!function(e,t){for(var i=t,s=i+1,n=e.length;s<n;i+=1,s+=1)e[i]=e[s];e.pop()}(i,n);s.removeListener&&this.emit("removeListener",e,r||t)}return this},E.prototype.removeAllListeners=function(e){var t,i;if(!(i=this._events))return this;if(!i.removeListener)return 0===arguments.length?(this._events=new g,this._eventsCount=0):i[e]&&(0==--this._eventsCount?this._events=new g:delete i[e]),this;if(0===arguments.length){for(var s,n=Object.keys(i),o=0;o<n.length;++o)"removeListener"!==(s=n[o])&&this.removeAllListeners(s);return this.removeAllListeners("removeListener"),this._events=new g,this._eventsCount=0,this}if("function"==typeof(t=i[e]))this.removeListener(e,t);else if(t)do{this.removeListener(e,t[t.length-1])}while(t[0]);return this},E.prototype.listeners=function(e){var t,i=this._events;return i&&(t=i[e])?"function"==typeof t?[t.listener||t]:function(e){for(var t=new Array(e.length),i=0;i<t.length;++i)t[i]=e[i].listener||e[i];return t}(t):[]},E.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):v.call(e,t)},E.prototype.listenerCount=v,E.prototype.eventNames=function(){return this._eventsCount>0?Reflect.ownKeys(this._events):[]};class S extends E{constructor(){super(),this.__listeners=[],this.__requests=[],this.__rejectors=[]}bindAll(e){let t=e instanceof Map?(t,i)=>{e.set(i,t.bind(this))}:(t,i)=>{e[i]=t.bind(this)};e.forEach(t)}addListeners(e,t){t.forEach((t,i)=>{e.addListener(i,t)})}addEventListeners(e,t){t.forEach((t,i)=>{e.addEventListener(i,t)})}removeListeners(e,t){t.forEach((t,i)=>{e.removeListener(i,t)})}removeEventListeners(e,t){t.forEach((t,i)=>{e.removeEventListener(i,t)})}registerPendingEvent(e,t,i){this.__listeners.push({subject:e,eventName:t,listener:i})}registerPendingRequest(e){this.__requests.push(e)}registerPendingPromise(e){this.__rejectors.push(e)}abortPending(){this.__listeners.forEach(({subject:e,eventName:t,listener:i})=>{e.removeListener(t,i)}),this.__requests.forEach(e=>{e.abort()}),this.__rejectors.forEach(e=>{const t=new Error("Canceled due Component#abortPending.");t.canceled=!0,e(t)})}getErrorIfIsReason(e,t="[reason is unknown]"){if(!e)return new Error(t);if(e.canceled)return null;return e instanceof Error?e:new Error(String(e))}}class b extends S{constructor(){super(),this._statsHistory=[],this._sourceSettings=null,this._isSourcePreload=null}destroy(){throw new Error('[Tech/PlaybackElement] Method "destroy" is not implemented.')}getElement(){throw new Error('[Tech/PlaybackElement] Method "getElement" is not implemented.')}getResolvedSource(){throw new Error('[Tech/PlaybackElement] Method "getResolvedSource" is not implemented.')}getCurrentSrc(){throw new Error('[Tech/PlaybackElement] Method "getCurrentSrc" is not implemented.')}getPoster(){throw new Error('[Tech/PlaybackElement] Method "getPoster" is not implemented.')}getVideoWidth(){throw new Error('[Tech/PlaybackElement] Method "getVideoWidth" is not implemented.')}getVideoHeight(){throw new Error('[Tech/PlaybackElement] Method "getVideoHeight" is not implemented.')}getVideoDimensions(){throw new Error('[Tech/PlaybackElement] Method "getVideoDimensions" is not implemented.')}getElementDimensions(){throw new Error('[Tech/PlaybackElement] Method "getElementDimensions" is not implemented.')}getVolume(){throw new Error('[Tech/PlaybackElement] Method "getVolume" is not implemented.')}getCurrentTime(){throw new Error('[Tech/PlaybackElement] Method "getCurrentTime" is not implemented.')}getDuration(){throw new Error('[Tech/PlaybackElement] Method "getDuration" is not implemented.')}getBuffered(){throw new Error('[Tech/PlaybackElement] Method "getBuffered" is not implemented.')}getQuality(){throw new Error('[Tech/PlaybackElement] Method "getQuality" is not implemented.')}getBestUsedQuality(){throw new Error('[Tech/PlaybackElement] Method "getBestUsedQuality" is not implemented.')}getDefaultQuality(){return this._sourceSettings&&void 0!==this._sourceSettings.qualityIdx?this._sourceSettings.qualityIdx:null}getStartTime(){throw new Error('[Tech/PlaybackElement] Method "getStartTime" is not implemented.')}getStatsHistory(){return this._statsHistory}getAdPoints(){throw new Error('[Tech/PlaybackElement] Method "getAdPoints" is not implemented.')}getPreloadedStats(){throw new Error('[Tech/PlaybackElement] Method "getPreloadedStats" is not implemented.')}getSourcePreload(){return this._isSourcePreload}isReady(){throw new Error('[Tech/PlaybackElement] Method "isReady" is not implemented.')}isSourceReady(){throw new Error('[Tech/PlaybackElement] Method "isSourceReady" is not implemented.')}isMuted(){throw new Error('[Tech/PlaybackElement] Method "isMuted" is not implemented.')}isPlaying(){throw new Error('[Tech/PlaybackElement] Method "isPlaying" is not implemented.')}isPaused(){throw new Error('[Tech/PlaybackElement] Method "isPaused" is not implemented.')}isSeeking(){throw new Error('[Tech/PlaybackElement] Method "isSeeking" is not implemented.')}isEnded(){throw new Error('[Tech/PlaybackElement] Method "isEnded" is not implemented.')}isBufferEmpty(){throw new Error('[Tech/PlaybackElement] Method "isBufferEmpty" is not implemented.')}isLive(){throw new Error('[Tech/PlaybackElement] Method "isLive" is not implemented.')}isEvent(){throw new Error('[Tech/PlaybackElement] Method "isEvent" is not implemented.')}isLivePlaying(){throw new Error('[Tech/PlaybackElement] Method "isLivePlaying" is not implemented.')}isLiveStreaming(){throw new Error('[Tech/PlaybackElement] Method "isLiveStreaming" is not implemented.')}setSourceSettings(e){this._sourceSettings=e}setSourcePreload(e){this._isSourcePreload=e}setSource(e,t=null){throw new Error('[Tech/PlaybackElement] Method "setSource" is not implemented.')}setPoster(e){throw new Error('[Tech/PlaybackElement] Method "setPoster" is not implemented.')}setVolume(e){throw new Error('[Tech/PlaybackElement]Method "setVolume" is not implemented.')}setMute(e){throw new Error('[Tech/PlaybackElement] Method "setMute" is not implemented.')}setQuality(e){throw new Error('[Tech/PlaybackElement] Method "setQuality" is not implemented.')}setDefaultQuality(e){throw new Error('[Tech/PlaybackElement] Method "setDefaultQuality" is not implemented.')}addStats(e){void 0!==e.bandwidth&&!isNaN(e.bandwidth)&&e.bandwidth>=0&&e.bandwidth<b.MAX_STATS_NETWORK_BANDWIDTH&&this._statsHistory.push(e)}play(){throw new Error('[Tech/PlaybackElement] Method "play" is not implemented.')}pause(){throw new Error('[Tech/PlaybackElement] Method "pause" is not implemented.')}seek(e,t=!0){throw new Error('[Tech/PlaybackElement] Method "seek" is not implemented.')}seekToLive(){throw new Error('[Tech/PlaybackElement] Method "seekToLive" is not implemented.')}resetSource(){throw new Error('[Tech/PlaybackElement] Method "resetSource" is not implemented.')}reset(){throw new Error('[Tech/PlaybackElement] Method "reset" is not implemented.')}handleError(e){throw new Error('[Tech/PlaybackElement] Method "handleError" is not implemented.')}}b.MAX_STATS_NETWORK_BANDWIDTH=12e7,b.EVENT_READY="ready",b.EVENT_SOURCE_SET="sourceset",b.EVENT_SOURCE_READY="sourceready",b.EVENT_SOURCE_CANCEL="sourcecancel",b.EVENT_QUALITY_SET="qualityset",b.EVENT_QUALITY_CHANGE="qualitychange",b.EVENT_TEXT_TRACK_REQUEST="texttrackrequest",b.EVENT_TEXT_TRACK_SET="texttrackset",b.EVENT_DURATION_CHANGE="durationchange",b.EVENT_VOLUME_CHANGE="volumechange",b.EVENT_LIVE_PLAYING_CHANGE="liveplayingchange",b.EVENT_LIVE_STREAMING_CHANGE="livestreamingchange",b.EVENT_MEDIA_ABORT="abort",b.EVENT_PROGRESS="progress",b.EVENT_LOAD_START="loadstart",b.EVENT_LOADED_META="loadedmetadata",b.EVENT_LOADED_DATA="loadeddata",b.EVENT_LOADED_SEGMENT="loadedsegment",b.EVENT_LOADED_SILENT_AUDIO="loadedsilentaudio",b.EVENT_LOADING_PROGRESS="loadingprogress",b.EVENT_LOADING_FAILED="loadingfailed",b.EVENT_LOADING_ABORTED="loadingaborted",b.EVENT_PLAY="play",b.EVENT_PLAY_DENIED="playdenied",b.EVENT_PLAYING="playing",b.EVENT_PAUSED="paused",b.EVENT_TIMEUPDATE="timeupdate",b.EVENT_SEEKSTART="seekstart",b.EVENT_SEEKING="seeking",b.EVENT_SEEKED="seeked",b.EVENT_ENDED="ended",b.EVENT_BUFFER_READY="bufferready",b.EVENT_BUFFER_EMPTY="bufferempty",b.EVENT_CAN_PLAY="canplay",b.EVENT_FULLSCREEN_CHANGE="fullscreenchange",b.EVENT_SKIP_VIDEO_REQUEST="skipvideorequest",b.EVENT_VIDEO_CLICKTHROUGH="videoclickthrough",b.EVENT_VE_CLICK="visualelement-click",b.EVENT_VE_CLOSE="visualelement-close",b.EVENT_DESTROY="destroy",b.EVENT_ERROR="error";class C{constructor(e){this._disabled=!1,this._id=e.id,this._name=e.name,this._label=e.label,this._resolution=e.resolution}static toMicroseconds(e){let t=String(e),i=t.indexOf(".");if(i>-1){let e=t.substring(0,i),s=t.substring(i+1,i+1+6);return parseInt(e,10)*Math.pow(10,6)+parseInt(s,10)*Math.pow(10,6-s.length)}return e*Math.pow(10,6)}static fromMicroseconds(e){return e/1e6}isAdaptive(){throw new Error('[QualityItem] Method "isAdaptive" is not implemented.')}getTrackIdByName(e,t){throw new Error('[QualityItem] Method "getTrackIdByName" is not implemented.')}getTrackNameById(e,t){throw new Error('[QualityItem] Method "getTrackNameById" is not implemented.')}getTracks(e){throw new Error('[QualityItem] Method "getTracks" is not implemented.')}getTrack(e,t=""){throw new Error('[QualityItem] Method "getTrack" is not implemented.')}getDefaultTrackId(e){throw new Error('[QualityItem] Method "getDefaultTrackId" is not implemented.')}getFramerate(){throw new Error('[QualityItem] Method "getFramerate" is not implemented.')}getType(){throw new Error('[QualityItem] Method "getType" is not implemented.')}getUrl(){throw new Error('[QualityItem] Method "getUrl" is not implemented.')}getBitrate(){throw new Error('[QualityItem] Method "getBitrate" is not implemented.')}getCodecs(){throw new Error('[QualityItem] Method "getCodecs" is not implemented.')}getDuration(){throw new Error('[QualityItem] Method "getDuration" is not implemented.')}getId(){return this._id}getName(){return this._name}getLabel(){return this._label}getResolution(){return this._resolution}isDisabled(){return this._disabled}enable(){this._disabled=!1}disable(){this._disabled=!0}}C.MAX_BUFFER_SIZE=30,C.TYPE_VIDEO="video",C.TYPE_AUDIO="audio",C.TYPE_SUBTITLES="subtitles",C.TYPE_CLOSE_CAPTIONS="closedCaptions";let P=new m.ErrorFactory(m.createSourceName("src/js/mediaplayer/tech/html/VideoElement.js"));const k="track-";class I extends b{constructor(e,t,i){super(),this._env=e,this._utils=t,this._options=i,this._element=null,this._eventsMap=new Map([["durationchange",this.__event_durationchange],["volumechange",this.__event_volumechange],["abort",this.__event_abort],["progress",this.__event_progress],["loadstart",this.__event_loadstart],["loadedmetadata",this.__event_loadedmetadata],["loadeddata",this.__event_loadeddata],["play",this.__event_play],["playing",this.__event_playing],["pause",this.__event_pause],["timeupdate",this.__event_timeupdate],["seeking",this.__event_seeking],["seeked",this.__event_seeked],["ended",this.__event_ended],["error",this.__event_error]]),this._isReady=!1,this._isSourceReady=!1,this._isPaused=!0,this._isPlayingPending=!1,this._isPlayingSent=!1,this._isBufferEmpty=null,this._isBufferEmptyPending=!1,this._isSeekingInBuffer=!1,this._isLivePlaying=!1,this._wasLive=!1,this._wasEvent=!1,this._isLiveStreaming=!1,this._lastAdaptiveDuration=null,this._lastAdaptiveRealDuration=null,this._isSeekWaitingToLoad=!1,this._wasLoading=!1,this._qualityIdx=null,this._videoTrackId=void 0,this._audioTrackId=void 0,this._qualityItem=null,this._source=null,this._eventTimer=null,this._timeupdateTimer=null,this._pauseTimer=null,this._seekErrorTimer=null,this._mediaErrorCounter=0,this._adPoints=[],this._preloadedStats=[],this._seekInBufferTimer=null;let s=null;if(this._options.element){if(!(s=this._utils.getElement(this._options.element)))throw P.createError(m.SETTING,`Element "${this._options.element}" doesn't exist.`)}else s=window.document.createElement("video");let n=this._options.elmId||s.id||`hlm${this._options.id}`;this._attachElement(s),this._element.setAttribute("id",n),this._element.setAttribute("tabIndex",-1),this._element.setAttribute("playsinline","playsinline"),this._options.controls?this._element.setAttribute("controls","controls"):this._element.removeAttribute("controls"),this._options.muted?this._element.setAttribute("muted","muted"):this._element.removeAttribute("muted"),this._options.preload?this._element.setAttribute("preload",this._options.preload):this._element.removeAttribute("preload"),this._options.crossorigin?this._element.setAttribute("crossorigin",this._options.crossorigin):this._element.removeAttribute("crossorigin"),this.bindAll(this._eventsMap),this.addEventListeners(this._element,this._eventsMap),setTimeout(()=>{this.emit(b.EVENT_READY)},0)}destroy(){this.reset(),void 0!==this._isActive&&this._isActive&&this.resetAdaptive(),this.removeEventListeners(this._element,this._eventsMap)}getElement(){return this._element}getResolvedSource(){return this._source}getCurrentSrc(){return this._source?this._element.currentSrc:""}getCurrentAdaptiveSrc(){return this._source?this._source.getAdaptiveSrc():""}getPoster(){return this._element.poster}getVideoWidth(){return this._element.videoWidth}getVideoHeight(){return this._element.videoHeight}getVideoDimensions(){if(!this._element.videoWidth||!this._element.videoHeight)return null;const e=this._element.offsetWidth,t=this._element.offsetHeight,i=this._element.videoWidth,s=this._element.videoHeight,n=e/i,o=t/s,r=n<o?n:o,a=Math.ceil(Math.min(i*r,e)),l=Math.ceil(s*r);return{x:Math.round((e-a)/2),y:Math.round((t-l)/2),width:a,height:l,videoWidth:i,videoHeight:s}}getElementDimensions(){return this._element.offsetWidth&&this._element.offsetHeight?{elementWidth:this._element.offsetWidth,elementHeight:this._element.offsetHeight}:null}getVolume(){return this._element.volume}getCurrentTime(){return this._element.currentTime}getDuration(){return this._lastAdaptiveDuration||this._element.duration}getBuffered(e,t=I.BUFFER_HOLE_TOLERANCE){return this._getBuffered(this._element.buffered,e,t)}_getBuffered(e,t,i){let s,n=[];for(s=0;s<e.length;s++)n.length&&e.start(s)-n[n.length-1].end<i?n[n.length-1].end=e.end(s):n.push({start:e.start(s),end:e.end(s)});for(s=0;s<n.length;s++)if(n[s].start<=t+i&&n[s].end>t){const e=i?I.BUFFER_INACCURACY_TOLERANCE:0;return{start:n[s].start,end:n[s].end+e,length:n[s].end+e-t}}return{start:t,end:t,length:0}}getQuality(){return this._qualityIdx}getCurrentFrame(e){if(this._env.isSafari())return null;if(e&&e>this._element.videoHeight)return null;const t=e?e/this._element.videoHeight:1,i=document.createElement("canvas");i.width=this._element.videoWidth*t,i.height=this._element.videoHeight*t,i.getContext("2d").drawImage(this._element,0,0,i.width,i.height);let s=null;try{s=i.toDataURL()}catch(e){}return s}getBestUsedQuality(){return this.getQuality()}getStartTime(){return this._sourceSettings&&void 0!==this._sourceSettings.startTime?this._sourceSettings.startTime:null}getAdPoints(){return this._adPoints}getPreloadedStats(){return this._preloadedStats}getTrack(e){return e===C.TYPE_AUDIO?this._audioTrackId:this._videoTrackId}getQualityItem(){return this._qualityItem}isReady(){return!0}isSourceReady(){return this._isSourceReady}isMuted(){return this._element.muted}isPlaying(){return!this._isPaused}isPaused(){return this._isPaused}isSeeking(){return this._element.seeking}isEnded(){return this._element.ended}isBufferEmpty(){return this.isEnded()||null===this._isBufferEmpty||this._isBufferEmpty}isLive(){return!this.isEvent()&&(!!this._sourceSettings&&void 0!==this._sourceSettings.streamingType&&"live"===this._sourceSettings.streamingType||this._wasLive)}isEvent(){return!!this._sourceSettings&&void 0!==this._sourceSettings.streamingType&&"event"===this._sourceSettings.streamingType||this._wasEvent}isLivePlaying(){return this._isLivePlaying}isLiveStreaming(){return this._isLiveStreaming}handleAdaptiveTrackUpdate(e,t=!1){this._updateAdaptiveTrackData(e,t)}_updateAdaptiveTrackData(e,t=!1){const i=e.isLive();i&&(this._wasLive=!0),e.isEvent()&&(this._wasEvent=!0);const s=this._isLiveStreaming&&!i;if(this._isLiveStreaming!==i&&(this._isLiveStreaming=i,this.emit(b.EVENT_LIVE_STREAMING_CHANGE,{liveStreaming:i})),this._isLiveStreaming){const i=e.getDuration(this._isLiveStreaming);if(null===this._lastAdaptiveDuration||this._lastAdaptiveDuration!==i&&(!isNaN(this._lastAdaptiveDuration)||!isNaN(i))){this.isPaused()&&this._setLivePlaying(!1);const t=e.getDuration();this._lastAdaptiveDuration=i,this._lastAdaptiveRealDuration=t,this.emit(b.EVENT_DURATION_CHANGE,{duration:i,realDuration:t})}t&&this._setLivePlaying(null===this.getStartTime()||this.getStartTime()>=i)}else if(this._lastAdaptiveDuration=null,this._lastAdaptiveRealDuration=null,s){const t=e.getDuration();this.emit(b.EVENT_DURATION_CHANGE,{duration:this._element.duration,realDuration:t})}}setSource(e,t=null){const i=()=>{this._isSourceReady=!0,this.emit(b.EVENT_SOURCE_READY,{source:e})};if(this._source=e,this._isSourceReady=!1,this.setSourceSettings(t),this._source.hasQualityItemWithSeparatedStreams()&&!this._source.isTrackSelectionSupported())this._qualityIdx=null;else if(t&&"function"==typeof t.forcedQualityFunc){0;try{const e=t.forcedQualityFunc(this._source);(null===e&&this._source.isAdaptive()||null!==e&&this._source.getQualityItem(e))&&(this._qualityIdx=e)}catch(e){0}}else t&&void 0!==t.forcedQualityIdx&&(null===t.forcedQualityIdx&&this._source.isAdaptive()||null!==t.forcedQualityIdx&&this._source.getQualityItem(t.forcedQualityIdx))?this._qualityIdx=t.forcedQualityIdx:t&&void 0!==t.storedQualityIdx&&null!==t.storedQualityIdx&&this._source.getQualityItem(t.storedQualityIdx)&&(this._qualityIdx=t.storedQualityIdx);if(t&&void 0!==t.storedAudioTrack&&null!==t.storedAudioTrack&&this._source.isTrackSelectionSupported()){let e=this._source.getTrackIdByName(t.storedAudioTrack,C.TYPE_AUDIO);if(null!==this._qualityIdx){const t=this._source.getQualityItem(this._qualityIdx);t&&t.getTrack(e,C.TYPE_AUDIO)||(e=null)}null!==e&&(this._audioTrackId=e)}if(t&&void 0!==t.storedVideoTrack&&null!==t.storedVideoTrack&&this._source.isTrackSelectionSupported()){let e=this._source.getTrackIdByName(t.storedVideoTrack,C.TYPE_VIDEO);if(null!==this._qualityIdx){const t=this._source.getQualityItem(this._qualityIdx);t&&t.getTrack(e,C.TYPE_VIDEO)||(e=null)}null!==e&&(this._videoTrackId=e)}if(t&&void 0!==t.bandwidth&&!this.getStatsHistory().length){const e=parseInt(t.bandwidth,10);!isNaN(e)&&e>0&&this.addStats({bandwidth:e})}t&&void 0!==t.preloadedStats&&(this._preloadedStats=t.preloadedStats),this.getCurrentTime()>0&&this.seekInBuffer(0),this._eventTimer=setInterval(this._onEventTimer.bind(this),100),this.emit(b.EVENT_SOURCE_SET,{source:e}),this.once(b.EVENT_LOAD_START,i),this.registerPendingEvent(this,b.EVENT_LOAD_START,i)}setPoster(e){e?this._element.setAttribute("poster",e):this._element.hasAttribute("poster")&&this._element.removeAttribute("poster")}addTrack(e,t){const i=this._createTrackElement(e,t);this._element.appendChild(i)}setTrackVisible(e){const t=this._element.textTracks;if(t)for(let i=0;i<t.length;i++)t[i].mode=null!==e&&t[i].id===k+e?"showing":"hidden"}setVolume(e){this._element.volume=e}setMute(e){this._element.removeAttribute("muted"),this._element.muted=!!e}setQuality(e){if(!this._source||null===e&&!this._source.isAdaptive()||null!==e&&!this._source.getQualityItem(e)){const t=P.createError(m.SETTING,`Quality "${e}" doesn't exist.`);return void this.handleError(t)}if(this._qualityIdx===e)return;this._qualityIdx=e;const t=this.isPlaying(),i=this._isPlayingSent;this.isLivePlaying()||this.pause(!1),this.emit(b.EVENT_QUALITY_SET,{qualityIdx:e,wasPlaying:t,wasPlayingSent:i})}setTrack(e,t){if(t==C.TYPE_VIDEO){if(this._videoTrackId===e)return;this._videoTrackId=e}else{if(t!=C.TYPE_AUDIO){const e=P.createError(m.SETTING,"Only audio/video tracks are supported.");return void this.handleError(e)}if(this._audioTrackId===e)return;this._audioTrackId=e}const i=this.isPlaying(),s=this._isPlayingSent;this.isLivePlaying()||this.pause(!1),this.emit(b.EVENT_TRACK_SET,{trackId:e,trackType:t,trackName:this._source.getTrackNameById(e,t),wasPlaying:i,wasPlayingSent:s,isUserAction:!0})}setDefaultQuality(e){null===this._qualityIdx&&(this._qualityIdx=e,this.emit(b.EVENT_QUALITY_SET,{qualityIdx:e,autoset:!0}))}setAdPoints(e){this._adPoints=e}loadSource(e,t,i,s=null){this._wasLoading=!0,this._isSeekingInBuffer=!0,this._source.isAdaptive()?(this._audioTrackId=t,this._videoTrackId=i):(this._audioTrackId=void 0,this._videoTrackId=void 0);let n=this._source.getQualityItemUrl(e,this._audioTrackId,this._videoTrackId);this.setSrc(n)}play(e=!0){this._setPlay(e);const t=this._element.play();null!==t&&"object"==typeof t&&t.catch(()=>{this._isSourceReady&&this._element.paused&&this._element.play().catch(()=>{this._setPaused(!0),this.emit(b.EVENT_PLAY_DENIED)})})}pause(e=!0){this._setPaused(e),this._element.pause()}seek(e,t=!0){this._isSeekingInBuffer=!1,this.emit(b.EVENT_SEEKSTART,{time:e}),this._element.currentTime=e}seekInBuffer(e){return this._isSeekingInBuffer=!0,this._element.seekable.length?this._element.currentTime=e:this._setSeekInBufferTimer(e),!0}_setSeekInBufferTimer(e){this._clearSeekInBufferTimer(),this._seekInBufferTimer=setTimeout(()=>{this._element.seekable.length?this._element.currentTime=e:this._setSeekInBufferTimer(e)},100)}seekToLive(){this.seek(this.getDuration()||0)}resetSource(){this.abortPending(),this.setSrc(""),this._source=null,this.setSourceSettings(null),this._qualityIdx=null,this._wasLive=!1,this._wasEvent=!1,this._isLiveStreaming=!1,this._isSourceReady=!1,this._isBufferEmptyPending=!1,this._isSeekingInBuffer=!1,this._isLivePlaying=!1,this._lastAdaptiveDuration=null,this._lastAdaptiveRealDuration=null,this._audioTrackId=void 0,this._videoTrackId=void 0,this._qualityItem=null,this._clearSeekInBufferTimer(),this._clearEventTimer(),this._clearTimeupdateTimer(),this._clearSeekErrorTimer(),this._isPaused=!0,this._isPlayingPending=!1,this._isPlayingSent=!1,this._isBufferEmpty=null,this._wasLoading=!1,this._mediaErrorCounter=0,this._adPoints=[],this._preloadedStats=[],void 0!==this._isActive&&this._isActive?this.resetSourceAdaptive():this.emit(b.EVENT_SOURCE_CANCEL)}reset(){this.resetSource(),this._removeAllTracks(),this.setPoster("")}handleError(e){this.emit(b.EVENT_ERROR,e)}setSrc(e){if(e){const t=this._element.paused;if(this._element.src=e,!t&&this._element.paused){const e=this._element.play();null!==e&&"object"==typeof e&&e.catch(()=>{})}}else this._element.removeAttribute("src"),this._element.load()}_setLivePlaying(e){this._isLivePlaying!==e&&(this._isLivePlaying=e,this.emit(b.EVENT_LIVE_PLAYING_CHANGE,{livePlaying:this._isLivePlaying}))}_setPlay(e=!0){this._isPaused=!1,this._isPlayingPending=e,e&&this.emit(b.EVENT_PLAY),(this._isBufferEmpty||null===this._isBufferEmpty)&&(this._isBufferEmpty=!0,this.emit(b.EVENT_BUFFER_EMPTY))}_setPaused(e=!0){if(this._isPaused=!0,this._isPlayingSent=!1,this._isPlayingPending=!1,e){const e=this.isEnded();0,this.emit(b.EVENT_PAUSED,{ended:e})}}_onEventTimer(){const e=this.isEnded();let t=this._element.readyState<this._element.HAVE_FUTURE_DATA||this._isBufferEmptyPending;if(this._wasLoading&&this._isBufferEmpty!==t)if(this._isBufferEmpty=t,this._isBufferEmpty){if(!e){let e=this.getBuffered(this._element.currentTime,0);this._element.readyState<this._element.HAVE_FUTURE_DATA&&!this.isLive()&&e.length>=1?(this._clearSeekErrorTimer(),this._setSeekErrorTimer()):this._skipBufferHole(),this._isSeekWaitingToLoad=!0,this.emit(b.EVENT_BUFFER_EMPTY)}}else this._clearSeekErrorTimer(),this.emit(b.EVENT_CAN_PLAY)}_onTimeupdateTimer(){this._element.paused||this.isEnded()||(this._isBufferEmptyPending=!0)}_clearEventTimer(){this._eventTimer&&(clearInterval(this._eventTimer),this._eventTimer=null)}_clearSeekInBufferTimer(){this._seekInBufferTimer&&(clearTimeout(this._seekInBufferTimer),this._seekInBufferTimer=null)}_clearTimeupdateTimer(){this._timeupdateTimer&&(clearInterval(this._timeupdateTimer),this._timeupdateTimer=null)}_clearSeekErrorTimer(){this._isSeekWaitingToLoad=!1,this._seekErrorTimer&&(clearTimeout(this._seekErrorTimer),this._seekErrorTimer=null)}_setSeekErrorTimer(){this._seekErrorTimer=setTimeout(()=>{this._seekErrorTimer=null,void 0!==this._isActive&&this._isActive&&this._element.readyState<this._element.HAVE_FUTURE_DATA&&this._softReset()},1500)}_softReset(){this.loadSource(this._qualityIdx,this._audioTrackId,this._videoTrackId,this._element.currentTime)}_skipBufferHole(){let e=this.getCurrentTime(),t=this.getBuffered(e,0);if(t.length<I.BUFFER_HOLE_TOLERANCE){let i=this.getBuffered(e+t.length+I.BUFFER_HOLE_TOLERANCE,0);if(i.length>0)return void this.seek(i.start)}}_attachElement(e){if(!e)throw P.createError(m.SETTING,"Element must be specified.");if(!e.canPlayType)throw P.createError(m.SETTING,`Element "${e}" is not valid.`+" Element must have a type of HTMLMediaElement.");this._element=e}_createTrackElement(e,t){const i=document.createElement("track");return i.setAttribute("id",k+t),i.setAttribute("src",e.src),i.setAttribute("kind",e.kind),e.srclang&&i.setAttribute("srclang",e.srclang),e.label&&i.setAttribute("label",e.label),e.default&&i.setAttribute("default",!0),i}_removeAllTracks(){const e=this._element.querySelectorAll("track");for(var t=e.length-1;t>=0;t--)e[t].parentNode.removeChild(e[t])}__event_volumechange(e){const t=this._element.muted,i=this._element.volume;this.emit(b.EVENT_VOLUME_CHANGE,{muted:t,level:i})}__event_durationchange(e){if(void 0===this._isActive||!this._isActive){const e=this.getDuration(),t=this._lastAdaptiveRealDuration||e;this.emit(b.EVENT_DURATION_CHANGE,{duration:e,realDuration:t})}}__event_abort(e){this.emit(b.EVENT_MEDIA_ABORT)}__event_progress(e){this.emit(b.EVENT_PROGRESS)}__event_loadstart(e){this._wasLoading&&this.emit(b.EVENT_LOAD_START)}__event_loadedmetadata(e){this.emit(b.EVENT_LOADED_META,{duration:this.getDuration()})}__event_loadeddata(e){this.emit(b.EVENT_LOADED_DATA)}__event_play(e){this._isPaused&&this._setPlay()}__event_playing(e){if(this._isPlayingPending){const e=this._element.currentTime;0,this._isPlayingPending=!1,this._isPlayingSent=!0,this.emit(b.EVENT_PLAYING,{time:e})}}__event_pause(e){const t=this.isEnded();this._isPaused||this._element.seeking||t?t&&this._setPaused():this._element.seeking||this._setPaused()}__event_timeupdate(e){if(!this._isSourceReady)return;const t=this._element.currentTime,i=this._element.paused;this.emit(b.EVENT_TIMEUPDATE,{time:t}),this._element.readyState>=this._element.HAVE_FUTURE_DATA&&this._clearSeekErrorTimer(),this._clearTimeupdateTimer(),i||(this._isBufferEmptyPending=!1,this.isBufferEmpty()||(this._timeupdateTimer=setTimeout(this._onTimeupdateTimer.bind(this),500)))}__event_seeking(e){if(this._clearSeekErrorTimer(),void 0!==this._isActive&&this._isActive){this.getBuffered(this._element.currentTime,0).length>=1?this._setSeekErrorTimer():this._isSeekWaitingToLoad=!0}if(this._isSeekingInBuffer)return;this._setLivePlaying(this._isLiveStreaming&&this.getDuration()-this._element.currentTime<1);const t=this._element.currentTime;this.emit(b.EVENT_SEEKING,{time:t})}__event_seeked(e){if(this._clearSeekErrorTimer(),this._isSeekingInBuffer)return void(this._isSeekingInBuffer=!1);const t=this._element.currentTime;this.emit(b.EVENT_SEEKED,{time:t})}__event_ended(e){this.emit(b.EVENT_ENDED)}__event_error(e){const t=e.target.error;if(!t)return;if(t.code===t.MEDIA_ERR_SRC_NOT_SUPPORTED&&!this._element.src)return;if((t.code===t.MEDIA_ERR_SRC_NOT_SUPPORTED||t.code===t.MEDIA_ERR_DECODE)&&this._mediaErrorCounter<I.MEDIA_ERRORS_MAX)return this._mediaErrorCounter++,void this._softReset();let i="";switch(t.code){case t.MEDIA_ERR_ABORTED:return void(i="The fetching process for the media resource was aborted by the user agent at the user's request.");case t.MEDIA_ERR_NETWORK:i="A network error of some description caused the user agent to stop fetching the media resource, after the resource was established to be usable.";break;case t.MEDIA_ERR_DECODE:i="An error of some description occurred while decoding the media resource, after the resource was established to be usable.";break;case t.MEDIA_ERR_SRC_NOT_SUPPORTED:i="The media resource indicated by the src attribute was not suitable.";break;default:i="An unknown error occurred."}const s=P.createError(m.MEDIA,i);s.code=t.code,s.src=this._element.src,this.handleError(s)}}I.BUFFER_HOLE_TOLERANCE=.3,I.BUFFER_INACCURACY_TOLERANCE=.2,I.MEDIA_ERRORS_MAX=2;let w=new m.ErrorFactory(m.createSourceName("src/js/mediaplayer/streaming/QualityList.js"));class N{constructor(e,t={},i=null){if(!e||!Array.isArray(e)||!e.length)throw w.createError(m.SOURCE,"Invalid data.");if(e.some(e=>!Array.isArray(e.source)||!e.source.length))throw w.createError(m.SOURCE,"Invalid data source.");if(e.some(e=>e.source.some(e=>!e.type||void 0===e.src)))throw w.createError(m.SOURCE,"Invalid data source - missing attribute src or type.");this.type="quality",this.data=e,this.adaptiveSource=t,this._options=i,this.data.sort((e,t)=>e.source[0].bitrate-t.source[0].bitrate)}isAdaptive(){return!!this.getAdaptiveType()}getAdaptiveType(){return this.adaptiveSource.type||""}getAdaptiveSrc(){return this.adaptiveSource.src||""}getAdaptiveName(){return this.adaptiveSource.name||""}getData(){return this.data}getLength(){return this.data.length}getName(e){return this.data[e].name}getSource(e){return this.data[e].source}}new m.ErrorFactory(m.createSourceName("src/js/mediaplayer/streaming/resolvedQualityList/Track.js"));class L{constructor(e={}){this._id=void 0!==e.id?e.id:NaN,this._url=e.url||null,this._name=e.name||"?",this._hasAudio=void 0!==e.hasAudio?e.hasAudio:null,this._hasVideo=void 0!==e.hasVideo?e.hasVideo:null,this._codecs=e.codecs||null,this._bitrate=e.bitrate||null,this._framerate=e.framerate||null,this._adaptiveType=e.adaptiveType||null,this._type=e.type||null,this._groupId=void 0!==e.groupId?e.groupId:null,this._language=void 0!==e.language?e.language:null,this._assocLanguage=void 0!==e.assocLanguage?e.assocLanguage:null,this._autoselect=void 0!==e.autoselect?e.autoselect:null,this._default=void 0!==e.default?e.default:null,this._channels=void 0!==e.channels?e.channels:null,this._instreamId=void 0!==e.instreamId?e.instreamId:null,this._src=e.src?L.createTrackSource(e.src):null,this._wasLive=!1,this._artificial=void 0!==e.artificial&&e.artificial}static createTrackSource(e){let t={allowCache:e.allowCache,dsequence:e.dsequence,duration:e.duration,isChanged:e.isChanged,isEvent:e.isEvent,isLive:e.isLive,segments:Array.isArray(e.segments)?o.clone(e.segments):[],sequence:e.sequence,targetDuration:e.targetDuration,version:e.verbatimCommand,headerFile:e.headerFile,srcType:e.srcType};return t.segments.forEach(e=>{e.updated||(e.updated=!1,e.originalDuration=e.duration)}),t}clone(){let e={};return Object.keys(this).forEach(t=>{e[t.substr(1)]=o.clone(this[t])}),new L(e)}forceDefault(){this._default=!0,this._autoselect=!0}getDuration(e=!1){if(!this._src)return NaN;if(this.isLive()&&!this.isEvent())return NaN;const t=this._src.duration;return e?t<C.MAX_BUFFER_SIZE?NaN:t-C.MAX_BUFFER_SIZE:t}addUpdatedData(e){let t=e.getSource();if(!t||!this._src)return;let i=t.segments,s=this._src.segments;for(let e=0;e<i.length;e++){const n=e+t.sequence-this.getSequence();n>=0&&i[e].updated&&void 0!==s[n]&&(s[n].start=i[e].start,s[n].duration=i[e].duration,s[n].updated=!0)}}resetSegmentsData(){this._src&&this._src.segments.forEach(e=>{e.duration=e.originalDuration,e.start=null,e.updated=!1})}getSegment(e){if(!this._src)return null;const t=this._src.segments;const i=C.toMicroseconds(e);let s=void 0;for(let e=0;e<t.length;e++)if(t[e].updated){const n=C.toMicroseconds(t[e].start),o=C.toMicroseconds(t[e].duration);if(n<=i&&n+o>i)return Object.assign({},t[e],{idx:e});if(n>i){void 0===s&&(s=e);break}s=e}if(void 0!==s){let e=C.toMicroseconds(t[s].start);if(!(e>i)){let n=e;for(let e=s;e<t.length;e++){const s=n;if((n=e+1<t.length&&t[e+1].updated?C.toMicroseconds(t[e+1].start):n+C.toMicroseconds(t[e].duration))>i)return t[e].updated&&s+C.toMicroseconds(t[e].duration)<=i?null:Object.assign({},t[e],{idx:e,start:C.fromMicroseconds(s)})}return}for(let n=s;n>=0;n--){if(e<=i||!n)return t[n].updated&&e>i?null:t[n].updated&&e+C.toMicroseconds(t[n].duration)<=i?null:Object.assign({},t[n],{idx:n,start:C.fromMicroseconds(e>0?e:0)});e=t[n-1].updated?C.toMicroseconds(t[n-1].start):e-C.toMicroseconds(t[n-1].duration)}}else{if(this._wasLive){const e=C.fromMicroseconds(i);return Object.assign({},t[0],{idx:0,start:e})}let e=0;for(let s=0;s<t.length;s++){const n=C.fromMicroseconds(e);if((e+=C.toMicroseconds(t[s].duration))>i||s===t.length-1)return Object.assign({},t[s],{idx:s,start:n})}}return null}getSegmentsLength(){return this._src?this._src.segments.length:NaN}updateSegmentData(e,t,i){this._src&&(this._src.segments[e].duration=i,this._src.segments[e].start=t,this._src.segments[e].updated=!0)}isLive(){return!!this._src&&this._src.isLive}isEvent(){return!!this._src&&this._src.isEvent}isChanged(){return!!this._src&&this._src.isChanged}setChanged(e){this._src&&(this._src.isChanged=e)}getSrcType(){return this._src?this._src.srcType:null}getSequence(){return this._src?this._src.sequence:NaN}getTargetDuration(){return this._src?this._src.targetDuration:NaN}getHeaderFile(){return this._src?this._src.headerFile:null}setSource(e){this._src=L.createTrackSource(e),this._wasLive||!this.isLive()||this.isEvent()||(this._wasLive=!0)}getSource(){return o.clone(this._src)}hasSource(){return!!this._src}getId(){return this._id}getUrl(){return this._url}getName(){return this._name}hasAudio(){return this._hasAudio}hasVideo(){return this._hasVideo}getCodecs(e=null){return e===C.TYPE_VIDEO?this._codecs.video:e===C.TYPE_AUDIO?this._codecs.audio:o.clone(this._codecs)}getBitrate(){return this._bitrate}getFramerate(){return this._framerate}getAdaptiveType(){return this._adaptiveType}getType(){return this._type}getGroupId(){return this._groupId}getLanguage(){return this._language}getAssocLanguage(){return this._assocLanguage}getAutoselect(){return this._autoselect}isDefault(){return this._default}isArtificial(){return this._artificial}getChannels(){return this._channels}getInstreamId(){return this._instreamId}}class x extends C{constructor(e,t,i){super(e),this._adaptiveType=i,this._srcStream=new L(this._createTrackData(Object.assign({id:null},t.srcStream))),this._tracks=this._createSource(t)}_createSource(e){let t={video:{},audio:{},subtitles:{},closedCaptions:{}};e.video.forEach(e=>{e.artificial&&!this._srcStream.hasVideo()||(t.video[e.id]=new L(this._createTrackData(e,C.TYPE_VIDEO)))});let i=Object.keys(t.video),s=t.video,n=i.some(e=>s[e].isDefault());return i.length&&!n&&s[i[0]].forceDefault(),e.audio.forEach(e=>{e.artificial&&!this._srcStream.hasAudio()||(t.audio[e.id]=new L(this._createTrackData(e,C.TYPE_AUDIO)))}),i=Object.keys(t.audio),s=t.audio,n=i.some(e=>s[e].isDefault()),i.length&&!n&&s[i[0]].forceDefault(),e.subtitles.forEach(e=>{t.subtitles[e.id]=new L(this._createTrackData(e,C.TYPE_SUBTITLES))}),e.closedCaptions.forEach(e=>{t.closedCaptions[e.id]=new L(this._createTrackData(e,C.TYPE_CLOSE_CAPTIONS))}),t}isAdaptive(){return!0}getTrackIdByName(e,t){let i=this._getTrackTypeData(t);if(i){const t=Object.keys(i).find(t=>i[t].getName()===e);return t?i[t].getId():null}return null}getTrackNameById(e,t){let i=this._getTrackTypeData(t);if(i){const t=Object.keys(i).find(t=>parseInt(t)===e);return t?i[t].getName():null}return null}isLive(e,t){const i=this.getTrack(e,C.TYPE_AUDIO),s=this.getTrack(t,C.TYPE_VIDEO);return!!(i&&i.isLive()||s&&s.isLive())}isEvent(e,t){const i=this.getTrack(e,C.TYPE_AUDIO),s=this.getTrack(t,C.TYPE_VIDEO);return!!(i&&i.isEvent()||s&&s.isEvent())}getCodecs(e=null){const t=this.getDefaultTrackId(C.TYPE_VIDEO),i=this.getDefaultTrackId(C.TYPE_AUDIO),s=this.getTrack(t,C.TYPE_VIDEO),n=this.getTrack(i,C.TYPE_AUDIO);return null===e&&s&&s.hasVideo()&&(!n||!n.hasAudio())||s&&e===C.TYPE_VIDEO?s.getCodecs().video:null===e&&n&&n.hasAudio()&&(!s||!s.hasVideo())||n&&e===C.TYPE_AUDIO?n.getCodecs().audio:null===e&&s&&n&&s.hasVideo()&&n.hasAudio()?s.getCodecs().video+","+n.getCodecs().audio:null}getDuration(e,t,i=!1){const s=this.getTrack(t,C.TYPE_VIDEO),n=this.getTrack(e,C.TYPE_AUDIO),o=s||n||null;return o?o.getDuration(i):NaN}getBitrate(e,t){const i=this.getTrack(t,C.TYPE_VIDEO),s=this.getTrack(e,C.TYPE_AUDIO);let n=0;if(i){if(i.hasAudio()&&i.hasVideo())return i.getBitrate();i.hasVideo()&&(n+=i.getBitrate())}if(s){if(s.hasAudio()&&s.hasVideo())return s.getBitrate();s.hasAudio()&&(n+=s.getBitrate())}return n||NaN}getFramerate(){return this._srcStream.hasVideo()?this._srcStream.getFramerate():this._tracks.video.length?this._tracks[0].getFramerate():null}getType(){return this._srcStream.getType()}getUrl(){return this._srcStream.getUrl()||""}getTracks(e){let t=this._getTrackTypeData(e);if(t){let e=[];return Object.keys(t).forEach(i=>{e.push(t[i])}),e}return[]}getTrack(e,t=""){if(null===e&&this._srcStream)return t===C.TYPE_VIDEO&&this._srcStream.hasVideo()||t===C.TYPE_AUDIO&&this._srcStream.hasAudio()||""===t?this._srcStream:null;let i=this._getTrackTypeData(t);return i&&i[e]?i[e]:null}getDefaultTrackId(e){let t=this._getTrackTypeData(e),i=void 0;return t&&(i=Object.keys(t).find(e=>t[e].isDefault())),void 0!==i?t[i].getId():e===C.TYPE_VIDEO&&this._srcStream.hasVideo()||e===C.TYPE_AUDIO&&this._srcStream.hasAudio()?null:void 0}getTrackRelevantData(e,t,i){const s=this.getTrack(t,C.TYPE_VIDEO),n=this.getTrack(e,C.TYPE_AUDIO);let o=!1,r=!1;return i===C.TYPE_VIDEO?s&&n&&s.hasAudio()&&s.getUrl()===n.getUrl()?(o=!0,r=!0):s&&(r=!0):s&&n&&n.hasVideo()&&n.getUrl()===s.getUrl()?(o=!0,r=!0):n&&(o=!0),{useAudio:o,useVideo:r}}_createTrackData(e,t){let i=Object.assign({adaptiveType:this._adaptiveType},o.clone(e));return i.url?(i.hasVideo=void 0!==i.hasVideo?i.hasVideo:t===C.TYPE_VIDEO,i.hasAudio=void 0!==i.hasAudio?i.hasAudio:t===C.TYPE_AUDIO):this._srcStream&&(i.url=this._srcStream.getUrl(),i.codecs=this._srcStream.getCodecs(),i.hasVideo=this._srcStream.hasVideo(),i.hasAudio=this._srcStream.hasAudio()),i}_getTrackTypeData(e){let t=null;switch(e){case C.TYPE_VIDEO:t=this._tracks.video;break;case C.TYPE_AUDIO:t=this._tracks.audio;break;case C.TYPE_SUBTITLES:t=this._tracks.subtitles;break;case C.TYPE_CLOSE_CAPTIONS:t=this._tracks.closedCaptions}return t}}class M extends C{constructor(e){super(e),this._data=e}isAdaptive(){return!1}getTracks(e){return[]}getTrack(e,t){return null}getTrackIdByName(e,t){return null}getTrackNameById(e,t){return null}getDefaultTrackId(e){return null}getBitrate(){return this._data.bitrate||null}getCodecs(){return this._data.codecs||null}getFramerate(){return this._data.framerate||null}getType(){return this._data.type||null}getUrl(){return this._data.src||""}getDuration(){return parseInt(this._data.duration)}}class D{constructor(e,t=null,i={}){this._adaptiveSource=t,this._options=i,this._qualityList=t?this._createAdaptiveQualityList(e):this._createNonAdaptiveQualityList(e)}_createAdaptiveQualityList(e){if(!Array.isArray(e.qualities)||!e.qualities.length)return[];e.qualities.sort((e,t)=>e.bitrate-t.bitrate);let t=[],i=0;for(let s=0;s<e.qualities.length;s++){let n=e.qualities[s],o={id:i,name:n.name,label:n.label,resolution:n.resolution||{width:0,height:0}};i++;let r={srcStream:{url:n.url,type:n.type,bitrate:n.bitrate,codecs:n.codecs,src:n.src,framerate:n.framerate,hasVideo:n.hasVideo,hasAudio:n.hasAudio},video:[],audio:[],subtitles:[],closedCaptions:[]};n.audioGroup&&e.altAudioMap&&e.altAudioMap[n.audioGroup]&&(r.audio=e.altAudioMap[n.audioGroup]),n.videoGroup&&e.altVideoMap&&e.altVideoMap[n.videoGroup]&&(r.video=e.altVideoMap[n.videoGroup]),n.subtitlesGroup&&e.subtitlesMap&&e.subtitlesMap[n.subtitlesGroup]&&(r.subtitles=e.subtitlesMap[n.subtitlesGroup]),n.captionsGroup&&e.closedCaptionsMap&&e.closedCaptionsMap[n.captionsGroup]&&(r.closedCaptions=e.closedCaptionsMap[n.captionsGroup]),t.push(new x(o,r,this.getAdaptiveType()))}return t}_createNonAdaptiveQualityList(e){if(!Array.isArray(e.qualities)||!e.qualities.length)return[];e.qualities.sort((e,t)=>e.bitrate-t.bitrate);let t=[],i=0;for(let s=0;s<e.qualities.length;s++){let n=e.qualities[s],o={id:i,name:n.name,label:n.label,resolution:n.resolution||{width:0,height:0},bitrate:n.bitrate,codecs:n.codecs,framerate:n.framerate,type:n.type,src:n.src,duration:n.duration};i++,t.push(new M(o))}return t}getQualityIdx(e){return this._qualityList.findIndex(t=>t.getId()===e.getId())}getQualityItemWithSelectedTracks(e,t){return this._qualityList.find(i=>i.getTrack(e,C.TYPE_AUDIO)&&i.getTrack(t,C.TYPE_VIDEO))}getQualityItem(e){return void 0!==this._qualityList[e]?this._qualityList[e]:null}removeQualityItem(e){this._qualityList.splice(e,1)}getLength(){return this._qualityList.length}getAdaptiveType(){return this._adaptiveSource&&this._adaptiveSource.type}getAdaptiveSrc(){return this._adaptiveSource&&this._adaptiveSource.src}isTrackSelectionSupported(e=!0){return!!(!e||this._adaptiveSource&&this._adaptiveSource.tracks)}getQualityItemUrl(e=null,t=null,i=null){if(!this.isAdaptive()||!this._adaptiveSource.tracks&&null!==e){return this.getQualityItem(e).getUrl()}if(!this._adaptiveSource.tracks)return this.getAdaptiveSrc();let s=this._adaptiveSource.tracks.baseUrl,n=null,o="";if(null!==i){const e=this.getAvailableTracks(C.TYPE_VIDEO);if(e){const t=e.find(e=>e.getId()===i);t&&!t.isArtificial()&&(o=t.getName())}}if(this._adaptiveSource.tracks.videoTracks){const e=this._adaptiveSource.tracks.videoTracks;n=Object.keys(e).find(t=>e[t]==o)}s=s.replace("{{VIDEO_TRACK_ID}}",n||"");let r=null,a="";if(null!==t){const e=this.getAvailableTracks(C.TYPE_AUDIO);if(e){const i=e.find(e=>e.getId()===t);i&&!i.isArtificial()&&(a=i.getName())}}if(this._adaptiveSource.tracks.audioTracks){const e=this._adaptiveSource.tracks.audioTracks;r=Object.keys(e).find(t=>e[t]==a)}s=s.replace("{{AUDIO_TRACK_ID}}",r||"");const l=null!==e?this.getQualityItem(e).getBitrate(null,null):"";return s=s.replace("{{VIDEO_BANDWIDTH}}",isNaN(l)?"":l)}isAdaptive(){return!!this._adaptiveSource}getAvailableQualitySettings(e=!0){if(e&&this.isAdaptive()&&!this.isTrackSelectionSupported(e)&&this.hasQualityItemWithSeparatedStreams())return[{name:"",idx:null}];let t=this._qualityList.map((e,t)=>({name:e.getName(),framerate:e.getFramerate(),resolution:e.getResolution(),idx:t}));return this.isAdaptive()&&(t=t.concat({name:"",idx:null})),t}hasQualityItemWithSeparatedStreams(){return this._qualityList.some(e=>{const t=e.getTrack(null);return t&&t.hasVideo()!==t.hasAudio()})}hasAnyVideoTrackAvailable(){return this._qualityList.some(e=>{const t=e.getTrack(null),i=e.getType();return!this.isAdaptive()&&-1===i.indexOf(C.TYPE_AUDIO)||t&&t.hasVideo()})}getAvailableTracks(e,t=!0){let i=[];return this.isTrackSelectionSupported(t)?(this._qualityList.forEach(t=>{t.getTracks(e).forEach(e=>{void 0===i.find(t=>t.getId()===e.getId())&&i.push(e)})}),i.sort((e,t)=>{const i=e.getName().toUpperCase(),s=t.getName().toUpperCase();return i<s?-1:i>s?1:0}),i):null}getDefaultTrackIds(e){let t=[];return this._qualityList.some(i=>{const s=i.getDefaultTrackId(e);if(void 0===s)return!0;if(null!=s){t.includes(s)||t.push(s)}return!1})?void 0:t}getTrackIdByName(e,t){for(let i=0;i<this._qualityList.length;i++){const s=this._qualityList[i].getTrackIdByName(e,t);if(null!=s)return s}return null}getTrackNameById(e,t){for(let i=0;i<this._qualityList.length;i++){const s=this._qualityList[i].getTrackNameById(e,t);if(null!=s)return s}return null}resetSegmentsData(e=null){this._qualityList.forEach(t=>{if(t.getTrack(null).resetSegmentsData(),t.getTracks(e||C.TYPE_AUDIO).forEach(e=>{e.resetSegmentsData()}),!e){t.getTracks(C.TYPE_VIDEO).forEach(e=>{e.resetSegmentsData()})}})}}let O=new m.ErrorFactory(m.createSourceName("src/js/mediaplayer/streaming/QualityListFactory.js"));class R{constructor(e=[],t=null){this._dict=e,this._options=t,this._idGenerator=0,this._idMap={}}create(e,t={}){if(!e.playlists)throw O.createError(m.GENERAL,"There isn't any playlist file in the master playlist.");let i={},s={},n={},o={},r=e.playlists.filter(e=>e.hasAudio),a=e.playlists.filter(e=>e.hasVideo);if(e.alternativeMedia&&e.alternativeMedia.AUDIO&&e.alternativeMedia.AUDIO.length){let t=e.alternativeMedia.AUDIO;for(let e=0;e<t.length;e++){t[e].id=this._getAlternativeMediaId("audio",t[e].name);let s=r.filter(i=>i.audioGroup===t[e].groupId);const n=(s=s.length?s:[{audioGroup:t[e].groupId,bitrate:128e3,codecs:{video:null,audio:"mp4a.40.2"}}]).find(e=>e.hasAudio&&!e.hasVideo);if(n){let e=n.codecs.audio;s.forEach(t=>{if(t.codecs.audio!==e&&t.hasAudio&&!t.hasVideo)throw O.createError(m.GENERAL,"Playlist contains conflicting codecs definition for alternative media.")})}let o=n||s[0];i[o.audioGroup]=i[o.audioGroup]||[{name:R.DEFAULT_NAME,language:R.DEFAULT_LANGUAGE,groupId:o.audioGroup,bitrate:o.bitrate,artificial:!0,id:this._getAlternativeMediaId("audio",R.DEFAULT_NAME),codecs:{video:null,audio:o.codecs.audio},url:null,default:!0,autoselect:!0}];let a=Object.assign(t[e],{bitrate:o.bitrate,codecs:{video:null,audio:o.codecs.audio},url:t[e].url||null,default:"YES"===t[e].default,autoselect:"YES"===t[e].autoselect});a.default?(i[o.audioGroup].shift(),i[o.audioGroup].unshift(a)):i[o.audioGroup].push(a)}}if(e.alternativeMedia&&e.alternativeMedia.VIDEO&&e.alternativeMedia.VIDEO.length){let t=e.alternativeMedia.VIDEO;for(let e=0;e<t.length;e++){t[e].id=this._getAlternativeMediaId("video",t[e].name);let i=a.filter(i=>i.videoGroup===t[e].groupId);if(i.length){const n=i.find(e=>!e.hasAudio&&e.hasVideo);if(n){let e=n.codecs.video;i.forEach(t=>{if(t.codecs.video!==e&&!t.hasAudio&&t.hasVideo)throw O.createError(m.GENERAL,"Playlist contains conflicting codecs definition for alternative media.")})}let o=n||i[0];s[o.videoGroup]=s[o.videoGroup]||[{name:R.DEFAULT_NAME,framerate:o.framerate,groupId:o.videoGroup,bitrate:o.bitrate,artificial:!0,id:this._getAlternativeMediaId("video",R.DEFAULT_NAME),codecs:{video:o.codecs.video,audio:null},url:null,default:!0,autoselect:!0}];let r=Object.assign(t[e],{bitrate:o.bitrate,codecs:{audio:null,video:o.codecs.video},url:t[e].url||null,framerate:o.framerate,default:"YES"===t[e].default,autoselect:"YES"===t[e].autoselect});r.default?(s[o.videoGroup].shift(),s[o.videoGroup].unshift(r)):s[o.videoGroup].push(r)}}}if(e.alternativeMedia&&e.alternativeMedia.SUBTITLES&&e.alternativeMedia.SUBTITLES.length){let t=e.alternativeMedia.SUBTITLES;for(let e=0;e<t.length;e++){t[e].id=this._getAlternativeMediaId("subtitles",t[e].name);let i=a.filter(i=>i.subtitlesGroup===t[e].groupId);i.length&&(n[i[0].subtitlesGroup]=n[i[0].subtitlesGroup]||[],n[i[0].subtitlesGroup].push(t[e]))}}if(e.alternativeMedia&&void 0!==e.alternativeMedia["CLOSED-CAPTIONS"]&&e.alternativeMedia["CLOSED-CAPTIONS"].length){let t=e.alternativeMedia["CLOSED-CAPTIONS"];for(let e=0;e<t.length;e++){t[e].id=this._getAlternativeMediaId("closedCaptions",t[e].name);let i=a.filter(i=>i.captionsGroup===t[e].groupId);i.length&&(o[i[0].captionsGroup]=o[i[0].captionsGroup]||[],o[i[0].captionsGroup].push(t[e]))}}let l=[];for(let t=0,i=e.playlists.length;t<i;t++){let i=e.playlists[t],s=this._getMeta(i,t);l.push(Object.assign({name:s.name,label:s.label},i))}return new D({qualities:l,altAudioMap:i,altVideoMap:s,subtitlesMap:n,closedCaptionsMap:o},t,this._options)}_getAlternativeMediaId(e,t){return void 0===this._idMap[e]&&(this._idMap[e]={}),void 0===this._idMap[e][t]&&(this._idMap[e][t]=this._idGenerator,this._idGenerator++),this._idMap[e][t]}_getMeta(e,t){return{name:e.name||(e.resolution?e.resolution.height+"p":"")||(this._dict.length?this._getMetaByDict(e).name:"")||(e.bitrate?String(e.bitrate):""),label:e.label||(e.resolution?e.resolution.height+"p":"")||(this._dict.length?this._getMetaByDict(e).label:"")||"#"+t}}_getMetaByDict(e){for(let t=this._dict.length-1;t>=0;t--)if(e.bitrate>=this._dict[t].minBR)return this._dict[t]}}R.DEFAULT_NAME="Výchozí",R.DEFAULT_LANGUAGE="?";var U={videoControls:!0,videoPreload:"",videoMuted:!1,videoCrossorigin:"",requestTimeout:5e3,loadAttemps:2,appendAttemps:3,qualityDict:[{minBR:0,name:"-",label:"-"},{minBR:64e3,name:"64k",label:"64k"},{minBR:24e4,name:"240k",label:"240k"},{minBR:44e4,name:"440k",label:"440k"},{minBR:64e4,name:"640k",label:"640k"},{minBR:104e4,name:"1040k",label:"1040k"},{minBR:154e4,name:"1540k",label:"1540k"},{minBR:204e4,name:"2040k",label:"2040k"}],loadOnSource:!1,preferredBitrate:16e5,vpaidResponseTimeout:2e3,stopBufferingOnPause:!1,adaptResolutionToSize:!0};class V{parse(e){throw new Error('[TextTrackParser] Method "parse" is not implemented.')}}class B{setKind(e){throw new Error('[TextTrack] Method "setKind" is not implemented.')}setLanguage(e){throw new Error('[TextTrack] Method "setLanguage" is not implemented.')}addRegion(e){throw new Error('[TextTrack] Method "addRegion" is not implemented.')}addCue(e){throw new Error('[TextTrack] Method "addCue" is not implemented.')}addMetadata(e,t){throw new Error('[TextTrack] Method "addMetadata" is not implemented.')}getKind(){throw new Error('[TextTrack] Method "getKind" is not implemented.')}getLanguage(){throw new Error('[TextTrack] Method "getLanguage" is not implemented.')}getCues(){throw new Error('[TextTrack] Method "getCues" is not implemented.')}getRegions(){throw new Error('[TextTrack] Method "getRegions" is not implemented.')}getMetadata(){throw new Error('[TextTrack] Method "getMetadata" is not implemented.')}getMetadataByKey(e){throw new Error('[TextTrack] Method "getMetadataByKey" is not implemented.')}getRegionById(e){throw new Error('[TextTrack] Method "getRegionById" is not implemented.')}getCueById(e){throw new Error('[TextTrack] Method "getCueById" is not implemented.')}}class F extends B{constructor(){super(),this._cues=[]}setKind(e){}setLanguage(e){}addRegion(e){}addCue(e){this._cues.push(e)}addMetadata(e,t){}getKind(){return"subtitles"}getLanguage(){return"cs-CZ"}getCues(){return this._cues}getRegions(){return[]}getMetadata(){return{}}getMetadataByKey(e){return null}getRegionById(e){return null}getCueById(e){return null}}class H{setId(e){throw new Error('[TextTrackCue] Method "setId" is not implemented.')}setStartTime(e){throw new Error('[TextTrackCue] Method "setStartTime" is not implemented.')}setEndTime(e){throw new Error('[TextTrackCue] Method "setEndTime" is not implemented.')}setRegion(e){throw new Error('[TextTrackCue] Method "setRegion" is not implemented.')}setSize(e){throw new Error('[TextTrackCue] Method "setSize" is not implemented.')}setPosition(e){throw new Error('[TextTrackCue] Method "setPosition" is not implemented.')}setPositionAlign(e){throw new Error('[TextTrackCue] Method "setPostionAlign" is not implemented.')}setTextAlign(e){throw new Error('[TextTrackCue] Method "setTextAlign" is not implemented.')}setVerticalWritingDirection(e){throw new Error('[TextTrackCue] Method "setVerticalWritingDirection" is not implemented.')}setLine(e){throw new Error('[TextTrackCue] Method "setLine" is not implemented.')}setLineInterpretation(e){throw new Error('[TextTrackCue] Method "setLineInterpretation" is not implemented.')}setLineAlign(e){throw new Error('[TextTrackCue] Method "setLineAlign" is not implemented.')}setSnapToLine(e){throw new Error('[TextTrackCue] Method "setSnapToLine" is not implemented.')}setPayload(e){throw new Error('[TextTrackCue] Method "setPayload" is not implemented.')}getId(){throw new Error('[TextTrackCue] Method "getId" is not implemented.')}getStartTime(){throw new Error('[TextTrackCue] Method "getStartTime" is not implemented.')}getEndTime(){throw new Error('[TextTrackCue] Method "getEndTime" is not implemented.')}getRegion(){throw new Error('[TextTrackCue] Method "getRegion" is not implemented.')}getPosition(){throw new Error('[TextTrackCue] Method "getPosition" is not implemented.')}getPositionAlign(){throw new Error('[TextTrackCue] Method "getPositionAlign" is not implemented.')}getSize(){throw new Error('[TextTrackCue] Method "getSize" is not implemented.')}getTextAlign(){throw new Error('[TextTrackCue] Method "getTextAlign" is not implemented.')}getWritingDirection(){throw new Error('[TextTrackCue] Method "getWritingDirection" is not implemented.')}getLineInterpretation(){throw new Error('[TextTrackCue] Method "getLineInterpretation" is not implemented.')}getLine(){throw new Error('[TextTrackCue] Method "getLine" is not implemented.')}getLineAlign(){throw new Error('[TextTrackCue] Method "getLineAlign" is not implemented.')}getPayload(){throw new Error('[TextTrackCue] Method "getPayload" is not implemented.')}getSnapToLine(){throw new Error('[TextTrackCue] Method "getSnapToLine" is not implemented.')}isVertical(){throw new Error('[TextTrackCue] Method "getVertical" is not implemented.')}}H.POSITION_ALIGN={LEFT:"line-left",RIGHT:"line-right",CENTER:"center",AUTO:"auto"},H.TEXT_ALIGN={LEFT:"left",RIGHT:"right",CENTER:"center",START:"start",END:"end"},H.WRITING_DIRECTION={HORIZONTAL_LEFT_TO_RIGHT:"horizontal-tb",VERTICAL_LEFT_TO_RIGHT:"vertical-lr",VERTICAL_RIGHT_TO_LEFT:"vertical-rl"},H.LINE_INTERPRETATION={LINE_NUMBER:"px",PERCENTAGE:"%"},H.LINE_ALIGN={CENTER:"center",START:"start",END:"end"},H.DEFAULT_SIZE=65;class G extends H{constructor(){super(),this._startTime=0,this._endTime=0,this._payload={}}setId(e){}setStartTime(e){this._startTime=e}setEndTime(e){this._endTime=e}setRegion(e){}setSize(e){}setPosition(e){}setPositionAlign(e){}setTextAlign(e){}setVerticalWritingDirection(e){}setLine(e){}setLineInterpretation(e){}setLineAlign(e){}setSnapToLine(e){}setPayload(e){this._payload=e}getId(){return""}getStartTime(){return this._startTime}getEndTime(){return this._endTime}getRegion(){return null}getPosition(){return null}getPositionAlign(){return""}getSize(){return H.DEFAULT_SIZE}getTextAlign(){return H.TEXT_ALIGN.CENTER}getWritingDirection(){return""}getLineInterpretation(){return H.LINE_INTERPRETATION.LINE_NUMBER}getLine(){return-1}getLineAlign(){return H.LINE_ALIGN.END}getPayload(){return this._payload}getSnapToLine(){return!1}isVertical(){return!1}}class j extends V{parse(e){const t=JSON.parse(e),i=new F;return t.forEach(e=>{this._parseCue(i,e)}),i}_parseCue(e,t){if(t.text.length){const i=new G;i.setStartTime(parseInt(t.start,10)),i.setEndTime(parseInt(t.end,10)),i.setPayload({text:t.text}),e.addCue(i)}}}class q extends B{constructor(){super(),this._kind="subtitles",this._language="cs-CZ",this._cues=[],this._regions=[],this._metadata={}}setKind(e){this._kind=e}setLanguage(e){this._language=e}addRegion(e){this.getRegionById(e.getId())||this._regions.push(e)}addCue(e){this.getCueById(e.getId())&&e.setId(""),this._cues.push(e)}addMetadata(e,t){this._metadata[e]=t}getKind(){return this._kind}getLanguage(){return this._language}getCues(){return this._cues}getRegions(){return this._regions}getMetadata(){return this._metadata}getMetadataByKey(e){const t=e.toLowerCase();return t in this._metadata?null:this._metadata[t]}getRegionById(e){const t=this._regions.filter(t=>t.getId()===e);return t.length?t[0]:null}getCueById(e){const t=this._cues.filter(t=>t.getId()===e);return t.length?t[0]:null}}class Q extends H{constructor(){super(),this._id="",this._startTime=0,this._endTime=0,this._region=null,this._position=null,this._positionAlign=H.POSITION_ALIGN.AUTO,this._size=H.DEFAULT_SIZE,this._textAlign=H.TEXT_ALIGN.CENTER,this._writingDirection=H.WRITING_DIRECTION.HORIZONTAL_LEFT_TO_RIGHT,this._lineInterpretation=H.LINE_INTERPRETATION.LINE_NUMBER,this._line=-1,this._lineAlign=H.LINE_ALIGN.END,this._snapToLine=!0,this._vertical="",this._payload={}}setId(e){this._id=e}setStartTime(e){this._startTime=e}setEndTime(e){this._endTime=e}setRegion(e){this._region=e}setSize(e){this._size=e}setPosition(e){this._position=e}setPositionAlign(e){this._positionAlign="line-left"===e||"start"===e?H.POSITION_ALIGN.LEFT:"line-right"===e||"end"===e?H.POSITION_ALIGN.RIGHT:H.POSITION_ALIGN.CENTER}setTextAlign(e){"middle"===e?this._textAlign=H.TEXT_ALIGN.CENTER:e.toUpperCase()in H.TEXT_ALIGN&&(this._textAlign=H.TEXT_ALIGN[e.toUpperCase()])}setVerticalWritingDirection(e){"lr"==e?(this._vertical=e,this._writingDirection=H.WRITING_DIRECTION.VERTICAL_LEFT_TO_RIGHT):(this._vertical=e,this._writingDirection=H.WRITING_DIRECTION.VERTICAL_RIGHT_TO_LEFT)}setLine(e){this._line=e}setLineInterpretation(e){this._lineInterpretation=H.LINE_INTERPRETATION[e]}setLineAlign(e){e.toUpperCase()in H.LINE_ALIGN&&(this._lineAlign=H.LINE_ALIGN[e.toUpperCase()])}setSnapToLine(e){this._snapToLine=e}setPayload(e){this._payload=e}getId(){return this._id}getStartTime(){return this._startTime}getEndTime(){return this._endTime}getRegion(){return this._region}getPosition(){return this._position}getPositionAlign(){return this._positionAlign}getSize(){return this._size}getTextAlign(){return this._textAlign}getWritingDirection(){return this._writingDirection}getLineInterpretation(){return this._lineInterpretation}getLine(){return this._line}getLineAlign(){return this._lineAlign}getPayload(){return this._payload}getSnapToLine(){return this._snapToLine}isVertical(){return!!this._vertical.length}}class Y{setId(e){throw new Error('[TextTrackRegion] Method "setId" is not implemented.')}setHeight(e){throw new Error('[TextTrackRegion] Method "setHeight" is not implemented.')}setWidth(e){throw new Error('[TextTrackRegion] Method "setWidth" is not implemented.')}setViewportAnchors(e,t){throw new Error('[TextTrackRegion] Method "setViewportAnchors" is not implemented.')}setRegionAnchors(e,t){throw new Error('[TextTrackRegion] Method "setRegionAnchors" is not implemented.')}setScroll(e){throw new Error('[TextTrackRegion] Method "setScroll" is not implemented.')}getId(){throw new Error('[TextTrackRegion] Method "getId" is not implemented.')}getHeight(){throw new Error('[TextTrackRegion] Method "getHeight" is not implemented.')}getHeightUnits(){throw new Error('[TextTrackRegion] Method "getHeightUnits" is not implemented.')}getWidth(){throw new Error('[TextTrackRegion] Method "getWidth" is not implemented.')}getWidthUnits(){throw new Error('[TextTrackRegion] Method "getWidthUnits" is not implemented.')}getScroll(){throw new Error('[TextTrackRegion] Method "getScroll" is not implemented.')}getRegionAnchors(){throw new Error('[TextTrackRegion] Method "getRegionAnchors" is not implemented.')}getViewportAnchors(){throw new Error('[TextTrackRegion] Method "getViewportAnchors" is not implemented.')}getAnchorUnits(){throw new Error('[TextTrackRegion] Method "getAnchorUnits" is not implemented.')}}Y.UNITS={PX:"px",LINES:"",PERCENTAGE:"%"},Y.SCROLL={NONE:"",UP:"up"};class z extends Y{constructor(){super(),this._id="",this._viewportAnchorX=0,this._viewportAnchorY=0,this._regionAnchorX=0,this._regionAnchorY=0,this._width=100,this._height=100,this._heightUnits=Y.UNITS.PERCENTAGE,this._widthUnits=Y.UNITS.PERCENTAGE,this._anchorUnits=Y.UNITS.PERCENTAGE,this._scroll=Y.SCROLL.NONE}setId(e){this._id=e}setHeight(e){this._height=e,this._heightUnits=Y.UNITS.LINES}setWidth(e){this._width=e}setViewportAnchors(e,t){this._viewportAnchorX=e,this._viewportAnchorY=t}setRegionAnchors(e,t){this._regionAnchorX=e,this._regionAnchorY=t}setScroll(e){e.toUpperCase()in Y.SCROLL&&(this._scroll=Y.SCROLL[e.toUpperCase()])}getId(){return this._id}getHeight(){return this._height}getHeightUnits(){return this._heightUnits}getWidth(){return this._width}getWidthUnits(){return this._widthUnits}getScroll(){return this._scroll}getRegionAnchors(){return{x:this._regionAnchorX,y:this._regionAnchorY}}getViewportAnchors(){return{x:this._viewportAnchorX,y:this._viewportAnchorY}}getAnchorUnits(){return this._anchorUnits}}let W=new m.ErrorFactory(m.createSourceName("src/js/mediaplayer/tech/html/TextTracks/WebVTT/WebVTTParser.js"));class K extends V{parse(e){let t=e.replace(/\r\n|\r(?=[^\n]|$)/gm,"\n").split(/\n{2,}/m);if(!/^WEBVTT($|[ \t\n])/.test(t[0]))throw W.createError(m.TEXTSOURCE,"Invalid WebVTT header.");const i=new q;if(0===(t=t.filter(e=>{let t=e.split("\n");return/^WEBVTT($|[ \t\n])/.test(t[0])?(this._parseMetadata(i,t),!1):/^REGION($|[ \t\n])/.test(t[0])?(this._parseRegion(i,t),!1):!/^STYLE($|[ \t\n])/.test(t[0])&&!/^NOTE($|[ \t\n])/.test(t[0])})).length)throw W.createError(m.TEXTSOURCE,"Invalid WebVTT structure. No Cues.");return t.forEach(e=>{let t=e.split("\n");this._parseCue(i,t)}),i}_parseMetadata(e,t){let i=null;t.forEach(t=>{if(/^Region:($|[ \t\n])/.test(t)){const i=t.split(/[ \t]/);this._parseRegion(e,i)}else(i=/^Kind:[ \t](captions|subtitles|chapters|metadata)$/.exec(t))?e.setKind(i[1]):(i=/^Language:[ \t](.*)$/.exec(t))?e.setLanguage(i[1]):(i=/^(.*):[ \t](.*)$/.exec(t))&&e.addMetadata(i[1].toLowerCase(),i[2])})}_parseRegion(e,t){const i=new z;t.splice(0,1),t.forEach((e,t)=>{let s=null;if(s=/^id[\:\=](.*)$/.exec(e))i.setId(s[1]);else if(s=/^width[\:\=](\d{1,2}|100)%$/.exec(e))i.setWidth(parseInt(s[1],10));else if(s=/^lines[\:\=](\d+)$/.exec(e))i.setHeight(parseInt(s[1],10));else if(s=/^regionanchor[\:\=](\d{1,2}|100)%,(\d{1,2}|100)%$/.exec(e))i.setRegionAnchors(parseInt(s[1],10),parseInt(s[2],10));else if(s=/^viewportanchor[\:\=](\d{1,2}|100)%,(\d{1,2}|100)%$/.exec(e))i.setViewportAnchors(parseInt(s[1],10),parseInt(s[2],10));else{if(!(s=/^scroll[\:\=](up)$/.exec(e)))throw W.createError(m.TEXTSOURCE,`Invalid WebVTT region setting: ${e}`);i.setScroll(s[1])}}),e.addRegion(i)}_parseCue(e,t){const i=new Q;if(1==t[0].length&&!t[0])return null;t[0].indexOf("--\x3e")<0&&(i.setId(t[0]),t.splice(0,1));const s=/((?:\d{1,}:)?\d{2}:\d{2}\.\d{3})[ \t]+-->[ \t]+((?:\d{1,}:)?\d{2}:\d{2}\.\d{3})/g.exec(t[0]);if(null===s)throw W.createError(m.TEXTSOURCE,`Invalid WebVTT cue timestamps line: ${linex[0]}`);const n=t[0].slice(s.splice(0,1)[0].length).trim(),o=this._parseTime(s[0]),r=this._parseTime(s[1]);null!==o&&null!==r&&(this._parseCueSettings(i,n),i.setStartTime(o),i.setEndTime(r),t.splice(0,1),this._parseCuePayload(e,i,t),e.addCue(i))}_parseCuePayload(e,t,i){const s=e.getKind(),n=i.join("\n").trim();"metadata"===s?t.setPayload(JSON.parse(n)):t.setPayload({text:i.join("\n").trim()})}_parseCueSettings(e,t){if(0===t.length)return;t.split(/[ \t]+/).forEach(t=>{let i=null;if(i=/^align:(start|middle|center|end|left|right)$/.exec(t))e.setTextAlign(i[1]);else if(i=/^vertical:(lr|rl)$/.exec(t))e.setVerticalWritingDirection(i[1]);else if(i=/^size:([\d.]+)%$/.exec(t))e.setSize(parseInt(i[1],10));else if(i=/^position:([\d.]+)%(?:,(line-left|line-right|center|start|end))?$/.exec(t))e.setPosition(parseInt(i[1],10)),i[2]&&e.setPositionAlign(i[2]);else if(i=/^region:(.*)$/.exec(t))e.setRegion(i[1]);else if(i=/^line:([\d.]+)%(?:,(start|end|center))?$/.exec(t))e.setLineInterpretation("PERCENTAGE"),e.setSnapToLine(!1),e.setLine(parseInt(i[1])),i[2]&&e.setLineAlign(i[2]);else{if(!(i=/^line:(-?\d+)(?:,(start|end|center))?$/.exec(t)))throw W.createError(m.TEXTSOURCE,`Invalid WebVTT cue setting: ${t}`);e.setLineInterpretation("LINE_NUMBER"),e.setLine(parseInt(i[1])),i[2]&&e.setLineAlign(i[2])}})}_parseTime(e){const t=/(?:(\d{1,}):)?(\d{2}):(\d{2})\.(\d{3})/g.exec(e);if(null===t)return null;const i=parseInt(t[1],10)||0,s=parseInt(t[2],10),n=parseInt(t[3],10),o=parseInt(t[4],10);return s>59||n>59?null:o/1e3+n+60*s+3600*i}}let $=new m.ErrorFactory(m.createSourceName("src/js/mediaplayer/tech/Tech.js"));class X extends S{static getTechName(){throw new Error('[Tech] Method "getTechName" is not implemented.')}static isSupported(){throw new Error('[Tech] Method "isSupported" is not implemented.')}static canPlayType(e){throw new Error('[Tech] Method "canPlayType" is not implemented.')}static canPlaySource(e){throw new Error('[Tech] Method "canPlaySource" is not implemented.')}static copySource(e){return e instanceof N?new N(this.copySource(e.getData())):Array.isArray(e)?e.map(e=>this.copySource(e)):e&&"object"==typeof e?Object.assign({},e):e}static parseCodecs(e){let t={},i=[];return e.split(",").forEach(e=>{let[s,...n]=e.toLowerCase().split("."),o=n.join(".").toUpperCase();switch(s){case"avc1":if(2===n.length){let e=parseInt(n[0],10),t=parseInt(n[1],10);!isNaN(e)&&!isNaN(t)&&e>=0&&t>=0&&e<=255&&t<=255&&(o=(("0"+e.toString(16)).slice(-2)+"00"+("0"+t.toString(16)).slice(-2)).toUpperCase())}case"mp4a":t[s]=o;default:i.push(s+"."+o)}}),t.fullName=i.join(","),t}constructor(e,t,i,s){if(super(),!s||"object"!=typeof s)throw $.createError(m.SETTING,'Argument "options" must be an object.');if(!s.id||"string"!=typeof s.id)throw $.createError(m.SETTING,'Option "id" must be a string.');this._env=e,this._utils=t,this._ttLoaderFactory=i,this._JSONTextTrackParser=new j,this._webVTTParser=new K,this._options=s,this._source=null,this._isAdaptiveSource=!1,this._textSource="",this._textTracks=null}destroy(){this.emit(X.EVENT_DESTROYING),this.processDestroy()}getPlayerId(){return this._options.id}getElement(){throw new Error('[Tech] Method "getElement" is not implemented.')}getSource(){return this._source}getResolvedSource(){throw new Error('[Tech] Method "getResolvedSource" is not implemented.')}getCurrentSrc(){throw new Error('[Tech] Method "getCurrentSrc" is not implemented.')}getCurrentAdaptiveSrc(){throw new Error('[Tech] Method "getCurrentAdaptiveSrc" is not implemented.')}getCurrentQualityItem(){throw new Error('[Tech] Method "getCurrentQualityItem" is not implemented.')}getTextSource(){return this._textSource}getTextTracks(){return this._textTracks}getSupportedTextTracks(){const e=[],t={};return this._textTracks&&(this._textTracks.forEach((e,i)=>{if(this.canDisplaySubtitles(e.type)){const s=e.label||"";t[s]||(t[s]=[]),t[s].push(Object.assign({},e,{id:i}))}}),Object.keys(t).forEach(i=>{let s=null;t[i].forEach(e=>{e.type===X.TYPE_VTT?s=e:e.type===X.TYPE_JSON&&null===s&&(s=e)}),e.push(s)})),e}getTextTrack(){throw new Error('[Tech] Method "getTextTrack" is not implemented.')}getPoster(){throw new Error('[Tech] Method "getPoster" is not implemented.')}getQuality(){throw new Error('[Tech] Method "getQuality" is not implemented.')}getVideoWidth(){throw new Error('[Tech] Method "getVideoWidth" is not implemented.')}getVideoHeight(){throw new Error('[Tech] Method "getVideoHeight" is not implemented.')}getVideoDimensions(){throw new Error('[Tech] Method "getVideoDimensions" is not implemented.')}getElementDimensions(){throw new Error('[Tech] Method "getElementDimensions" is not implemented.')}getVolume(){throw new Error('[Tech] Method "getVolume" is not implemented.')}getCurrentTime(){throw new Error('[Tech] Method "getCurrentTime" is not implemented.')}getStartTime(){throw new Error('[Tech] Method "getStartTime" is not implemented.')}getDuration(){throw new Error('[Tech] Method "getDuration" is not implemented.')}getBuffered(e){throw new Error('[Tech] Method "getBuffered" is not implemented.')}getStatsHistory(){throw new Error('[Tech] Method "getStatsHistory" is not implemented.')}getCurrentFrame(e){throw new Error('[Tech] Method "getCurrentFrame" is not implemented.')}isCustomUiCapable(){throw new Error('[Tech] Method "isCustomUiCapable" is not implemented.')}isNative(){throw new Error('[Tech] Method "isNative" is not implemented.')}isReady(){throw new Error('[Tech] Method "isReady" is not implemented.')}isSourceReady(){throw new Error('[Tech] Method "isSourceReady" is not implemented.')}isAdaptiveSource(){return this._isAdaptiveSource}isMuted(){throw new Error('[Tech] Method "isMuted" is not implemented.')}isPlaying(){throw new Error('[Tech] Method "isPlaying" is not implemented.')}isPaused(){throw new Error('[Tech] Method "isPaused" is not implemented.')}isEnded(){throw new Error('[Tech] Method "isEnded" is not implemented.')}isBufferEmpty(){throw new Error('[Tech] Method "isBufferEmpty" is not implemented.')}isLive(){throw new Error('[Tech] Method "isLive" is not implemented.')}isEvent(){throw new Error('[Tech] Method "isEvent" is not implemented.')}isLivePlaying(){throw new Error('[Tech] Method "isLivePlaying" is not implemented.')}isLiveStreaming(){throw new Error('[Tech] Method "isLiveStreaming" is not implemented.')}canDisplaySubtitles(e){throw new Error('[Tech] Method "canDisplaySubtitles" is not implemented.')}hasTextTrack(e){let t=this._textSource;return Array.isArray(t)||(t=[t]),!!t[e]}setSourcePreload(e){throw new Error('[Tech] Method "setSourcePreload" is not implemented.')}getPreparedSource(e,t,i=null){return this.getQualityList(e,t,i).then(e=>e||null,e=>null)}getQualityList(e,t,i=null){let s=X.copySource(t),n=this.resolveSource(s),o=i&&i.disableAdaptive?null:this.getAdaptiveSources(n);return this._chooseAdaptiveSource(o).then(e=>e||Promise.resolve(this.getNonAdaptiveQualityList(n)))}_chooseAdaptiveSource(e){if(!e||!e.length)return Promise.resolve(null);let t=e.shift();return t&&this.constructor.canPlayType(t.type)?this._qualityListService.get(t).then(t=>(this.prepareSource(t),t.getLength()?t:this._chooseAdaptiveSource(e))):this._chooseAdaptiveSource(e)}setSource(e,t=null){this.resetSource(),this._source=e,this.getQualityList(this._qualityListService,e,t).then(e=>{if(e)this._isAdaptiveSource=e.isAdaptive(),this.processSource(e,t);else{const e=$.createError(m.SOURCE_UNPLAYABLE,"No playable sources found.");this.processError(e)}},e=>{this._handleRequestError(e)})}setTextSource(e){let t=null;this._textSource=e,t="string"==typeof e?{src:e,kind:"subtitles",type:X.TYPE_VTT}:X.copySource(e),Array.isArray(t)||(t=[t]),t.forEach(e=>{e.type=e.type||X.TYPE_VTT,void 0===e.kind&&(e.kind="subtitles")}),this._textTracks=t,this.processTextSource(t)}setTextTrack(e=null){if(null===e)return void this.processTextTrack(e);if(!this._textTracks){const e=$.createError(m.SETTING,"There is no text track.");return void this.processError(e)}const t=this._textTracks[e];if(!t){const t=$.createError(m.SETTING,`There isn't any text track for index ${e}.`);return void this.processError(t)}if(!this.canDisplaySubtitles(t.type)){const e=$.createError(m.TEXTSOURCE,`Subtitle format "${t.type}" not supported in current Tech.`);return void this.processError(e)}let i=null;if(t.type!==X.TYPE_JSON&&!this.isCustomUiCapable()||t.data)i=Promise.resolve(t.data||null);else{i=this._ttLoaderFactory.create().load(t.src).then(e=>t.type===X.TYPE_JSON?this._JSONTextTrackParser.parse(e.data):t.type===X.TYPE_VTT?this._webVTTParser.parse(e.data):void 0)}i.then(i=>{t.data=i,this.processTextTrack(e,i)}).catch(e=>{e instanceof Error||(e=$.createError(m.TEXTSOURCE,String(e))),this.processError(e)})}setLocalizedTexts(e){throw new Error('[Tech] Method "setLocalizedTexts" is not implemented.')}setPoster(e){throw new Error('[Tech] Method "setPoster" is not implemented.')}setQuality(e){throw new Error('[Tech] Method "setQuality" is not implemented.')}setVolume(e){throw new Error('[Tech] Method "setVolume" is not implemented.')}setMute(e){throw new Error('[Tech] Method "setMute" is not implemented.')}setAdPoints(e){throw new Error('[Tech] Method "setAdPoints" is not implemented.')}addStats(e){throw new Error('[Tech] Method "addStats" is not implemented.')}play(){throw new Error('[Tech] Method "play" is not implemented.')}pause(){throw new Error('[Tech] Method "pause" is not implemented.')}seek(e,t=!0){throw new Error('[Tech] Method "seek" is not implemented.')}seekToLive(){throw new Error('[Tech] Method "seekToLive" is not implemented.')}skip(){throw new Error('[Tech] Method "skip" is not implemented.')}setViewMode(e){throw new Error('[Tech] Method "setViewMode" is not implemented.')}resetSource(){this._source=null,this._isAdaptiveSource=!1,this.processResetSource()}reset(){this._source=null,this._isAdaptiveSource=!1,this._textSource="",this._textTracks=null,this.processReset()}processSource(e,t=null){throw new Error('[Tech] Method "processSource" is not implemented.')}processTextSource(e){throw new Error('[Tech] Method "processTextSource" is not implemented.')}processTextTrack(e,t){throw new Error('[Tech] Method "processTextTrack" is not implemented.')}processResetSource(){throw new Error('[Tech] Method "processResetSource" is not implemented.')}processReset(){throw new Error('[Tech] Method "processReset" is not implemented.')}processDestroy(){throw new Error('[Tech] Method "processDestroy" is not implemented.')}processError(e){e instanceof Error||(e=new Error(String(e))),void 0===e.category&&(e.category=m.UNSPECIFIED),this.emit(X.EVENT_ERROR,e)}processWarning(e){e instanceof Error||(e=new Error(String(e))),void 0===e.category&&(e.category=m.UNSPECIFIED),this.emit(X.EVENT_WARNING,e)}resolveSource(e){if(!e)throw $.createError(m.SETTING,"Source must be specified.");let t=null;if(e instanceof N)t=e;else if(Array.isArray(e))t=new N([{name:"?",source:e}]);else if("object"==typeof e)t=new N([{name:"?",source:[e]}]);else{if("string"!=typeof e)throw $.createError(m.SOURCE,"Unsupported source.");{const i=this._getTypeFromUrl(e);if(!i)throw $.createError(m.SOURCE,"Unrecognized source type.");t=new N([{name:"?",source:[{type:i,src:e}]}])}}return t}getAdaptiveSources(e){let t={};for(let i=e.getLength()-1;i>=0;i--){let s=e.getSource(i);Array.isArray(s)||(s=[s]);for(let n=s.length-1;n>=0;n--){let o=this._getTypeFromSource(s[n]);if(this._isAdaptiveType(o)){let r={src:s[n].src||s[n],type:o,tracks:s[n].tracks||null,name:e.getName(i)};if(this._env.isBuggyFmp4()&&r.name===X.FMP4_LABEL)continue;t[r.type]?r.name===X.FMP4_LABEL?t[r.type].unshift(r):t[r.type].push(r):t[r.type]=[r]}}}return t[X.TYPE_HLS]?t[X.TYPE_HLS]:t[X.TYPE_DASH]?t[X.TYPE_DASH]:null}getNonAdaptiveQualityList(e){const t=[];for(let i=0;i<e.getLength();i++){const s=e.getName(i);let n=e.getSource(i);Array.isArray(n)||(n=[n]);for(let e=n.length-1;e>=0;e--){let i=this._getTypeFromSource(n[e]);this._isAdaptiveType(i)||t.push({name:s,type:i,src:n[e].src||n[e],bitrate:n[e].bitrate||null,codecs:n[e].codecs||null})}}const i=t.length?new D({qualities:t},null,this._options):null;if(i)for(let e=i.getLength()-1;e>=0;e--){let t=i.getQualityItem(e),s={codecs:t.getCodecs(),type:t.getType()};this.constructor.canPlaySource(s)||i.removeQualityItem(e)}return i}prepareSource(e){let t=!1;const i=e.hasAnyVideoTrackAvailable();for(let s=e.getLength()-1;s>=0;s--){let n=e.getQualityItem(s),o={codecs:n.getCodecs(),type:n.getType()||X.TYPE_TS};if(!this.constructor.canPlaySource(o)){e.removeQualityItem(s);continue}const r=n.getTrack(null);if(i&&!r.hasVideo()){e.removeQualityItem(s);continue}const a=n.getTrack(null),l=n.getTracks(C.TYPE_AUDIO),h=n.getTracks(C.TYPE_VIDEO);this._checkCodecIncosistency(a,l,C.TYPE_AUDIO)?e.removeQualityItem(s):this._checkCodecIncosistency(a,h,C.TYPE_VIDEO)?e.removeQualityItem(s):a.hasVideo()&&!a.hasAudio()&&(t=!0)}if(t)for(let t=e.getLength()-1;t>=0;t--){let i=e.getQualityItem(t);i.getTrack(null).hasVideo()&&i.getTrack(null).hasAudio()&&e.removeQualityItem(t)}let s={};for(let t=e.getLength()-1;t>=0;t--){let i=e.getQualityItem(t);const n=i.getResolution().height+";"+i.getCodecs()+";"+i.getBitrate(null,null)+";"+i.getFramerate()+";";void 0===s[n]&&(s[n]=[]);const o=i.getDefaultTrackId(C.TYPE_AUDIO),r=i.getTrack(o,C.TYPE_AUDIO),a=r&&null!==o?r.getBitrate():0;s[n].push({data:i,idx:t,audioBitrate:a,redundant:!1})}let n=[];Object.keys(s).forEach(e=>{let t=s[e],i=X.HEIGHT_TO_BITRATE_TABLE;if(t.length>1){const e=t[0].data.getResolution().height,s=i.find(t=>t.low<=e&&(void 0===t.high||t.high>=e));this._setRedundantItems(t,s.bitrate)}n=n.concat(t)});for(let t=e.getLength()-1;t>=0;t--){n.find(e=>e.idx===t&&e.redundant)&&e.removeQualityItem(t)}}_checkCodecIncosistency(e,t,i){if(t.length){const s=e.getCodecs(i);for(let e=0;e<t.length;e++){const n=t[e].getCodecs(i);if(null!=n&&null!=s&&n!==s)return!0}}return!1}_setRedundantItems(e,t){let i=null,s=null;e.forEach(e=>{(!i||e.audioBitrate<t&&e.audioBitrate>i.audioBitrate)&&(i=e),(!s||e.audioBitrate>t&&e.audioBitrate<s.audioBitrate)&&(s=e)});let n=null;n=Math.abs(i.audioBitrate-t)<Math.abs(s.audioBitrate-t)?i:s,e.forEach(e=>{e.idx!==n.idx&&(e.redundant=!0)})}dispatchReady(){this.emit(X.EVENT_READY)}dispatchSourceSet(e){this.emit(X.EVENT_SOURCE_SET,e)}dispatchSourceReady(e){this.emit(X.EVENT_SOURCE_READY,e)}dispatchTextSourceSet(){this.emit(X.EVENT_TEXT_SOURCE_SET,{textSource:this._textSource})}dispatchTextTrackSet(e){this.emit(X.EVENT_TEXT_TRACK_SET,e)}dispatchQualitySet(e){this.emit(X.EVENT_QUALITY_SET,e)}dispatchQualityChange(e){this.emit(X.EVENT_QUALITY_CHANGE,e)}dispatchTrackSet(e){this.emit(X.EVENT_TRACK_SET,e)}dispatchVolumeChange(e){this.emit(X.EVENT_VOLUME_CHANGE,e)}dispatchDurationChange(e){this.emit(X.EVENT_DURATION_CHANGE,e)}dispatchCueChange(e){this.emit(X.EVENT_CUE_CHANGE,e)}dispatchLivePlayingChange(e){this.emit(X.EVENT_LIVE_PLAYING_CHANGE,e)}dispatchLiveStreamingChange(e){this.emit(X.EVENT_LIVE_STREAMING_CHANGE,e)}dispatchAbort(){this.emit(X.EVENT_ABORT)}dispatchProgress(){this.emit(X.EVENT_PROGRESS)}dispatchLoadStart(){this.emit(X.EVENT_LOAD_START)}dispatchLoadedMeta(e){this.emit(X.EVENT_LOADED_META,e)}dispatchLoadedData(){this.emit(X.EVENT_LOADED_DATA)}dispatchLoadedSegment(e){this.emit(X.EVENT_LOADED_SEGMENT,e)}dispatchPlay(e){this.emit(X.EVENT_PLAY,e)}dispatchPlayDenied(e){this.emit(X.EVENT_PLAY_DENIED,e)}dispatchPlaying(e){this.emit(X.EVENT_PLAYING,e)}dispatchPaused(e){this.emit(X.EVENT_PAUSED,e)}dispatchTimeUpdate(e){this.emit(X.EVENT_TIMEUPDATE,e)}dispatchSeekstart(e){this.emit(X.EVENT_SEEKSTART,e)}dispatchSeeking(e){this.emit(X.EVENT_SEEKING,e)}dispatchSeeked(e){this.emit(X.EVENT_SEEKED,e)}dispatchEnded(){this.emit(X.EVENT_ENDED)}dispatchBufferEmpty(){this.emit(X.EVENT_BUFFER_EMPTY)}dispatchCanPlay(){this.emit(X.EVENT_CAN_PLAY)}_handleRequestError({type:e,url:t,status:i=0}){if("abort"===e)return;const s="done"===e?`server response with status ${i}`:e,n=$.createError(m.NETWORK,`Request to ${t} was rejected because ${s}.`);n.genericMessage="Request to media url was rejected",n.resultType=e,n.url=t,n.status=i,this.processError(n)}_isAdaptiveType(e){return e===X.TYPE_HLS||e===X.TYPE_DASH}_getTypeFromSource(e){let t="";return t="object"==typeof e?e.type:this._getTypeFromUrl(e)}_getTypeFromUrl(e){return this._utils.getTypeByFileExt(this._utils.getFileExt(e))}}X.TYPE_HLS="application/vnd.apple.mpegurl",X.TYPE_DASH="application/dash+xml",X.TYPE_TS="video/mp2t",X.TYPE_MP4="video/mp4",X.TYPE_MP3="audio/mpeg",X.TYPE_VTT="text/vtt",X.TYPE_JSON="application/json",X.HEIGHT_TO_BITRATE_TABLE=[{low:0,high:240,bitrate:48e3},{low:241,high:360,bitrate:64e3},{low:361,high:480,bitrate:96e3},{low:481,high:720,bitrate:128e3},{low:721,high:void 0,bitrate:16e4}],X.DASH_LABEL="dash",X.FMP4_LABEL="fMP4",X.TS_LABEL="TS",X.EVENT_READY="ready",X.EVENT_SOURCE_SET="sourceset",X.EVENT_SOURCE_READY="sourceready",X.EVENT_TEXT_SOURCE_SET="textsourceset",X.EVENT_TEXT_TRACK_SET="texttrackset",X.EVENT_QUALITY_SET="qualityset",X.EVENT_QUALITY_CHANGE="qualitychange",X.EVENT_TRACK_SET="trackset",X.EVENT_VOLUME_CHANGE="volumechange",X.EVENT_DURATION_CHANGE="durationchange",X.EVENT_CUE_CHANGE="texttrackcuechange",X.EVENT_LIVE_PLAYING_CHANGE="liveplayingchange",X.EVENT_UI_RESIZE="ui-resize",X.EVENT_LIVE_STREAMING_CHANGE="livestreamingchange",X.EVENT_ABORT="abort",X.EVENT_PROGRESS="progress",X.EVENT_LOAD_START="loadstart",X.EVENT_LOADED_META="loadedmetadata",X.EVENT_LOADED_DATA="loadeddata",X.EVENT_LOADED_SEGMENT="loadedsegment",X.EVENT_LOADING_FAILED="loadingfailed",X.EVENT_PLAY="play",X.EVENT_PLAY_DENIED="playdenied",X.EVENT_PLAYING="playing",X.EVENT_PAUSED="paused",X.EVENT_TIMEUPDATE="timeupdate",X.EVENT_PLAYBACK_PROGRESS="playbackprogress",X.EVENT_SEEKSTART="seekstart",X.EVENT_SEEKING="seeking",X.EVENT_SEEKED="seeked",X.EVENT_ENDED="ended",X.EVENT_BUFFER_EMPTY="bufferempty",X.EVENT_CAN_PLAY="canplay",X.EVENT_DESTROYING="destroying",X.EVENT_ERROR="error",X.EVENT_WARNING="warning",X.EVENT_FULLSCREEN_CHANGE="fullscreenchange",X.EVENT_PIP_CHANGE="pipchange",X.EVENT_CINEMA_CHANGE="cinemachange",X.EVENT_AP_CHANGE="airplaychange",X.EVENT_SKIP_VIDEO_REQUEST="skipvideorequest",X.EVENT_CANCEL_AD_REQUEST="canceladrequest",X.EVENT_VIDEO_CLICKTHROUGH="videoclickthrough",X.EVENT_ACTION_CLICKTHROUGH="actionclickthrough",X.EVENT_ACTION_BACK="actionback",X.EVENT_ACTION_CONTENT_LINK="actioncontentlink",X.EVENT_VE_DISPLAYED="visualelement-displayed",X.EVENT_VE_HIDDEN="visualelement-hidden",X.EVENT_VE_CLICK="visualelement-click",X.EVENT_VE_CLOSE="visualelement-close",X.EVENT_VE_ERROR="visualelement-error",X.EVENT_USER_ACCEPT_INVITATION="user-acceptinvitation",X.EVENT_USER_MINIMIZE="user-minimize",X.EVENT_USER_CLOSE="user-close",X.EVENT_IMPRESSION="impression",X.EVENT_SKIPPABLE_STATE_CHANGE="skippablestatechange",X.EVENT_REPLAY_REQUEST="replay-request";var Z=2147483647,J=36,ee=1,te=26,ie=38,se=700,ne=72,oe=128,re="-",ae=/[^\x20-\x7E]/,le=/[\x2E\u3002\uFF0E\uFF61]/g,he={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},_e=J-ee,de=Math.floor,ue=String.fromCharCode;function ce(e){throw new RangeError(he[e])}function pe(e,t){return e+22+75*(e<26)-((0!=t)<<5)}function me(e,t,i){var s=0;for(e=i?de(e/se):e>>1,e+=de(e/t);e>_e*te>>1;s+=J)e=de(e/_e);return de(s+(_e+1)*e/(e+ie))}function ge(e){return function(e,t){var i=e.split("@"),s="";i.length>1&&(s=i[0]+"@",e=i[1]);var n=function(e,t){for(var i=e.length,s=[];i--;)s[i]=t(e[i]);return s}((e=e.replace(le,".")).split("."),t).join(".");return s+n}(e,function(e){return ae.test(e)?"xn--"+function(e){var t,i,s,n,o,r,a,l,h,_,d,u,c,p,m,g=[];for(u=(e=function(e){for(var t,i,s=[],n=0,o=e.length;n<o;)(t=e.charCodeAt(n++))>=55296&&t<=56319&&n<o?56320==(64512&(i=e.charCodeAt(n++)))?s.push(((1023&t)<<10)+(1023&i)+65536):(s.push(t),n--):s.push(t);return s}(e)).length,t=oe,i=0,o=ne,r=0;r<u;++r)(d=e[r])<128&&g.push(ue(d));for(s=n=g.length,n&&g.push(re);s<u;){for(a=Z,r=0;r<u;++r)(d=e[r])>=t&&d<a&&(a=d);for(a-t>de((Z-i)/(c=s+1))&&ce("overflow"),i+=(a-t)*c,t=a,r=0;r<u;++r)if((d=e[r])<t&&++i>Z&&ce("overflow"),d==t){for(l=i,h=J;!(l<(_=h<=o?ee:h>=o+te?te:h-o));h+=J)m=l-_,p=J-_,g.push(ue(pe(_+m%p,0))),l=de(m/p);g.push(ue(pe(l,0))),o=me(i,c,s==n),i=0,++s}++i,++t}return g.join("")}(e):e})}var Ee="undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},Te=[],fe=[],ye="undefined"!=typeof Uint8Array?Uint8Array:Array,ve=!1;function Ae(){ve=!0;for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",t=0,i=e.length;t<i;++t)Te[t]=e[t],fe[e.charCodeAt(t)]=t;fe["-".charCodeAt(0)]=62,fe["_".charCodeAt(0)]=63}function Se(e){var t,i,s,n,o,r;ve||Ae();var a=e.length;if(a%4>0)throw new Error("Invalid string. Length must be a multiple of 4");o="="===e[a-2]?2:"="===e[a-1]?1:0,r=new ye(3*a/4-o),s=o>0?a-4:a;var l=0;for(t=0,i=0;t<s;t+=4,i+=3)n=fe[e.charCodeAt(t)]<<18|fe[e.charCodeAt(t+1)]<<12|fe[e.charCodeAt(t+2)]<<6|fe[e.charCodeAt(t+3)],r[l++]=n>>16&255,r[l++]=n>>8&255,r[l++]=255&n;return 2===o?(n=fe[e.charCodeAt(t)]<<2|fe[e.charCodeAt(t+1)]>>4,r[l++]=255&n):1===o&&(n=fe[e.charCodeAt(t)]<<10|fe[e.charCodeAt(t+1)]<<4|fe[e.charCodeAt(t+2)]>>2,r[l++]=n>>8&255,r[l++]=255&n),r}function be(e,t,i){for(var s,n,o=[],r=t;r<i;r+=3)s=(e[r]<<16)+(e[r+1]<<8)+e[r+2],o.push(Te[(n=s)>>18&63]+Te[n>>12&63]+Te[n>>6&63]+Te[63&n]);return o.join("")}function Ce(e){var t;ve||Ae();for(var i=e.length,s=i%3,n="",o=[],r=0,a=i-s;r<a;r+=16383)o.push(be(e,r,r+16383>a?a:r+16383));return 1===s?(t=e[i-1],n+=Te[t>>2],n+=Te[t<<4&63],n+="=="):2===s&&(t=(e[i-2]<<8)+e[i-1],n+=Te[t>>10],n+=Te[t>>4&63],n+=Te[t<<2&63],n+="="),o.push(n),o.join("")}function Pe(e,t,i,s,n){var o,r,a=8*n-s-1,l=(1<<a)-1,h=l>>1,_=-7,d=i?n-1:0,u=i?-1:1,c=e[t+d];for(d+=u,o=c&(1<<-_)-1,c>>=-_,_+=a;_>0;o=256*o+e[t+d],d+=u,_-=8);for(r=o&(1<<-_)-1,o>>=-_,_+=s;_>0;r=256*r+e[t+d],d+=u,_-=8);if(0===o)o=1-h;else{if(o===l)return r?NaN:1/0*(c?-1:1);r+=Math.pow(2,s),o-=h}return(c?-1:1)*r*Math.pow(2,o-s)}function ke(e,t,i,s,n,o){var r,a,l,h=8*o-n-1,_=(1<<h)-1,d=_>>1,u=23===n?Math.pow(2,-24)-Math.pow(2,-77):0,c=s?0:o-1,p=s?1:-1,m=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(a=isNaN(t)?1:0,r=_):(r=Math.floor(Math.log(t)/Math.LN2),t*(l=Math.pow(2,-r))<1&&(r--,l*=2),(t+=r+d>=1?u/l:u*Math.pow(2,1-d))*l>=2&&(r++,l/=2),r+d>=_?(a=0,r=_):r+d>=1?(a=(t*l-1)*Math.pow(2,n),r+=d):(a=t*Math.pow(2,d-1)*Math.pow(2,n),r=0));n>=8;e[i+c]=255&a,c+=p,a/=256,n-=8);for(r=r<<n|a,h+=n;h>0;e[i+c]=255&r,c+=p,r/=256,h-=8);e[i+c-p]|=128*m}var Ie={}.toString,we=Array.isArray||function(e){return"[object Array]"==Ie.call(e)};function Ne(){return xe.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function Le(e,t){if(Ne()<t)throw new RangeError("Invalid typed array length");return xe.TYPED_ARRAY_SUPPORT?(e=new Uint8Array(t)).__proto__=xe.prototype:(null===e&&(e=new xe(t)),e.length=t),e}function xe(e,t,i){if(!(xe.TYPED_ARRAY_SUPPORT||this instanceof xe))return new xe(e,t,i);if("number"==typeof e){if("string"==typeof t)throw new Error("If encoding is specified then the first argument must be a string");return Oe(this,e)}return Me(this,e,t,i)}function Me(e,t,i,s){if("number"==typeof t)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer?function(e,t,i,s){if(t.byteLength,i<0||t.byteLength<i)throw new RangeError("'offset' is out of bounds");if(t.byteLength<i+(s||0))throw new RangeError("'length' is out of bounds");t=void 0===i&&void 0===s?new Uint8Array(t):void 0===s?new Uint8Array(t,i):new Uint8Array(t,i,s);xe.TYPED_ARRAY_SUPPORT?(e=t).__proto__=xe.prototype:e=Re(e,t);return e}(e,t,i,s):"string"==typeof t?function(e,t,i){"string"==typeof i&&""!==i||(i="utf8");if(!xe.isEncoding(i))throw new TypeError('"encoding" must be a valid string encoding');var s=0|Be(t,i),n=(e=Le(e,s)).write(t,i);n!==s&&(e=e.slice(0,n));return e}(e,t,i):function(e,t){if(Ve(t)){var i=0|Ue(t.length);return 0===(e=Le(e,i)).length?e:(t.copy(e,0,0,i),e)}if(t){if("undefined"!=typeof ArrayBuffer&&t.buffer instanceof ArrayBuffer||"length"in t)return"number"!=typeof t.length||(s=t.length)!=s?Le(e,0):Re(e,t);if("Buffer"===t.type&&we(t.data))return Re(e,t.data)}var s;throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(e,t)}function De(e){if("number"!=typeof e)throw new TypeError('"size" argument must be a number');if(e<0)throw new RangeError('"size" argument must not be negative')}function Oe(e,t){if(De(t),e=Le(e,t<0?0:0|Ue(t)),!xe.TYPED_ARRAY_SUPPORT)for(var i=0;i<t;++i)e[i]=0;return e}function Re(e,t){var i=t.length<0?0:0|Ue(t.length);e=Le(e,i);for(var s=0;s<i;s+=1)e[s]=255&t[s];return e}function Ue(e){if(e>=Ne())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+Ne().toString(16)+" bytes");return 0|e}function Ve(e){return!(null==e||!e._isBuffer)}function Be(e,t){if(Ve(e))return e.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(e)||e instanceof ArrayBuffer))return e.byteLength;"string"!=typeof e&&(e=""+e);var i=e.length;if(0===i)return 0;for(var s=!1;;)switch(t){case"ascii":case"latin1":case"binary":return i;case"utf8":case"utf-8":case void 0:return dt(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*i;case"hex":return i>>>1;case"base64":return ut(e).length;default:if(s)return dt(e).length;t=(""+t).toLowerCase(),s=!0}}function Fe(e,t,i){var s=e[t];e[t]=e[i],e[i]=s}function He(e,t,i,s,n){if(0===e.length)return-1;if("string"==typeof i?(s=i,i=0):i>2147483647?i=2147483647:i<-2147483648&&(i=-2147483648),i=+i,isNaN(i)&&(i=n?0:e.length-1),i<0&&(i=e.length+i),i>=e.length){if(n)return-1;i=e.length-1}else if(i<0){if(!n)return-1;i=0}if("string"==typeof t&&(t=xe.from(t,s)),Ve(t))return 0===t.length?-1:Ge(e,t,i,s,n);if("number"==typeof t)return t&=255,xe.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?n?Uint8Array.prototype.indexOf.call(e,t,i):Uint8Array.prototype.lastIndexOf.call(e,t,i):Ge(e,[t],i,s,n);throw new TypeError("val must be string, number or Buffer")}function Ge(e,t,i,s,n){var o,r=1,a=e.length,l=t.length;if(void 0!==s&&("ucs2"===(s=String(s).toLowerCase())||"ucs-2"===s||"utf16le"===s||"utf-16le"===s)){if(e.length<2||t.length<2)return-1;r=2,a/=2,l/=2,i/=2}function h(e,t){return 1===r?e[t]:e.readUInt16BE(t*r)}if(n){var _=-1;for(o=i;o<a;o++)if(h(e,o)===h(t,-1===_?0:o-_)){if(-1===_&&(_=o),o-_+1===l)return _*r}else-1!==_&&(o-=o-_),_=-1}else for(i+l>a&&(i=a-l),o=i;o>=0;o--){for(var d=!0,u=0;u<l;u++)if(h(e,o+u)!==h(t,u)){d=!1;break}if(d)return o}return-1}function je(e,t,i,s){i=Number(i)||0;var n=e.length-i;s?(s=Number(s))>n&&(s=n):s=n;var o=t.length;if(o%2!=0)throw new TypeError("Invalid hex string");s>o/2&&(s=o/2);for(var r=0;r<s;++r){var a=parseInt(t.substr(2*r,2),16);if(isNaN(a))return r;e[i+r]=a}return r}function qe(e,t,i,s){return ct(dt(t,e.length-i),e,i,s)}function Qe(e,t,i,s){return ct(function(e){for(var t=[],i=0;i<e.length;++i)t.push(255&e.charCodeAt(i));return t}(t),e,i,s)}function Ye(e,t,i,s){return Qe(e,t,i,s)}function ze(e,t,i,s){return ct(ut(t),e,i,s)}function We(e,t,i,s){return ct(function(e,t){for(var i,s,n,o=[],r=0;r<e.length&&!((t-=2)<0);++r)i=e.charCodeAt(r),s=i>>8,n=i%256,o.push(n),o.push(s);return o}(t,e.length-i),e,i,s)}function Ke(e,t,i){return 0===t&&i===e.length?Ce(e):Ce(e.slice(t,i))}function $e(e,t,i){i=Math.min(e.length,i);for(var s=[],n=t;n<i;){var o,r,a,l,h=e[n],_=null,d=h>239?4:h>223?3:h>191?2:1;if(n+d<=i)switch(d){case 1:h<128&&(_=h);break;case 2:128==(192&(o=e[n+1]))&&(l=(31&h)<<6|63&o)>127&&(_=l);break;case 3:o=e[n+1],r=e[n+2],128==(192&o)&&128==(192&r)&&(l=(15&h)<<12|(63&o)<<6|63&r)>2047&&(l<55296||l>57343)&&(_=l);break;case 4:o=e[n+1],r=e[n+2],a=e[n+3],128==(192&o)&&128==(192&r)&&128==(192&a)&&(l=(15&h)<<18|(63&o)<<12|(63&r)<<6|63&a)>65535&&l<1114112&&(_=l)}null===_?(_=65533,d=1):_>65535&&(_-=65536,s.push(_>>>10&1023|55296),_=56320|1023&_),s.push(_),n+=d}return function(e){var t=e.length;if(t<=Xe)return String.fromCharCode.apply(String,e);var i="",s=0;for(;s<t;)i+=String.fromCharCode.apply(String,e.slice(s,s+=Xe));return i}(s)}xe.TYPED_ARRAY_SUPPORT=void 0===Ee.TYPED_ARRAY_SUPPORT||Ee.TYPED_ARRAY_SUPPORT,xe.poolSize=8192,xe._augment=function(e){return e.__proto__=xe.prototype,e},xe.from=function(e,t,i){return Me(null,e,t,i)},xe.TYPED_ARRAY_SUPPORT&&(xe.prototype.__proto__=Uint8Array.prototype,xe.__proto__=Uint8Array),xe.alloc=function(e,t,i){return function(e,t,i,s){return De(t),t<=0?Le(e,t):void 0!==i?"string"==typeof s?Le(e,t).fill(i,s):Le(e,t).fill(i):Le(e,t)}(null,e,t,i)},xe.allocUnsafe=function(e){return Oe(null,e)},xe.allocUnsafeSlow=function(e){return Oe(null,e)},xe.isBuffer=function(e){return null!=e&&(!!e._isBuffer||pt(e)||function(e){return"function"==typeof e.readFloatLE&&"function"==typeof e.slice&&pt(e.slice(0,0))}(e))},xe.compare=function(e,t){if(!Ve(e)||!Ve(t))throw new TypeError("Arguments must be Buffers");if(e===t)return 0;for(var i=e.length,s=t.length,n=0,o=Math.min(i,s);n<o;++n)if(e[n]!==t[n]){i=e[n],s=t[n];break}return i<s?-1:s<i?1:0},xe.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},xe.concat=function(e,t){if(!we(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return xe.alloc(0);var i;if(void 0===t)for(t=0,i=0;i<e.length;++i)t+=e[i].length;var s=xe.allocUnsafe(t),n=0;for(i=0;i<e.length;++i){var o=e[i];if(!Ve(o))throw new TypeError('"list" argument must be an Array of Buffers');o.copy(s,n),n+=o.length}return s},xe.byteLength=Be,xe.prototype._isBuffer=!0,xe.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)Fe(this,t,t+1);return this},xe.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)Fe(this,t,t+3),Fe(this,t+1,t+2);return this},xe.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)Fe(this,t,t+7),Fe(this,t+1,t+6),Fe(this,t+2,t+5),Fe(this,t+3,t+4);return this},xe.prototype.toString=function(){var e=0|this.length;return 0===e?"":0===arguments.length?$e(this,0,e):function(e,t,i){var s=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===i||i>this.length)&&(i=this.length),i<=0)return"";if((i>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return et(this,t,i);case"utf8":case"utf-8":return $e(this,t,i);case"ascii":return Ze(this,t,i);case"latin1":case"binary":return Je(this,t,i);case"base64":return Ke(this,t,i);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return tt(this,t,i);default:if(s)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),s=!0}}.apply(this,arguments)},xe.prototype.equals=function(e){if(!Ve(e))throw new TypeError("Argument must be a Buffer");return this===e||0===xe.compare(this,e)},xe.prototype.inspect=function(){var e="";return this.length>0&&(e=this.toString("hex",0,50).match(/.{2}/g).join(" "),this.length>50&&(e+=" ... ")),"<Buffer "+e+">"},xe.prototype.compare=function(e,t,i,s,n){if(!Ve(e))throw new TypeError("Argument must be a Buffer");if(void 0===t&&(t=0),void 0===i&&(i=e?e.length:0),void 0===s&&(s=0),void 0===n&&(n=this.length),t<0||i>e.length||s<0||n>this.length)throw new RangeError("out of range index");if(s>=n&&t>=i)return 0;if(s>=n)return-1;if(t>=i)return 1;if(this===e)return 0;for(var o=(n>>>=0)-(s>>>=0),r=(i>>>=0)-(t>>>=0),a=Math.min(o,r),l=this.slice(s,n),h=e.slice(t,i),_=0;_<a;++_)if(l[_]!==h[_]){o=l[_],r=h[_];break}return o<r?-1:r<o?1:0},xe.prototype.includes=function(e,t,i){return-1!==this.indexOf(e,t,i)},xe.prototype.indexOf=function(e,t,i){return He(this,e,t,i,!0)},xe.prototype.lastIndexOf=function(e,t,i){return He(this,e,t,i,!1)},xe.prototype.write=function(e,t,i,s){if(void 0===t)s="utf8",i=this.length,t=0;else if(void 0===i&&"string"==typeof t)s=t,i=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t|=0,isFinite(i)?(i|=0,void 0===s&&(s="utf8")):(s=i,i=void 0)}var n=this.length-t;if((void 0===i||i>n)&&(i=n),e.length>0&&(i<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");s||(s="utf8");for(var o=!1;;)switch(s){case"hex":return je(this,e,t,i);case"utf8":case"utf-8":return qe(this,e,t,i);case"ascii":return Qe(this,e,t,i);case"latin1":case"binary":return Ye(this,e,t,i);case"base64":return ze(this,e,t,i);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return We(this,e,t,i);default:if(o)throw new TypeError("Unknown encoding: "+s);s=(""+s).toLowerCase(),o=!0}},xe.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var Xe=4096;function Ze(e,t,i){var s="";i=Math.min(e.length,i);for(var n=t;n<i;++n)s+=String.fromCharCode(127&e[n]);return s}function Je(e,t,i){var s="";i=Math.min(e.length,i);for(var n=t;n<i;++n)s+=String.fromCharCode(e[n]);return s}function et(e,t,i){var s=e.length;(!t||t<0)&&(t=0),(!i||i<0||i>s)&&(i=s);for(var n="",o=t;o<i;++o)n+=_t(e[o]);return n}function tt(e,t,i){for(var s=e.slice(t,i),n="",o=0;o<s.length;o+=2)n+=String.fromCharCode(s[o]+256*s[o+1]);return n}function it(e,t,i){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>i)throw new RangeError("Trying to access beyond buffer length")}function st(e,t,i,s,n,o){if(!Ve(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>n||t<o)throw new RangeError('"value" argument is out of bounds');if(i+s>e.length)throw new RangeError("Index out of range")}function nt(e,t,i,s){t<0&&(t=65535+t+1);for(var n=0,o=Math.min(e.length-i,2);n<o;++n)e[i+n]=(t&255<<8*(s?n:1-n))>>>8*(s?n:1-n)}function ot(e,t,i,s){t<0&&(t=4294967295+t+1);for(var n=0,o=Math.min(e.length-i,4);n<o;++n)e[i+n]=t>>>8*(s?n:3-n)&255}function rt(e,t,i,s,n,o){if(i+s>e.length)throw new RangeError("Index out of range");if(i<0)throw new RangeError("Index out of range")}function at(e,t,i,s,n){return n||rt(e,0,i,4),ke(e,t,i,s,23,4),i+4}function lt(e,t,i,s,n){return n||rt(e,0,i,8),ke(e,t,i,s,52,8),i+8}xe.prototype.slice=function(e,t){var i,s=this.length;if((e=~~e)<0?(e+=s)<0&&(e=0):e>s&&(e=s),(t=void 0===t?s:~~t)<0?(t+=s)<0&&(t=0):t>s&&(t=s),t<e&&(t=e),xe.TYPED_ARRAY_SUPPORT)(i=this.subarray(e,t)).__proto__=xe.prototype;else{var n=t-e;i=new xe(n,void 0);for(var o=0;o<n;++o)i[o]=this[o+e]}return i},xe.prototype.readUIntLE=function(e,t,i){e|=0,t|=0,i||it(e,t,this.length);for(var s=this[e],n=1,o=0;++o<t&&(n*=256);)s+=this[e+o]*n;return s},xe.prototype.readUIntBE=function(e,t,i){e|=0,t|=0,i||it(e,t,this.length);for(var s=this[e+--t],n=1;t>0&&(n*=256);)s+=this[e+--t]*n;return s},xe.prototype.readUInt8=function(e,t){return t||it(e,1,this.length),this[e]},xe.prototype.readUInt16LE=function(e,t){return t||it(e,2,this.length),this[e]|this[e+1]<<8},xe.prototype.readUInt16BE=function(e,t){return t||it(e,2,this.length),this[e]<<8|this[e+1]},xe.prototype.readUInt32LE=function(e,t){return t||it(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},xe.prototype.readUInt32BE=function(e,t){return t||it(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},xe.prototype.readIntLE=function(e,t,i){e|=0,t|=0,i||it(e,t,this.length);for(var s=this[e],n=1,o=0;++o<t&&(n*=256);)s+=this[e+o]*n;return s>=(n*=128)&&(s-=Math.pow(2,8*t)),s},xe.prototype.readIntBE=function(e,t,i){e|=0,t|=0,i||it(e,t,this.length);for(var s=t,n=1,o=this[e+--s];s>0&&(n*=256);)o+=this[e+--s]*n;return o>=(n*=128)&&(o-=Math.pow(2,8*t)),o},xe.prototype.readInt8=function(e,t){return t||it(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},xe.prototype.readInt16LE=function(e,t){t||it(e,2,this.length);var i=this[e]|this[e+1]<<8;return 32768&i?4294901760|i:i},xe.prototype.readInt16BE=function(e,t){t||it(e,2,this.length);var i=this[e+1]|this[e]<<8;return 32768&i?4294901760|i:i},xe.prototype.readInt32LE=function(e,t){return t||it(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},xe.prototype.readInt32BE=function(e,t){return t||it(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},xe.prototype.readFloatLE=function(e,t){return t||it(e,4,this.length),Pe(this,e,!0,23,4)},xe.prototype.readFloatBE=function(e,t){return t||it(e,4,this.length),Pe(this,e,!1,23,4)},xe.prototype.readDoubleLE=function(e,t){return t||it(e,8,this.length),Pe(this,e,!0,52,8)},xe.prototype.readDoubleBE=function(e,t){return t||it(e,8,this.length),Pe(this,e,!1,52,8)},xe.prototype.writeUIntLE=function(e,t,i,s){(e=+e,t|=0,i|=0,s)||st(this,e,t,i,Math.pow(2,8*i)-1,0);var n=1,o=0;for(this[t]=255&e;++o<i&&(n*=256);)this[t+o]=e/n&255;return t+i},xe.prototype.writeUIntBE=function(e,t,i,s){(e=+e,t|=0,i|=0,s)||st(this,e,t,i,Math.pow(2,8*i)-1,0);var n=i-1,o=1;for(this[t+n]=255&e;--n>=0&&(o*=256);)this[t+n]=e/o&255;return t+i},xe.prototype.writeUInt8=function(e,t,i){return e=+e,t|=0,i||st(this,e,t,1,255,0),xe.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),this[t]=255&e,t+1},xe.prototype.writeUInt16LE=function(e,t,i){return e=+e,t|=0,i||st(this,e,t,2,65535,0),xe.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):nt(this,e,t,!0),t+2},xe.prototype.writeUInt16BE=function(e,t,i){return e=+e,t|=0,i||st(this,e,t,2,65535,0),xe.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):nt(this,e,t,!1),t+2},xe.prototype.writeUInt32LE=function(e,t,i){return e=+e,t|=0,i||st(this,e,t,4,4294967295,0),xe.TYPED_ARRAY_SUPPORT?(this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e):ot(this,e,t,!0),t+4},xe.prototype.writeUInt32BE=function(e,t,i){return e=+e,t|=0,i||st(this,e,t,4,4294967295,0),xe.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):ot(this,e,t,!1),t+4},xe.prototype.writeIntLE=function(e,t,i,s){if(e=+e,t|=0,!s){var n=Math.pow(2,8*i-1);st(this,e,t,i,n-1,-n)}var o=0,r=1,a=0;for(this[t]=255&e;++o<i&&(r*=256);)e<0&&0===a&&0!==this[t+o-1]&&(a=1),this[t+o]=(e/r>>0)-a&255;return t+i},xe.prototype.writeIntBE=function(e,t,i,s){if(e=+e,t|=0,!s){var n=Math.pow(2,8*i-1);st(this,e,t,i,n-1,-n)}var o=i-1,r=1,a=0;for(this[t+o]=255&e;--o>=0&&(r*=256);)e<0&&0===a&&0!==this[t+o+1]&&(a=1),this[t+o]=(e/r>>0)-a&255;return t+i},xe.prototype.writeInt8=function(e,t,i){return e=+e,t|=0,i||st(this,e,t,1,127,-128),xe.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),e<0&&(e=255+e+1),this[t]=255&e,t+1},xe.prototype.writeInt16LE=function(e,t,i){return e=+e,t|=0,i||st(this,e,t,2,32767,-32768),xe.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):nt(this,e,t,!0),t+2},xe.prototype.writeInt16BE=function(e,t,i){return e=+e,t|=0,i||st(this,e,t,2,32767,-32768),xe.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):nt(this,e,t,!1),t+2},xe.prototype.writeInt32LE=function(e,t,i){return e=+e,t|=0,i||st(this,e,t,4,2147483647,-2147483648),xe.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24):ot(this,e,t,!0),t+4},xe.prototype.writeInt32BE=function(e,t,i){return e=+e,t|=0,i||st(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),xe.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):ot(this,e,t,!1),t+4},xe.prototype.writeFloatLE=function(e,t,i){return at(this,e,t,!0,i)},xe.prototype.writeFloatBE=function(e,t,i){return at(this,e,t,!1,i)},xe.prototype.writeDoubleLE=function(e,t,i){return lt(this,e,t,!0,i)},xe.prototype.writeDoubleBE=function(e,t,i){return lt(this,e,t,!1,i)},xe.prototype.copy=function(e,t,i,s){if(i||(i=0),s||0===s||(s=this.length),t>=e.length&&(t=e.length),t||(t=0),s>0&&s<i&&(s=i),s===i)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(i<0||i>=this.length)throw new RangeError("sourceStart out of bounds");if(s<0)throw new RangeError("sourceEnd out of bounds");s>this.length&&(s=this.length),e.length-t<s-i&&(s=e.length-t+i);var n,o=s-i;if(this===e&&i<t&&t<s)for(n=o-1;n>=0;--n)e[n+t]=this[n+i];else if(o<1e3||!xe.TYPED_ARRAY_SUPPORT)for(n=0;n<o;++n)e[n+t]=this[n+i];else Uint8Array.prototype.set.call(e,this.subarray(i,i+o),t);return o},xe.prototype.fill=function(e,t,i,s){if("string"==typeof e){if("string"==typeof t?(s=t,t=0,i=this.length):"string"==typeof i&&(s=i,i=this.length),1===e.length){var n=e.charCodeAt(0);n<256&&(e=n)}if(void 0!==s&&"string"!=typeof s)throw new TypeError("encoding must be a string");if("string"==typeof s&&!xe.isEncoding(s))throw new TypeError("Unknown encoding: "+s)}else"number"==typeof e&&(e&=255);if(t<0||this.length<t||this.length<i)throw new RangeError("Out of range index");if(i<=t)return this;var o;if(t>>>=0,i=void 0===i?this.length:i>>>0,e||(e=0),"number"==typeof e)for(o=t;o<i;++o)this[o]=e;else{var r=Ve(e)?e:dt(new xe(e,s).toString()),a=r.length;for(o=0;o<i-t;++o)this[o+t]=r[o%a]}return this};var ht=/[^+\/0-9A-Za-z-_]/g;function _t(e){return e<16?"0"+e.toString(16):e.toString(16)}function dt(e,t){var i;t=t||1/0;for(var s=e.length,n=null,o=[],r=0;r<s;++r){if((i=e.charCodeAt(r))>55295&&i<57344){if(!n){if(i>56319){(t-=3)>-1&&o.push(239,191,189);continue}if(r+1===s){(t-=3)>-1&&o.push(239,191,189);continue}n=i;continue}if(i<56320){(t-=3)>-1&&o.push(239,191,189),n=i;continue}i=65536+(n-55296<<10|i-56320)}else n&&(t-=3)>-1&&o.push(239,191,189);if(n=null,i<128){if((t-=1)<0)break;o.push(i)}else if(i<2048){if((t-=2)<0)break;o.push(i>>6|192,63&i|128)}else if(i<65536){if((t-=3)<0)break;o.push(i>>12|224,i>>6&63|128,63&i|128)}else{if(!(i<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;o.push(i>>18|240,i>>12&63|128,i>>6&63|128,63&i|128)}}return o}function ut(e){return Se(function(e){if((e=function(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}(e).replace(ht,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function ct(e,t,i,s){for(var n=0;n<s&&!(n+i>=t.length||n>=e.length);++n)t[n+i]=e[n];return n}function pt(e){return!!e.constructor&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)}Ee.setTimeout,Ee.clearTimeout;var mt=Ee.performance||{};mt.now||mt.mozNow||mt.msNow||mt.oNow||mt.webkitNow;function gt(e){return null===e}function Et(e){return"string"==typeof e}function Tt(e){return"object"==typeof e&&null!==e}function ft(e,t){return Object.prototype.hasOwnProperty.call(e,t)}var yt=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)};function vt(e){switch(typeof e){case"string":return e;case"boolean":return e?"true":"false";case"number":return isFinite(e)?e:"";default:return""}}function At(e,t){if(e.map)return e.map(t);for(var i=[],s=0;s<e.length;s++)i.push(t(e[s],s));return i}var St=Object.keys||function(e){var t=[];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.push(i);return t};function bt(e,t,i,s){t=t||"&",i=i||"=";var n={};if("string"!=typeof e||0===e.length)return n;var o=/\+/g;e=e.split(t);var r=1e3;s&&"number"==typeof s.maxKeys&&(r=s.maxKeys);var a=e.length;r>0&&a>r&&(a=r);for(var l=0;l<a;++l){var h,_,d,u,c=e[l].replace(o,"%20"),p=c.indexOf(i);p>=0?(h=c.substr(0,p),_=c.substr(p+1)):(h=c,_=""),d=decodeURIComponent(h),u=decodeURIComponent(_),ft(n,d)?yt(n[d])?n[d].push(u):n[d]=[n[d],u]:n[d]=u}return n}var Ct={parse:Ft,resolve:function(e,t){return Ft(e,!1,!0).resolve(t)},resolveObject:function(e,t){return e?Ft(e,!1,!0).resolveObject(t):t},format:function(e){Et(e)&&(e=Ht({},e));return Gt(e)},Url:Pt};function Pt(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}var kt=/^([a-z0-9.+-]+:)/i,It=/:[0-9]*$/,wt=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,Nt=["{","}","|","\\","^","`"].concat(["<",">",'"',"`"," ","\r","\n","\t"]),Lt=["'"].concat(Nt),xt=["%","/","?",";","#"].concat(Lt),Mt=["/","?","#"],Dt=255,Ot=/^[+a-z0-9A-Z_-]{0,63}$/,Rt=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,Ut={javascript:!0,"javascript:":!0},Vt={javascript:!0,"javascript:":!0},Bt={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0};function Ft(e,t,i){if(e&&Tt(e)&&e instanceof Pt)return e;var s=new Pt;return s.parse(e,t,i),s}function Ht(e,t,i,s){if(!Et(t))throw new TypeError("Parameter 'url' must be a string, not "+typeof t);var n=t.indexOf("?"),o=-1!==n&&n<t.indexOf("#")?"?":"#",r=t.split(o);r[0]=r[0].replace(/\\/g,"/");var a=t=r.join(o);if(a=a.trim(),!s&&1===t.split("#").length){var l=wt.exec(a);if(l)return e.path=a,e.href=a,e.pathname=l[1],l[2]?(e.search=l[2],e.query=i?bt(e.search.substr(1)):e.search.substr(1)):i&&(e.search="",e.query={}),e}var h,_,d,u,c=kt.exec(a);if(c){var p=(c=c[0]).toLowerCase();e.protocol=p,a=a.substr(c.length)}if(s||c||a.match(/^\/\/[^@\/]+@[^@\/]+/)){var m="//"===a.substr(0,2);!m||c&&Vt[c]||(a=a.substr(2),e.slashes=!0)}if(!Vt[c]&&(m||c&&!Bt[c])){var g,E,T=-1;for(h=0;h<Mt.length;h++)-1!==(_=a.indexOf(Mt[h]))&&(-1===T||_<T)&&(T=_);for(-1!==(E=-1===T?a.lastIndexOf("@"):a.lastIndexOf("@",T))&&(g=a.slice(0,E),a=a.slice(E+1),e.auth=decodeURIComponent(g)),T=-1,h=0;h<xt.length;h++)-1!==(_=a.indexOf(xt[h]))&&(-1===T||_<T)&&(T=_);-1===T&&(T=a.length),e.host=a.slice(0,T),a=a.slice(T),jt(e),e.hostname=e.hostname||"";var f="["===e.hostname[0]&&"]"===e.hostname[e.hostname.length-1];if(!f){var y=e.hostname.split(/\./);for(h=0,d=y.length;h<d;h++){var v=y[h];if(v&&!v.match(Ot)){for(var A="",S=0,b=v.length;S<b;S++)v.charCodeAt(S)>127?A+="x":A+=v[S];if(!A.match(Ot)){var C=y.slice(0,h),P=y.slice(h+1),k=v.match(Rt);k&&(C.push(k[1]),P.unshift(k[2])),P.length&&(a="/"+P.join(".")+a),e.hostname=C.join(".");break}}}}e.hostname.length>Dt?e.hostname="":e.hostname=e.hostname.toLowerCase(),f||(e.hostname=ge(e.hostname)),u=e.port?":"+e.port:"";var I=e.hostname||"";e.host=I+u,e.href+=e.host,f&&(e.hostname=e.hostname.substr(1,e.hostname.length-2),"/"!==a[0]&&(a="/"+a))}if(!Ut[p])for(h=0,d=Lt.length;h<d;h++){var w=Lt[h];if(-1!==a.indexOf(w)){var N=encodeURIComponent(w);N===w&&(N=escape(w)),a=a.split(w).join(N)}}var L=a.indexOf("#");-1!==L&&(e.hash=a.substr(L),a=a.slice(0,L));var x=a.indexOf("?");if(-1!==x?(e.search=a.substr(x),e.query=a.substr(x+1),i&&(e.query=bt(e.query)),a=a.slice(0,x)):i&&(e.search="",e.query={}),a&&(e.pathname=a),Bt[p]&&e.hostname&&!e.pathname&&(e.pathname="/"),e.pathname||e.search){u=e.pathname||"";var M=e.search||"";e.path=u+M}return e.href=Gt(e),e}function Gt(e){var t=e.auth||"";t&&(t=(t=encodeURIComponent(t)).replace(/%3A/i,":"),t+="@");var i,s,n,o,r=e.protocol||"",a=e.pathname||"",l=e.hash||"",h=!1,_="";e.host?h=t+e.host:e.hostname&&(h=t+(-1===e.hostname.indexOf(":")?e.hostname:"["+this.hostname+"]"),e.port&&(h+=":"+e.port)),e.query&&Tt(e.query)&&Object.keys(e.query).length&&(i=e.query,s=s||"&",n=n||"=",null===i&&(i=void 0),_="object"==typeof i?At(St(i),function(e){var t=encodeURIComponent(vt(e))+n;return yt(i[e])?At(i[e],function(e){return t+encodeURIComponent(vt(e))}).join(s):t+encodeURIComponent(vt(i[e]))}).join(s):o?encodeURIComponent(vt(o))+n+encodeURIComponent(vt(i)):"");var d=e.search||_&&"?"+_||"";return r&&":"!==r.substr(-1)&&(r+=":"),e.slashes||(!r||Bt[r])&&!1!==h?(h="//"+(h||""),a&&"/"!==a.charAt(0)&&(a="/"+a)):h||(h=""),l&&"#"!==l.charAt(0)&&(l="#"+l),d&&"?"!==d.charAt(0)&&(d="?"+d),r+h+(a=a.replace(/[?#]/g,function(e){return encodeURIComponent(e)}))+(d=d.replace("#","%23"))+l}function jt(e){var t=e.host,i=It.exec(t);i&&(":"!==(i=i[0])&&(e.port=i.substr(1)),t=t.substr(0,t.length-i.length)),t&&(e.hostname=t)}Pt.prototype.parse=function(e,t,i){return Ht(this,e,t,i)},Pt.prototype.format=function(){return Gt(this)},Pt.prototype.resolve=function(e){return this.resolveObject(Ft(e,!1,!0)).format()},Pt.prototype.resolveObject=function(e){if(Et(e)){var t=new Pt;t.parse(e,!1,!0),e=t}for(var i,s=new Pt,n=Object.keys(this),o=0;o<n.length;o++){var r=n[o];s[r]=this[r]}if(s.hash=e.hash,""===e.href)return s.href=s.format(),s;if(e.slashes&&!e.protocol){for(var a=Object.keys(e),l=0;l<a.length;l++){var h=a[l];"protocol"!==h&&(s[h]=e[h])}return Bt[s.protocol]&&s.hostname&&!s.pathname&&(s.path=s.pathname="/"),s.href=s.format(),s}if(e.protocol&&e.protocol!==s.protocol){if(!Bt[e.protocol]){for(var _=Object.keys(e),d=0;d<_.length;d++){var u=_[d];s[u]=e[u]}return s.href=s.format(),s}if(s.protocol=e.protocol,e.host||Vt[e.protocol])s.pathname=e.pathname;else{for(i=(e.pathname||"").split("/");i.length&&!(e.host=i.shift()););e.host||(e.host=""),e.hostname||(e.hostname=""),""!==i[0]&&i.unshift(""),i.length<2&&i.unshift(""),s.pathname=i.join("/")}if(s.search=e.search,s.query=e.query,s.host=e.host||"",s.auth=e.auth,s.hostname=e.hostname||e.host,s.port=e.port,s.pathname||s.search){var c=s.pathname||"",p=s.search||"";s.path=c+p}return s.slashes=s.slashes||e.slashes,s.href=s.format(),s}var m,g=s.pathname&&"/"===s.pathname.charAt(0),E=e.host||e.pathname&&"/"===e.pathname.charAt(0),T=E||g||s.host&&e.pathname,f=T,y=s.pathname&&s.pathname.split("/")||[],v=s.protocol&&!Bt[s.protocol];if(i=e.pathname&&e.pathname.split("/")||[],v&&(s.hostname="",s.port=null,s.host&&(""===y[0]?y[0]=s.host:y.unshift(s.host)),s.host="",e.protocol&&(e.hostname=null,e.port=null,e.host&&(""===i[0]?i[0]=e.host:i.unshift(e.host)),e.host=null),T=T&&(""===i[0]||""===y[0])),E)s.host=e.host||""===e.host?e.host:s.host,s.hostname=e.hostname||""===e.hostname?e.hostname:s.hostname,s.search=e.search,s.query=e.query,y=i;else if(i.length)y||(y=[]),y.pop(),y=y.concat(i),s.search=e.search,s.query=e.query;else if(null!=e.search)return v&&(s.hostname=s.host=y.shift(),(m=!!(s.host&&s.host.indexOf("@")>0)&&s.host.split("@"))&&(s.auth=m.shift(),s.host=s.hostname=m.shift())),s.search=e.search,s.query=e.query,gt(s.pathname)&&gt(s.search)||(s.path=(s.pathname?s.pathname:"")+(s.search?s.search:"")),s.href=s.format(),s;if(!y.length)return s.pathname=null,s.search?s.path="/"+s.search:s.path=null,s.href=s.format(),s;for(var A=y.slice(-1)[0],S=(s.host||e.host||y.length>1)&&("."===A||".."===A)||""===A,b=0,C=y.length;C>=0;C--)"."===(A=y[C])?y.splice(C,1):".."===A?(y.splice(C,1),b++):b&&(y.splice(C,1),b--);if(!T&&!f)for(;b--;b)y.unshift("..");!T||""===y[0]||y[0]&&"/"===y[0].charAt(0)||y.unshift(""),S&&"/"!==y.join("/").substr(-1)&&y.push("");var P=""===y[0]||y[0]&&"/"===y[0].charAt(0);return v&&(s.hostname=s.host=P?"":y.length?y.shift():"",(m=!!(s.host&&s.host.indexOf("@")>0)&&s.host.split("@"))&&(s.auth=m.shift(),s.host=s.hostname=m.shift())),(T=T||s.host&&y.length)&&!P&&y.unshift(""),y.length?s.pathname=y.join("/"):(s.pathname=null,s.path=null),gt(s.pathname)&&gt(s.search)||(s.path=(s.pathname?s.pathname:"")+(s.search?s.search:"")),s.auth=e.auth||s.auth,s.slashes=s.slashes||e.slashes,s.href=s.format(),s},Pt.prototype.parseHost=function(){return jt(this)};let qt=new m.ErrorFactory(m.createSourceName("src/js/common/Request.js"));class Qt{constructor(e,t={}){let i=Object.assign({},t);i.method=t.method||"get",i.timeout=t.timeout||0,i.responseType=t.responseType||"",i.withCredentials=void 0!==t.withCredentials&&t.withCredentials,this._utils=e,this._options=i,this._state=Qt._NEW,this._url="",this._xhr=null,this._resolve=null,this._reject=null,this._stats={start:0,end:0,bytes:0,bandwidth:0},this._loaded=0,this._total=0,this._tId=0,this._promise=null,this._headers={},this._progressHandler=this._progressHandler.bind(this)}destroy(){this.abort(),this._xhr&&this._xhr.removeEventListener&&this._xhr.removeEventListener("progress",this._progressHandler),this._tId&&(clearTimeout(this._tId),this._tId=0),this._state=null,this._xhr=null,this._promise=null,this._stats=null,this._reject=null,this._resolve=null,this._options=null,this._utils=null}setHeaders(e){Object.assign(this._headers,e)}send(e,t=""){if(this._state!==Qt._NEW)throw qt.createError(m.GENERAL,"Request already sent.");this._url=e,this._state=Qt._SENT;let i=e,s=t;t&&"get"===this._options.method.toLowerCase()&&(i=`${e}${e.indexOf("?")>-1?"&":"?"}${t}`,s=null),this._promise=new Promise((e,t)=>{this._resolve=e,this._reject=t});let n=e.match(/^(https?\:)?\/\/(.*?)\//);n&&n[2]!=window.location.host&&window.XDomainRequest&&this._isIE9()&&(!this._options.responseType||"text"===this._options.responseType)?this._xhr=new XDomainRequest:this._xhr=new XMLHttpRequest,this._xhr instanceof XMLHttpRequest?this._xhr.onreadystatechange=this._readyStateHandler.bind(this):(this._xhr.onload=this._xDomainLoadHandler.bind(this),this._xhr.onerror=this._xDomainErrorHandler.bind(this)),this._xhr.addEventListener&&this._xhr.addEventListener("progress",this._progressHandler),this._xhr.open(this._options.method,i,!0),this._options.responseType&&this._xhr instanceof XMLHttpRequest&&(this._xhr.responseType=this._options.responseType),this._options.withCredentials&&(this._xhr.withCredentials=this._options.withCredentials);for(let e in this._headers)this._xhr.setRequestHeader(e,this._headers[e]);return this._stats.start=Date.now(),this._xhr.send(s),this._options.timeout&&(this._tId=setTimeout(this._timeout.bind(this),this._options.timeout)),this._promise}getProgressInfo(){if(this._state!==Qt._SENT&&this._state!==Qt._DONE)return null;if(!this._total||!this._loaded)return null;let e=(this._state===Qt._DONE?this._stats.end:Date.now())-this._stats.start,t=this._total-this._loaded,i=this._utils.calculateBandwidth(this._loaded,e);return{duration:e/1e3,loaded:this._loaded,total:this._total,bandwidth:i,estimatedRemainingTime:8*t/i}}abort(){return this._state===Qt._SENT&&(this._state=Qt._ABORTED,this._xhr.abort(),this._reject({type:"abort",request:this,url:this._url}),!0)}serializeData(e){if("string"==typeof e)return e;if(!e)return"";const t=[];for(let i in e){let s=e[i];s instanceof Array||(s=[s]);for(let e=0;e<s.length;e++)t.push(`${encodeURIComponent(i)}=${encodeURIComponent(s[e])}`)}return t.join("&")}_isIE9(){return navigator.userAgent.includes("MSIE 9.0")}_timeout(){this._state===Qt._SENT&&(this._state=Qt._TIMEOUT,this._xhr.abort(),this._reject({type:"timeout",request:this,url:this._url}))}_readyStateHandler(){if(this._state===Qt._SENT&&4===this._xhr.readyState)if(this._xhr.status){let e=Date.now(),t=this._xhr.response||this._xhr.responseText;this._done(t,this._xhr.status,e)}else this._failed()}_xDomainLoadHandler(){if(this._state!==Qt._SENT)return;let e=Date.now(),t=this._xhr.responseText;this._done(t,200,e)}_xDomainErrorHandler(){this._state===Qt._SENT&&this._failed()}_done(e,t,i){this._state=Qt._DONE,this._stats.total=e.byteLength||e.length,this._stats.end=i,this._stats.duration=(this._stats.end-this._stats.start)/1e3,this._stats.bandwidth=this._utils.calculateBandwidth(this._stats.total,this._stats.end-this._stats.start),this._resolve({status:t,data:e,type:"done",request:this,url:this._url,stats:this._stats})}_failed(e=null,t=0){this._state=Qt._FAILED,this._reject({status:t,type:"failed",request:this,url:this._url,error:e})}_progressHandler(e){this._tId&&(clearTimeout(this._tId),this._tId=0),this._loaded=e.loaded,this._total=e.total}}Qt._NEW=0,Qt._SENT=1,Qt._DONE=2,Qt._ABORTED=3,Qt._TIMEOUT=4,Qt._FAILED=5;class Yt{constructor(e,t,i=null){this._utils=e,this._settings=t,this._options=i,this._url="",this._requestData="",this._request=null,this._resolve=null,this._reject=null,this._promise=null,this._info=null,this._attempts=0,this._isLoading=!1,this._done=this._done.bind(this),this._failed=this._failed.bind(this)}load(e,t=""){return this._promise=new Promise((e,t)=>{this._resolve=e,this._reject=t}),this._url=e,this._requestData=t,this._processRequest(),this._promise}abort(){return this._isLoading=!1,!!this._request&&this._request.abort()}getProgressInfo(){return this._info?this._info:this._request?this._request.getProgressInfo():null}isLoading(){return this._isLoading}_processRequest(){this._isLoading=!0,this._attempts++;let e=null;try{this._request=new Qt(this._utils,this._options),e=this._request.send(this._url,this._requestData)}catch(e){return this._reject({error:e,type:"invalid",request:this,url:this._url})}e.then(this._done).catch(this._failed)}_done(e){if(e.status>=400)return e.type="failed",e.error=null,void this._failed(e);this._info=this._request.getProgressInfo(),this._request.destroy(),this._request=null,this._isLoading=!1,200===e.status?this._resolve(e):this._reject(e)}_failed(e){this._request.destroy(),this._request=null,("failed"===e.type||"timeout"===e.type)&&this._attempts<this._settings.maxAttemps?this._processRequest():(this._isLoading=!1,this._reject(e))}}class zt{constructor(e,t,i){this._utils=e,this._loaderSettings={maxAttemps:t.maxAttemps||1},this._options={timeout:t.timeout||0},i===zt.PROFILE_SEGMENT?this._options.responseType="arraybuffer":i===zt.PROFILE_NORMALIZATION_PUT&&(this._options.method="PUT")}create(){return new Yt(this._utils,this._loaderSettings,this._options)}}zt.PROFILE_NORMALIZATION_PUT="normalization-put",zt.PROFILE_NORMALIZATION_GET="normalization-get",zt.PROFILE_PLAYLIST="playlist",zt.PROFILE_SEGMENT="segment",zt.PROFILE_TEXTTRACK="texttrack",zt.PROFILE_VAST="vast",zt.PROFILE_AD="ad";class Wt{constructor(e){this._settings=e,this._defaultSettings=Object.assign({},this._settings),this._qualityList=null}isLoadOnSource(){return this._settings.loadOnSource}isBufferLow(e){return e.length<C.MAX_BUFFER_SIZE/4}setQualityList(e){this._qualityList=e}getQuality(e,t,i=null,s=null,n=null,o=null,r=null,a=null,l,h,_=0){let d=null;if(s&&s.length)if(a){const e=s.find(e=>e.start<=a.end&&e.start+e.duration>a.end),t=e?this._qualityList.getQualityItem(e.qualityIdx):null;!e||void 0!==l&&!t.getTrack(l,C.TYPE_AUDIO)||void 0!==h&&!t.getTrack(h,C.TYPE_VIDEO)||(d=e.qualityIdx)}else d=s[0].qualityIdx;let u=0;if(this._isEmpty())u=-1;else if(null!==d)u=d;else if(i&&i.length&&this._hasBitrates(l,h)){let s=i[i.length-1],r=s.bandwidth*Wt.BANDWIDTH_REDUCE;if(e&&s.duration&&a&&a.length<C.MAX_BUFFER_SIZE/3)if(t&&!a.length&&s.adaptiveSource&&s.adaptiveSource===this._qualityList.getAdaptiveSrc()){let e=this._qualityList.getQualityItem(s.qualityIdx),t=this._qualityList.getQualityItem(s.qualityIdx>Wt.MAX_SEEK_QUALITY_DROP?s.qualityIdx-Wt.MAX_SEEK_QUALITY_DROP:0);r=Math.max(Math.min(e.getBitrate(void 0!==l?l:null,void 0!==h?h:null)*(Wt.MAX_TOLERABLE_SEEK_TIME/s.duration),r),t.getBitrate(void 0!==l?l:null,void 0!==h?h:null))}else r=Math.min(s.bandwidth*(s.segmentDuration/s.duration),r);u=this._getFitQualityIdx(l,h,r,n,o)}else u=null!==r?r:this._hasBitrates(l,h)&&this._settings.preferredBitrate?this._getFitQualityIdx(l,h,this._settings.preferredBitrate,n,o):this._getMiddleQualityIdx(l,h);return u}_isEmpty(){if(this._qualityList)for(let e=this._qualityList.getLength()-1;e>=0;e--){if(!this._qualityList.getQualityItem(e).isDisabled())return!1}return!0}_isQualityItemSuitable(e,t,i){if(e.isDisabled())return!1;const s=void 0!==t?e.getTrack(t,C.TYPE_AUDIO):null,n=void 0!==i?e.getTrack(i,C.TYPE_VIDEO):null,o=e.getCodecs(C.TYPE_AUDIO),r=e.getCodecs(C.TYPE_VIDEO);return(void 0===t||s&&s.getCodecs(C.TYPE_AUDIO)===o)&&(void 0===i||n&&n.getCodecs(C.TYPE_VIDEO)===r)}_getMiddleQualityIdx(e,t){let i=Math.floor((this._qualityList.getLength()-1)/2);for(let s=i;s>=0;s--){const i=this._qualityList.getQualityItem(s);if(this._isQualityItemSuitable(i,e,t))return s}for(let s=i+1,n=this._qualityList.getLength();s<n;s++){const i=this._qualityList.getQualityItem(s);if(this._isQualityItemSuitable(i,e,t))return s}return-1}_getFitQualityIdx(e,t,i,s=null,n=null){let o=[];for(let i=0;i<this._qualityList.getLength();i++){const s=this._qualityList.getQualityItem(i);this._isQualityItemSuitable(s,e,t)&&o.push({qualityIdx:i,qualityItem:s})}for(let r=o.length-1;r>=0;r--){const a=o[r].qualityItem,l=o[r].qualityIdx,h=a.getResolution(),_=h&&h.height,d=this._settings.isSmallScreen?Wt.RESOLUTION_FACTOR_MOBILE:Wt.RESOLUTION_FACTOR_DESKTOP,u=this._settings.isSmallScreen?Wt.MINIMAL_QUALITY_MOBILE:Wt.MINIMAL_QUALITY_DESKTOP;if(!(this._settings.adaptResolutionToSize&&(null===n||n!==l)&&_&&_>u&&s&&s.elementHeight&&s.elementHeight*d<_)&&a.getBitrate(void 0!==e?e:null,void 0!==t?t:null)<=i)return l}return o.length?o[0].qualityIdx:-1}_hasBitrates(e,t){for(let i=this._qualityList.getLength()-1;i>=0;i--){if(!this._qualityList.getQualityItem(i).getBitrate(void 0!==e?e:null,void 0!==t?t:null))return!1}return!0}}Wt.EVENT_ERROR="error",Wt.EVENT_LOAD="load",Wt.BANDWIDTH_REDUCE=.85,Wt.RESOLUTION_FACTOR=1.15,Wt.RESOLUTION_FACTOR_MOBILE=1.3,Wt.MINIMAL_QUALITY_MOBILE=360,Wt.RESOLUTION_FACTOR_DESKTOP=1.6,Wt.MINIMAL_QUALITY_DESKTOP=480,Wt.MAX_TOLERABLE_SEEK_TIME=2,Wt.MAX_SEEK_QUALITY_DROP=2;let Kt=new m.ErrorFactory(m.createSourceName("src/js/mediaplayer/streaming/NativeStreamController.js"));class $t extends S{constructor(e,t,i){super(),this._nativeStreamModel=e,this._qualityListService=t,this._playbackElement=i,this._elementEventsMap=new Map([[b.EVENT_SOURCE_SET,this._handleSourceSet],[b.EVENT_SOURCE_CANCEL,this._handleSourceCancel],[b.EVENT_QUALITY_SET,this._handleQualitySet],[b.EVENT_TRACK_SET,this._handleQualitySet],[b.EVENT_LOADED_META,this._handleLoadedMetadata],[b.EVENT_DURATION_CHANGE,this._handleDurationChange]]),this._elementNoLoadSourceMap=new Map([[b.EVENT_PLAY,this._handleNoLoadSource]]),this._isProcessing=!1,this._isSourcePreload=null,this._isNoLoadSourceHandled=!1,this._isQualitySet=!1,this._isMetadataLoaded=!1,this._wasPlaying=null,this._wasPlayingSent=null,this._seekPending=null,this._liveTimer={},this._qualityItemData=null,this.bindAll(this._elementNoLoadSourceMap),this.bindAll(this._elementEventsMap),this.addListeners(this._playbackElement,this._elementEventsMap)}destroy(){let e=Object.keys(this);this._clearLiveTimer(),this.removeListeners(this._playbackElement,this._elementEventsMap),this.removeListeners(this._playbackElement,this._elementNoLoadSourceMap);for(let t of e)this[t]=null}_processNextStep(){let e=this._playbackElement.getResolvedSource(),t=this._playbackElement.getQuality();if(null===t&&!e.isAdaptive()){const e=this._playbackElement.getDefaultQuality();t=null===e?this._nativeStreamModel.getQuality(this._playbackElement.isPlaying(),this._playbackElement.isSeeking(),this._playbackElement.getStatsHistory(),this._playbackElement.getPreloadedStats(),this._playbackElement.getElementDimensions(),this._playbackElement.getBestUsedQuality()):e,this._playbackElement.setDefaultQuality(t)}if(-1===t){const e=Kt.createError(m.SOURCE,"No valid quality available.");return this._playbackElement.handleError(e),void(this._isProcessing=!1)}const i=this._playbackElement.getTrack(C.TYPE_AUDIO),s=this._playbackElement.getTrack(C.TYPE_VIDEO),n=e.getDefaultTrackIds(C.TYPE_AUDIO),o=e.getDefaultTrackIds(C.TYPE_VIDEO),r=e.hasAnyVideoTrackAvailable();if(void 0===n||void 0===o&&r){const e=Kt.createError(m.MEDIA,"No usable audio/video track found.");return this._playbackElement.handleError(e),void(this._isProcessing=!1)}const a=void 0!==i?i:n.length?n[0]:null,l=void 0!==s?s:o&&o.length?o[0]:null;this._playbackElement.loadSource(t,a,l,this._seekPending),this._isProcessing=!1}_resolveSourceSrc(){let e=this._playbackElement.getResolvedSource();if(!e.isAdaptive()||!this._playbackElement.isLive()&&!this._playbackElement.isEvent())return Promise.resolve(!0);const t=this._playbackElement.getQuality()||e.getLength()-1,i=e.getQualityItem(t),s=e.hasAnyVideoTrackAvailable();let n=null,o=null;return s?(n=i.getDefaultTrackId(C.TYPE_VIDEO),o=i.getTrack(n,C.TYPE_VIDEO)):(n=i.getDefaultTrackId(C.TYPE_AUDIO),o=i.getTrack(n,C.TYPE_AUDIO)),this._qualityListService.fillTrack(o).then(e=>{const t=e.isLive(),s=e.isEvent();if(null===this._seekPending&&t&&s){const t=i.getDuration(null,n,!0);if(t){const i=e.getSegment(t);i&&(this._seekPending=i.start)}}if(null!==this._seekPending){const e=i.getDuration(null,n,t&&s);this._seekPending>e&&(this._seekPending=e)}return this._playbackElement.handleAdaptiveTrackUpdate(o,!0),t&&this._setReload(e,C.TYPE_VIDEO),Promise.resolve(!0)},e=>{if("abort"!==e.type){const e=Kt.createError(m.MEDIA,`Quality ${t} could not be retrieved.`);this._handleFatalError(e)}return Promise.resolve(!1)}).catch(e=>{this._handleFatalError(e)})}_setReload(e,t){const i=e.getTargetDuration()*(e.isChanged()?1e3:500);this._liveTimer[t]=setTimeout(this._reloadTrack.bind(this,e,t),i)}_reloadTrack(e,t){this._qualityListService.loadTrack(e).then(i=>{this._clearLiveTimer(t),this._qualityListService.refillTrack(e,i),this._playbackElement.handleAdaptiveTrackUpdate(e),i.isLive()&&this._setReload(e,t)},i=>{"abort"!==i.type&&this._setReload(e,t)}).catch(e=>{this._handleFatalError(e)})}_clearLiveTimer(e=null){if(null===e)for(let e in this._liveTimer)clearTimeout(this._liveTimer[e]),this._liveTimer[e]=null;else clearTimeout(this._liveTimer[e]),this._liveTimer[e]=null}_handleSourceSet(e){this._nativeStreamModel.setQualityList(e.source),this._isNoLoadSourceHandled=!1,this._isSourcePreload=this._playbackElement.getSourcePreload(),null===this._isSourcePreload&&(this._isSourcePreload=this._nativeStreamModel.isLoadOnSource()),this._isSourcePreload?(this._isProcessing=!0,this._isQualitySet=!1,this._isMetadataLoaded=!1,this._seekPending=this._playbackElement.getStartTime(),this._resolveSourceSrc().then(e=>{e&&this._processNextStep()})):(this._isProcessing=!1,this.addListeners(this._playbackElement,this._elementNoLoadSourceMap))}_handleSourceCancel(){this._clearLiveTimer(),this._qualityListService.abortFill(),this._isProcessing=!1}_handleQualitySet(e){this._isProcessing||!this._isSourcePreload&&!this._isNoLoadSourceHandled||(this._isProcessing=!0,this._isMetadataLoaded=!1,this._isQualitySet=!0,this._seekPending=this._playbackElement.getCurrentTime(),this._wasPlaying="wasPlaying"in e?e.wasPlaying:null,this._wasPlayingSent="wasPlayingSent"in e&&e.wasPlayingSent,this._processNextStep())}_handleNoLoadSource(){if(this._playbackElement.getResolvedSource())this._isProcessing=!0,this._isQualitySet=!1,this._isMetadataLoaded=!1,this._seekPending=this._playbackElement.getStartTime(),this._isNoLoadSourceHandled=!0,this.removeListeners(this._playbackElement,this._elementNoLoadSourceMap),this._resolveSourceSrc().then(e=>{e&&this._processNextStep()});else{const e=Kt.createError(m.SOURCE,"No source specified.");this._playbackElement.handleError(e)}}_handleLoadedMetadata(){this._isMetadataLoaded=!0,this._handlePendingSeek()}_handleDurationChange(){this._handlePendingSeek()}_handlePendingSeek(){null!==this._seekPending&&this._isMetadataLoaded&&this._seekPending<=this._playbackElement.getDuration()&&(this._isQualitySet&&null!==this._wasPlaying?(this._playbackElement.seekInBuffer(this._seekPending),this._wasPlaying&&this._playbackElement.play(!this._wasPlayingSent)):this._isQualitySet||this._playbackElement.seekInBuffer(this._seekPending),this._seekPending=null)}_handleFatalError(e){this._isProcessing=!1,this._playbackElement.handleError(e)}}class Xt{constructor(e,t,i,s){this._env=e,this._utils=t,this._qualityListService=i,this._options=s}create(e){let t=new Wt({loadOnSource:this._options.loadOnSource,resolution:this._env.getScreenResolution(),isSmallScreen:this._env.isSmallScreen(),preferredBitrate:this._options.preferredBitrate,adaptResolutionToSize:this._options.adaptResolutionToSize});return new $t(t,this._qualityListService,e)}}class Zt extends Wt{getNextTrackType(e,t,i,s,n,o,r,a,l){const h=l.filter((e,i,s)=>e.time>t);let _=null!==r?r:C.MAX_BUFFER_SIZE;return e&&!(i.end<e)||!(null===_||i.length<_)||h.length&&!(i.end-Zt.BBPOINT_BUFFER_AFTER<h[0].time)||a&&i.length&&!this._settings.loadSegmentsWhilePaused?null:this._qualityList.hasAnyVideoTrackAvailable()?n&&s?n.end-s.end<=Zt.MIN_BUFFERS_DIFFERENCE?C.TYPE_VIDEO:C.TYPE_AUDIO:s?C.TYPE_AUDIO:C.TYPE_VIDEO:C.TYPE_AUDIO}}Zt.BBPOINT_BUFFER_AFTER=5,Zt.MIN_BUFFERS_DIFFERENCE=.01;const Jt=4;let ei=new m.ErrorFactory(m.createSourceName("src/js/mediaplayer/streaming/AdaptiveStreamController.js"));class ti extends S{constructor(e,t,i){super(),this._adaptiveStreamModel=e,this._qualityListService=t,this._playbackElement=i,this._elementEventsMap=new Map([[b.EVENT_SOURCE_SET,this._handleSourceSet],[b.EVENT_SOURCE_CANCEL,this._handleSourceCancel],[b.EVENT_DESTROY,this._handleSourceCancel],[b.EVENT_QUALITY_SET,this._handleQualitySet],[b.EVENT_TRACK_SET,this._handleTrackSet],[b.EVENT_BUFFER_READY,this._handleBufferReady],[b.EVENT_LOADED_SEGMENT,this._handleLoadedSegment],[b.EVENT_LOADED_SILENT_AUDIO,this._handleLoadedSilentAudio],[b.EVENT_LOADING_PROGRESS,this._handleLoadProgress],[b.EVENT_LOADING_FAILED,this._handleFailedLoad],[b.EVENT_LOADING_ABORTED,this._handleAbortedLoad]]),this._elementNoLoadSourceMap=new Map([[b.EVENT_PLAY,this._handleNoLoadSource]]),this._isProcessing=!1,this._isLoadAborting=!1,this._isLoadAfterAbort=!1,this._isFirstLoad=!0,this._maxNext=null,this._lastLoadedSegment=null,this._isSourcePreload=null,this._isNoLoadSourceHandled=!1,this._seekPending=null,this._liveTimer={},this._reloadedTrack={},this._restartAttempts=0,this.bindAll(this._elementNoLoadSourceMap),this.bindAll(this._elementEventsMap),this.addListeners(this._playbackElement,this._elementEventsMap)}destroy(){let e=Object.keys(this);this._clearLiveTimer(),this.removeListeners(this._playbackElement,this._elementEventsMap),this.removeListeners(this._playbackElement,this._elementNoLoadSourceMap);for(let t of e)this[t]=null}_processNextStep(e={}){const t=this._playbackElement.getCurrentTime(),i=this._playbackElement.getBuffered(t),s=this._playbackElement.getBufferedAudio(t),n=this._playbackElement.getBufferedVideo(t);let o=i.end,r=this._playbackElement.getResolvedSource(),a=this._playbackElement.getQuality();const l=this._playbackElement.getQualityItem(),h=this._playbackElement.getTrack(C.TYPE_AUDIO),_=this._playbackElement.getTrack(C.TYPE_VIDEO);let d=null;void 0!==e.loadedSegment&&((d=e.loadedSegment).useAudio&&d.useVideo&&o<=d.start||d.useAudio&&s&&s.end<=d.start||d.useVideo&&n&&n.end<=d.start)&&(this._maxNext=Math.max(i.length/2,ti.MIN_MAX_NEXT));let u=this._lastLoadedSegment;this._lastLoadedSegment=d;for(let e in this._reloadedTrack)this._reloadedTrack[e]&&(this._qualityListService.refillTrack(this._reloadedTrack[e].oldTrack,this._reloadedTrack[e].newTrack),this._playbackElement.handleTrackUpdate(),this._reloadedTrack[e]=null);const c=this._adaptiveStreamModel.getNextTrackType(l?l.getDuration(h,_):null,t,i,s,n,a,this._maxNext,this._playbackElement.isPaused(),this._playbackElement.getAdPoints());if(!c)return void(this._isProcessing=!1);if(this._maxNext=null,null===a&&l&&c===C.TYPE_AUDIO?a=r.getQualityIdx(l):null===a&&(a=this._adaptiveStreamModel.getQuality(this._playbackElement.isPlaying(),this._playbackElement.isSeeking(),this._playbackElement.getStatsHistory(),this._playbackElement.getPreloadedStats(),this._playbackElement.getElementDimensions(),this._playbackElement.getBestUsedQuality(),this._playbackElement.getDefaultQuality(),this._playbackElement.getBuffered(t),h,_)),-1===a){const e=ei.createError(m.SOURCE,"No valid quality available.");return this._playbackElement.handleError(e),void(this._isProcessing=!1)}const p=r.getQualityItem(a),g=void 0!==h?h:p.getDefaultTrackId(C.TYPE_AUDIO),E=void 0!==_?_:p.getDefaultTrackId(C.TYPE_VIDEO);if(void 0===g&&void 0===E||void 0===g&&s||void 0===E&&n){const e=ei.createError(m.MEDIA,"No usable audio/video track found.");return this._playbackElement.handleError(e),void(this._isProcessing=!1)}const T=p.getTrackRelevantData(g,E,c);if(!T.useAudio&&!T.useVideo){const e=ei.createError(m.MEDIA,"No relevant data found in track.");return this._playbackElement.handleError(e),void(this._isProcessing=!1)}const f=c===C.TYPE_VIDEO?E:g,y=p.getTrack(f,c);if(!y){const e=ei.createError(m.MEDIA,"Track not found.");return this._playbackElement.handleError(e),void(this._isProcessing=!1)}const v=c===C.TYPE_VIDEO?_:h,A=y.hasSource()&&(!y.isLive()||l===p&&f===v);A||(this._clearLiveTimer(c),this._reloadedTrack[c]=null),this._qualityListService.fillTrack(y,A).then(s=>{const n=p.isLive(g,E),l=p.isEvent(g,E),h=this._playbackElement.getStartTime();if(null!==h&&this._isFirstLoad){const e=p.getDuration(g,E,n&&l),t=h>e?e:h;s.getSegment(t)&&(o=t,this._seekPending=o)}else if(n&&l&&this._isFirstLoad){const e=p.getDuration(g,E,!0);if(e){const t=s.getSegment(e);t&&(o=t.start,this._seekPending=o)}}null!==this._seekPending||void 0===e.setQualityIdx&&void 0===e.setTrackId||(o=t,this._seekPending=o);const _=r.hasAnyVideoTrackAvailable();let d=s.getSegment(o);const y=Object.assign({qualityIdx:a,trackId:f,trackType:c},T,d);if(c!==C.TYPE_AUDIO||!_||d&&this._playbackElement.isReadyToAddAudio(y)&&!T.useVideo||(d=null),d&&u&&u.idx===y.idx&&u.qualityIdx===y.qualityIdx&&u.trackId===y.trackId&&u.trackType===y.trackType){if(++this._restartAttempts<=Jt)return void this._playbackElement.restart();{const e=ei.createError(m.GENERAL,"Attempt to fill buffer has failed.");return this._playbackElement.handleError(e),void(this._isProcessing=!1)}}if(d)this._playbackElement.loadSegment(y,p,g,E);else{let e=!!_&&null;if(c===C.TYPE_AUDIO&&_&&(!n||T.useVideo||!this._playbackElement.isReadyToAddAudio(y)||i.length<ti.BUFFER_EMPTY_LENGTH)){const i=this._playbackElement.getBufferedAudio(t,0),s=this._playbackElement.getBufferedAudio(t+i.length+ti.SILENT_AUDIO_LENGTH+I.BUFFER_HOLE_TOLERANCE,0),n=this._playbackElement.getBufferedVideo(t,0);e=this._playbackElement.addSilentAudio(i.end,Math.min(ti.SILENT_AUDIO_LENGTH+(s.length>0?s.start-i.end:0),Math.max(n.end-i.end,ti.MIN_SILENT_AUDIO_LENGTH)),T)}if(!e)if(this._isProcessing=!1,n||c!==C.TYPE_VIDEO&&_||void 0!==d){if(i.length<=ti.BUFFER_EMPTY_LENGTH){if(n&&!l&&(c===C.TYPE_VIDEO||!1===e)||++this._restartAttempts<=Jt)return void this._playbackElement.restart(i.length+ti.BUFFER_RESTART_SEEK);{const e=ei.createError(m.GENERAL,"Segment not found.");return this._playbackElement.handleError(e),void(this._isProcessing=!1)}}}else this._playbackElement.forceEndOfStream()}!n||this._liveTimer[c]||c===C.TYPE_AUDIO&&T.useVideo||this._setReload(s,c)},e=>{"abort"!==e.type&&this._handleInvalidQualityItem(a)}).catch(e=>{this._handleFatalError(e)})}_reloadTrack(e,t){this._qualityListService.loadTrack(e).then(i=>{this._reloadedTrack[t]={oldTrack:e,newTrack:i},this._clearLiveTimer(t),i.isLive()&&(i.setChanged(e.getSequence()!==i.getSequence()),this._setReload(e,t)),this._isProcessing||(this._isProcessing=!0,this._processNextStep())},i=>{"abort"!==i.type&&this._setReload(e,t)}).catch(e=>{this._handleFatalError(e)})}_setReload(e,t){let i=e.getTargetDuration()*(e.isChanged()?1e3:500);this._liveTimer[t]=setTimeout(this._reloadTrack.bind(this,e,t),i)}_clearLiveTimer(e=null){if(null===e)for(let e in this._liveTimer)clearTimeout(this._liveTimer[e]),this._liveTimer[e]=null;else clearTimeout(this._liveTimer[e]),this._liveTimer[e]=null}_handleSourceSet(e){this._adaptiveStreamModel.setQualityList(e.source),this._lastLoadedSegment=null,this._maxNext=null,this._isNoLoadSourceHandled=!1,this._isLoadAborting=!1,this._isLoadAfterAbort=!1,this._isFirstLoad=!0,this._restartAttempts=0,this._isSourcePreload=this._playbackElement.getSourcePreload(),null===this._isSourcePreload&&(this._isSourcePreload=this._adaptiveStreamModel.isLoadOnSource()),this._isSourcePreload?(this._isProcessing=!0,this._processNextStep()):(this._isProcessing=!1,this.addListeners(this._playbackElement,this._elementNoLoadSourceMap))}_handleSourceCancel(){this._clearLiveTimer(),this._qualityListService.abortFill(),this._reloadedTrack={},this._isProcessing=!1,this._seekPending=null,this._lastLoadedSegment=null}_handleQualitySet(e){(this._isSourcePreload||this._isNoLoadSourceHandled)&&(this._qualityListService.abortFill(),this._isProcessing=!0,this._lastLoadedSegment=null,this._maxNext=null,this._processNextStep({setQualityIdx:e.qualityIdx}))}_handleTrackSet(e){!e.wasQualityChanged&&e.isUserAction&&(this._isSourcePreload||this._isNoLoadSourceHandled)&&(this._qualityListService.abortFill(),this._isProcessing=!0,this._lastLoadedSegment=null,this._maxNext=null,this._processNextStep({setTrackId:e.trackId,setTrackType:e.trackType}))}_handleBufferReady(){this._isProcessing||(this._isProcessing=!0,this._processNextStep())}_handleLoadedSegment(e){if(this._playbackElement.getQualityItem().enable(),this._isLoadAfterAbort=!1,this._isProcessing=!0,null!==this._seekPending){if(!this._playbackElement.seekInBuffer(this._seekPending)){const e=ei.createError(m.MEDIA,"Seek in buffer failed.");return this._playbackElement.handleError(e),this._seekPending=null,void(this._isFirstLoad=!1)}this._seekPending=null}this._isFirstLoad=!1,this._processNextStep({loadedSegment:e})}_handleLoadedSilentAudio(){this._isProcessing=!0,this._processNextStep({silentAudio:!0})}_handleLoadProgress({stats:e,segment:t}){const i=this._playbackElement.getTrack(C.TYPE_AUDIO),s=this._playbackElement.getTrack(C.TYPE_VIDEO),n=this._playbackElement.getQualityItem();if(!n||n.isLive(i,s)||t.trackType!==C.TYPE_VIDEO||this._isLoadAfterAbort||this._playbackElement.isSeeking()||!this._playbackElement.isPlaying()||null!==this._playbackElement.getQuality()||this._playbackElement.isBufferEmpty()&&!this._isFirstLoad)return;const o=this._playbackElement.getCurrentTime(),r=this._playbackElement.getBufferedVideo(o);if(e.estimatedRemainingTime-r.length>ti.MIN_TIME_DIFFERENCE&&(e.loaded>ti.MIN_JUDGED_LOADED||e.duration>ti.MIN_JUDGED_LOAD_TIME)){if(!r.length&&e.duration+e.estimatedRemainingTime<=ti.MAX_FIRST_LOAD_TIME+ti.MIN_TIME_DIFFERENCE)return;this._playbackElement.addStats({bandwidth:(r.length||e.duration>=ti.MAX_FIRST_LOAD_TIME?r.length:ti.MAX_FIRST_LOAD_TIME-e.duration)/e.estimatedRemainingTime*e.bandwidth*ti.BANDWIDTH_FACTOR_CRITICAL}),this._isLoadAborting=!0,this._playbackElement.loadAbort()}else e.duration+e.estimatedRemainingTime-t.duration>ti.MIN_TIME_DIFFERENCE&&this._adaptiveStreamModel.isBufferLow(r)&&(e.loaded>ti.MIN_JUDGED_LOADED||e.duration>ti.MIN_JUDGED_LOAD_TIME)&&(this._playbackElement.addStats({bandwidth:t.duration/(e.duration+e.estimatedRemainingTime)*e.bandwidth*ti.BANDWIDTH_FACTOR_LOW}),this._isLoadAborting=!0,this._playbackElement.loadAbort())}_handleFailedLoad(e){const t=this._playbackElement.getTrack(C.TYPE_AUDIO),i=this._playbackElement.getTrack(C.TYPE_VIDEO),s=this._playbackElement.getQualityItem();s.disable(),s.isLive(t,i)&&!s.isEvent(t,i)||null===this._playbackElement.getQuality()?(this._isLoadAfterAbort=!1,this._isProcessing=!0,this._processNextStep()):(this._isProcessing=!1,this._playbackElement.setQuality(null))}_handleAbortedLoad(){this._isProcessing=!1,this._isLoadAborting&&(this._isLoadAborting=!1,this._isLoadAfterAbort=!0,this._isProcessing=!0,this._processNextStep())}_handleNoLoadSource(){if(this._playbackElement.getResolvedSource())this._isProcessing=!0,this._isNoLoadSourceHandled=!0,this.removeListeners(this._playbackElement,this._elementNoLoadSourceMap),this._processNextStep();else{const e=ei.createError(m.SOURCE,"No source specified.");this._playbackElement.handleError(e)}}_handleInvalidQualityItem(e){let t=this._playbackElement.getResolvedSource();if(!t)return;const i=t.getQualityItem(e);i&&(i.isDisabled()||(i.disable(),this._isProcessing=!0,this._processNextStep()))}_handleFatalError(e){this._isProcessing=!1,this._playbackElement.handleError(e)}}ti.MIN_JUDGED_LOADED=153600,ti.MIN_JUDGED_LOAD_TIME=2.4,ti.MAX_FIRST_LOAD_TIME=3.5,ti.MIN_TIME_DIFFERENCE=.5,ti.BANDWIDTH_FACTOR_CRITICAL=.8,ti.BANDWIDTH_FACTOR_LOW=.9,ti.MIN_MAX_NEXT=6,ti.SILENT_AUDIO_LENGTH=1.11,ti.MIN_SILENT_AUDIO_LENGTH=.09,ti.BUFFER_EMPTY_LENGTH=3,ti.BUFFER_RESTART_SEEK=.5;class ii{constructor(e,t,i,s){this._env=e,this._utils=t,this._qualityListService=i,this._options=s}create(e){let t=new Zt({loadOnSource:this._options.loadOnSource,resolution:this._env.getScreenResolution(),isSmallScreen:this._env.isSmallScreen(),loadSegmentsWhilePaused:!this._options.stopBufferingOnPause,adaptResolutionToSize:this._options.adaptResolutionToSize});return new ti(t,this._qualityListService,e)}}class si extends S{constructor(e){super(),this._videoElement=e,this._textTrack=null,this._currentCues=null,this._currentRegions=null,this._eventsMap=new Map([[b.EVENT_TIMEUPDATE,this._handleTimeUpdate]]),this.bindAll(this._eventsMap)}setTextTrack(e){this.removeListeners(this._videoElement,this._eventsMap),this._textTrack=null,this._currentCues=null,this._currentRegions=null,null!==e&&(this._textTrack=e,this._currentCues=e.data.getCues(),this._currentRegions=e.data.getRegions(),this.addListeners(this._videoElement,this._eventsMap))}_processActiveCues(e){const t=this._currentCues.filter(t=>t.getStartTime()<=e&&t.getEndTime()>=e);return t.length?t:null}_handleTimeUpdate(e){this.emit(si.EVENT_CUE_CHANGE,{cues:this._processActiveCues(e.time),regions:this._currentRegions})}}si.EVENT_CUE_CHANGE="cuechange";class ni extends S{constructor(e,t,i){super(),this._utils=t,this._options=i,this._source=e}reset(){throw new Error('[AdaptiveStrategy] Method "reset" is not implemented.')}loadAbort(){throw new Error('[AdaptiveStrategy] Method "loadAbort" is not implemented.')}processSegment(e,t,i,s){throw new Error('[AdaptiveStrategy] Method "processSegment" is not implemented.')}loadInitSegment(e){throw new Error('[AdaptiveStrategy] Method "loadInitSegment" is not implemented.')}getType(){throw new Error('[AdaptiveStrategy] Method "getType" is not implemented.')}_handleSegmentLoadFailed(e,t=null){this.emit(ni.EVENT_SEGMENT_LOAD_FAILED,{segment:e,requestResult:t})}_handleError(e){this.emit(ni.EVENT_ERROR,e)}}ni.EVENT_SEGMENT_LOAD_FAILED="segmentloadfailed",ni.EVENT_ERROR="error";class oi{static getGolomb(e,t){var i=e.indexOf("1",t)-t;return 0===i?{end:t,value:0}:{end:t+2*i,value:[0,1,3,7,15,31,63,127,255,511][i]+oi.toNumber(e.substr(t+i+1,i))}}static toNumber(e){for(var t=0,i=1;i<=e.length;i++)t+=parseInt(e.charAt(e.length-i))*Math.pow(2,i-1);return t}static toString(e){for(var t=0,i="",s=["0000","0001","0010","0011","0100","0101","0110","0111","1000","1001","1010","1011","1100","1101","1110","1111"];t<e.length;)i+=s[(240&e[t])>>4]+s[15&e[t]],t++;return i}}new m.ErrorFactory(m.createSourceName("src/js/mediaplayer/tech/html/mux/Fmp4Remux.js"));const ri=9e4,ai=Math.pow(2,32)-1;class li{constructor(){this.reset()}resetHeader(){this._tracks=null}reset(){this.resetHeader(),this._baseDts=null}remux(e,t,i,s,n,o){let r=!1,a=null;this._tracks?a=this._getBaseDts(this._tracks,t):(this._tracks=this._parseInitSegment(e),r=!0,a=this._getBaseDts(this._tracks,t),null===this._baseDts&&(this._baseDts=null!==o?o/ri:a-i)),this._shiftBaseDts(this._tracks,t);let l=!1,h=!1;for(let e of Object.keys(this._tracks))"audio"===this._tracks[e].type&&(l=!0),"video"===this._tracks[e].type&&(h=!0);const _=this._getDuration(t);return r?{header:e,data:t,isAudio:l,isVideo:h,initDts:this._baseDts*ri,realStart:a-this._baseDts,realDuration:_}:{data:t,isAudio:l,isVideo:h,initDts:this._baseDts*ri,realStart:a-this._baseDts,realDuration:_}}_readUInt16(e,t){const i=e[t]<<8|e[t+1];return i<0?65536+i:i}_readUInt32(e,t){const i=e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3];return i<0?4294967296+i:i}_readString(e,t,i){return String.fromCharCode.apply(null,e.subarray(t,i))}_writeUInt32(e,t,i){e[t]=i>>24,e[t+1]=i>>16&255,e[t+2]=i>>8&255,e[t+3]=255&i}_findBoxes(e,t,i=null){if(!e.length)return[];const s=i?i.offset:0,n=i?i.length:t.byteLength;let o=[],r=s;for(;r<s+n-8;){const i=this._readUInt32(t,r),s=this._readString(t,r+4,r+8),n={offset:r+8,length:i};s===e[0]&&1===e.length?o.push(n):s===e[0]&&(o=o.concat(this._findBoxes(e.slice(1),t,n))),r+=i}return o}_findBox(e,t,i=null){const s=this._findBoxes(e,t,i);return s.length?s[0]:null}_parseInitSegment(e){const t={};return this._findBoxes(["moov","trak"],e).forEach(i=>{const s=this._findBox(["tkhd"],e,i),n=this._findBox(["mdia","mdhd"],e,i),o=this._findBox(["mdia","hdlr"],e,i);if(s&&n&&o){const i=e[s.offset],r=this._readUInt32(e,s.offset+(i?20:12)),a=e[n.offset],l=this._readUInt32(e,n.offset+(a?20:12)),h=this._readString(e,o.offset+8,o.offset+12),_="soun"===h?"audio":"vide"===h?"video":null;_&&(t[r]={trackId:r,timescale:l,type:_})}}),t}_getBaseDts(e,t){let i=null;return this._findBoxes(["moof","traf"],t).forEach(s=>{const n=this._findBox(["tfhd"],t,s),o=this._findBox(["tfdt"],t,s);if(n&&o){const r=this._readUInt32(t,n.offset+4),a=e[r]&&e[r].timescale||ri,l=t[s.offset];let h=this._readUInt32(t,o.offset+4);l&&(h*=Math.pow(2,32),h+=this._readUInt32(t,o.offset+8)),h/=a,(null===i||i>h)&&(i=h)}}),null===i?0:i}_shiftBaseDts(e,t){this._findBoxes(["moof","traf"],t).forEach(i=>{const s=this._findBox(["tfhd"],t,i),n=this._findBox(["tfdt"],t,i);if(s&&n){const o=this._readUInt32(t,s.offset+4),r=e[o]&&e[o].timescale||ri,a=this._baseDts*r,l=t[i.offset];let h=this._readUInt32(t,n.offset+4);if(l){h*=Math.pow(2,32),h+=this._readUInt32(t,n.offset+8),h-=a;const e=Math.floor(h/(ai+1)),i=Math.floor(h%(ai+1));this._writeUInt32(t,n.offset+4,e),this._writeUInt32(t,n.offset+8,i)}else h-=a,this._writeUInt32(t,n.offset+4,h)}})}_getDuration(e){const t=this._findBox(["sidx"],e);if(t){const i=e[t.offset],s=this._readUInt32(e,t.offset+8);let n=12+(i?16:8)+2+2;const o=this._readUInt16(e,t.offset+n-2);let r=0;for(let i=0;i<o;i++){if(1===(2147483648&this._readUInt32(e,t.offset+n))>>>31)return null;r+=this._readUInt32(e,t.offset+n+4),n+=12}return r/s}return null}}let hi=new m.ErrorFactory(m.createSourceName("src/js/mediaplayer/tech/html/mux/M2ts.js"));const _i=9e4;class di{static demux(e){var t,i,s,n,o=e.length,r=[],a={},l=!1,h=null,_={type:"audio",codec:null,id:null,samples:[],length:0},d={type:"video",codec:null,id:null,samples:[],length:0,unitCount:0};for(o-=o%188,t=0;t<o;t+=188){if(71!==e[t])throw hi.createError(m.GENERAL,"TS packet not found.");if(i=!!(64&e[t+1]),s=((31&e[t+1])<<8)+e[t+2],(48&e[t+3])>>4>1){if((n=t+5+e[t+4])===t+188)continue}else n=t+4;if(l)s!==d.id&&s!==_.id||(i?(r.push({type:s,size:t+188-n,data:[[n,t+188]]}),a[s]=r.length-1):void 0!==a[s]&&(r[a[s]].data.push([n,t+188]),r[a[s]].size+=t+188-n));else if(n+=i?e[n]+1:0,0===s)h=di._parsePAT(e,n);else if(s===h){let t=di._parsePMT(e,n);_.id=t.audio,d.id=t.video,l=!0}}for(var u=0;u<r.length;u++){let t=new Uint8Array(r[u].size),i=0;for(;r[u].data.length;){let s=r[u].data.shift();t.set(e.subarray(s[0],s[1]),i),i+=s[1]-s[0]}switch(r[u].type){case d.id:di._parseAVC(di._parsePES(t),d);break;case _.id:di._parseAAC(di._parsePES(t),_,null)}}return{audio:_,video:d}}static _parsePAT(e,t){return(31&e[t+10])<<8|e[t+11]}static _parsePMT(e,t){var i=t+((15&e[t+1])<<8|e[t+2]-1),s={audio:null,video:null};for(t+=12+((15&e[t+10])<<8|e[t+11]);t<i;){let i=(31&e[t+1])<<8|e[t+2];switch(e[t]){case 15:s.audio=i;break;case 27:s.video=i}t+=5+((15&e[t+3])<<8|e[t+4])}return s}static _parsePTS(e,t){return 536870912*(14&e[t])+4194304*(255&e[t+1])+16384*(254&e[t+2])+128*(255&e[t+3])+(254&e[t+4])/2}static _parsePES(e){var t,i;return(e[0]<<16)+(e[1]<<8)+e[2]===1?(192&e[7]&&(t=di._parsePTS(e,9),i=64&e[7]?di._parsePTS(e,14):t),{data:e.subarray(e[8]+9),pts:t,dts:i,length:(e[4]<<8)+e[5]}):null}static appendArray(...e){let t=e.reduce((e,t)=>e+t.byteLength,0),i=new Uint8Array(t),s=0;return e.forEach(e=>{i.set(e,s),s+=e.byteLength}),i}static _parseNAL(e,t){for(var i,s,n=0,o=e.byteLength,r=[];n+3<o;){let o=1;if(0===e[n]&&0===e[n+1]&&0===e[n+2]&&1===e[n+3]?o=4:0===e[n]&&0===e[n+1]&&1===e[n+2]&&(o=3),n+=o,1!==o){if(i)r.push({data:e.subarray(i,n-o),type:s});else{let i=n-o;if(i&&t.samples.length){let s=t.samples[t.samples.length-1],n=s.units[s.units.length-1];n.data=di.appendArray(n.data,e.subarray(0,i)),s.length+=i,t.length+=i}}if(i=n,1===(s=31&e[n])||5===s)break}}return i&&r.push({data:e.subarray(i,o),type:s}),r}static _parseAVC(e,t){var i=di._parseNAL(e.data,t),s=[],n=!1,o=!1,r=0;if(0===i.length&t.samples.length>0){var a=t.samples[t.samples.length-1],l=a.units[a.units.length-1];l.data=di.appendArray(l.data,e.data),a.length+=e.data.byteLength,t.length+=e.data.byteLength}e.data=null,i.forEach(e=>{switch(e.type){case 1:o=!0;break;case 5:o=!0,n=!0;break;case 7:if(!t.sps){t.sps=[e.data],t.profileIdc=e.data[1],t.profileCompat=oi.toNumber(oi.toString([e.data[2]]).substr(0,5)),t.levelIdc=e.data[3];let i=e.data.subarray(1,4),s="avc1.";for(let e=0;e<3;e++){let t=i[e].toString(16);s+=(t.length<2?"0":"")+t}t.codec=s;let n=oi.toString(e.data.subarray(4)),o=oi.getGolomb(n,0);if(-1!==[100,110,122,244,44,83,86,118,128,138].indexOf(t.profileIdc)){if(3===(o=oi.getGolomb(n,o.end+1)).value&&o.end++,o=oi.getGolomb(n,o.end+1),(o=oi.getGolomb(n,o.end+1)).end++,o.end++,"1"===n.charAt(o.end))throw hi.createError(m.GENERAL,"Scaling matrix not supported.")}if(o=oi.getGolomb(n,o.end+1),0===(o=oi.getGolomb(n,o.end+1)).value)o=oi.getGolomb(n,o.end+1);else if(1===o.value){o.end++,o=oi.getGolomb(n,o.end+1),o=oi.getGolomb(n,o.end+1);for(let e=0,t=(o=oi.getGolomb(n,o.end+1)).value;e<t;e++)o=oi.getGolomb(n,o.end+1)}(o=oi.getGolomb(n,o.end+1)).end++,o=oi.getGolomb(n,o.end+1),t.width=16*(o.value+1),o=oi.getGolomb(n,o.end+1),t.height=16*(o.value+1),o.end++,"0"===n.charAt(o.end)&&o.end++,o.end++,o.end++,"1"===n.charAt(o.end)&&(o=oi.getGolomb(n,o.end+1),t.width-=2*o.value,o=oi.getGolomb(n,o.end+1),t.width-=2*o.value,o=oi.getGolomb(n,o.end+1),t.height-=2*o.value,o=oi.getGolomb(n,o.end+1),t.height-=2*o.value)}break;case 8:t.pps||(t.pps=[e.data])}o&&(s.push(e),r+=e.data.byteLength)}),s.length&&(!0===n||t.sps)&&(t.samples.push({units:s,length:r,pts:e.pts,dts:e.dts,key:n}),t.length+=r,t.unitCount+=s.length)}static _getAudioPts(e,t,i){return Math.round(e+1024*t*_i/i)}static _parseAAC(e,t,i){var s,n,o=i?di.appendArray(i,e.data):e.data,r=0;for(n=0,s=o.length;n<s-1&&(255!==o[n]||240!=(240&o[n+1]));n++);if(n)throw n<s-1?hi.createError(m.GENERAL,"AAC stream not starting with ADTS header."):hi.createError(m.GENERAL,"ADTS header not found in AAC stream.");if(!t.sampleRate){let e=di._buildADIF(o,n);t.config=e.adif,t.sampleRate=e.sampleRate,t.channelCount=e.channelCount,t.codec=e.codec}for(;n+5<s;){let i=(3&o[n+3])<<11|o[n+4]<<3|(224&o[n+5])>>>5,a=1&o[n+1]?7:9;if(!(n+i<=s))break;{let s=di._getAudioPts(e.pts,r,t.sampleRate);t.samples.push({unit:o.subarray(n+a,n+i),pts:s,dts:s,frame:r}),t.length+=i-a,n+=i,r++}}i=n<s?o.subarray(n,s):null}static _getSampleRate(e){let t=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350];return e>t.length-1?null:t[e]}static _buildADIF(e,t){const i=1+((192&e[t+2])>>>6),s=(60&e[t+2])>>>2,n=(1&e[t+2])<<2|(192&e[t+3])>>>6,o=di._getSampleRate(s);if(!o)throw hi.createError(m.GENERAL,"Sample rate found in AAC stream is invalid.");let r=new Array(5===i?4:2);return r[0]=i<<3|(14&s)>>1,r[1]=(1&s)<<7|n<<3,5===i&&(r[1]|=(14&s)>>1,r[2]=(1&s)<<7|8,r[3]=0),{adif:r,sampleRate:o,channelCount:n,codec:"mp4a.40."+i}}}class ui extends ni{constructor(e,t,i){super(e,t,i),this._loaderFactory=new zt(this._utils,{maxAttemps:this._options.loadAttemps||1},zt.PROFILE_SEGMENT),this._loader=null,this._remuxer=new li}reset(){this.loadAbort(),this._remuxer.reset()}static getBuffers(e){const t=[];if(e.getTrack(null,C.TYPE_VIDEO).hasAudio())return t.push({type:"audiovideo",codecs:e.getCodecs()}),t;const i=e.getCodecs(C.TYPE_VIDEO),s=e.getCodecs(C.TYPE_AUDIO);return i&&t.push({type:"video",codecs:i}),s&&t.push({type:"audio",codecs:s}),t}getType(){return X.FMP4_LABEL}loadAbort(){if(this._loader){const e=this._loader.abort();return this._loader=null,e}return!1}loadInitSegment(e){const t=this._source.getQualityItem(e.qualityIdx).getTrack(e.trackId,e.trackType).getHeaderFile(),i=Array.isArray(t)?t[e.discontinuity]:null;return this._loader=null,i&&"string"==typeof i.url?i.data?Promise.resolve():(this._loader=this._loaderFactory.create(),this._loader.load(i.url).then(e=>{i.data=e.data})):Promise.reject({error:new Error("No init segment specified for"+` quality ${qualityIdx}.`),type:"invalid"})}processSegment(e,t,i,s){const n=this._source.getQualityItem(e.qualityIdx).getTrack(e.trackId,e.trackType),o=n.getHeaderFile()[e.discontinuity];let r=null;try{0,!i||i.discontinuity!==e.discontinuity||"undefined"!==i.trackId&&i.trackId!==e.trackId?this._remuxer.reset():"undefined"!==i.qualityIdx&&i.qualityIdx!==e.qualityIdx&&this._remuxer.resetHeader(),r=this._remuxer.remux(new Uint8Array(o.data),new Uint8Array(t),e.start,e.duration,n.getDuration(),s)}catch(t){return this._handleSegmentLoadFailed(e),void this._handleError(t)}if(e.realStart=r.realStart,e.realDuration=r.realDuration,e.initDts=r.initDts,!r.isVideo&&e.useVideo||!r.isAudio&&e.useAudio&&!e.useVideo){const e=errorFactory.createError(errors.SOURCE,"Audio/Video not found in segment.");return void this._handleError(e)}const a=[];return a.push({qualityIdx:e.qualityIdx,segmentIdx:e.idx,start:e.start,end:e.start+e.duration,type:e.useAudio&&e.useVideo?"audiovideo":e.useAudio?"audio":"video",data:void 0!==r.header?di.appendArray(r.header,r.data):r.data}),a}}const ci=Math.pow(2,32)-1;class pi{static init(){var e;for(e in pi.types={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],".mp3":[],mvex:[],mvhd:[],pasp:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[]},pi.types)pi.types.hasOwnProperty(e)&&(pi.types[e]=[e.charCodeAt(0),e.charCodeAt(1),e.charCodeAt(2),e.charCodeAt(3)]);var t=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),i=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]);pi.HDLR_TYPES={video:t,audio:i};var s=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),n=new Uint8Array([0,0,0,0,0,0,0,0]);pi.STTS=pi.STSC=pi.STCO=n,pi.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),pi.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0]),pi.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]),pi.STSD=new Uint8Array([0,0,0,0,0,0,0,1]);var o=new Uint8Array([105,115,111,109]),r=new Uint8Array([97,118,99,49]),a=new Uint8Array([0,0,0,1]);pi.FTYP=pi.box(pi.types.ftyp,o,a,o,r),pi.DINF=pi.box(pi.types.dinf,pi.box(pi.types.dref,s))}static box(e){for(var t,i=Array.prototype.slice.call(arguments,1),s=8,n=i.length,o=n;n--;)s+=i[n].byteLength;for((t=new Uint8Array(s))[0]=s>>24&255,t[1]=s>>16&255,t[2]=s>>8&255,t[3]=255&s,t.set(e,4),n=0,s=8;n<o;n++)t.set(i[n],s),s+=i[n].byteLength;return t}static hdlr(e){return pi.box(pi.types.hdlr,pi.HDLR_TYPES[e])}static mdat(e){return pi.box(pi.types.mdat,e)}static mdhd(e,t){t*=e;const i=Math.floor(t/(ci+1)),s=Math.floor(t%(ci+1));return pi.box(pi.types.mdhd,new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,e>>24&255,e>>16&255,e>>8&255,255&e,i>>24,i>>16&255,i>>8&255,255&i,s>>24,s>>16&255,s>>8&255,255&s,85,196,0,0]))}static mdia(e){return pi.box(pi.types.mdia,pi.mdhd(e.timescale,e.duration),pi.hdlr(e.type),pi.minf(e))}static mfhd(e){return pi.box(pi.types.mfhd,new Uint8Array([0,0,0,0,e>>24,e>>16&255,e>>8&255,255&e]))}static minf(e){return"audio"===e.type?pi.box(pi.types.minf,pi.box(pi.types.smhd,pi.SMHD),pi.DINF,pi.stbl(e)):pi.box(pi.types.minf,pi.box(pi.types.vmhd,pi.VMHD),pi.DINF,pi.stbl(e))}static moof(e,t,i){return pi.box(pi.types.moof,pi.mfhd(e),pi.traf(i,t))}static moov(e){for(var t=e.length,i=[];t--;)i[t]=pi.trak(e[t]);return pi.box.apply(null,[pi.types.moov,pi.mvhd(e[0].timescale,e[0].duration)].concat(i).concat(pi.mvex(e)))}static mvex(e){for(var t=e.length,i=[];t--;)i[t]=pi.trex(e[t]);return pi.box.apply(null,[pi.types.mvex].concat(i))}static mvhd(e,t){t*=e;const i=Math.floor(t/(ci+1)),s=Math.floor(t%(ci+1));var n=new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,e>>24&255,e>>16&255,e>>8&255,255&e,i>>24,i>>16&255,i>>8&255,255&i,s>>24,s>>16&255,s>>8&255,255&s,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return pi.box(pi.types.mvhd,n)}static sdtp(e){var t,i,s=e.samples||[],n=new Uint8Array(4+s.length);for(i=0;i<s.length;i++)t=s[i].flags,n[i+4]=t.dependsOn<<4|t.isDependedOn<<2|t.hasRedundancy;return pi.box(pi.types.sdtp,n)}static stbl(e){return pi.box(pi.types.stbl,pi.stsd(e),pi.box(pi.types.stts,pi.STTS),pi.box(pi.types.stsc,pi.STSC),pi.box(pi.types.stsz,pi.STSZ),pi.box(pi.types.stco,pi.STCO))}static avc1(e){var t,i,s,n=[],o=[];for(t=0;t<e.sps.length;t++)s=(i=e.sps[t]).byteLength,n.push(s>>>8&255),n.push(255&s),n=n.concat(Array.prototype.slice.call(i));for(t=0;t<e.pps.length;t++)s=(i=e.pps[t]).byteLength,o.push(s>>>8&255),o.push(255&s),o=o.concat(Array.prototype.slice.call(i));var r=pi.box(pi.types.avcC,new Uint8Array([1,n[3],n[4],n[5],255,224|e.sps.length].concat(n).concat([e.pps.length]).concat(o))),a=e.width,l=e.height;return pi.box(pi.types.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,a>>8&255,255&a,l>>8&255,255&l,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),r,pi.box(pi.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])),pi.box(pi.types.pasp,new Uint8Array([0,0,0,1,0,0,0,1])))}static esds(e){var t=e.config.length;return new Uint8Array([0,0,0,0,3,23+t,0,1,0,4,15+t,64,21,0,0,0,0,0,0,0,0,0,0,0,5].concat([t]).concat(e.config).concat([6,1,2]))}static mp4a(e){var t=e.samplerate;return pi.box(pi.types.mp4a,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,e.channelCount,0,16,0,0,0,0,t>>8&255,255&t,0,0]),pi.box(pi.types.esds,pi.esds(e)))}static mp3(e){var t=e.samplerate;return pi.box(pi.types[".mp3"],new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,e.channelCount,0,16,0,0,0,0,t>>8&255,255&t,0,0]))}static stsd(e){return"audio"===e.type?e.isAAC||"mp3"!==e.codec?pi.box(pi.types.stsd,pi.STSD,pi.mp4a(e)):pi.box(pi.types.stsd,pi.STSD,pi.mp3(e)):pi.box(pi.types.stsd,pi.STSD,pi.avc1(e))}static tkhd(e){var t=e.id,i=e.duration*e.timescale,s=e.width,n=e.height,o=Math.floor(i/(ci+1)),r=Math.floor(i%(ci+1));return pi.box(pi.types.tkhd,new Uint8Array([1,0,0,7,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,t>>24&255,t>>16&255,t>>8&255,255&t,0,0,0,0,o>>24,o>>16&255,o>>8&255,255&o,r>>24,r>>16&255,r>>8&255,255&r,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,s>>8&255,255&s,0,0,n>>8&255,255&n,0,0]))}static traf(e,t){var i=pi.sdtp(e),s=e.id,n=Math.floor(t/(ci+1)),o=Math.floor(t%(ci+1));return pi.box(pi.types.traf,pi.box(pi.types.tfhd,new Uint8Array([0,0,0,0,s>>24,s>>16&255,s>>8&255,255&s])),pi.box(pi.types.tfdt,new Uint8Array([1,0,0,0,n>>24,n>>16&255,n>>8&255,255&n,o>>24,o>>16&255,o>>8&255,255&o])),pi.trun(e,i.length+16+20+8+16+8+8),i)}static trak(e){return e.duration=e.duration||4294967295,pi.box(pi.types.trak,pi.tkhd(e),pi.mdia(e))}static trex(e){var t=e.id;return pi.box(pi.types.trex,new Uint8Array([0,0,0,0,t>>24,t>>16&255,t>>8&255,255&t,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]))}static trun(e,t){var i,s,n,o,r,a,l=e.samples||[],h=l.length,_=12+16*h,d=new Uint8Array(_);for(t+=8+_,d.set([0,0,15,1,h>>>24&255,h>>>16&255,h>>>8&255,255&h,t>>>24&255,t>>>16&255,t>>>8&255,255&t],0),i=0;i<h;i++)n=(s=l[i]).duration,o=s.size,r=s.flags,a=s.cts,d.set([n>>>24&255,n>>>16&255,n>>>8&255,255&n,o>>>24&255,o>>>16&255,o>>>8&255,255&o,r.isLeading<<2|r.dependsOn,r.isDependedOn<<6|r.hasRedundancy<<4|r.paddingValue<<1|r.isNonSync,61440&r.degradPrio,15&r.degradPrio,a>>>24&255,a>>>16&255,a>>>8&255,255&a],12+16*i);return pi.box(pi.types.trun,d)}static initSegment(e){pi.types||pi.init();var t,i=pi.moov(e);return(t=new Uint8Array(pi.FTYP.byteLength+i.byteLength)).set(pi.FTYP),t.set(i,pi.FTYP.byteLength),t}}const mi=9e4,gi=22500,Ei=8589934592,Ti=25;class fi{constructor(){this.reset()}resetHeader(){this._isHeader=!1,this._audioTimescale=void 0,this._videoTimescale=void 0,this._audioSequence=0,this._videoSequence=0}reset(){this.resetHeader(),this._baseDts=void 0,this._baseDtsVideoOffset=0}_mergeObj(e,t){return Object.keys(t).forEach(i=>{e[i]=t[i]}),e}remux(e,t,i){var s={audio:{},video:{},initDts:i,realStart:null,realDuration:null};this._isHeader||(s=this._remuxHeader(e,t,i));let n=null,o=null;return t.samples.length&&(this._mergeObj(s.video,this._remuxVideo(t)),n=s.video.duration,o=s.video.start),e.samples.length&&(this._mergeObj(s.audio,this._remuxAudio(e)),(null===n||n<s.audio.duration)&&(n=s.audio.duration),(null===o||o>s.audio.start)&&(o=s.audio.start)),s.realDuration=n,s.realStart=o,s}_remuxHeader(e,t,i){var s=e.samples.length&&e.config,n=t.samples.length&&t.sps&&t.pps,o={audio:{},video:{},initDts:i};if(s){let t=function(e,i){return i?t(i,e%i):e};this._audioTimescale=e.sampleRate/t(e.sampleRate,1024),e.timescale=this._audioTimescale,o.audio={moov:pi.initSegment([e])}}if(n&&(this._videoTimescale=gi,t.timescale=this._videoTimescale,o.video={moov:pi.initSegment([t])}),(s||n)&&(this._isHeader=!0,void 0===this._baseDts)){let r=mi*(n?t.timeOffset:e.timeOffset),a=(s&&n?Math.min(t.samples[0].dts,e.samples[0].dts):s?e.samples[0].dts:t.samples[0].dts)-this._denormalizeDts(r);this._baseDts=null!==i?i:a,o.initDts=this._baseDts,this._baseDtsVideoOffset=s&&n?t.samples[0].dts-e.samples[0].dts:0}return o}_remuxVideo(e){var t,i,s,n,o=8,r=[],a=mi/this._videoTimescale;i=new Uint8Array(e.length+4*e.unitCount+8),(t=new DataView(i.buffer)).setUint32(0,i.byteLength),i.set(pi.types.mdat,4);let l=0;for(;e.samples.length;){let s=e.samples.shift(),h=0;for(;s.units.length;){let e=s.units.shift();t.setUint32(o,e.data.byteLength),o+=4,i.set(e.data,o),o+=e.data.byteLength,h+=4+e.data.byteLength}const _=e.samples.length?e.samples[0].dts:null;let d=e.samples.length?Math.round((_-s.dts+(s.dts<=_?0:Ei))/a):r.length?r[r.length-1].duration:Math.round(1/Ti*mi/a);l+=d/this._videoTimescale,void 0===n&&(n=this._getBaseDts(s.dts,e),this._baseDtsVideoOffset>0&&(n-=this._baseDtsVideoOffset,d+=this._baseDtsVideoOffset/a,this._baseDtsVideoOffset=0)),r.push({size:h,duration:d,cts:Math.round((s.pts-s.dts)/a),flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:s.key?2:1,isNonSync:s.key?0:1}})}return e.samples=r,s=pi.moof(this._videoSequence++,Math.round(n/a),e),e.samples=[],{moof:s,mdat:i,duration:Math.max(0,l+(n<0?n/mi:0)),start:n<0?0:n/mi}}_remuxAudio(e){var t,i,s,n=8,o=[],r=mi/this._audioTimescale;t=new Uint8Array(e.length+8),new DataView(t.buffer).setUint32(0,t.byteLength),t.set(pi.types.mdat,4);let a=0;for(;e.samples.length;){let i=e.samples.shift();t.set(i.unit,n),n+=i.unit.byteLength;const l=e.samples.length?e.samples[0].dts:null,h=e.samples.length?Math.round((l-i.dts+(i.dts<=l?0:Ei))/r):o.length?o[o.length-1].duration:Math.round(1024/e.sampleRate*mi/r);a+=h/this._audioTimescale,o.push({size:i.unit.byteLength,duration:h,cts:0,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:1}}),void 0===s&&(s=this._getBaseDts(i.dts,e))}return e.samples=o,i=pi.moof(this._audioSequence++,Math.round(s/r),e),e.samples=[],{moof:i,mdat:t,duration:Math.max(0,a+(s<0?s/mi:0)),start:s<0?0:s/mi}}_normalizeDts(e,t,i=0){for(;t+i>Ei;)e+=Ei,t-=Ei;return e}_denormalizeDts(e){for(;e>Ei;)e-=Ei;return e}_getBaseDts(e,t){let i=mi*t.timeOffset;return this._normalizeDts(e,i,this._baseDts)-this._baseDts}static _getSilentFrame(e){if("mp4a.40.2"===e.codec){if(1===e.channelCount)return new Uint8Array([0,200,0,128,35,128]);if(2===e.channelCount)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(3===e.channelCount)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(4===e.channelCount)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(5===e.channelCount)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(6===e.channelCount)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224])}return null}static _getAudioPts(e,t,i){return Math.round(e+1024*t*mi/i)}static _buildFakeADIF(e){if(e.indexOf("mp4a.40.2")<=-1)return null;let t=new Array(2);return t[0]=18,t[1]=16,{adif:t,sampleRate:44100,channelCount:2,codec:"mp4a.40.2"}}static getSilentAudio(e,t,i){const s=fi._buildFakeADIF(i);if(!s)return null;const n=function(e,t){return t?n(t,e%t):e},o={type:"audio",config:s.adif,codec:s.codec,sampleRate:s.sampleRate,timescale:s.sampleRate/n(s.sampleRate,1024),channelCount:s.channelCount,duration:t,timeOffset:e,id:null,samples:[],length:0},r=fi._getSilentFrame(o);if(!r)return null;const a=pi.initSegment([o]),l=mi*e,h=l+mi*t;let _=0;for(;fi._getAudioPts(l,_+1,o.sampleRate)<=h;){const e=fi._getAudioPts(l,_,o.sampleRate);o.samples.push({unit:r,pts:e,dts:e,frame:_}),o.length+=r.byteLength,_++}let d,u,c,p,m=8,g=[],E=mi/o.timescale;for(u=new Uint8Array(o.length+8),(d=new DataView(u.buffer)).setUint32(0,u.byteLength),u.set(pi.types.mdat,4);o.samples.length;){let e=o.samples.shift();u.set(e.unit,m),m+=e.unit.byteLength;const t=o.samples.length?o.samples[0].dts:null,i=o.samples.length?Math.round((t-e.dts)/E):g[g.length-1].duration;g.push({size:e.unit.byteLength,duration:i,cts:0,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:1}}),void 0===p&&(p=e.dts)}return o.samples=g,c=pi.moof(0,Math.round(p/E),o),o.samples=[],{moov:a,moof:c,mdat:u}}}let yi=new m.ErrorFactory(m.createSourceName("src/js/mediaplayer/tech/html/TransportStreamStrategy.js"));class vi extends ni{constructor(e,t,i){super(e,t,i),this._remuxer=new fi}reset(){this._remuxer.reset()}static getBuffers(e){const t=e.getCodecs(C.TYPE_VIDEO),i=e.getCodecs(C.TYPE_AUDIO),s=[];return t&&s.push({type:"video",codecs:t}),i&&s.push({type:"audio",codecs:i}),s}getType(){return X.TS_LABEL}loadAbort(){return!1}loadInitSegment(e){return Promise.resolve()}processSegment(e,t,i,s){const n=this._source.getQualityItem(e.qualityIdx).getTrack(e.trackId,e.trackType);let o=null,r=null;try{0,(o=di.demux(new Uint8Array(t))).audio.timeOffset=e.start,o.audio.duration=n.getDuration(),o.video.timeOffset=e.start,o.video.duration=n.getDuration(),!i||i.discontinuity!==e.discontinuity||"undefined"!==i.trackId&&i.trackId!==e.trackId?this._remuxer.reset():"undefined"!==i.qualityIdx&&i.qualityIdx!==e.qualityIdx&&this._remuxer.resetHeader(),r=this._remuxer.remux(o.audio,o.video,s)}catch(t){return this._handleSegmentLoadFailed(e),void this._handleError(t)}if(e.realStart=r.realStart,e.start=r.realStart,e.realDuration=r.realDuration,e.duration=r.realDuration,e.initDts=r.initDts,void 0===r.video.moof&&e.useVideo||void 0===r.audio.moof&&e.useAudio&&!e.useVideo){const e=yi.createError(m.SOURCE,"Audio/Video not found in segment.");return void this._handleError(e)}const a=[];return void 0!==r.audio.moof&&e.useAudio&&a.push({qualityIdx:e.qualityIdx,segmentIdx:e.idx,start:e.start,end:e.start+e.duration,type:"audio",data:void 0!==r.audio.moov?di.appendArray(r.audio.moov,r.audio.moof,r.audio.mdat):di.appendArray(r.audio.moof,r.audio.mdat)}),void 0!==r.video.moof&&e.useVideo&&a.push({qualityIdx:e.qualityIdx,segmentIdx:e.idx,start:e.start,end:e.start+e.duration,type:"video",data:void 0!==r.video.moov?di.appendArray(r.video.moov,r.video.moof,r.video.mdat):di.appendArray(r.video.moof,r.video.mdat)}),a}static getSilentAudio(e,t,i,s){const n=fi.getSilentAudio(e,t,s);return n?{qualityIdx:null,segmentIdx:null,start:e,end:e+t,type:i,data:di.appendArray(n.moov,n.moof,n.mdat)}:null}}let Ai=new m.ErrorFactory(m.createSourceName("src/js/mediaplayer/tech/html/VideoElementAdaptive.js")),Si={init(){this._isActive=!0,this._loader=null,this._loaderFactory=new zt(this._utils,{maxAttemps:this._options.loadAttemps||1},zt.PROFILE_SEGMENT),this._mediaSource=null,this._toAdd=[],this._lastAppended=null,this._sourceBuffers={},this._sourceBuffersToAdd=[],this._timer=null,this._timerProgress=null,this._isChangingQuality=!1,this._changingTrackType=null,this._qualityIdxMax=null,this._appendErrorCount=0,this._isSourceReadyPending=!1,this._lastDuration=null,this._wasLoaded=!1,this._sourceOpenHandler=null,this._adaptiveStrategy={},this._initDts={},this._lastSegment={},this._adaptiveStrategyEventsMap=new Map([[ni.EVENT_ERROR,this.handleError],[ni.EVENT_SEGMENT_LOAD_FAILED,this._handleSegmentLoadFailed]]),this.bindAll(this._adaptiveStrategyEventsMap),this._eventsMap=new Map([["seeking",this.__eventAdaptive_seeking],["timeupdate",this.__eventAdaptive_timeupdate]]),this.bindAll(this._eventsMap),this.addEventListeners(this._element,this._eventsMap),this.__event_sourceUpdateEnd=this.__event_sourceUpdateEnd.bind(this),this.__event_sourceError=this.__event_sourceError.bind(this)},resetAdaptive(){this._isActive=!1,this.loadAbort(),this._clearRemuxTimer(),this._clearProgressTimer(),this._resetSourceBuffer(),this._resetSourceOpenHandler(),this._resetStrategy(),this._resetSegmentsData(),this.removeEventListeners(this._element,this._eventsMap),this._element.removeAttribute("src"),this.emit(b.EVENT_DESTROY),delete this._initDts,delete this._lastSegment,delete this._qualityIdxMax,delete this._isChangingQuality,delete this._changingTrackType,delete this._timer,delete this._timerProgress,delete this._loader,delete this._loaderFactory,delete this._mediaSource,delete this._adaptiveStrategy,delete this._adaptiveStrategyEventsMap,delete this._toAdd,delete this._lastAppended,delete this._sourceBuffers,delete this._sourceBuffersToAdd,delete this._appendErrorCount,delete this._isSourceReadyPending,delete this._lastDuration,delete this._wasLoaded,delete this._sourceOpenHandler},getDuration(){return this._qualityItem?this._qualityItem.getDuration(this._audioTrackId,this._videoTrackId,this.isLiveStreaming()):null},getBestUsedQuality(){return this._qualityIdxMax},getBuffered(e,t=I.BUFFER_HOLE_TOLERANCE){const i=this.getBufferedAudio(e,t),s=this.getBufferedVideo(e,t);return i&&s?{start:s.start>=i.start?s.start:i.start,end:s.length<=i.length?s.end:i.end,length:s.length<=i.length?s.length:i.length}:s||(i||{start:e,end:e,length:0})},getBufferedAudio(e,t=I.BUFFER_HOLE_TOLERANCE){return void 0!==this._sourceBuffers.audio?this._getBuffered(this._sourceBuffers.audio.buffer.buffered,e,t):void 0!==this._sourceBuffers.audiovideo?this._getBuffered(this._sourceBuffers.audiovideo.buffer.buffered,e,t):null},getBufferedVideo(e,t=I.BUFFER_HOLE_TOLERANCE){return void 0!==this._sourceBuffers.video?this._getBuffered(this._sourceBuffers.video.buffer.buffered,e,t):void 0!==this._sourceBuffers.audiovideo?this._getBuffered(this._sourceBuffers.audiovideo.buffer.buffered,e,t):null},setSource(e,t=null){if(this.resetSourceAdaptive(),this._source=e,this._isSourceReady=!1,this._isSourceReadyPending=!0,this.setSourceSettings(t),t&&"function"==typeof t.forcedQualityFunc){0;try{const i=t.forcedQualityFunc(e);(null===i||e.getQualityItem(i))&&(this._qualityIdx=i)}catch(e){0}}else t&&void 0!==t.forcedQualityIdx&&(null===t.forcedQualityIdx||this._source.getQualityItem(t.forcedQualityIdx))?this._qualityIdx=t.forcedQualityIdx:t&&void 0!==t.storedQualityIdx&&null!==t.storedQualityIdx&&this._source.getQualityItem(t.storedQualityIdx)&&(this._qualityIdx=t.storedQualityIdx);if(t&&void 0!==t.storedAudioTrack&&null!==t.storedAudioTrack){let e=this._source.getTrackIdByName(t.storedAudioTrack,C.TYPE_AUDIO);if(null!==this._qualityIdx&&null!==e){this._source.getQualityItem(this._qualityIdx).getTrack(e,C.TYPE_AUDIO)||(e=null)}null!==e&&(this._audioTrackId=e)}if(t&&void 0!==t.storedVideoTrack&&null!==t.storedVideoTrack){let e=this._source.getTrackIdByName(t.storedVideoTrack,C.TYPE_VIDEO);if(null!==this._qualityIdx&&null!==e){this._source.getQualityItem(this._qualityIdx).getTrack(e,C.TYPE_VIDEO)||(e=null)}null!==e&&(this._videoTrackId=e)}if(null!==this._qualityIdx||this._source.getQualityItemWithSelectedTracks(this._audioTrackId,this._videoTrackId)||(this._audioTrackId=void 0,this._videoTrackId=void 0),t&&void 0!==t.bandwidth&&!this.getStatsHistory().length){const e=parseInt(t.bandwidth,10);!isNaN(e)&&e>0&&this.addStats({bandwidth:e})}t&&void 0!==t.preloadedStats&&(this._preloadedStats=t.preloadedStats),this._sourceOpenHandler=(()=>{this._resetSourceOpenHandler(),this.emit(b.EVENT_SOURCE_SET,{source:e})}),this._mediaSource=new MediaSource,this._mediaSource.addEventListener("sourceopen",this._sourceOpenHandler),this._timer=setInterval(this._onTimer.bind(this),100),this._eventTimer=setInterval(this._onEventTimer.bind(this),100);const i=this._element.paused;this._element.src=URL.createObjectURL(this._mediaSource),!i&&this._element.paused&&this._element.play()},resetSourceAdaptive(){this.loadAbort(),this._clearRemuxTimer(),this._clearProgressTimer(),this._resetSourceBuffer(),this._resetSourceOpenHandler(),this._resetStrategy(),this._resetSegmentsData(),this._source=null,this._wasLoaded=!1,this._toAdd=[],this._lastAppended=null,this._qualityIdxMax=null,this._lastDuration=null,this._isChangingQuality=!1,this._changingTrackType=null,this._appendErrorCount=0,this._isSourceReadyPending=!1,this._lastSegment={},this.emit(b.EVENT_SOURCE_CANCEL)},restart(e=null){this._softReset(e)},handleTrackUpdate(){this._updateTrackData()},_setQualityItem(e,t,i){const s=this._audioTrackId!==t,n=this._videoTrackId!==i,o=this._qualityItem!==e;this._audioTrackId=t,this._videoTrackId=i,this._qualityItem=e,s&&this.emit(b.EVENT_TRACK_SET,{trackId:this._audioTrackId,trackType:C.TYPE_AUDIO,wasQualityChanged:!1,isUserAction:!1}),n&&this.emit(b.EVENT_TRACK_SET,{trackId:this._videoTrackId,trackType:C.TYPE_VIDEO,wasQualityChanged:!1,isUserAction:!1}),o&&this.emit(b.EVENT_QUALITY_CHANGE,{qualityIdx:this._source.getQualityIdx(this._qualityItem)}),this._isSourceReadyPending&&(this._isSourceReady=!0,this._isSourceReadyPending=!1,this.emit(b.EVENT_SOURCE_READY,{source:this._source}))},_updateTrackData(){const e=this._qualityItem.isLive(this._audioTrackId,this._videoTrackId);if(e&&(this._wasLive=!0),this._qualityItem.isEvent(this._audioTrackId,this._videoTrackId)&&(this._wasEvent=!0),this._isLiveStreaming!==e){let t=this._isLiveStreaming&&!e;this._isLiveStreaming=e,this.emit(b.EVENT_LIVE_STREAMING_CHANGE,{liveStreaming:e}),t&&this._evaluateEndOfStream()}let t=this._qualityItem.getDuration(this._audioTrackId,this._videoTrackId,this._isLiveStreaming);if(null===this._lastDuration||this._lastDuration!=t&&(!isNaN(this._lastDuration)||!isNaN(t))){this._lastDuration=t,this.isPaused()&&this._setLivePlaying(!1);const e=this._qualityItem.getDuration(this._audioTrackId,this._videoTrackId);if(!this._isBufferUpdating()&&e>this._mediaSource.duration)try{this._mediaSource.duration=e}catch(e){}this.emit(b.EVENT_DURATION_CHANGE,{duration:t,realDuration:e})}},setQuality(e){if(null===e||this._source&&this._source.getQualityItem(e))this._qualityIdx!==e&&(this.loadAbort(),this._toAdd=[],this._lastAppended=null,this._qualityIdxMax=null,this._qualityIdx=e,this._isChangingQuality=!0,null!==e&&this._adjustStoredTracksForQuality(e),this._flushBuffers()||(this._isChangingQuality=!1,this.emit(b.EVENT_QUALITY_SET,{qualityIdx:this._qualityIdx})));else{const t=Ai.createError(m.SETTING,`Quality "${e}" doesn't exist.`);this.handleError(t)}},setTrack(e,t){if(t===C.TYPE_VIDEO){if(this._videoTrackId===e)return;this._resetSegmentsData(C.TYPE_AUDIO),void 0!==this._adaptiveStrategy[C.TYPE_AUDIO]&&this._adaptiveStrategy[C.TYPE_AUDIO].reset(),this._videoTrackId=e}else{if(t!==C.TYPE_AUDIO){const e=Ai.createError(m.SETTING,"Only audio/video tracks are supported.");return void this.handleError(e)}if(this._audioTrackId===e)return;this._audioTrackId=e}this.loadAbort(),this._toAdd=[],this._lastAppended=null,this._changingTrackType=t;let i=t===C.TYPE_VIDEO;if(null!==this._qualityIdx){this._source.getQualityItem(this._qualityIdx).getTrack(e,t)||(i=!0,this._qualityIdxMax=null,this._qualityIdx=null,this._isChangingQuality=!0)}if(null!==this._qualityIdx||this._source.getQualityItemWithSelectedTracks(this._audioTrackId,this._videoTrackId)||(this._qualityItem=null,t===C.TYPE_VIDEO?this._audioTrackId=void 0:this._videoTrackId=void 0,i=!0),!this._flushBuffers(i?null:t)){this._changingTrackType=null;const i=this._isChangingQuality;this._isChangingQuality&&(this._isChangingQuality=!1,this.emit(b.EVENT_QUALITY_SET,{qualityIdx:this._qualityIdx})),this.emit(b.EVENT_TRACK_SET,{trackId:e,trackType:t,trackName:this._source.getTrackNameById(e,t),wasQualityChanged:i,isUserAction:!0})}},seek(e,t=!0){this._isSeekingInBuffer=!1,this.emit(b.EVENT_SEEKSTART,{time:e}),this._element.currentTime=e},loadSegment(e,t,i,s){this._setQualityItem(t,i,s),this._updateTrackData(),this._wasLoading||(this._wasLoading=!0,this.emit(b.EVENT_LOAD_START)),(null===this._qualityIdxMax&&this._element.videoWidth&&this._element.videoHeight||null!==this._qualityIdxMax&&this._qualityIdxMax<e.qualityIdx)&&(this._qualityIdxMax=e.qualityIdx),this._clearProgressTimer();const n=e.trackType,o=this._qualityItem.getTrack(e.trackId,e.trackType).getSrcType(),r=this._source.hasAnyVideoTrackAvailable();let a=null;if(n!==C.TYPE_VIDEO&&r||(o===X.FMP4_LABEL?a=ui.getBuffers(this._qualityItem):o===X.TS_LABEL&&(a=vi.getBuffers(this._qualityItem))),Object.keys(this._sourceBuffers).length){const e=[];for(let t in this._sourceBuffers)e.push({type:t,codecs:this._sourceBuffers[t].codecs});if(a&&JSON.stringify(a)!=JSON.stringify(e))return void this._softReset()}else{if(!a||this._sourceBuffersToAdd.length){const e=Ai.createError(m.SOURCE,"Could not determine codecs for source buffers.");return void this.handleError(e)}this._sourceBuffersToAdd=a}if(void 0!==this._adaptiveStrategy[n]&&this._adaptiveStrategy[n].getType()!==o&&this._resetStrategy(n),void 0===this._adaptiveStrategy[n]){if(o!==X.FMP4_LABEL&&o!==X.TS_LABEL){const e=Ai.createError(m.SOURCE,"No usable adaptive strategy found.");return void this.handleError(e)}this._adaptiveStrategy[n]=o===X.FMP4_LABEL?new ui(this._source,this._utils,this._options):new vi(this._source,this._utils,this._options),this.addListeners(this._adaptiveStrategy[n],this._adaptiveStrategyEventsMap)}this._adaptiveStrategy[n].loadInitSegment(e).then(()=>{this._timerProgress=setInterval(this._onTimerProgress.bind(this,e),500),this._loader=this._loaderFactory.create(),this._loader.load(e.url).then(t=>{this._isActive&&this._handleSegmentLoaded(e,t)},t=>{this._segmentLoadRejected(e,t)})},t=>{this._segmentLoadRejected(e,t)}).catch(e=>{this.handleError(e)})},addSilentAudio(e,t,i){let s=null;if(void 0!==this._sourceBuffers.audio)s="audio";else{if(void 0===this._sourceBuffers.audiovideo)return!1;s="audiovideo"}const n=vi.getSilentAudio(e,t,s,this._sourceBuffers[s].codecs);return!!n&&(i.useAudio&&(this._lastSegment[C.TYPE_AUDIO]=null),i.useVideo&&(this._lastSegment[C.TYPE_VIDEO]=null),this._toAdd.push(n),this._toAdd.push({type:"stats",segment:null}),!0)},isReadyToAddAudio(e){const t=e.trackType,i=e.discontinuity,s=(t===C.TYPE_VIDEO?e.trackId:this._videoTrackId)||"",n=this._source.hasAnyVideoTrackAvailable();return t!==C.TYPE_AUDIO||!n||void 0!==this._initDts[s+"_"+i]},forceEndOfStream(){this._mediaSource&&"open"===this._mediaSource.readyState&&(this._isSeekingInBuffer=!0,this._mediaSource.endOfStream())},_processSegment(e,t){const i=e.trackType,s=e.discontinuity,n=(i===C.TYPE_VIDEO?e.trackId:this._videoTrackId)||"",o=this._source.hasAnyVideoTrackAvailable();if(i===C.TYPE_AUDIO&&void 0===this._initDts[n+"_"+s]&&o){const e=Ai.createError(m.SOURCE,"Video segment not downloaded before audio segment.");return void this.handleError(e)}const r=void 0===this._initDts[n+"_"+s]?null:this._initDts[n+"_"+s],a=this._adaptiveStrategy[i].processSegment(e,t.data,this._lastSegment[i],r);if(a)if(i===C.TYPE_VIDEO&&void 0===this._initDts[n+"_"+s]&&(this._initDts[n+"_"+s]=e.initDts),a.forEach(e=>{this._toAdd.push(e)}),this._lastSegment[i]=e,this._qualityItem)this._qualityItem.getTrack(e.trackId,e.trackType).updateSegmentData(e.idx,e.realStart,e.realDuration),this._toAdd.push({type:"stats",segment:e,data:Object.assign({qualityIdx:e.qualityIdx,adaptiveSource:this._source.getAdaptiveSrc()},t.stats,{segmentDuration:e.duration})});else{const e=Ai.createError(m.SOURCE,"Unable to process segment.");this.handleError(e)}else{const e=Ai.createError(m.SOURCE,"Processing segment failed.");this.handleError(e)}},_segmentLoadRejected(e,t){this._isActive&&("abort"===t.type?this._handleSegmentLoadAborted(e):this._handleSegmentLoadFailed(e,t))},loadAbort(){this._loader&&(this._loader.abort()&&(this._clearProgressTimer(),this.emit(b.EVENT_LOADING_ABORTED)),this._loader=null);let e=!1;for(let t in this._adaptiveStrategy)this._adaptiveStrategy[t].loadAbort()&&(e=!0);e&&this.emit(b.EVENT_LOADING_ABORTED)},_resetSourceBuffer(){for(let e in this._sourceBuffers){this._sourceBuffers[e].buffer.removeEventListener("error",this._sourceBuffers[e].eventListeners.error),this._sourceBuffers[e].buffer.removeEventListener("updateend",this._sourceBuffers[e].eventListeners.updateend);try{this._mediaSource.removeSourceBuffer(this._sourceBuffers[e].buffer)}catch(e){0}}this._sourceBuffersToAdd=[],this._sourceBuffers={}},_resetStrategy(e=null){for(let t in this._adaptiveStrategy)null!==e&&e!==t||(this.removeListeners(this._adaptiveStrategy[t],this._adaptiveStrategyEventsMap),this._adaptiveStrategy[t].reset(),delete this._adaptiveStrategy[t])},_resetSegmentsData(e=null){e&&e!==C.TYPE_VIDEO||(this._initDts={}),this._source&&this._source.resetSegmentsData(e)},_resetSourceOpenHandler(){this._sourceOpenHandler&&(this._mediaSource.removeEventListener("sourceopen",this._sourceOpenHandler),this._sourceOpenHandler=null)},_softReset(e=null){const t=this.isLive()&&!this.isEvent()?0:this._element.currentTime+(null!==e&&this._element.currentTime+e<this.getDuration()?e:0),i=this.isPlaying();this.loadAbort(),this._resetSourceBuffer(),this._resetSourceOpenHandler(),this._resetStrategy(),this._resetSegmentsData(),null!==this._qualityIdx&&this._adjustStoredTracksForQuality(this._qualityIdx),this._toAdd=[],this._lastAppended=null,this._qualityIdxMax=null,this._isChangingQuality=!1,this._changingTrackType=null,this._appendErrorCount=0,this.emit(b.EVENT_SOURCE_CANCEL),this._sourceOpenHandler=(()=>{this._resetSourceOpenHandler(),this._isSeekingInBuffer=!0,this._element.currentTime=t,i&&this._element.play(),this.emit(b.EVENT_BUFFER_READY)}),this._mediaSource=new MediaSource,this._mediaSource.addEventListener("sourceopen",this._sourceOpenHandler),this._element.src=URL.createObjectURL(this._mediaSource)},_adjustStoredTracksForQuality(e){const t=this._source.getQualityItem(e);if(void 0!==this._audioTrackId){t.getTrack(this._audioTrackId,C.TYPE_AUDIO)&&null!=this._audioTrackId||(this._audioTrackId=void 0)}if(void 0!==this._videoTrackId){t.getTrack(this._videoTrackId,C.TYPE_VIDEO)&&null!=this._videoTrackId||(this._videoTrackId=void 0)}},_clearProgressTimer(){this._timerProgress&&(clearInterval(this._timerProgress),this._timerProgress=null)},_clearRemuxTimer(){this._timer&&(clearInterval(this._timer),this._timer=null)},_evaluateEndOfStream(){this._mediaSource&&"open"===this._mediaSource.readyState&&this._qualityItem&&!this._isBufferUpdating()&&!this.isLiveStreaming()&&this.getBuffered(this.getCurrentTime()).end>=this._qualityItem.getDuration(this._audioTrackId,this._videoTrackId)&&this._mediaSource.endOfStream()},_flushBuffers(e=null){let t=0;for(let i in this._sourceBuffers)if(null===e||e===i)if("open"!==this._mediaSource.readyState||this._env.isMac()&&this._env.isSafari()||this._sourceBuffers[i].buffer.abort(),this._sourceBuffers[i].flushPending)t++;else if(this._sourceBuffers[i].buffer.buffered.length){this._sourceBuffers[i].flushPending=!0,t++;try{const e=this._env.isEdgeBrowser()?1/0:Number.MAX_VALUE;this._sourceBuffers[i].buffer.remove(0,e)}catch(e){const t=Ai.createError(m.GENERAL,"Flushing buffer failed.");t.code=e.code,this.handleError(t)}}return t},_isBufferUpdating(){let e=!1;for(let t in this._sourceBuffers)(this._sourceBuffers[t].buffer.updating||this._sourceBuffers[t].flushPending)&&(e=!0);return this._toAdd.length>1||this._sourceBuffersToAdd.length||e},_handleSegmentLoaded(e,t){this._clearProgressTimer(),this._processSegment(e,t)},_handleSegmentLoadFailed(e,t=null){this._clearProgressTimer(),this.emit(b.EVENT_LOADING_FAILED,e)},_handleSegmentLoadAborted(e){0},_onTimer(){if("open"===this._mediaSource.readyState&&this._sourceBuffersToAdd.length&&this._qualityItem)for(;this._sourceBuffersToAdd.length;){let e=this._sourceBuffersToAdd.shift();0;const t={codecs:e.codecs,buffer:null,eventListeners:{},flushPending:!1};t.eventListeners.error=this.__event_sourceError.bind(this,e.type),t.eventListeners.updateend=this.__event_sourceUpdateEnd.bind(this,e.type);const i=this._mediaSource.addSourceBuffer("video/mp4;codecs="+e.codecs);i.addEventListener("error",t.eventListeners.error),i.addEventListener("updateend",t.eventListeners.updateend),t.buffer=i,this._sourceBuffers[e.type]=t}let e=!1;for(let t in this._sourceBuffers)(this._sourceBuffers[t].buffer.updating||this._sourceBuffers[t].flushPending)&&(e=!0);if(this._toAdd.length&&!e&&!this._sourceBuffersToAdd.length){let e=this._toAdd.shift();if("stats"!==e.type)try{0,this._sourceBuffers[e.type].buffer.appendBuffer(e.data),this._appendErrorCount=0,this._lastAppended=e}catch(t){if(t.code!==DOMException.QUOTA_EXCEEDED_ERR)if(++this._appendErrorCount<=(this._options.appendAttemps||1))this._toAdd.unshift(e);else{this._toAdd=[],this._lastAppended=null;const i=Ai.createError(m.GENERAL,`Appending "${e.qualityIdx}"`+` x "${e.segmentIdx}" failed. Cannot`+" append data to the source buffer.");i.code=t.code,this.handleError(i)}else e.start<=this._element.currentTime&&e.end>=this._element.currentTime&&(this._flushBuffers(),this._toAdd.unshift(e),"video"===e.type&&this._lastAppended&&"audio"===this._lastAppended.type&&this._lastAppended.start<=this._element.currentTime&&this._lastAppended.end>=this._element.currentTime&&this._toAdd.unshift(this._lastAppended),this._lastAppended=null)}else{if(!e.segment)return void this.emit(b.EVENT_LOADED_SILENT_AUDIO);if(this.addStats(e.data),this._wasLoaded||(this._wasLoaded=!0,this.isLiveStreaming()&&this._setLivePlaying(null===this.getStartTime()||this.getStartTime()>=this._qualityItem.getDuration(this._audioTrackId,this._videoTrackId,!0))),this._isSeekWaitingToLoad){this._clearSeekErrorTimer();let e=this.getBuffered(this._element.currentTime,0);!this.isLive()&&e.length>=1&&this._setSeekErrorTimer()}this._isBufferEmpty&&this._skipBufferHole(),this.emit(b.EVENT_LOADED_SEGMENT,Object.assign({bandwidth:e.data.bandwidth},e.segment))}}},_onTimerProgress(e){if(this._loader){let t=this._loader.getProgressInfo();null!==t&&this.emit(b.EVENT_LOADING_PROGRESS,{stats:t,segment:e})}},__eventAdaptive_timeupdate(e){this._isSourceReady&&!this._isChangingQuality&&!this._changingTrackType&&this._mediaSource&&"open"===this._mediaSource.readyState&&this.emit(b.EVENT_BUFFER_READY),this._evaluateEndOfStream()},__eventAdaptive_seeking(e){const t=this._qualityItem?this._qualityItem.getDuration(this._audioTrackId,this._videoTrackId):null;!this.isLiveStreaming()&&t&&this._element.currentTime>=t&&(this._element.currentTime=t-Si.MIN_DURATION_DISTANCE),this._isSeekingInBuffer||!this.loadAbort()&&this._toAdd.length||this.emit(b.EVENT_BUFFER_READY)},__event_sourceUpdateEnd(e,t){if(this._sourceBuffers[e].flushPending&&(this._sourceBuffers[e].flushPending=!1),!this._isBufferUpdating()){const e=this._isChangingQuality;if(this._isChangingQuality&&(this._isChangingQuality=!1,this.emit(b.EVENT_QUALITY_SET,{qualityIdx:this._qualityIdx})),this._changingTrackType){const t=this._changingTrackType,i=t===C.TYPE_AUDIO?this._audioTrackId:this._videoTrackId;this._changingTrackType=null,this.emit(b.EVENT_TRACK_SET,{trackId:i,trackType:t,trackName:this._source.getTrackNameById(i,t),wasQualityChanged:e,isUserAction:!0})}this._evaluateEndOfStream()}},__event_sourceError(e,t){0},MIN_DURATION_DISTANCE:.01};const bi=10,Ci=20;class Pi{constructor(e){this._audioCtx=e,this._audioNode=e.createGain(),this._gainData=[],this._sampleRate=null}getNode(){return this._audioNode}update(e){if(!this._gainData.length||!this._sampleRate)return;const t=Math.round(e/this._sampleRate);t>this._gainData.length-1||isNaN(parseInt(this._gainData[t],10))||this._audioNode.gain.linearRampToValueAtTime(Math.pow(bi,this._gainData[t]/Ci),this._audioCtx.currentTime)}setData(e=[],t=null){Array.isArray(e)&&(this._gainData=e,this._sampleRate=t)}resetData(){this._gainData=[],this._sampleRate=null}}class ki{constructor(e){this._elm=e,this._audioCtx=null,this._audioSrc=null,this._audioNodes=null,this._checkTimer=null,this._lastTime=null}create(){this._audioCtx||(this._audioCtx=this._getAudioContext(),this._audioCtx&&(this._audioCtx.suspend().catch(e=>{console.warn(e)}),this._audioSrc=this._audioCtx.createMediaElementSource(this._elm.getElement()),this._audioNodes=new Map([[ki.NORMALIZE,new Pi(this._audioCtx)]]),this._connectNodes()))}resume(){this._audioCtx&&(this._audioCtx.resume().catch(e=>{console.warn(e)}),this._createTimer())}suspend(){this._audioCtx&&(this._audioCtx.suspend().catch(e=>{console.warn(e)}),this._clearTimer())}close(){this._audioCtx&&(this._audioCtx.close(),this._audioCtx=null,this._audioSrc=null,this._audioNodes=null,this._clearTimer())}setData(e,t=null,i=null){this._audioCtx&&this._audioNodes&&this._audioNodes.has(e)&&this._audioNodes.get(e).setData(t,i)}resetData(e){this._audioCtx&&this._audioNodes&&this._audioNodes.has(e)&&this._audioNodes.get(e).resetData()}_getAudioContext(){return"AudioContext"in window?new window.AudioContext:"webkitAudioContext"in window?new window.webkitAudioContext:null}_checkTime(){const e=parseFloat(this._elm.getCurrentTime().toFixed(1));null!==this._lastTime&&this._lastTime===e||(this._audioNodes.get(ki.NORMALIZE).update(e),this._lastTime=e),this._checkTimer=requestAnimationFrame(()=>this._checkTime())}_createTimer(){this._clearTimer(),this._checkTimer||(this._checkTimer=requestAnimationFrame(()=>this._checkTime()))}_clearTimer(){this._checkTimer&&(cancelAnimationFrame(this._checkTimer),this._checkTimer=null)}_connectNodes(){let e=null;this._audioNodes.forEach(t=>{const i=t.getNode();e?e.connect(i):this._audioSrc.connect(i),e=i}),e.connect(this._audioCtx.destination)}}ki.NORMALIZE="normalize";const Ii=["sdn.szn.cz","sdn.cz","novinky.cz","sport.cz","super.cz"],wi="//api.sdn.szn.cz/api/loudness-diff";let Ni=new m.ErrorFactory(m.createSourceName("src/js/mediaplayer/tech/html/NormalizationManager.js"));class Li extends S{constructor(e,t){super(),this._utils=t,this._element=e,this._webAudio=new ki(this._element),this._loaderPutFactory=new zt(this._utils,{maxAttemps:2,timeout:1500},zt.PROFILE_NORMALIZATION_PUT),this._loaderGetFactory=new zt(this._utils,{maxAttemps:2,timeout:1500},zt.PROFILE_NORMALIZATION_GET),this._eventsMap=new Map([[b.EVENT_SOURCE_READY,this._handleSourceReady],[b.EVENT_SOURCE_SET,this._handleSourceSet],[b.EVENT_PLAY,this._handlePlay],[b.EVENT_PAUSED,this._handlePaused],[b.EVENT_SOURCE_CANCEL,this._handleSourceCancel],[b.EVENT_DESTROY,this._handleSourceCancel]]),this.bindAll(this._eventsMap),this.addListeners(this._element,this._eventsMap)}_putData(e){if(!e)return;const t=document.createElement("a");t.href=e,t.hostname&&!Ii.some(e=>{return new RegExp(e+"$").test(t.hostname)})&&this._makePutRequest(e)}_makePutRequest(e){return this._loaderPutFactory.create().load(wi,JSON.stringify({url:e})).then(e=>{try{const t=JSON.parse(e.data);if(t&&t.msg&&t.msg.url);else{const e="An error occurred while parsing normalization PUT result.",t=Ni.createError(m.NORMALIZATION,e);this.emit(Li.EVENT_ERROR,t)}}catch(e){this.emit(Li.EVENT_ERROR,e)}},({type:e,url:t,status:i=0})=>{if("abort"!==e){const e="An error occurred during normalization PUT.",s=Ni.createError(m.NORMALIZATION,e);s.src=t,s.code=i,this.emit(Li.EVENT_ERROR,s)}})}_makeGetRequest(e){return this._loaderGetFactory.create().load(e).then(e=>{try{const t=JSON.parse(e.data);t&&t.loudness_list&&t.loudness_sampling_rate&&(this._webAudio.create(),this._webAudio.setData(ki.NORMALIZE,t.loudness_list,t.loudness_sampling_rate),this._element.isPlaying()&&this._webAudio.resume())}catch(e){this.emit(Li.EVENT_ERROR,e)}},({type:e,url:t,status:i=0})=>{if("abort"!==e){const e="An error occurred during normalization GET.",s=Ni.createError(m.NORMALIZATION,e);s.src=t,s.code=i,this.emit(Li.EVENT_ERROR,s)}})}_handleSourceSet(){this._element.getResolvedSource().isAdaptive()&&this._putData(this._element.getCurrentAdaptiveSrc())}_handleSourceReady(){this._element.getResolvedSource().isAdaptive()||this._putData(this._element.getCurrentSrc())}_handlePlay(){this._webAudio.resume()}_handlePaused(){this._webAudio.suspend()}_handleSourceCancel(){this._webAudio.resetData(ki.NORMALIZE),this._webAudio.close()}}Li.EVENT_ERROR="error";let xi=new m.ErrorFactory(m.createSourceName("src/js/mediaplayer/tech/Html.js")),Mi=null;class Di extends X{static getTechName(){return"html"}static _createEmptyVideo(){Mi||(Mi=window.document.createElement("video"))}static isSupported(){return Di._createEmptyVideo(),!!Mi.canPlayType}static canPlayType(e){return Di.canPlayTypeNative(e)||Di.canPlayTypeNonNative(e)}static canPlayTypeNative(e){return Di._createEmptyVideo(),Mi.canPlayType(e)&&(e!==X.TYPE_HLS||p.isMac()||p.isIPhone()||p.isIPad()||p.isIPod()||p.isSamsungBrowser())}static canPlayTypeNonNative(e){return window.MediaSource&&(e===X.TYPE_HLS||e===X.TYPE_DASH)&&!p.isAndroid4()&&!p.isIE11()}static canPlaySource(e){Di._createEmptyVideo();let t=(e.type===X.TYPE_TS?X.TYPE_MP4:e.type)+(e.codecs?';codecs="'+X.parseCodecs(e.codecs).fullName+'"':"");return Mi.canPlayType(t)}constructor(e,t,i,s,n){super(e,t,i,n),this._qualityListService=s,this._element=new I(e,t,this._options),this._elementAdaptive=Si,this._textTrackIdx=null,this._ttProcessor=new si(this._element),this._normalizationManager=new Li(this._element,t),this._nsFactory=new Xt(this._env,this._utils,this._qualityListService,this._options),this._nativeCtrl=null,this._asFactory=new ii(this._env,this._utils,this._qualityListService,this._options),this._adaptiveCtrl=null,this._eventsMap=new Map([[b.EVENT_READY,this.dispatchReady],[b.EVENT_SOURCE_READY,this.dispatchSourceReady],[b.EVENT_SOURCE_SET,this.dispatchSourceSet],[b.EVENT_QUALITY_SET,this.dispatchQualitySet],[b.EVENT_QUALITY_CHANGE,this.dispatchQualityChange],[b.EVENT_TRACK_SET,this.dispatchTrackSet],[b.EVENT_DURATION_CHANGE,this.dispatchDurationChange],[b.EVENT_VOLUME_CHANGE,this.dispatchVolumeChange],[b.EVENT_LIVE_PLAYING_CHANGE,this.dispatchLivePlayingChange],[b.EVENT_LIVE_STREAMING_CHANGE,this.dispatchLiveStreamingChange],[b.EVENT_LOAD_START,this.dispatchLoadStart],[b.EVENT_LOADED_META,this.dispatchLoadedMeta],[b.EVENT_LOADED_DATA,this.dispatchLoadedData],[b.EVENT_LOADED_SEGMENT,this.dispatchLoadedSegment],[b.EVENT_PROGRESS,this.dispatchProgress],[b.EVENT_MEDIA_ABORT,this.dispatchAbort],[b.EVENT_PLAY,this.dispatchPlay],[b.EVENT_PLAY_DENIED,this.dispatchPlayDenied],[b.EVENT_PLAYING,this.dispatchPlaying],[b.EVENT_PAUSED,this.dispatchPaused],[b.EVENT_SEEKSTART,this.dispatchSeekstart],[b.EVENT_SEEKING,this.dispatchSeeking],[b.EVENT_SEEKED,this.dispatchSeeked],[b.EVENT_TIMEUPDATE,this.dispatchTimeUpdate],[b.EVENT_ENDED,this.dispatchEnded],[b.EVENT_BUFFER_EMPTY,this.dispatchBufferEmpty],[b.EVENT_CAN_PLAY,this.dispatchCanPlay],[b.EVENT_ERROR,this._handleErrorEvent]]),this._ttEventsMap=new Map([[si.EVENT_CUE_CHANGE,this.dispatchCueChange]]),this._normEventsMap=new Map([[Li.EVENT_ERROR,this._handleWarningEvent]]),this.bindAll(this._eventsMap),this.bindAll(this._ttEventsMap),this.bindAll(this._normEventsMap),this.addListeners(this._element,this._eventsMap),this.addListeners(this._ttProcessor,this._ttEventsMap),this.addListeners(this._normalizationManager,this._normEventsMap)}getElement(){return this._element.getElement()}getResolvedSource(){return this._element.getResolvedSource()}getCurrentSrc(){return this._element.getCurrentSrc()}getCurrentAdaptiveSrc(){return this._element.getCurrentAdaptiveSrc()}getCurrentQualityItem(){return this._element.getQualityItem()}getTextTrack(){return this._textTrackIdx}getPoster(){return this._element.getPoster()}getQuality(){return this._element.getQuality()}getVideoWidth(){return this._element.getVideoWidth()}getVideoHeight(){return this._element.getVideoHeight()}getVideoDimensions(){return this._element.getVideoDimensions()}getElementDimensions(){return this._element.getElementDimensions()}getVolume(){return this._element.getVolume()}getCurrentTime(){return this._element.getCurrentTime()}getStartTime(){return this._element.getStartTime()}getDuration(){return this._element.getDuration()}getBuffered(e){return this._element.getBuffered(e)}getStatsHistory(){return this._element.getStatsHistory()}getTrack(e){return this._element.getTrack(e)}setTrack(e,t){this._element.setTrack(e,t)}getCurrentFrame(e){return this._element.getCurrentFrame(e)}isCustomUiCapable(){return(!this.constructor.canPlayTypeNative(X.TYPE_HLS)||p.isMac()||p.isIPhone()||p.isIPad()||p.isIPod()||p.isSamsungBrowser())&&!p.isBuggyCustomUi()}isReady(){return!0}isSourceReady(){return this._element.isSourceReady()}isMuted(){return this._element.isMuted()}isPlaying(){return this._element.isPlaying()}isPaused(){return this._element.isPaused()}isEnded(){return this._element.isEnded()}isBufferEmpty(){return this._element.isBufferEmpty()}isLive(){return this._element.isLive()}isEvent(){return this._element.isEvent()}isLivePlaying(){return this._element.isLivePlaying()}isLiveStreaming(){return this._element.isLiveStreaming()}isNative(){return!!this._nativeCtrl}canDisplaySubtitles(e){return Di._createEmptyVideo(),this.isCustomUiCapable()?e===X.TYPE_JSON||e===X.TYPE_VTT:void 0!==Mi.textTracks&&e===X.TYPE_VTT}setPoster(e){this._element.setPoster(e)}setVolume(e){this._element.setVolume(e)}setMute(e){this._element.setMute(e)}setQuality(e){this._element.setQuality(e)}setAdPoints(e){this._element.setAdPoints(e)}addStats(e){this._element.addStats(e)}play(){this._element.play()}pause(){this._element.pause()}seek(e,t=!0){this._element.seek(e,t)}seekToLive(){this._element.seekToLive()}skip(){}setViewMode(e){}setSourcePreload(e){this._element.setSourcePreload(e)}processSource(e,t=null){if(e.getLength()){if(e.isAdaptive()&&!this.constructor.canPlayTypeNative(e.getAdaptiveType())&&this.constructor.canPlayTypeNonNative(e.getAdaptiveType()))this._nativeCtrl&&(this._nativeCtrl.destroy(),this._nativeCtrl=null),this._adaptiveCtrl||(this._utils.decorate(this._element,this._elementAdaptive),this._adaptiveCtrl=this._asFactory.create(this._element),"function"==typeof this._element.init&&this._element.init());else{if(e.isAdaptive()&&!this.constructor.canPlayTypeNative(e.getAdaptiveType())){const e=xi.createError(m.SOURCE_TECH,"No technology for adaptive playback found.");return void this.processError(e)}this._adaptiveCtrl&&(this._element.resetAdaptive(),this._utils.undecorate(this._element,this._elementAdaptive),this._adaptiveCtrl.destroy(),this._adaptiveCtrl=null),this._nativeCtrl||(this._nativeCtrl=this._nsFactory.create(this._element))}this._element.setSource(e,t)}else{const e=xi.createError(m.SOURCE_UNPLAYABLE,"No supported source found.");this.processError(e)}}processTextSource(e){this._textTracks.forEach((e,t)=>{e.type===X.TYPE_VTT&&this._element.addTrack(e,t)}),this.dispatchTextSourceSet()}processTextTrack(e,t){this._textTrackIdx=e,null===e||null===this._textTracks?(this._ttProcessor.setTextTrack(null),this._element.setTrackVisible(null)):this._textTracks[e].type===X.TYPE_JSON?this._ttProcessor.setTextTrack(this._textTracks[e]):this._textTracks[e].type===X.TYPE_VTT&&(this.isCustomUiCapable()?this._ttProcessor.setTextTrack(this._textTracks[e]):this._element.setTrackVisible(e)),this.dispatchTextTrackSet({textTrackIdx:e})}processResetSource(){this._element.pause(!1),this._element.resetSource()}processReset(){this._element.pause(!1),this._element.reset()}processDestroy(){this._element.destroy()}_handleWarningEvent(e){this.processWarning(e)}_handleErrorEvent(e){this.processError(e)}}let Oi=new m.ErrorFactory(m.createSourceName("src/js/mediaplayer/tech/techFactory.js"));var Ri={create(e,t,i,s,n){if(!n.id)throw Oi.createError(m.SETTING,'Option "id" must be specified.');return new Di(e,t,i,s,n)}};class Ui{constructor(e,t,i){this._resource=e,this._factory=i,this._loaderFactory=t,this._loader=null,this._liveTimer=null,this._isFilledPromise=null,this._isFilledResolve=null,this._isFilledReject=null,this._isFilledTimeout=null}get(e){return this._resource.get(e.src,e.type).then(t=>this._factory.create(t,{src:e.src,type:e.type,name:e.name,tracks:e.tracks||null}))}loadTrack(e){return this._resource.get(e.getUrl(),e.getAdaptiveType()).then(t=>{let i=e.clone();return i.setSource(t),i})}abortFill(){if(this._isFilledPromise){this._isFilledPromise=null,this._isFilledTimeout&&(clearTimeout(this._isFilledTimeout),this._isFilledTimeout=null);const e=new Error("abortFill");e.type="abort",this._isFilledReject(e)}this._loader&&(this._loader.abort(),this._loader=null),this._resource.abort()}fillTrack(e,t=!1){return this._isFilledPromise=null,t?(this._isFilledPromise=new Promise((e,t)=>{this._isFilledResolve=e,this._isFilledReject=t}),this._isFilledTimeout=setTimeout(()=>{this._isFilledResolve(e)},0),this._isFilledPromise):this.loadTrack(e).then(t=>{return!(e.isLive()&&!e.isEvent())&&e.hasSource()&&e.setChanged(e.getSegmentsLength()!==t.getSegmentsLength()),t.addUpdatedData(e),e.setSource(t.getSource()),e})}refillTrack(e,t){return!(e.isLive()&&!e.isEvent())&&e.hasSource()&&t.setChanged(e.getSegmentsLength()!==t.getSegmentsLength()),t.addUpdatedData(e),e.setSource(t.getSource()),e}}class Vi{constructor(e,t){this._loader=null,this._loaderFactory=e,this._playlistParserFactory=t,this._parser=null}get(e,t){return this._parser=this._playlistParserFactory.createParser(t),this._loader=this._loaderFactory.create(),this._loader.load(e).then(t=>this._parser.parse(e,t.data))}abort(){let e=!1;return this._loader&&(e=this._loader.abort(),this._loader=null),e}}class Bi{constructor(e){this._url=e}parse(e,t){throw new Error('[PlaylistParser] Method "parse" is not implemented.')}_resolveUrl(e,t){return decodeURI(this._url.resolve(e,t))}}let Fi=new m.ErrorFactory(m.createSourceName("src/js/mediaplayer/hls/M3uParser.js"));const Hi="master",Gi="media",ji=new RegExp("(?:^|,)((?:[^=]*)=(?:\"[^\"]*\"|'[^']*'|[^,]*))");class qi extends Bi{static _setDefaultsIfNecessary(e,t){e===Gi&&(t.isChanged=!0,void 0===t.sequence&&(t.sequence=0),void 0===t.dsequence&&(t.dsequence=0),void 0===t.allowCache&&(t.allowCache=!0),void 0===t.isLive&&(t.isLive=!0),void 0===t.isEvent&&(t.isEvent=!1))}constructor(e,t){super(t),this._tokenizer=e}parse(e,t){let i=null,s={},n="",o=null,r=0,a=null,l=null;for(this._tokenizer.setInput(t);i=this._tokenizer.getToken();)if(i.type===this._tokenizer.TAG){let{name:t,attributes:h}=this.parseTag(i.value);if("#EXTINF"===t){this._checkPlaylistType(n,Gi),n=Gi;let e=this.parseInfAttributes(h);(a={}).duration=C.fromMicroseconds(C.toMicroseconds(e[0])),void 0===s.duration&&(s.duration=0),a.start=null,s.duration=C.fromMicroseconds(C.toMicroseconds(s.duration)+C.toMicroseconds(a.duration)),e[1]&&(a.title=e[1]),o&&(a.key=o)}else if("#EXT-X-ENDLIST"===t)s.isLive=!1;else if("#EXT-X-PLAYLIST-TYPE"===t)s.isEvent="EVENT"===h;else if("#EXT-X-MEDIA"===t){let t=this.parseKeyValueAttributes(h);s.alternativeMedia=s.alternativeMedia||{},s.alternativeMedia[t.TYPE]=s.alternativeMedia[t.TYPE]||[];let i={};i.groupId=t["GROUP-ID"],i.name=t.NAME,i.language=t.LANGUAGE||null,i.autoselect=t.AUTOSELECT||"NO",i.default=t.DEFAULT||"NO",i.instreamId=t["INSTREAM-ID"]||null,i.assocLanguage=t["ASSOC-LANGUAGE"]||null,i.channels=t.CHANNELS||null;const n=t.URI||null;i.url=n?this._resolveUrl(e,n):null,s.alternativeMedia[t.TYPE].push(i)}else if("#EXT-X-STREAM-INF"===t){this._checkPlaylistType(n,Hi),n=Hi;let e=this.parseKeyValueAttributes(h);if(l={},e.BANDWIDTH&&(l.bandwidth=l.bitrate=parseInt(e.BANDWIDTH,10)),e["PROGRAM-ID"]&&(l.programId=parseInt(e["PROGRAM-ID"],10)),e.CODECS){let t=e.CODECS.split(",");l.hasVideo=!1,l.hasAudio=!1,l.codecs={audio:null,video:null},t.forEach(e=>{/.*avc.*/.test(e)?(l.codecs.video=e,l.hasVideo=!0):/.*mp4a.*/.test(e)&&(l.codecs.audio=e,l.hasAudio=!0)})}if(e.RESOLUTION){let t=e.RESOLUTION.split("x");l.resolution={width:parseInt(t[0],10),height:parseInt(t[1],10)}}e["FRAME-RATE"]&&(l.framerate=Math.floor(parseInt(e["FRAME-RATE"],10))),e.AUDIO&&(l.audioGroup=e.AUDIO),e.VIDEO&&(l.videoGroup=e.VIDEO),e.SUBTITLES&&(l.subtitlesGroup=e.SUBTITLES),e["CLOSED-CAPTIONS"]&&(l.captionsGroup=e["CLOSED-CAPTIONS"])}else if("#EXT-X-VERSION"===t)s.version=parseInt(h,10);else if("#EXT-X-TARGETDURATION"===t)s.targetDuration=parseFloat(h,10);else if("#EXT-X-MEDIA-SEQUENCE"===t)s.sequence=parseInt(h,10);else if("#EXT-X-DISCONTINUITY-SEQUENCE"===t)s.dsequence=parseInt(h,10);else if("#EXT-X-KEY"===t){let e=this.parseKeyValueAttributes(h);(o={}).method=e.METHOD,e.URI&&(o.uri=e.URI),e.IV&&(o.iv=e.IV)}else if("#EXT-X-PROGRAM-DATE-TIME"===t)s.programDateTime=new Date(h);else if("#EXT-X-ALLOW-CACHE"===t)s.allowCache="YES"===h;else if("#EXT-X-DISCONTINUITY"===t)r++;else if("#EXT-X-MAP"===t){let t=this.parseKeyValueAttributes(h);const i=this._resolveUrl(e,t.URI);s.headerFile=s.headerFile||[],s.headerFile.push({url:i,data:null})}}else l?(l.url=this._resolveUrl(e,i.value),s.playlists=s.playlists||[],s.playlists.push(l),l=null):(a.url=this._resolveUrl(e,i.value),void 0===s.dsequence&&(s.dsequence=0),/\.m4s$/i.test(a.url)?s.srcType=X.FMP4_LABEL:s.srcType=X.TS_LABEL,a.discontinuity=s.dsequence+r,s.segments=s.segments||[],s.segments.push(a),a=null);return qi._setDefaultsIfNecessary(n,s),s}parseTag(e){let t="",i="",s=e.match(/(#[A-Z-]+):(.*)/);return s?(t=s[1],i=s[2]):t=e,{name:t,attributes:i}}parseInfAttributes(e){if(!e)throw Fi.createError(m.GENERAL,"EXTINF tag must have attributes.");let t=e.indexOf(",");if(-1===t)throw Fi.createError(m.GENERAL,"Invalid EXTINF tag attributes.");return[parseFloat(e.substring(0,t),10),e.substring(t+1)]}parseKeyValueAttributes(e){if(!e)return{};let t=e.split(ji),i={};for(let e=t.length-1;e>=0;e--){let s=t[e];if(""===s)continue;let n=s.indexOf("="),o=s.substring(0,n),r=s.substring(n+1);o=o.replace(/^\s+|\s+$/g,""),r=(r=r.replace(/^\s+|\s+$/g,"")).replace(/^['"]|['"]$/g,""),i[o]=r}return i}_checkPlaylistType(e,t){if(e&&e!==t)throw Fi.createError(m.GENERAL,"A HLS Playlist must contain only segments or only another playlists.")}}class Qi{constructor(){this.TAG="tag",this.URI="uri",this._lines=null}setInput(e){this._lines=e.split("\n")}getToken(){let e="",t=null;for(;void 0!==(e=this._lines.shift())&&(!(e=e.replace(/^[\u0000\s]+|[\u0000\s]+$/g,"")).length||"#"===e[0]&&0!==e.indexOf("#EXT")););return void 0===e?null:{type:t="#"!==e[0]?this.URI:this.TAG,value:e}}}let Yi=new m.ErrorFactory(m.createSourceName("src/js/sznplayer/ad/vast/XmlUtils.js"));var zi={stringToXml(e){if(!window.DOMParser)throw Yi.createError(m.AD,"Unable to parse XML string.");let t=new DOMParser,i=null;try{i=t.parseFromString(e,"application/xml")}catch(e){throw Yi.createError(m.AD,"Unable to parse XML string.")}return i},xmlStringDecode:e=>e.replace(/&apos;/g,"'").replace(/&quot;/g,'"').replace(/&gt;/g,">").replace(/&lt;/g,"<").replace(/&amp;/g,"&"),getTime(e){if(!e)return null;let t=e.match(/^(\d{1,2}):(\d{1,2}):(\d{1,2})(\.\d{1,})?/);return t?3600*parseInt(t[1],10)+60*parseInt(t[2],10)+parseInt(t[3],10)+(t[4]?parseFloat(t[4]):0):null},getFormattedTime(e){const t=Math.floor(e/3600),i=Math.floor(e/60%60),s=Math.floor(e%60),n=Math.floor(1e3*e)%1e3,o=(e,t)=>{let i=String(e);for(;i.length<t;)i="0"+i;return i};return o(t,2)+":"+o(i,2)+":"+o(s,2)+"."+o(n,3)},getBoolean(e){if("string"==typeof e&&""!==e){let t=e.toLowerCase();if("true"===t)return!0;if("false"===t)return!1}return!!e},getChildrenByName(e,t){let i=[],s=e.childNodes;for(let e=0;e<s.length;e++){let n=s[e];n.nodeName===t&&i.push(n)}return i},getChildByName(e,t){let i=e.childNodes;for(let e=0;e<i.length;e++){let s=i[e];if(s.nodeName===t)return s}return null},getText:e=>(e&&(e.textContent||e.text)||"").trim()};let Wi=new m.ErrorFactory(m.createSourceName("src/js/mediaplayer/hls/DashParser.js"));class Ki extends Bi{constructor(e){super(e),this._baseUri="",this._periodDuration=0,this._mediaDuration=0,this._discontinuity=0,this._segmentTemplate=null}static _setDefault(e){return void 0===e.isChanged&&(e.isChanged=!0),void 0===e.sequence&&(e.sequence=0),void 0===e.dsequence&&(e.dsequence=0),void 0===e.allowCache&&(e.allowCache=!0),void 0===e.isLive&&(e.isLive=!1),void 0===e.isEvent&&(e.isEvent=!1),e}parse(e,t){let i=zi.stringToXml(t);this._baseUri=e;let s={playlists:[]},n=null;try{let e=zi.stringToXml("<").getElementsByTagName("parsererror");n=e.length?e[0].namespaceURI:null}catch(e){}if(!i.documentElement||"MPD"!==i.documentElement.nodeName||n&&i.getElementsByTagNameNS(n,"parsererror").length){throw Wi.createError(m.SOURCE_SPL,"Specified string is not a valid DASH manifest.")}{let e=i.documentElement;const t=zi.getChildByName(e,"BaseURL");t&&(this._baseUri=zi.getText(t));const n=e.getAttribute("mediaPresentationDuration"),o=/\d+\.?\d*(?=H)/.exec(n),r=/\d+\.?\d*(?=M)/.exec(n),a=/\d+\.?\d*(?=S)/.exec(n);this._mediaDuration=360*Number(o)+60*Number(r)+Number(a);let l=zi.getChildrenByName(e,"Period");if(l.length)return l.forEach(e=>{this._parsePeriod(e).forEach(e=>{let t=s.playlists.find(t=>t.width===e.width&&t.height===e.height&&t.codecs===e.codecs);t?this._mergeQualities(t,e):s.playlists.push(e)}),this._discontinuity++}),s.playlists=s.playlists.filter(e=>e.src.duration>=Math.floor(this._mediaDuration)),s;throw Wi.createError(m.SOURCE_SPL,"There is no period in Dash manifest.")}}_mergeQualities(e,t){t.src.segments.forEach(t=>{t.start+=e.src.duration}),t.bitrate>e.bitrate&&(e.bitrate=t.bitrate),e.src.headerFile.push(t.src.headerFile[0]),e.src.segments=e.src.segments.concat(t.src.segments),e.src.duration+=t.src.duration}_parsePeriod(e){const t=e.getAttribute("duration"),i=/\d+\.?\d*(?=H)/.exec(t),s=/\d+\.?\d*(?=M)/.exec(t),n=/\d+\.?\d*(?=S)/.exec(t);this._periodDuration=360*Number(i)+60*Number(s)+Number(n);let o=[],r=zi.getChildrenByName(e,"AdaptationSet"),a=null;if(1!==r.length){throw Wi.createError(m.SOURCE_SPL,"Period in DASH manifest contains more than one Adaptation sets.")}if(!(a=r[0])){throw Wi.createError(m.SOURCE_SPL,"Period in DASH manifest does not contain any Adaptation sets.")}{let e=zi.getChildByName(a,"SegmentTemplate");e&&(this._segmentTemplate=this._parseSegmentTemplate(e));const t=zi.getChildByName(a,"BaseURL"),i=t?zi.getText(t):"";let s=zi.getChildrenByName(a,"Representation");if(!s){throw Wi.createError(m.SOURCE_SPL,"AdaptationSet in DASH manifest does not contain any Representations.")}s.forEach(e=>{let t=this._parseRepresentation(e,i);t.type||(t.type=a.getAttribute("mimeType"));const s=o.find(e=>t.width===e.width&&t.height===e.height&&t.codecs===e.codecs);s?s.bitrate<t.bitrate&&(o.splice(o.indexOf(s),1),o.push(t)):o.push(t)})}return o}_parseRepresentation(e,t){let i={};i.id=e.getAttribute("id"),i.name=e.getAttribute("height")+"p",i.label=e.getAttribute("height")+"p",i.bitrate=Number(e.getAttribute("bandwidth")),i.codecs=e.getAttribute("codecs"),i.height=e.getAttribute("height"),i.width=e.getAttribute("width"),i.type=e.getAttribute("mimeType"),i.resolution={height:Number(i.height),width:Number(i.width)},i.src=null;const s=zi.getChildByName(e,"SegmentList"),n=zi.getChildByName(e,"SegmentTemplate");if(s&&n){throw Wi.createError(m.SOURCE_SPL,"Representation in DASH manifest contains more than one segments descriptions.")}if(s&&(i.src=this._parseSegmentList(s,t)),n){const e=this._parseSegmentTemplate(n);i.src=this._createSegmentsFromTemplate(e,i.id,t)}if(this._segmentTemplate&&!i.src&&(i.src=this._createSegmentsFromTemplate(this._segmentTemplate,i.id,t)),!i.src){throw Wi.createError(m.SOURCE_SPL,"Representation in DASH manifest does not contain SegmentList, or SegmentTemplate.")}if(i.src.segments.length>0){const e=i.src.segments[0].url;/\.ts$/i.test(e)?i.src.srcType=X.TS_LABEL:i.src.srcType=X.FMP4_LABEL}return i}_parseSegmentTemplate(e){let t={};t.timescale=Number(e.getAttribute("timescale")),t.segmentDuration=Number(e.getAttribute("duration")),t.startNumber=Number(e.getAttribute("startNumber"));const i=e.getAttribute("media"),s=e.getAttribute("initialization");if(t.mediaTemplate=i?i.split("$"):[],!t.mediaTemplate){throw Wi.createError(m.SOURCE_SPL,"SegmentTemplate in DASH manifest does not contain 'media' attribute.")}if(t.initTemplate=s?s.split("$"):[],!t.initTemplate){throw Wi.createError(m.SOURCE_SPL,"SegmentTemplate in DASH manifest does not contain 'initialization' attribute.")}const n=zi.getChildByName(e,"SegmentTimeline");if(n){const e=zi.getChildrenByName(n,"S");t.segmentTimeline=[],e.forEach(e=>{let i={};const s=e.getAttribute("t");i.t=null!==s?Number(s):null;const n=e.getAttribute("r");i.r=null!==n?Number(n):null;const o=e.getAttribute("d");i.d=null!==o?Number(o):null,t.segmentTimeline.push(i)})}return t}_createSegmentsFromTemplate(e,t,i){let s={},n=e.startNumber,o=0;const r=this._resolveUrl(this._baseUri+i,this._parseMediaExpression(e.initTemplate,n,o,t));if(s.headerFile=[{url:r,data:null}],s.segments=[],e.segmentTimeline)e.segmentTimeline.forEach(r=>{let a={},l=r.d;const h=r.r||1;for(let _=0;_<h;_++)(a={}).start=null!==r.t?r.t:o/e.timescale,a.duration=l/e.timescale,a.discontinuity=this._discontinuity,a.url=this._resolveUrl(this._baseUri+i,this._parseMediaExpression(e.mediaTemplate,n,o,t)),s.segments.push(a),o+=l,n++});else{if(!e.segmentDuration){throw Wi.createError(m.SOURCE_SPL,"SegmentTemplate in DASH manifest does not contain 'duration' attribute, or SegmentTimeline child node.")}let r=e.segmentDuration/e.timescale;for(;o<this._periodDuration;){let a={};a.start=o,a.duration=r,a.discontinuity=this._discontinuity,a.url=this._resolveUrl(this._baseUri+i,this._parseMediaExpression(e.mediaTemplate,n,o*e.timescale,t)),s.segments.push(a),n++,o+=r}const a=s.segments[s.segments.length-1];a.duration=this._periodDuration-a.start}return s.duration=Math.floor(this._periodDuration),s=Ki._setDefault(s)}_parseMediaExpression(e,t,i,s){let n=[];return e.forEach(e=>{switch(e){case"RepresentationID":n.push(s);break;case"Time":n.push(i);break;case"Number":n.push(t);break;default:n.push(e)}}),n.join("")}_parseSegmentList(e,t){let i={},s=zi.getChildByName(e,"Initialization");if(!s){throw Wi.createError(m.SOURCE_SPL,"SegmentList in DASH manifest does not contain Initialization node.")}const n=this._resolveUrl(this._baseUri+t,s.getAttribute("sourceURL"));i.headerFile=[{url:n,data:null}],i.segments=[];let o=0;let r=e.getAttribute("duration")/e.getAttribute("timescale"),a=zi.getChildrenByName(e,"SegmentURL");if(!a){throw Wi.createError(m.SOURCE_SPL,"SegmentList in DASH manifest does not contain any segments.")}a.forEach(e=>{i.segments.push({url:this._resolveUrl(this._baseUri+t,e.getAttribute("media")),start:o,duration:r,discontinuity:this._discontinuity}),o+=r});const l=i.segments[i.segments.length-1];return l.duration=this._periodDuration-l.start,i.duration=Math.floor(this._periodDuration),i=Ki._setDefault(i)}}class $i{constructor(e){this._url=e}createParser(e){return e===X.TYPE_HLS?new qi(new Qi,this._url):e===X.TYPE_DASH?new Ki(this._url):void 0}}new m.ErrorFactory(m.createSourceName("src/js/mediaplayer/createMediaPlayer.js"));function Xi(e={}){let t={loadAttemps:e.loadAttemps||U.loadAttemps,appendAttemps:e.appendAttemps||U.appendAttemps,id:e.id||o.generateId("me"),element:e.element||"",elmId:e.elmId||"",loadOnSource:void 0!==e.loadOnSource?e.loadOnSource:U.loadOnSource,preferredBitrate:e.preferredBitrate||U.preferredBitrate,controls:"controls"in e?!!e.controls:U.videoControls,preload:"preload"in e?e.preload:U.videoPreload,muted:"muted"in e?!!e.muted:U.videoMuted,crossorigin:"crossorigin"in e?e.crossorigin:U.videoCrossorigin,stopBufferingOnPause:"stopBufferingOnPause"in e?e.stopBufferingOnPause:U.stopBufferingOnPause,adaptResolutionToSize:"adaptResolutionToSize"in e?e.adaptResolutionToSize:U.adaptResolutionToSize},i={maxAttemps:U.loadAttemps,timeout:U.requestTimeout},s=new Vi(new zt(o,i,zt.PROFILE_PLAYLIST),new $i(Ct)),n=new zt(o,i,zt.PROFILE_TEXTTRACK),r=new Ui(s,new zt(o,i,zt.PROFILE_SEGMENT),new R(U.qualityDict,t));return Ri.create(p,o,n,r,t)}const Zi="http://www.w3.org/2000/svg",Ji="http://www.w3.org/1999/xlink";function es(e,t={}){let i=null;const s=e.toLowerCase();if(i=["svg","use"].indexOf(s)>-1?document.createElementNS(Zi,e):document.createElement(e),!t||"object"!=typeof t)throw new Error("[createElm] Attrs argument must be an object");for(let e of Object.keys(t)){if("style"==e){for(let e of Object.keys(t.style))i.style[e]=t.style[e];continue}if("className"==e){i.setAttribute("class",t.className);continue}if("innerHTML"==e){i.innerHTML=t.innerHTML;continue}["use"].indexOf(s)>-1?i.setAttributeNS(Ji,e,t[e]):i.setAttribute(e,t[e])}return i}function ts(e){return"__dom_helper__"in e&&(e=e.node()),{__dom_helper__:!0,node:()=>e,append(...t){return t.forEach(t=>{Array.isArray(t)?this.append.apply(this,t):("__dom_helper__"in t&&(t=t.node()),e.appendChild(t))}),this},remove(t){return e.removeChild(t),this},clear(){for(;e.firstChild;)this.remove(e.firstChild);return this},moveChildrenFrom(t){for(;t.firstChild;)e.appendChild(t.firstChild);return this},cssClasses(t){for(let i of Object.keys(t))i&&(t[i]&&!e.classList.contains(i)?e.classList.add(i):!t[i]&&e.classList.contains(i)&&e.classList.remove(i));return this},removeCssClasses(e){return this},stopClickPropagation(){return e.addEventListener("click",e=>{e.stopPropagation()}),this},setStyle(t){for(let i of Object.keys(t))e.style[i]!==t[i]&&(e.style[i]=t[i]);return this},setInnerHTML(t){return"string"==typeof t&&(e.innerHTML=t),this},setAttr(t){for(let i of Object.keys(t))e.setAttribute(i,t[i]);return this},setAttrNS(t){for(let i of Object.keys(t))e.setAttributeNS(Ji,i,t[i]);return this},setDisplayed(e){return this.cssClasses({"-hidden":!e}),this},setBoxShadow(t){const i=e.style;return"boxShadow"in i&&i.boxShadow!==t&&(i.boxShadow=t),"webkitBoxShadow"in i&&i.webkitBoxShadow!==t&&(i.webkitBoxShadow=t),this}}}class is extends E{constructor(e,t,i){super(),this._env=e,this._container=t,this._video=i,this._methodRequest=null,this._methodExit=null,this._methodState=null,this._isFakeFS=!1,this._emitFullscreenChange=this._emitFullscreenChange.bind(this),this._changeEventName="",this._enterEventName="",this._leaveEventName="",this._env.getFSRequestMethod(t,i)&&this._env.getFSExitMethod(document,i)&&!this._env.isBuggyFullscreen()?(this._methodRequest=this._env.getFSRequestMethod(t,i),this._methodExit=this._env.getFSExitMethod(document,i),this._methodState=(()=>this._env.getFSStateIndicator(document,t,i)),this._changeEventName=this._env.getFSChangeEventName(document),this._changeEventName?document.addEventListener(this._changeEventName,this._emitFullscreenChange):(this._enterEventName=this._env.getFSChangeEventName(document,i,!1),this._enterEventName&&i.addEventListener(this._enterEventName,this._emitFullscreenChange),this._leaveEventName=this._env.getFSChangeEventName(document,i,!0),this._leaveEventName&&i.addEventListener(this._leaveEventName,this._emitFullscreenChange))):(this._methodRequest=this._turnOnFakeFullscreen.bind(this),this._methodExit=this._turnOffFakeFullscreen.bind(this),this._methodState=this._isFakeFullscreen.bind(this))}destroy(){this.exitFullscreen(),this._changeEventName&&document.removeEventListener(this._changeEventName,this._emitFullscreenChange),this._enterEventName&&this._video.removeEventListener(this._enterEventName,this._emitFullscreenChange),this._leaveEventName&&this._video.removeEventListener(this._leaveEventName,this._emitFullscreenChange),this._env=null,this._container=null,this._video=null,this._methodRequest=null,this._methodExit=null,this._methodState=null,this._isFakeFS=!1,this._emitFullscreenChange=null,this._enterEventName="",this._leaveEventName="",this._changeEventName=""}isFullscreen(){return this._methodState()}enterFullscreen(){this._methodRequest()}exitFullscreen(){this.isFullscreen()&&this._methodExit()}_emitFullscreenChange(){this.emit(is.EVENT_CHANGE,{isFullscreen:this.isFullscreen()})}_isFakeFullscreen(){return this._isFakeFS}_turnOnFakeFullscreen(){this._container.classList.add("-mode-fake-fullscreen"),this._isFakeFS=!0,this._emitFullscreenChange()}_turnOffFakeFullscreen(){this._container.classList.remove("-mode-fake-fullscreen"),this._isFakeFS=!1,this._emitFullscreenChange()}}is.EVENT_CHANGE="fullscreenchange";class ss extends E{constructor(e,t,i=!1){super(),this._env=e,this._container=t,this._customCinemaMode=i,this._methodRequest=null,this._methodExit=null,this._methodState=null,this._isActive=!1,this._isAvailable=!0,this._methodRequest=this._turnOnCinemaMode.bind(this),this._methodExit=this._turnOffCinemaMode.bind(this),this._methodState=(()=>this._isActive)}destroy(){this.exitCinema(),this._env=null,this._container=null,this._video=null,this._isActive=!1,this._isAvailable=!1,this._methodRequest=null,this._methodExit=null,this._methodState=null}isCinemaActive(){return this._methodState()}isCinemaAvailable(){return this._isAvailable}enterCinema(){this._methodRequest()}exitCinema(){this._turnOffCinemaMode()}_turnOnCinemaMode(){this._customCinemaMode||this._container.classList.add("-mode-cinema"),this._isActive=!0,this._emitCinemaChange()}_turnOffCinemaMode(){this._customCinemaMode||this._container.classList.remove("-mode-cinema"),this._isActive=!1,this._emitCinemaChange()}_emitCinemaChange(){this.emit(ss.EVENT_CHANGE,{isCinema:this.isCinemaActive()})}}ss.EVENT_CHANGE="cinemachange";class ns extends E{constructor(e,t){super(),this._env=e,this._element=t,this._methodRequest=null,this._methodExit=null,this._methodState=null,this._handlePipEnter=this._handlePipEnter.bind(this),this._handlePipLeave=this._handlePipLeave.bind(this),this._enterEventName="",this._leaveEventName="",this._isActive=!1,this._env.getPipRequestMethod(document,this._element)&&(this._methodRequest=this._env.getPipRequestMethod(document,this._element),this._methodExit=this._env.getPipExitMethod(document,this._element),this._env.getPipStateMethod(this._element)?this._methodState=this._env.getPipStateMethod(this._element):this._methodState=(()=>this._isActive),this._enterEventName=this._env.getPipEnterEventName(document,this._element),this._enterEventName&&this._element.addEventListener(this._enterEventName,this._handlePipEnter),this._leaveEventName=this._env.getPipLeaveEventName(document,this._element),this._leaveEventName&&this._element.addEventListener(this._leaveEventName,this._handlePipLeave))}destroy(){this.exitPip(),this._enterEventName&&document.removeEventListener(this._enterEventName,this._handleEnterEvent),this._leaveEventName&&document.removeEventListener(this._leaveEventName,this._handleLeaveEvent),this._env=null,this._element=null,this._methodRequest=null,this._methodExit=null,this._methodState=null,this._isActive=!1,this._handlePipEnter=null,this._handlePipLeave=null,this._enterEventName=null,this._leaveEventName=null}isPipAvailable(){return!!this._methodRequest}isPipActive(){return!!this._methodState&&this._methodState()}enterPip(){this._methodRequest()}exitPip(){this._methodExit()}_emitPipChange(){this.emit(ns.EVENT_CHANGE,{isPip:this.isPipActive()})}_handlePipEnter(){this._isActive=!0,this._emitPipChange()}_handlePipLeave(){this._isActive=!1,this._emitPipChange()}}ns.EVENT_CHANGE="pipchange";const os=3e4,rs="available";class as extends E{constructor(e,t){super(),this._env=e,this._element=t,this._methodState=null,this._methodShowPicker=null,this._availabilityTimeout=null,this._handleAvailabilityChange=this._handleAvailabilityChange.bind(this),this._handlePlaybackChange=this._handlePlaybackChange.bind(this),this._availabilityChangeEventName="",this._playbackChangeEventName="",this._isAvailable=!1,this._env.isAirPlayPossible(this._element)&&(this._methodState=(()=>this._env.getAirPlayStateIndicator(this._element)),this._methodShowPicker=this._env.getAirPlayTargetPickerMethod(this._element),this._availabilityChangeEventName=this._env.getAirPlayAvailabilityChangeEventName(this._element),this.checkAirPlayTargetAvailability(),this._playbackChangeEventName=this._env.getAirPlayPlaybackChangeEventName(this._element),this._createPlaybackListener())}destroy(){this._availabilityTimeout&&clearTimeout(this._availabilityTimeout),this._removeAvailabilityListener(),this._removePlaybackListener(),this._env=null,this._element=null,this._methodState=null,this._methodShowPicker=null,this._availabilityTimeout=null,this._handlePlaybackChange=null,this._handleAvailabilityChange=null,this._playbackChangeEventName=null,this._availabilityChangeEventName=null,this._isAvailable=!1}isAirPlayAvailable(){return this._isAvailable}isAirPlayActive(){return!!this._methodState&&this._methodState()}showAirPlayTargetPicker(){this._methodShowPicker&&this._methodShowPicker()}checkAirPlayTargetAvailability(){this._createAvailabilityListener(),this._createAvailabilityTimeout()}_createAvailabilityTimeout(){this._availabilityTimeout=setTimeout(()=>{this._removeAvailabilityListener(),clearTimeout(this._availabilityTimeout)},os)}_createAvailabilityListener(){this._availabilityChangeEventName&&this._element.addEventListener(this._availabilityChangeEventName,this._handleAvailabilityChange)}_removeAvailabilityListener(){this._availabilityChangeEventName&&this._element.removeEventListener(this._availabilityChangeEventName,this._handleAvailabilityChange)}_createPlaybackListener(){this._playbackChangeEventName&&this._element.addEventListener(this._playbackChangeEventName,this._handlePlaybackChange)}_removePlaybackListener(){this._playbackChangeEventName&&this._element.removeEventListener(this._playbackChangeEventName,this._handlePlaybackChange)}_handleAvailabilityChange(e){this._isAvailable=e.availability===rs,this._emitAirPlayChange()}_handlePlaybackChange(e){this._emitAirPlayChange()}_emitAirPlayChange(){this.emit(as.EVENT_AP_CHANGE,{airPlayVisible:this._isAvailable,airPlayOn:this.isAirPlayActive()})}}as.EVENT_AP_CHANGE="airplaychange";let ls=new m.ErrorFactory(m.createSourceName("src/js/sznplayer/spl/SplResource.js"));const hs="application/vnd.apple.mpegurl",_s="application/dash+xml",ds="video/mp4",us=415,cs=5e3,ps={json:X.TYPE_JSON,webvtt:X.TYPE_VTT};class ms{static resolveUrl(e,t){return`${e}`+`${"number"==typeof t.cutFrom?`cut,${t.cutFrom}`+`${"number"==typeof t.cutTo?","+t.cutTo:""}`+"|":""}`+"spl2"+`,${ms.SUPPORTED_VERSION}`+`${t.type?","+t.type:""}`}static isValidSpl(e){const t=e.data&&e.data.mp4,i=e.pls&&e.pls.hls,s=e.pls&&e.pls.hls_fmp4,n=e.pls&&e.pls.dash,o=e.data&&e.data.overlay&&e.data.overlay.overlay,r=(e.data&&e.data.sprite_image&&e.data.sprite_image.seek_sprite,e.data&&e.data.video_preview),a=e.data&&e.data.chapter;return t||i||s||n||o||r||a}static getRedirectSpl(e){return e.Location?e.Location:e.location?e.location:null}static getBaseUrl(e){let t="",i=e,s=e.indexOf("//");s>-1&&(t=e.substr(0,s+2),i=e.substr(s+2));let n=null;const o=i.lastIndexOf("/");return n=o>-1?t+i.substr(0,o+1):t+i+"/"}static parseSpl(e){const t=JSON.parse(e);if(0===Object.keys(t).length)return null;let i=ms.getRedirectSpl(t);if(null!==i)return i;if(!ms.isValidSpl(t))throw ls.createError(m.SOURCE_SPL,"Spl is not valid.");return t}static absolutizeSpl(e,t){const i=ms.getBaseUrl(t),s=Object.assign({},e);if(s.pls&&s.pls.hls&&(s.pls.hls.url=ms.absolutizeUrl(s.pls.hls.url,i),s.pls.hls.splitted&&(s.pls.hls.splitted.url=ms.absolutizeUrl(s.pls.hls.splitted.url,i))),s.pls&&s.pls.hls_fmp4&&(s.pls.hls_fmp4.url=ms.absolutizeUrl(s.pls.hls_fmp4.url,i)),s.pls&&s.pls.dash&&(s.pls.dash.url=ms.absolutizeUrl(s.pls.dash.url,i)),s.data&&s.data.mp4){Object.keys(s.data.mp4).forEach(e=>{const t=s.data.mp4[e];t.url=ms.absolutizeUrl(t.url,i)})}if(s.data&&s.data.overlay&&s.data.overlay.overlay&&(s.data.overlay.overlay.url=ms.absolutizeUrl(s.data.overlay.overlay.url,i)),s.data&&s.data.subtitles){Object.keys(s.data.subtitles).forEach(e=>{const t=s.data.subtitles[e];Object.keys(t.urls||{}).forEach(e=>{t.urls[e]=ms.absolutizeUrl(t.urls[e],i)})})}if(s.data&&s.data.video_preview&&s.data.video_preview.preview_mp4&&s.data.video_preview.preview_mp4.urls.forEach((e,t)=>{s.data.video_preview.preview_mp4.urls[t]=ms.absolutizeUrl(e,i)}),s.data&&s.data.sprite_image&&s.data.sprite_image.preview_sprite&&(s.data.sprite_image.preview_sprite.url=ms.absolutizeUrl(s.data.sprite_image.preview_sprite.url,i)),s.data&&s.data.sprite_image&&s.data.sprite_image.seek_sprite){const e=s.data.sprite_image.seek_sprite;e.urls.forEach((t,s)=>{e.urls[s]=ms.absolutizeUrl(t,i)})}if(s.data&&s.data.chapter){Object.keys(s.data.chapter).forEach(e=>{const t=s.data.chapter[e];t.url=ms.absolutizeUrl(t.url,i)})}return s}static absolutizeUrl(e,t){return e.indexOf("//")>-1?e:t+e}static createSource(e){const t=e.pls&&e.pls.hls,i=e.pls&&e.pls.hls_fmp4,s=e.data&&e.data.mp4,n=e.pls&&e.pls.dash,o=[];n&&o.push({name:X.DASH_LABEL,source:[{src:n.url,type:_s}]});let r=null;if(t&&(r=ms.getAlternativeTracks(t),o.push({name:X.TS_LABEL,source:[{src:r?r.url:t.url,type:hs,tracks:r}]})),i&&!r&&o.push({name:X.FMP4_LABEL,source:[{src:i.url,type:hs}]}),s)for(let e of Object.keys(s))o.push({name:e,source:[{src:s[e].url,type:ds,bitrate:s[e].bandwidth||null,codecs:s[e].codec||null}]});return new N(o)}static createSeekSource(e){const t=e.data&&e.data.sprite_image&&e.data.sprite_image.seek_sprite;return t?{rows:parseInt(t.rows,10)||0,columns:parseInt(t.columns,10)||0,height:parseInt(t.frame_height,10)||0,width:parseInt(t.frame_width,10)||0,frame_duration:parseInt(t.frame_duration,10)||1,urls:t.urls}:null}static createPreviewSource(e){const t=e.data&&e.data.video_preview&&e.data.video_preview.preview_mp4,i=e.data&&e.data.sprite_image&&e.data.sprite_image.preview_sprite,s={};return t&&t.urls[0]&&Object.assign(s,{video_preview:{url:t.urls[0],height:parseInt(t.height,10)||0,width:parseInt(t.width,10)||0}}),i&&i.url&&Object.assign(s,{sprite_preview:{url:i.url,frame_duration:parseInt(i.frame_duration,10)||1,rows:parseInt(i.rows,10)||0,columns:parseInt(i.columns,10)||0,height:parseInt(i.frame_height,10)||0,width:parseInt(i.frame_width,10)||0}}),Object.keys(s).length?s:null}static createChapters(e){const t=e.data&&e.data.chapter,i=[];if(t)for(let e of Object.keys(t))i.push({startTime:parseInt(t[e].start,10)||0,title:t[e].title||"",poster:t[e].url||""});return i}static getOverlayUrl(e){return e.data&&e.data.overlay&&e.data.overlay.overlay?e.data.overlay.overlay.url:""}static getSubtitlesTracks(e){const t=e.data&&e.data.subtitles,i=[];if(t)for(let e of Object.keys(t))for(let s of Object.keys(t[e].urls||{}))void 0!==ps[s]&&i.push({src:t[e].urls[s],kind:"subtitles",srclang:t[e].language,label:t[e].name,type:ps[s]});return i}static getAlternativeTracks(e){if(e&&e.splitted){const t=e.splitted.url.match(/{{[^{]*}}/g),i=e.splitted.url.replace("{{HLS_MODE}}","SAV").replace("{{AUDIO_BANDWIDTH}}","");return{variables:t,url:i.replace(/{{[^{]*}}/g,""),baseUrl:i,audioTracks:e.splitted.audio_idmap||{},videoTracks:e.splitted.video_idmap||{}}}return null}static getMp4Duration(e){const t=e.data&&e.data.mp4;if(t)for(let e of Object.keys(t))if(t[e].duration)return t[e].duration;return NaN}constructor(e){this._loaderFactory=e,this._options={},this._splUrl="",this._loadedUrl="",this._reloadTimer=null,this._reloadCount=0,this._loader=null,this._resolve=null,this._reject=null,this._loadDone=this._loadDone.bind(this),this._loadFailed=this._loadFailed.bind(this)}get(e,t={}){let i=new Promise((e,t)=>{this._resolve=e,this._reject=t});return this._splUrl=e,this._options=t,this._reloadCount=0,this._load(),i}reset(){if(this._reloadTimer)return clearTimeout(this._reloadTimer),this._reloadTimer=null,void this._resolve(null);this._loader&&this._loader.abort()}_load(e=null){return this._loadedUrl=null!==e?e:this._splUrl,this._loader=this._loaderFactory.create(),this._loader.load(this._loadedUrl).then(this._loadDone,this._loadFailed)}_reload(){this._options.reloadCallback&&this._options.reloadCallback(),this._reloadTimer=setTimeout(()=>{this._reloadTimer=null,this._reloadCount=0,this._load()},cs)}_loadDone(e){let t=null;try{t=ms.parseSpl(e.data)}catch(e){return void this._reject(e)}if("string"==typeof t)if(this._reloadCount<ms.MAX_REDIRECTS)this._reloadCount++,this._load(t);else{const e=ls.createError(m.SOURCE_SPL,"Too many Spl redirects.");this._reject(e)}else null===t?this._reload():this._resolve(ms.absolutizeSpl(t,this._loadedUrl))}_loadFailed({type:e,url:t,status:i=0}){if("abort"===e)this._resolve(null);else if(i===us)this._reload();else if(this._reloadCount<ms.MAX_RETRIES)this._reloadCount++,this._load();else{const s=ls.createError(m.SOURCE_SPL,`Request to ${t} was rejected.`+` Reason: ${e}, status: ${i}.`);s.status=i,s.genericMessage="Request to spl url was rejected",this._reject(s)}}resolveAndGet(e,t={}){const i=t.reloadCallback||null,s={scheme:t.scheme||"",type:t.type||"",cutFrom:"number"==typeof t.cutFrom&&t.cutFrom,cutTo:"number"==typeof t.cutTo&&t.cutTo},n=ms.resolveUrl(e,s);return this.get(n,{reloadCallback:i})}}function gs(){const e=new zt(o,{},zt.PROFILE_PLAYLIST);return new ms(e)}ms.SUPPORTED_VERSION=3,ms.MAX_REDIRECTS=5,ms.MAX_RETRIES=1,ms.VIDEO_TRACK_DEFAULT="default";class Es extends S{constructor(){super(),this._elements={},this._shown=[]}canRunType(e,t){return 0===e.indexOf("image")||"text/html"===e||t&&!p.isTouch()&&(e===i||"video/mp4s"===e)}isShown(e){return-1!==this._shown.indexOf(e)}get(){return Object.keys(this._elements)}getShown(){return this._shown.map(e=>Object.assign({},this._elements[e]))}add(e){if(this._elements[e.id]=e,this._elements[e.id].closeButtonDisplayed=!1,e.type===i&&e.src){gs().resolveAndGet(e.src,{}).then(t=>{e.type="video/mp4s",e.src=ms.getOverlayUrl(t)}).catch(t=>{this.emit(Es.EVENT_VE_ERROR,{id:e.id,error:t})})}else if(e.src){(new Image).src=e.src}}show(e){this._elements[e]&&!this.isShown(e)&&this._elements[e].type!==i&&(this._shown.push(e),this.emit(Es.EVENT_CHANGE,this.getShown()),this.emit(Es.EVENT_VE_DISPLAYED,{id:e}))}showClose(e){this._elements[e]&&!this._elements[e].closeButtonDisplayed&&(this._elements[e].closeButtonDisplayed=!0,this.emit(Es.EVENT_CHANGE,this.getShown()))}hide(e){this._elements[e]&&this._removeElementFromShown(e)&&(this.emit(Es.EVENT_CHANGE,this.getShown()),this.emit(Es.EVENT_VE_HIDDEN,{id:e}))}abort(e){this.hide(e)}remove(e){this._elements[e]&&(this.abort(e),this._elements[e]=null)}removeAll(){if(this._shown.length){this.emit(Es.EVENT_CHANGE,[]);for(let e=0,t=this._shown.length;e<t;e++){const t=this._shown[e];this._removeElementFromShown(t)&&this.emit(Es.EVENT_VE_HIDDEN,{id:t})}this._shown=[]}this._elements={}}_removeElementFromShown(e){const t=this._shown.indexOf(e);return-1!==t&&(this._shown.splice(t,1),!0)}setDefaultPosition(e,t){this._elements[e]&&(this._elements[e].defaultPosition=t,this.emit(Es.EVENT_CHANGE,this.getShown()))}}Es.EVENT_CHANGE="change",Es.EVENT_VE_DISPLAYED="displayed",Es.EVENT_VE_HIDDEN="hidden",Es.EVENT_VE_ERROR="error";let Ts=new m.ErrorFactory(m.createSourceName("src/js/common/UiComponent.js"));class fs{constructor(e){this._dom={root:null,refs:{}},this._flags={},this._component={},this._bind=[],this._props={};const t=this.uiGetDefaultProps(),i=Object.assign({},t,e);this.__checkProps(i),this._props=i,this.__internal={inited:!1,built:!1},this.__eventEmitter=null}uiSetEventEmitter(e){if(!e||"object"!=typeof e)throw Ts.createError(m.GENERAL,`In ${this.constructor.name} "eventEmitter" must be an object.`);this.__eventEmitter=e}uiGetDeclaredProps(){return{}}uiGetDefaultProps(){return{}}uiInit(){this.__bindAll(this._bind),this._onUiInit(this._props),this.__internal.inited=!0}uiInited(){return this.__internal.inited}uiBuild(){return this.__uiBuildComponents(this._component,this.__eventEmitter),this._onUiBuild(this._props),this.__internal.built=!0,this}uiBuilt(){return this.__internal.built}uiForceUpdate(){return this._onUiUpdate(this._props),this.__uiForceUpdateComponents(this._component),this}uiCanUpdate(e){return this._onUiCanUpdate(e)}uiUpdate(e){if(!e||"object"!=typeof e)throw Ts.createError(m.GENERAL,`In ${this.constructor.name} "props" must be an object.`);const t=Object.assign({},this._props,e);return this.__checkProps(t),this.uiCanUpdate(t)&&(this._onUiUpdate(t),this._props=t),this}uiDestroy(){this.__uiDestroyComponents(this._component),this._onUiDestroy(),this.__uiClearDom(),this._dom={root:null,destroyed:!0}}uiHasElement(e){if(!this._dom.root)throw Ts.createError(m.GENERAL,`In ${this.constructor.name}`+` Root element is ${this._dom.root}.`+' Be sure you called "uiBuild" before "uiHasElement".');return this._dom.root==e||this._dom.root.contains(e)}uiGetElement(){if(!this._dom.root)throw Ts.createError(m.GENERAL,`In ${this.constructor.name}`+` Root element is ${this._dom.root}.`+' Be sure you called "uiBuild" before "uiGetElement".');return this._dom.root}_uiAddListener(...e){this.__eventEmitter.addListener.apply(this.__eventEmitter,e)}_uiEmitEvent(...e){this.__eventEmitter.emit.apply(this.__eventEmitter,e)}_onUiInit(){this._dom.root=es("div",{"data-info":"In "+this.constructor.name+" there is no root."})}_onUiBuild(){}_onUiUpdate(){}_onUiCanUpdate(){return!0}_onUiDestroy(){}__checkProps(e){const t=this.uiGetDeclaredProps();for(let i of Object.keys(e)){if(!(i in t))throw Ts.createError(m.GENERAL,` In ${this.constructor.name}`+` got unknown prop name "${i}".`+' Define this prop in "uiGetDeclaredProps" method or stop setting it in props if it is useless.');if(-1==[].concat(t[i]).indexOf(typeof e[i]))throw Ts.createError(m.GENERAL,`In ${this.constructor.name}`+` got bad type of "${i}" property. Expected `+`${t[i]} but got ${typeof e[i]}.`)}}__bindAll(e){for(let t of e)this[t]=this[t].bind(this)}__uiBuildComponents(e,t){for(let i of Object.keys(e)){if(!e[i])throw Ts.createError(m.GENERAL,`In ${this.constructor.name}`+` is unitialized component "${i}".`+' Method "_onUiInit" is the best place.');Array.isArray(e[i])?e[i].forEach(e=>{e.uiInit(),e.uiSetEventEmitter(t),e.uiBuild()}):(e[i].uiInit(),e[i].uiSetEventEmitter(t),e[i].uiBuild())}}__uiForceUpdateComponents(e){for(let t of Object.keys(e))Array.isArray(e[t])?e[t].forEach(e=>{e.uiForceUpdate()}):e[t].uiForceUpdate()}__uiDestroyComponents(e){for(let t of Object.keys(e))Array.isArray(e[t])?e[t].forEach(e=>{e.uiDestroy()}):e[t].uiDestroy()}__uiClearDom(){for(;this._dom.root.firstChild;)this._dom.root.removeChild(this._dom.root.firstChild)}}var ys={CLICK_ON_LIVE:"click-on-live",CLICK_ON_CLICKTHROUGH_LINK:"click-on-clickthrough-link",CLICK_ON_SKIP_VIDEO:"click-on-skip-video",CLICK_ON_CANCEL_AD:"click-on-cancel-ad",CLICK_ON_INJECTION:"click-on-injection",CLICK_ON_ACTION_AREA:"click-on-action-area",CLICK_ON_BACK:"click-on-back",CLICK_ON_CONTENT_LINK:"click-on-content-link",CLOSE_INJECTION:"close-injection",ERROR_INJECTION:"error-injection",CLOSE_QUALITY_MENU_REQUEST:"close-quality-menu-request",CLOSE_SUBTITLES_MENU_REQUEST:"close-subtitles-menu-request",CLOSE_SETTINGS_MENU_REQUEST:"close-settings-menu-request",CLOSE_ADDITIONAL_MENU_REQUEST:"close-additional-menu-request",CLOSE_AUDIO_TRACK_MENU_REQUEST:"close-audio-track-menu-request",CLOSE_VIDEO_TRACK_MENU_REQUEST:"close-video-track-menu-request",CLOSE_CAST_MENU_REQUEST:"close-cast-menu-request",CTRL_PANEL_HOVERED:"ctrl-panel-hovered",HIDE_CONTROL_PANEL:"hide-ctrl-panel",SHOW_CONTROL_PANEL:"show-ctrl-panel",END_SEEKING:"end-seeking",FS_ON_REQUEST:"fs-on-request",FS_OFF_REQUEST:"fs-off-request",PIP_ON_REQUEST:"pip-on-request",PIP_OFF_REQUEST:"pip-off-request",CINEMA_ON_REQUEST:"cinema-on-request",CINEMA_OFF_REQUEST:"cinema-off-request",AP_ON_REQUEST:"ap-on-request",CHANGE_QUALITY_REQUEST:"change-quality-request",CHANGE_SUBTITLES_REQUEST:"change-subtitles-request",CHANGE_AUDIO_TRACK_REQUEST:"change-audio-track-request",CHANGE_VIDEO_TRACK_REQUEST:"change-video-track-request",TOGGLE_SUBTITLES_REQUEST:"toggle-subtitles-request",MOVE_CURRENT_TIME_TO:"move-current-time-to",OPEN_QUALITY_MENU_REQUEST:"open-quality-menu-request",OPEN_SUBTITLES_MENU_REQUEST:"open-subtitles-menu-request",OPEN_SETTINGS_MENU_REQUEST:"open-settings-menu-request",OPEN_ADDITIONAL_MENU_REQUEST:"open-additional-menu-request",OPEN_AUDIO_TRACK_MENU_REQUEST:"open-audio-track-menu-request",OPEN_VIDEO_TRACK_MENU_REQUEST:"open-video-track-menu-request",OPEN_CAST_MENU_REQUEST:"open-cast-menu-request",PLAY_REQUEST:"play-request",PAUSE_REQUEST:"pause-request",REPLAY_REQUEST:"replay-request",START_SEEKING:"start-seeking",SEEK_TO:"seek-to",VOLUME_CHANGE_TO:"volume-change-to",VOLUME_MUTE_CLICK:"volume-mute-click",COMPONENT_SHOWN:"component-shown",COMPONENT_ALL_HIDE:"component-all-hide"};class vs extends fs{constructor(e){super(e),this._dom={root:null,refs:{videoWrapper:null}}}uiGetDeclaredProps(){return{displayed:"boolean",elm:"object",controlsEnabled:"boolean"}}_onUiBuild(e){this._dom.root=es("div",{className:"w-Ui-Tech"}),this._dom.refs.videoWrapper=es("div",{className:"w-Ui-TechVideo"}),ts(this._dom.root).append(this._dom.refs.videoWrapper),e.elm&&(this.__setControlsEnabled(e.elm,e.controlsEnabled),ts(this._dom.refs.videoWrapper).append(e.elm)),this.__setDisplayed(e.displayed)}_onUiCanUpdate(e){return this._props.elm!=e.elm||this._props.controlsEnabled!=e.controlsEnabled||this._props.displayed!=e.displayed}_onUiUpdate(e){this._props.displayed!=e.displayed&&this.__setDisplayed(e.displayed),this._props.elm!=e.elm?(this._props.elm&&this._dom.refs.videoWrapper.removeChild(this._props.elm),e.elm&&ts(this._dom.refs.videoWrapper).append(e.elm),this.__setControlsEnabled(e.elm,e.controlsEnabled)):this._props.controlsEnabled!=e.controlsEnabled&&this.__setControlsEnabled(e.elm,e.controlsEnabled)}__setDisplayed(e){ts(this._dom.root).setDisplayed(e)}__setControlsEnabled(e,t){if(!e)return;let i=null;"VIDEO"===e.tagName?i=e:"function"==typeof e.querySelector&&(i=e.querySelector("video")),i&&"controls"in i&&(i.controls=t)}}class As extends fs{constructor(e){super(e),this._dom={root:null,refs:{img:null}}}uiGetDeclaredProps(){return{className:"string",displayed:"boolean",src:"string"}}uiGetDefaultProps(){return{className:"c-Ui-OvelayElement",displayed:!1,src:""}}_onUiBuild(e){this._dom.root=es("span",{className:`c-Ui-OvelayElement ${e.className}`}),this._dom.refs.img=es("img",{src:e.src}),ts(this._dom.root).append(this._dom.refs.img),this.__setDisplayed(e.displayed&&e.src)}_onUiUpdate(e){this._props.src!==e.src&&this._dom.refs.img.setAttribute("src",e.src),this._props.displayed===e.displayed&&this._props.src===e.src||this.__setDisplayed(e.displayed&&e.src)}__setDisplayed(e){ts(this._dom.root).setDisplayed(e)}}class Ss extends fs{constructor(e){super(e),this._dom={root:null,refs:{iconContainer:null,liveText:null}}}uiGetDeclaredProps(){return{textLive:"string",ppVisible:"boolean",displayed:"boolean"}}uiGetDefaultProps(){return{displayed:!1,ppVisible:!1,textLive:""}}_onUiBuild(e){this._dom.root=es("span",{className:"c-Ui-LogoLive"}),this._dom.refs.liveText=es("span",{className:"c-Ui-LogoLive__text"}),ts(this._dom.root).append(this._dom.refs.liveText),this.__setDisplayed(e.displayed),this.__setPpClass(e.ppVisible),this.__setTextLive(e.textLive)}_onUiCanUpdate(e){return e.displayed||this._props.displayed!==e.displayed}_onUiUpdate(e){this._props.displayed!==e.displayed&&this.__setDisplayed(e.displayed),this._props.textLive!==e.texLive&&this.__setTextLive(e.textLive),this._props.ppVisible!==e.ppVisible&&this.__setPpClass(e.ppVisible)}__setDisplayed(e){ts(this._dom.root).setDisplayed(e)}__setTextLive(e){this._dom.refs.liveText.innerHTML=e}__setPpClass(e){ts(this._dom.root).cssClasses({"-pp-active":e})}}const bs=24,Cs={LEFT:"left",RIGHT:"right",CENTER:"center",START:"start",END:"end"},Ps={HORIZONTAL_LEFT_TO_RIGHT:"horizontal-tb",VERTICAL_LEFT_TO_RIGHT:"vertical-lr",VERTICAL_RIGHT_TO_LEFT:"vertical-rl"},ks={CENTER:"center",START:"start",END:"end"};class Is extends fs{constructor(e){super(e),this._dom={root:null,refs:{regionDefault:null,regions:{}}}}uiGetDeclaredProps(){return{displayed:"boolean",cues:"object",regions:"object"}}uiGetDefaultProps(){return{displayed:!1,cues:[],regions:[]}}_onUiBuild(e){this._dom.root=es("div",{className:"c-Ui-Captions"}),this._dom.refs.regionDefault=es("div",{id:"captionsDefaultRegion",className:"w-Ui-CaptionsRegion"}),ts(this._dom.root).append(this._dom.refs.regionDefault),this.__setDisplayed(e.displayed)}_onUiUpdate(e){this._props.displayed!==e.displayed&&this.__setDisplayed(e.displayed),JSON.stringify(this._props.regions)!==JSON.stringify(e.regions)&&this.__manageRegions(e.regions),JSON.stringify(this._props.cues)!==JSON.stringify(e.cues)&&this.__manageCues(e.cues)}__setDisplayed(e){ts(this._dom.root).setDisplayed(e)}__manageCues(e){ts(this._dom.refs.regionDefault).clear(),Object.keys(this._dom.refs.regions).forEach(e=>{ts(this._dom.refs.regions[e]).clear()}),e.forEach(e=>{const t=this.__calculateCueBoxSize(e),i=this.__calculateCueBoxPosition(e),s=this.__verticalTextAlign(e),n={textAlign:e.getTextAlign()},o={writingMode:e.getWritingDirection()};Object.assign(n,t,i),Object.assign(o,s);const r=es("div",{id:e.getId(),className:"w-Ui-CaptionsCueBox",style:n}),a=e.getPayload();ts(r).append(es("div",{className:"w-Ui-CaptionsCue",innerHTML:a.text,style:o}));const l=e.getRegion();null!==l&&l in this._dom.refs.regions?ts(this._dom.refs.regions[l]).append(r):ts(this._dom.refs.regionDefault).append(r)})}__manageRegions(e){ts(this._dom.root).clear(),this._dom.refs.regions={},ts(this._dom.root).append(ts(this._dom.refs.regionDefault),e.map(e=>{const t=e.getAnchorUnits(),i=e.getHeight(),s=e.getHeightUnits(),n=e.getWidth(),o=e.getWidthUnits(),r=e.getRegionAnchors(),a=e.getViewportAnchors(),l=`translate(\n\t\t\t\t\t-${r.x}${t},\n\t\t\t\t\t-${r.y}${t}\n\t\t\t\t)`,h={height:s.length>0?`${i}${s}`:bs*i+"px",width:`${n}${o}`,top:`${a.y}${t}`,left:`${a.x}${t}`,transform:`${l}`},_=e.getId(),d=es("div",{id:_,className:"w-Ui-CaptionsRegion",style:h});return this._dom.refs.regions[_]=d,d}))}__calculateCueBoxPosition(e){const t=e.isVertical();let i=this.__calculateLineAlign(e);const s=e.getTextAlign();let n=e.getPosition();null===n&&(n=s===Cs.LEFT?0:s===Cs.RIGHT?100:50);const o=e.getSnapToLine();let r=e.getLine();const a=e.getLineInterpretation();let l=!1;r<0&&(r=-r-1,i-=100,l=!0);const h={};return h[t?l?"right":"left":l?"bottom":"top"]=`${o?r*bs:r}${a}`,t?Object.assign({top:`${n}%`,transform:`translate(${-i}%, -${n}%)`,textAlign:"initial",position:"absolute"},h):Object.assign({left:`${n}%`,transform:`translate(-${n}%, ${-i}%)`,position:"absolute"},h)}__calculateCueBoxSize(e){const t=e.getSize();return e.isVertical()?{height:`${t}%`}:{width:`${t}%`}}__calculateLineAlign(e){const t=e.getWritingDirection(),i=e.getLineAlign();let s=0;return t===Ps.VERTICAL_LEFT_TO_RIGHT?i===ks.END&&(s=100):t===Ps.VERTICAL_RIGHT_TO_LEFT?i===ks.START&&(s=100):i===ks.START?s=0:i===ks.END&&(s=100),i===ks.CENTER&&(s=50),s}__verticalTextAlign(e){if(e.isVertical()){const t=e.getTextAlign();let i=null;return i=t===Cs.LEFT?{top:"0%",transform:"translateY(0%)"}:t===Cs.RIGHT?{top:"100%",transform:"translateY(-100%)"}:{top:"50%",transform:"translateY(-50%)"}}return{}}}let ws=new m.ErrorFactory(m.createSourceName("src/js/common/uiIcon.js"));function Ns(e,t=null){const i=function(e){let t="";switch(e){case"cross":t="m1.6704 0c-0.42718 0-0.85554 0.16439-1.1815 0.49032-0.65186 0.65186-0.65186 1.7085 0 2.3603l10.151 10.151-10.151 10.151c-0.65186 0.65186-0.65186 1.7085 0 2.3603 0.65186 0.65186 1.7085 0.65186 2.3603 0l10.151-10.151 10.151 10.151c0.65186 0.65186 1.7085 0.65186 2.3603 0 0.65186-0.65186 0.65186-1.7085 0-2.3603l-10.151-10.151 10.151-10.151c0.65186-0.65186 0.65186-1.7085 0-2.3603-0.65186-0.65186-1.7085-0.65186-2.3603 0l-10.151 10.151-10.151-10.151c-0.32593-0.32593-0.75168-0.49032-1.1789-0.49032z";break;case"top":t="m17.413 17.614c-0.22573-1.3178 0.21061-2.6624 1.1668-3.5957l2.5247-2.4641-3.4891-0.50764c-1.3214-0.19226-2.4638-1.0233-3.0548-2.2222l-1.5604-3.1657-1.5604 3.1657c-0.59097 1.199-1.7333 2.03-3.0548 2.2222l-3.4891 0.50764 2.5247 2.4641c0.95621 0.93326 1.3925 2.2779 1.1668 3.5957l-0.59601 3.4794 3.6601-1.9267c0.84424-0.44441 1.8528-0.44441 2.6971 0l3.6601 1.9267zm-4.4127 4.121-6.7786 3.5682c-0.56666 0.29829-1.2675 0.080149-1.5654-0.48723-0.11863-0.22593-0.15957-0.48472-0.11647-0.7363l1.1916-6.9562c0.064494-0.37651-0.060173-0.76069-0.33338-1.0273l-5.0476-4.9264c-0.45844-0.44743-0.46782-1.1823-0.020952-1.6413 0.17794-0.18278 0.4111-0.30174 0.66338-0.33844l6.9756-1.0149c0.37756-0.054934 0.70394-0.29237 0.87279-0.63492l3.1196-6.329c0.28333-0.57482 0.9784-0.81082 1.5525-0.52713 0.2286 0.11297 0.41364 0.29824 0.52646 0.52713l3.1196 6.329c0.16885 0.34256 0.49523 0.57999 0.87279 0.63492l6.9756 1.0149c0.63354 0.092178 1.0725 0.68114 0.98044 1.3155-0.03666 0.2526-0.15546 0.48606-0.33801 0.66423l-5.0476 4.9264c-0.2732 0.26664-0.39787 0.65082-0.33338 1.0273l1.1916 6.9562c0.10822 0.63179-0.31556 1.2318-0.94654 1.3402-0.25126 0.04314-0.50972 0.0022-0.73537-0.11662z";break;case"chapters":t="M 24.037895,19.506461 V 1.3245503 c 0,-0.71725658 -0.580712,-1.29870798 -1.297057,-1.29870798 H 7.1761451 C 5.759774,-0.12297318 4.3519914,0.37631602 3.3449669,1.3846217 2.3379423,2.3929274 1.8392875,3.8025009 1.987914,5.2206739 V 22.103877 C 1.987914,24.255647 3.7300516,26 5.8790873,26 H 22.740838 c 0.716345,0 1.297057,-0.581451 1.297057,-1.298707 0,-0.717257 -0.580712,-1.298708 -1.297057,-1.298708 v -2.597416 c 0.716345,0 1.297057,-0.581452 1.297057,-1.298708 z M 7.1761451,2.6232582 H 12.364376 V 13.012922 l 2.594116,-1.298708 2.594115,1.298708 V 2.6232582 H 21.44378 V 18.207753 H 5.8790873 c -0.4424825,0.0036 -0.8811251,0.08257 -1.2970577,0.233767 V 5.2206739 c 0,-1.8701393 0.7263523,-2.5974157 2.5941155,-2.5974157 z M 20.146722,23.402585 H 5.8790873 c -0.7163452,0 -1.2970577,-0.581452 -1.2970577,-1.298708 0,-0.717257 0.5807125,-1.298707 1.2970577,-1.298707 H 20.146722 Z";break;case"about":t="m4.3333 0.8125c-2.3932 0-4.3333 1.9401-4.3333 4.3333v10.833c0 2.3932 1.9401 4.3333 4.3333 4.3333h17.333c2.3932 0 4.3333-1.9401 4.3333-4.3333v-10.833c0-2.3932-1.9401-4.3333-4.3333-4.3333zm0 2.7083h17.333c0.89746 0 1.625 0.72754 1.625 1.625v10.833c0 0.89746-0.72754 1.625-1.625 1.625h-17.333c-0.89746 0-1.625-0.72754-1.625-1.625v-10.833c0-0.89746 0.72754-1.625 1.625-1.625zm3.7917 19.5c-0.59831 0-1.0833 0.48502-1.0833 1.0833 0 0.59831 0.48502 1.0833 1.0833 1.0833h10.833c0.59831 1e-6 1.0833-0.48502 1.0833-1.0833 0-0.59831-0.48502-1.0833-1.0833-1.0833z";break;case"episodes":t="m3.512 3.2302c-1.9396 0-3.512 1.5741-3.512 3.5162v8.132c0 1.9421 1.5724 3.5162 3.512 3.5162h3.5774v0.859c0 1.9421 1.5724 3.5162 3.512 3.5162h11.887c1.9396 0 3.512-1.5741 3.512-3.5162v-7.5727c0-1.9421-1.5724-3.5162-3.512-3.5162h-3.7104v-1.4183c0-1.9421-1.5724-3.5162-3.512-3.5162zm0 2.7057h11.754c0.4476 0 0.81046 0.36228 0.81046 0.81046v1.4183h-5.4748c-1.9396 0-3.512 1.5741-3.512 3.5162v4.008h-3.5774c-0.4476 0-0.81046-0.36228-0.81046-0.81046v-8.132c0-0.44817 0.36285-0.81046 0.81046-0.81046zm7.0894 4.9324h11.887c0.4476 0 0.81046 0.3644 0.81046 0.81257v7.5727c0 0.44817-0.36285 0.81257-0.81046 0.81257h-11.887c-0.4476 0-0.81046-0.3644-0.81046-0.81257v-7.5727c0-0.44817 0.36285-0.81257 0.81046-0.81257z";break;case"burger":t="m 1.4897879,1.4897878 a 1.4390201,1.4390201 0 1 0 0,2.8780403 H 24.510212 a 1.4390202,1.4390202 0 1 0 0,-2.8780403 z m 0,10.0721672 a 1.4389439,1.4389439 0 1 0 0,2.87609 H 24.510212 a 1.4389439,1.4389439 0 1 0 0,-2.87609 z m 0,10.070217 a 1.4390201,1.4390201 0 1 0 0,2.87804 H 24.510212 a 1.4390201,1.4390201 0 1 0 0,-2.87804 z";break;case"fullscreen-off":t="m6.1995 7.8546-5.7633-5.7633c-0.47843-0.47843-0.47843-1.2541 0-1.7325 0.47843-0.47843 1.2541-0.47843 1.7325 0l5.6859 5.6859v-3.8255c0-0.6766 0.54849-1.2251 1.2251-1.2251 0.6766 0 1.2251 0.54849 1.2251 1.2251v4.9004c0 1.7592-1.4261 3.1852-3.1852 3.1852h-4.9004c-0.6766 0-1.2251-0.54849-1.2251-1.2251 0-0.6766 0.54849-1.2251 1.2251-1.2251zm13.601 10.291l5.7633 5.7633c0.47843 0.47843 0.47843 1.2541 0 1.7325-0.47843 0.47843-1.2541 0.47843-1.7325 0l-5.6859-5.6859v3.8255c0 0.6766-0.54849 1.2251-1.2251 1.2251s-1.2251-0.54849-1.2251-1.2251v-4.9004c0-1.7592 1.4261-3.1852 3.1852-3.1852h4.9004c0.6766 0 1.2251 0.54849 1.2251 1.2251 0 0.6766-0.54849 1.2251-1.2251 1.2251zm-11.946 1.8099-5.6859 5.6859c-0.47843 0.47843-1.2541 0.47843-1.7325 0-0.47843-0.47843-0.47843-1.2541 0-1.7325l5.7633-5.7633h-3.9803c-0.6766 0-1.2251-0.54849-1.2251-1.2251 0-0.6766 0.54849-1.2251 1.2251-1.2251h4.9004c1.7592 0 3.1852 1.4261 3.1852 3.1852v4.9004c0 0.6766-0.54849 1.2251-1.2251 1.2251-0.6766 0-1.2251-0.54849-1.2251-1.2251zm10.291-13.911 5.6859-5.6859c0.47843-0.47843 1.2541-0.47843 1.7325 0 0.47843 0.47843 0.47843 1.2541 0 1.7325l-5.7633 5.7633h3.9803c0.6766 0 1.2251 0.54849 1.2251 1.2251 0 0.6766-0.54849 1.2251-1.2251 1.2251h-4.9004c-1.7592 0-3.1852-1.4261-3.1852-3.1852v-4.9004c0-0.6766 0.54849-1.2251 1.2251-1.2251s1.2251 0.54849 1.2251 1.2251z";break;case"fullscreen-on":t="m2.5381 21.656 5.7983-5.7983c0.48789-0.48789 1.2789-0.48789 1.7668 0 0.48788 0.48788 0.48788 1.2789 0 1.7668l-5.8772 5.8772h4.059c0.68997 0 1.2493 0.55934 1.2493 1.2493 0 0.68997-0.55934 1.2493-1.2493 1.2493h-4.9972c-1.7939 0-3.2482-1.4543-3.2482-3.2482v-4.9972c0-0.68998 0.55934-1.2493 1.2493-1.2493 0.68998 0 1.2493 0.55934 1.2493 1.2493zm20.924-17.311-5.7983 5.7983c-0.48789 0.48789-1.2789 0.48789-1.7668 0-0.48789-0.48789-0.48789-1.2789 0-1.7668l5.8772-5.8772h-4.059c-0.68998 0-1.2493-0.55934-1.2493-1.2493 0-0.68997 0.55934-1.2493 1.2493-1.2493h4.9972c1.7939 0 3.2482 1.4543 3.2482 3.2482v4.9972c0 0.68998-0.55934 1.2493-1.2493 1.2493s-1.2493-0.55934-1.2493-1.2493zm-19.236-1.8457 5.8772 5.8772c0.48788 0.48789 0.48788 1.2789 0 1.7668-0.48789 0.48789-1.2789 0.48789-1.7668 0l-5.7983-5.7983v3.9011c0 0.68998-0.55934 1.2493-1.2493 1.2493-0.68997 0-1.2493-0.55934-1.2493-1.2493v-4.9972c0-1.7939 1.4543-3.2482 3.2482-3.2482h4.9972c0.68997 0 1.2493 0.55934 1.2493 1.2493 0 0.68998-0.55934 1.2493-1.2493 1.2493zm17.548 21.003-5.8772-5.8772c-0.48789-0.48789-0.48789-1.2789 0-1.7668 0.48788-0.48789 1.2789-0.48789 1.7668 0l5.7983 5.7983v-3.9011c0-0.68998 0.55934-1.2493 1.2493-1.2493s1.2493 0.55934 1.2493 1.2493v4.9972c0 1.7939-1.4543 3.2482-3.2482 3.2482h-4.9972c-0.68998 0-1.2493-0.55934-1.2493-1.2493 0-0.68998 0.55934-1.2493 1.2493-1.2493z";break;case"pip-on":t="m4 0c-2.2091 0-4 1.7909-4 4v18c0 2.2091 1.7909 4 4 4h18c2.2091 0 4-1.7909 4-4v-8.1875-9.8125c0-2.2091-1.7909-4-4-4h-9.8125-8.1875zm0 2.5h8.1875v7.3125c0 2.2091 1.7909 4 4 4h7.3125v8.1875c0 0.82843-0.67157 1.5-1.5 1.5h-18c-0.82843 0-1.5-0.67157-1.5-1.5v-18c0-0.82843 0.67157-1.5 1.5-1.5zm10.688 0h7.3125c0.82843 0 1.5 0.67157 1.5 1.5v7.3125h-7.3125c-0.82843 0-1.5-0.67157-1.5-1.5v-7.3125z";break;case"pip-off":t="m4 0c-2.2091 0-4 1.7909-4 4v18c0 2.2091 1.7909 4 4 4h18c2.2091 0 4-1.7909 4-4v-8.1875-9.8125c0-2.2091-1.7909-4-4-4h-9.8125-8.1875zm10.688 2.5h7.3125c0.82843 0 1.5 0.67157 1.5 1.5v7.3125h-7.3125c-0.82843 0-1.5-0.67157-1.5-1.5v-7.3125z";break;case"cinema-on":t="m26 10v12c0 2.2093-1.7907 4-4 4h-18c-2.2093 0-4-1.7907-4-4v-18c0-2.2093 1.7907-4 4-4h18c2.2093 0 4 1.7907 4 4zm-2.5 0v-6c0-0.828-0.672-1.5-1.5-1.5h-18c-0.828 0-1.5 0.672-1.5 1.5v18c0 0.828 0.672 1.5 1.5 1.5h18c0.828 0 1.5-0.672 1.5-1.5z";break;case"cinema-off":t="m4 0c-2.2091 0-4 1.7909-4 4v18c0 2.2091 1.7909 4 4 4h18c2.2091 0 4-1.7909 4-4v-18c0-2.2091-1.7909-4-4-4zm0 2.5h18c0.8284 0 1.5 0.6716 1.5 1.5v6.5h-21v-6.5c0-0.10355 0.011268-0.20509 0.03125-0.30273 0.13987-0.68351 0.7439-1.1973 1.4688-1.1973zm-1.5 10.5h21v9c0 0.8284-0.6716 1.5-1.5 1.5h-18c-0.8284 0-1.5-0.6716-1.5-1.5zm3.4648 2c-0.533 0-0.96484 0.4477-0.96484 1s0.43184 1 0.96484 1h9.0176c0.533 0 0.96484-0.4477 0.96484-1s-0.43184-1-0.96484-1zm-0.00781 4c-0.5291 0-0.95703 0.4477-0.95703 1s0.42783 1 0.95703 1h14.086c0.5291 0 0.95703-0.4477 0.95703-1s-0.42793-1-0.95703-1z";break;case"airplay-off":t="m4.0016 0.46973c-2.2087 0-4.0016 1.789-4.0016 3.999v11.164c0 2.2087 1.7929 3.999 4.0016 3.999h1.2061l1.9246-2.4984h-3.1307c-0.8281 0-1.5006-0.67249-1.5006-1.5006v-11.164c0-0.8294 0.67249-1.498 1.5006-1.498h17.999c0.8281 0 1.5006 0.66865 1.5006 1.498v11.164c0 0.8281-0.67249 1.5006-1.5006 1.5006h-3.1357l1.9297 2.4984h1.2061c2.2087 0 3.999-1.7903 3.999-3.999v-11.164c0-2.21-1.7903-3.999-3.999-3.999zm8.9146 13.401c-0.16494 0.0213-0.32179 0.10394-0.43164 0.24629l-7.9904 10.367c-0.0884 0.1144-0.13457 0.2531-0.13457 0.3961 0 0.3588 0.2912 0.65 0.65 0.65h15.981c0.1443 0 0.28169-0.04748 0.39609-0.13457 0.2834-0.2197 0.3365-0.62812 0.11679-0.91152l-7.9879-10.367c-0.0338-0.0442-0.07514-0.08169-0.11934-0.11679-0.1417-0.1092-0.31495-0.15078-0.47988-0.12949z";break;case"airplay-on":t="";break;case"chromecast-off":t="m3.8519 0h18.296c2.1272 0 3.8519 1.7254 3.8519 3.8535v18.293c0 2.1281-1.7247 3.8535-3.8519 3.8535h-7.7037v-2.4084h7.7037c0.7983 0 1.4444-0.64642 1.4444-1.4451v-18.313c0-0.79864-0.64615-1.4451-1.4444-1.4451h-18.296c-0.7983 0-1.4444 0.64642-1.4444 1.4451v7.7161h-2.4074v-7.6959c0-2.1281 1.7247-3.8535 3.8519-3.8535zm-3.8519 13.476c6.9141 0 12.519 5.6068 12.519 12.524h-1.9259c0-5.8535-4.7416-10.597-10.593-10.597zm6.7407 12.524c0-3.7244-3.0179-6.7436-6.7407-6.7436v-1.9267c4.7869 0 8.6667 3.8814 8.6667 8.6704zm-6.7407-4.8169c2.6587 0 4.8148 2.157 4.8148 4.8169h-4.8148z";break;case"chromecast-on":t="m3.8519 0h18.296c2.1272 0 3.8519 1.7242 3.8519 3.8508v18.298c0 2.1266-1.7247 3.8508-3.8519 3.8508h-7.7037v-2.4067h7.7037c0.7983 0 1.4444-0.64596 1.4444-1.444v-18.319c0-0.79807-0.64615-1.444-1.4444-1.444h-18.296c-0.7983 0-1.4444 0.64596-1.4444 1.444v7.7291h-2.4074v-7.7089c0-2.1266 1.7247-3.8508 3.8519-3.8508zm-3.8519 13.485c6.9141 0 12.519 5.6028 12.519 12.515h-1.9259c0-5.8493-4.7416-10.59-10.593-10.59zm6.7407 12.515c0-3.7218-3.0179-6.7388-6.7407-6.7388v-1.9254c4.7869 0 8.6667 3.8787 8.6667 8.6642zm-6.7407-4.8134c2.6587 0 4.8148 2.1555 4.8148 4.8134h-4.8148zm14.003-0.01829c-1.1968-4.4696-4.7176-7.9894-9.1885-9.1859v-7.169h16.37v16.355z";break;case"pause":t="m4.2677 2.9545v20.091h3.2829v-20.091zm-0.59091-2.9545h4.4647c1.3053 0 2.3636 1.0582 2.3636 2.3636v21.273c0 1.3054-1.0583 2.3636-2.3636 2.3636h-4.4647c-1.3054 0-2.3636-1.0582-2.3636-2.3636v-21.273c0-1.3054 1.0582-2.3636 2.3636-2.3636zm14.773 2.9545v20.091h3.2829v-20.091zm-0.59091-2.9545h4.4647c1.3053 0 2.3636 1.0582 2.3636 2.3636v21.273c0 1.3054-1.0583 2.3636-2.3636 2.3636h-4.4647c-1.3054 0-2.3636-1.0582-2.3636-2.3636v-21.273c0-1.3054 1.0582-2.3636 2.3636-2.3636z";break;case"play":t="m6.9196 4.4411v17.118l12.838-8.5589zm-1.104-4.2449 17.748 11.832c0.53666 0.35777 0.68168 1.0829 0.3239 1.6195-0.08552 0.12829-0.19561 0.23838-0.3239 0.3239l-17.748 11.832c-0.53666 0.35778-1.2617 0.21276-1.6195-0.3239-0.12789-0.19184-0.19614-0.41724-0.19614-0.64781v-23.664c0-0.64499 0.52287-1.1679 1.1679-1.1679 0.23056 0 0.45597 0.068247 0.64781 0.19614z";break;case"previous":t="m5.9222 26c-0.79774 0-1.4444-0.6467-1.4444-1.4444v-23.111c0-0.79774 0.6467-1.4444 1.4444-1.4444 0.79774 0 1.4444 0.6467 1.4444 1.4444v9.0142l12.278-9.8222c0.49835-0.39868 1.2263-0.31779 1.625 0.18056 0.16392 0.2049 0.25278 0.45757 0.25278 0.71996v22.926c0 0.6382-0.51736 1.1556-1.1556 1.1556-0.26239 0-0.51733-0.08886-0.72222-0.25278l-12.278-9.8245v9.0142c0 0.79774-0.6467 1.4444-1.4444 1.4444zm12.711-5.1436v-15.713l-9.82 7.8564z";break;case"next":t="m20.078-4.5e-7c-0.79774 0-1.4444 0.6467-1.4444 1.4444v9.0142l-12.278-9.8245c-0.2049-0.16392-0.45983-0.25278-0.72222-0.25278-0.6382 0-1.1556 0.51736-1.1556 1.1556v22.926c0 0.26239 0.088862 0.51733 0.25278 0.72222 0.39868 0.49835 1.1267 0.57923 1.625 0.18056l12.278-9.8245v9.0142c0 0.79774 0.6467 1.4444 1.4444 1.4444s1.4444-0.6467 1.4444-1.4444v-23.111c0-0.79774-0.6467-1.4444-1.4444-1.4444zm-12.711 5.1436 9.82 7.8564-9.82 7.8564z";break;case"settings":t="m11.598 1.3081e-4a2.0526 2.0526 0 0 0 -1.9439 1.5484l-0.29756 1.1795-1.078 0.43832-1.0477-0.62719a2.0526 2.0526 0 0 0 -2.5034 0.30825l-1.9172 1.9136a2.0526 2.0526 0 0 0 -0.31538 2.4999l0.6361 1.0726-0.39734 0.99067-1.2098 0.3225a2.0526 2.0526 0 0 0 -1.5234 1.9831v2.7511a2.0526 2.0526 0 0 0 1.5074 1.9796l1.2312 0.33854 0.39021 0.93722-0.63432 1.0887a2.0526 2.0526 0 0 0 0.37596 2.5355l2.0669 1.9243a2.0526 2.0526 0 0 0 2.4197 0.27618l1.0602-0.60937 0.93544 0.39378 0.30112 1.2027a2.0526 2.0526 0 0 0 1.992 1.5519h2.7083a2.0526 2.0526 0 0 0 1.992 -1.5537l0.29934-1.1956 0.98711-0.40803 1.2027 0.64679a2.0526 2.0526 0 0 0 2.4179 -0.34923l1.9172-1.8994a2.0526 2.0526 0 0 0 0.31894 -2.507l-0.65035-1.0922 0.40981-0.939 1.2419-0.3421a2.0526 2.0526 0 0 0 1.5092 -1.9796v-2.7511a2.0526 2.0526 0 0 0 -1.5234 -1.9831l-1.2223-0.32607-0.41694-0.99068 0.64144-1.0584a2.0526 2.0526 0 0 0 -0.30112 -2.5123l-1.9083-1.9172a2.0526 2.0526 0 0 0 -2.4624 -0.34032l-1.176 0.66283-0.98355-0.42228-0.30112-1.192a2.0526 2.0526 0 0 0 -1.9903 -1.5502h-2.7119a2.0526 2.0526 0 0 0 -0.04633 0zm0.2245 2.2807h2.3555l0.28687 1.1297a2.0526 2.0526 0 0 0 1.1795 1.3827l1.1885 0.51137a2.0526 2.0526 0 0 0 1.8192 -0.097999l1.1243-0.63254 1.6606 1.6678-0.61115 1.0067a2.0526 2.0526 0 0 0 -0.13542 1.862l0.50781 1.2009a2.0526 2.0526 0 0 0 1.3613 1.1849l1.1599 0.30825v2.4019l-1.1795 0.32607a2.0526 2.0526 0 0 0 -1.3381 1.1564l-0.4989 1.1457a2.0526 2.0526 0 0 0 0.11582 1.8727l0.62006 1.0406-1.6695 1.6553-1.1475-0.62006a2.0526 2.0526 0 0 0 -1.7586 -0.08909l-1.1938 0.49177a2.0526 2.0526 0 0 0 -1.2063 1.3987l-0.28509 1.135h-2.3555l-0.28687-1.1403a2.0526 2.0526 0 0 0 -1.1938 -1.3916l-1.1439-0.48108a2.0526 2.0526 0 0 0 -1.8192 0.11225l-1.0103 0.58086-1.8103-1.6838 0.59868-1.0281a2.0526 2.0526 0 0 0 0.12116 -1.8228l-0.47574-1.1457a2.0526 2.0526 0 0 0 -1.3506 -1.1902l-1.1706-0.32072v-2.4036l1.1493-0.30647a2.0526 2.0526 0 0 0 1.3755 -1.217l0.48286-1.1991a2.0526 2.0526 0 0 0 -0.1372 -1.8139l-0.60403-1.0174 1.6642-1.6624 0.99424 0.59334a2.0526 2.0526 0 0 0 1.8246 0.14076l1.29-0.52385a2.0526 2.0526 0 0 0 1.217 -1.3969zm1.1778 6.6443c-2.2505 0-4.075 1.8245-4.075 4.075s1.8245 4.075 4.075 4.075c2.2505 0 4.075-1.8245 4.075-4.075s-1.8245-4.075-4.075-4.075zm0 1.8246c1.2428 0 2.2504 1.0076 2.2504 2.2504 0 1.2428-1.0076 2.2504-2.2504 2.2504-1.2428 0-2.2504-1.0076-2.2504-2.2504 0-1.2428 1.0076-2.2504 2.2504-2.2504z";break;case"captions-on":t="m 24,0 c 1.104569,0 2,0.8954305 2,2 v 17.78648 c 0,1.104569 -0.895431,2 -2,2 H 17 L 13,26 9,21.78648 H 2 c -1.1045695,0 -2,-0.895431 -2,-2 V 2 C 0,0.8954305 0.8954305,0 2,0 Z m -7,7.5 h 3 c 0.552285,0 1,-0.4477153 1,-1 0,-0.5522848 -0.447715,-1 -1,-1 h -3 c -0.552285,0 -1,0.4477152 -1,1 0,0.5522847 0.447715,1 1,1 z m -11,0 h 7 c 0.552285,0 1,-0.4477153 1,-1 0,-0.5522848 -0.447715,-1 -1,-1 H 6 c -0.5522848,0 -1,0.4477152 -1,1 0,0.5522847 0.4477152,1 1,1 z m 0,4 h 3 c 0.5522848,0 1,-0.447715 1,-1 0,-0.5522847 -0.4477152,-1 -1,-1 H 6 c -0.5522848,0 -1,0.4477153 -1,1 0,0.552285 0.4477152,1 1,1 z m 7,0 h 7 c 0.552285,0 1,-0.447715 1,-1 0,-0.5522847 -0.447715,-1 -1,-1 h -7 c -0.552285,0 -1,0.4477153 -1,1 0,0.552285 0.447715,1 1,1 z m -7,4 h 8.15163 c 0.552284,0 1,-0.447715 1,-1 0,-0.552285 -0.447716,-1 -1,-1 H 6 c -0.5522848,0 -1,0.447715 -1,1 0,0.552285 0.4477152,1 1,1 z";break;case"captions-off":t="M 13,22.368876 15.926196,19.28648 H 23.5 V 2.5 h -21 v 16.78648 h 7.573804 z M 24,0 c 1.104569,0 2,0.8954305 2,2 v 17.78648 c 0,1.104569 -0.895431,2 -2,2 H 17 L 13,26 9,21.78648 H 2 c -1.1045695,0 -2,-0.895431 -2,-2 V 2 C 0,0.8954305 0.8954305,0 2,0 Z m -7,7.5 c -0.552285,0 -1,-0.4477153 -1,-1 0,-0.5522848 0.447715,-1 1,-1 h 3 c 0.552285,0 1,0.4477152 1,1 0,0.5522847 -0.447715,1 -1,1 z m -11,0 c -0.5522848,0 -1,-0.4477153 -1,-1 0,-0.5522848 0.4477152,-1 1,-1 h 7 c 0.552285,0 1,0.4477152 1,1 0,0.5522847 -0.447715,1 -1,1 z m 0,4 c -0.5522848,0 -1,-0.447715 -1,-1 0,-0.5522847 0.4477152,-1 1,-1 h 3 c 0.5522848,0 1,0.4477153 1,1 0,0.552285 -0.4477152,1 -1,1 z m 7,0 c -0.552285,0 -1,-0.447715 -1,-1 0,-0.5522847 0.447715,-1 1,-1 h 7 c 0.552285,0 1,0.4477153 1,1 0,0.552285 -0.447715,1 -1,1 z m -7,4 c -0.5522848,0 -1,-0.447715 -1,-1 0,-0.552285 0.4477152,-1 1,-1 h 8.15163 c 0.552284,0 1,0.447715 1,1 0,0.552285 -0.447716,1 -1,1 z";break;case"reload":t="m24.716 17.59c-0.63748 1.792-1.6301 3.3816-2.9584 4.7108-4.587 4.5861-11.887 4.9402-16.88 0.88272-0.048773-0.04786-0.058678-0.05757-0.069286-0.07344-2.0508-1.6832-3.5288-3.9615-4.2058-6.5535-0.21273-0.8189 0.33658-1.6469 1.1743-1.775 0.7182-0.11049 1.4079 0.3352 1.5886 1.0352 0.56761 2.1904 1.8678 4.0853 3.6735 5.4115 2.0798 1.5257 4.6625 2.1799 7.2609 1.781 2.598-0.39881 4.8654-1.7962 6.3931-3.8733 4.4426-7.0626 0.27045-15.239-7.8656-15.532-2.1486 8.363e-4 -4.2314 0.70758-5.9498 2.0359l2.3805-0.00714c0.79018-0.00229 1.4322 0.63588 1.4345 1.4255 0.0023 0.79018-0.63588 1.4322-1.4255 1.4345l-5.6502 0.016798c-0.37775 0.0011492-0.74636-0.1502-1.0122-0.41607-0.26731-0.26502-0.42119-0.63262-0.42234-1.0095l-0.015864-5.6502c-0.00229-0.78977 0.63649-1.4324 1.4255-1.4336 0.78953-0.002289 1.4322 0.63616 1.4345 1.4255l0.00585 2.0154c1.6449-1.2909 3.5696-2.1383 5.6178-2.4949l0.25503-0.073277c1.8564-0.28453 3.7245-0.14392 5.5022 0.38742 6.9882 2.1773 10.52 9.4077 8.3084 16.33z";break;case"volume":t="m14.214 4.2125-8.2556 5.8552h-3.4587v5.9321h3.4549l8.2594 5.8238v-17.611zm-12.218 3.3552h3.1663l9.9736-7.0736s1.5786-1.1292 1.5786 0.0265v24.813c0 1.472-1.7935 0.0476-1.7935 0.0476l-9.7587-6.881h-3.1663c-1.0966 0-1.9958-0.8977-1.9958-2.0051v-6.9219c0-1.1105 0.8936-2.0051 1.9958-2.0051zm18.504 10.068c0 0.5523-0.4477 1-1 1s-1-0.4477-1-1v-9.5112c0-0.5523 0.4477-1 1-1s1 0.4477 1 1zm4.0625 3.4888c0 0.5523-0.4477 1-1 1s-1-0.4477-1-1v-16.25c0-0.5523 0.4477-1 1-1s1 0.4477 1 1z";break;case"mute":t="m16.215 0.0043115c-0.46248 0.048677-1.0781 0.49023-1.0781 0.49023l-9.9746 7.0742h-3.166c-1.1023 0-1.9961 0.89341-1.9961 2.0039v6.9219c0 1.1074 0.89945 2.0059 1.9961 2.0059h3.166l9.7598 6.8809s1.793 1.4252 1.793-0.04687v-24.813c0-0.43337-0.22252-0.54678-0.5-0.51758zm-2 4.209v17.611l-8.2598-5.8242h-3.4551v-5.9316h3.459zm5.7852 4.7871c-0.25592 0-0.51177 0.097707-0.70703 0.29297-0.39052 0.39052-0.39052 1.0235 0 1.4141l2.4746 2.4746-2.4746 2.4746c-0.39052 0.39052-0.39052 1.0235 0 1.4141 0.39052 0.39052 1.0235 0.39052 1.4141 0l2.4766-2.4746 2.4746 2.4746c0.39052 0.39052 1.0235 0.39052 1.4141 0 0.39052-0.39052 0.39052-1.0235 0-1.4141l-2.4746-2.4746 2.4746-2.4746c0.39052-0.39052 0.39052-1.0235 0-1.4141-0.39052-0.39052-1.0235-0.39052-1.4141 0l-2.4746 2.4746-2.4766-2.4746c-0.19526-0.19526-0.45111-0.29297-0.70703-0.29297z";break;case"pp":t="m-7.5e-8 20.657v-15.314h4.9618c1.8803 0 3.1059 0.076602 3.677 0.22981 0.87746 0.22981 1.6122 0.72947 2.2041 1.499s0.88791 1.7636 0.88791 2.9823c0 0.94014-0.17062 1.7305-0.51185 2.3712-0.34124 0.64069-0.77474 1.1438-1.3005 1.5094-0.52578 0.36561-1.0603 0.60761-1.6035 0.726-0.73819 0.14624-1.8071 0.21936-3.2069 0.21936h-2.0161v5.7766zm3.092-12.723v4.3455h1.6922c1.2187 0 2.0335-0.08008 2.4444-0.24026 0.41088-0.16017 0.73296-0.41087 0.96625-0.75211 0.23329-0.34124 0.34994-0.73818 0.34994-1.1908 0-0.55712-0.16365-1.0167-0.49096-1.3789-0.32731-0.36213-0.74166-0.58846-1.2431-0.67899-0.36909-0.069641-1.1108-0.10446-2.225-0.10446zm11.177 12.723v-15.314h4.9618c1.8803 0 3.1059 0.076602 3.677 0.22981 0.87746 0.22981 1.6122 0.72947 2.2041 1.499 0.59194 0.76952 0.88791 1.7636 0.88791 2.9823 0 0.94014-0.17062 1.7305-0.51185 2.3712-0.34124 0.64069-0.77474 1.1438-1.3005 1.5094-0.52578 0.36561-1.0603 0.60761-1.6035 0.726-0.73818 0.14624-1.8071 0.21936-3.2069 0.21936h-2.0161v5.7766zm3.092-12.723v4.3455h1.6922c1.2187 0 2.0335-0.08008 2.4444-0.24026 0.41088-0.16017 0.73296-0.41087 0.96625-0.75211 0.2333-0.34124 0.34994-0.73818 0.34994-1.1908 0-0.55712-0.16365-1.0167-0.49096-1.3789-0.32731-0.36213-0.74166-0.58846-1.2431-0.67899-0.36909-0.069635-1.1107-0.10447-2.225-0.10447z";break;case"info":t="m10.4 5.2v-5.2h5.2v5.2zm0 20.8v-19.067h5.2v19.067z";break;case"info-round":t="m13 5.625e-8c-7.15 0-13 5.85-13 13 0 7.15 5.85 13 13 13 7.15 0 13-5.85 13-13 0-7.15-5.85-13-13-13zm1.4444 18.778h-2.8889v-7.2222h2.8889zm0-8.6667h-2.8889v-2.8889h2.8889z";break;case"share":t="m25.61 10.682-8.5722-7.7929c-0.64941-0.64941-1.4287 0-1.4287 1.0391v3.8965c-6.1044 0-11.3 3.7666-13.767 8.832-0.90917 1.6885-1.4287 3.5068-1.8183 5.3252-0.25976 1.2988 1.6885 1.9482 2.4678 0.77929 2.8574-4.5459 7.663-7.5331 13.118-7.5331v4.2861c0 1.0391 0.77929 1.6885 1.4287 1.0391l8.5722-7.7929c0.51953-0.51953 0.51953-1.5586 0-2.0781z";break;case"more":t="M 13,0.5 A 3.125,3.125 0 0 0 9.875,3.625 3.125,3.125 0 0 0 13,6.7499996 3.125,3.125 0 0 0 16.125,3.625 3.125,3.125 0 0 0 13,0.5 Z m 0,9.375 A 3.125,3.125 0 0 0 9.875,13 3.125,3.125 0 0 0 13,16.125 3.125,3.125 0 0 0 16.125,13 3.125,3.125 0 0 0 13,9.875 Z m 0,9.375 A 3.125,3.125 0 0 0 9.875,22.375 3.125,3.125 0 0 0 13,25.5 3.125,3.125 0 0 0 16.125,22.375 3.125,3.125 0 0 0 13,19.25 Z";break;case"chevron-right":t="m8.3876 0.45171 11.256 11.256c0.80304 0.80304 0.80304 2.105 0 2.908-0.0042 0.0042-0.0085 0.0084-0.01281 0.0127l-0.81946 0.80521-10.402 10.123c-0.61557 0.59909-1.5992 0.58933-2.2027-0.02186-0.60407-0.61178-0.60305-1.5958 0.0024-2.2063l10.304-10.39-10.306-10.307c-0.60228-0.60228-0.60228-1.5788 0-2.181 0.60228-0.60228 1.5788-0.60228 2.181 0z";break;case"chevron-left":t="m17.612 0.45171-11.256 11.256c-0.80304 0.80304-0.80304 2.105 0 2.908 0.0042 0.0042 0.0085 0.0084 0.01281 0.0127l0.81946 0.80521 10.402 10.123c0.61557 0.59909 1.5992 0.58933 2.2027-0.02186 0.60407-0.61178 0.60305-1.5958-0.0024-2.2063l-10.304-10.39 10.306-10.307c0.60228-0.60228 0.60228-1.5788 0-2.181-0.60228-0.60228-1.5788-0.60228-2.181 0z";break;case"chevron-up":t="m25.548 17.612-11.256-11.256c-0.80304-0.80304-2.105-0.80304-2.908 0-0.0042 0.0042-0.0084 0.0085-0.0127 0.01281l-0.80521 0.81946-10.123 10.402c-0.59909 0.61557-0.58933 1.5992 0.02186 2.2027 0.61178 0.60407 1.5958 0.60305 2.2063-0.0024l10.39-10.304 10.306 10.306c0.60228 0.60228 1.5788 0.60228 2.181 0s0.60228-1.5788 0-2.181z";break;case"chevron-down":t="m25.548 8.3876-11.256 11.256c-0.80304 0.80304-2.105 0.80304-2.908 0-0.0042-0.0042-0.0084-0.0085-0.0127-0.01281l-0.80521-0.81946-10.123-10.402c-0.59909-0.61557-0.58933-1.5992 0.02186-2.2027 0.61178-0.60407 1.5958-0.60305 2.2063 0.0024l10.39 10.304 10.306-10.306c0.60228-0.60228 1.5788-0.60228 2.181 0s0.60228 1.5788 0 2.181z";break;case"arrow-left":t="m9.8202 2.1973a1.3812 1.3812 0 0 0 -1.0617 0.47689l-8.2516 9.2442a1.3812 1.3812 0 0 0 -0.27621 0.31073 1.3812 1.3812 0 0 0 -0.008629 0.01083 1.3812 1.3812 0 0 0 -0.060419 0.10358 1.3812 1.3812 0 0 0 -0.008629 0.0151 1.3812 1.3812 0 0 0 -0.040999 0.09278 1.3812 1.3812 0 0 0 -0.028053 0.06905 1.3812 1.3812 0 0 0 -0.010794 0.03237 1.3812 1.3812 0 0 0 -0.034526 0.11868 1.3812 1.3812 0 0 0 0.010794 0.69051 1.3812 1.3812 0 0 0 0.038841 0.123 1.3812 1.3812 0 0 0 0.0064743 0.01942 1.3812 1.3812 0 0 0 0.040999 0.09278 1.3812 1.3812 0 0 0 0.032368 0.06042 1.3812 1.3812 0 0 0 0.015105 0.03021 1.3812 1.3812 0 0 0 0.066894 0.10573 1.3812 1.3812 0 0 0 0.2611 0.28699l8.2473 9.2378a1.3812 1.3812 0 1 0 2.0607 -1.8385l-6.3355-7.1015h20.116a1.3812 1.3812 0 1 0 0 -2.7621h-20.118l6.3376-7.1037a1.3812 1.3812 0 0 0 -0.99909 -2.3154z";break;default:throw ws.createError(m.GENERAL,`Unknown icon type ${e}.`)}return es("span",{className:`c-Icon -${e}`,"data-icon-type":e,innerHTML:`<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="26" height="26" viewBox="0 0 26 26" focusable="false"><path d="${t}"/></svg>`})}(e);return null!==t&&(i.querySelector("svg").style.fill=t,i.querySelector("svg").style.stroke=t),i}class Ls extends fs{constructor(e){super(e),this._dom={root:null,refs:{icons:{}}}}uiGetDeclaredProps(){return{cross:"object",top:"object",chapters:"object",about:"object",episodes:"object",burger:"object","fullscreen-off":"object","fullscreen-on":"object","cinema-off":"object","cinema-on":"object","airplay-off":"object","airplay-on":"object","chromecast-off":"object","chromecast-on":"object","pip-off":"object","pip-on":"object",mute:"object",pause:"object",play:"object",previous:"object",next:"object",settings:"object","captions-on":"object","captions-off":"object",reload:"object",volume:"object",pp:"object",info:"object","info-round":"object",share:"object",more:"object","chevron-right":"object","chevron-left":"object","chevron-down":"object","chevron-up":"object","arrow-left":"object"}}uiGetDefaultProps(){return{cross:null,top:null,chapters:null,about:null,episodes:null,burger:null,"fullscreen-off":null,"fullscreen-on":null,"cinema-off":null,"cinema-on":null,"airplay-off":null,"airplay-on":null,"chromecast-off":null,"chromecast-on":null,"pip-off":null,"pip-on":null,mute:null,pause:null,play:null,previous:null,next:null,settings:null,"captions-on":null,"captions-off":null,reload:null,volume:null,pp:null,info:null,"info-round":null,share:null,more:null,"chevron-right":null,"chevron-left":null,"chevron-down":null,"chevron-up":null,"arrow-left":null}}_onUiBuild(e){this._dom.root=es("span",{className:"w-Icons"}),this.__processIcons(e)}_onUiUpdate(e){this.__iconsChanged(e)&&this.__processIcons(e)}__iconsChanged(e){const t=this._props;return JSON.stringify(e)!=JSON.stringify(t)}__processIcons(e){for(let t of Object.keys(e))e[t]?this._dom.refs.icons[t]?this.__updateIcon(t,e[t]):this.__appendIcon(t,e[t]):this.__removeIcon(t)}__appendIcon(e,t){const i=t.displayed,s=(t.color,Ns(e,t.color));ts(this._dom.root).append(s),ts(s).setDisplayed(i),this._dom.refs.icons[e]=s}__updateIcon(e,t){const i=t.displayed,s=t.color,n=this._dom.refs.icons[e];ts(n).setDisplayed(i),function(e,t){const i=e.getAttribute("data-icon-type");if(!i)throw ws.createError(m.GENERAL,"Incompatible icon element.");const s=Ns(i,t);ts(e).clear(),ts(e).moveChildrenFrom(s)}(n,s)}__removeIcon(e){const t=this._dom.refs.icons[e];t&&(ts(this._dom.root).remove(t),delete this._dom.refs.icons[e])}}class xs extends fs{constructor(e){super(e),this._dom={root:null,refs:{logosContainer:null}},this._component={logo:null,logoLive:null,pp:null,captions:null}}uiGetDeclaredProps(){return{displayed:"boolean",logo:"boolean",logoSrc:"string",logoLive:"boolean",logoLiveText:"string",pp:"boolean",captions:"boolean",visibleElements:"object",isLargeUi:"boolean",controlPanelShown:"boolean",captionCues:"object",captionRegions:"object"}}uiGetDefaultProps(){return{displayed:!1,logo:!1,logoSrc:"",logoLive:!1,logoLiveText:"",pp:!1,captions:!1,visibleElements:null,isLargeUi:!1,controlPanelShown:!1,captionCues:[],captionRegions:[]}}_onUiInit(e){this._component.logo=new As(this.__getPropsForLogo(e)),this._component.logoLive=new Ss(this.__getPropsForLogoLive(e)),this._component.pp=new Ls(this.__getPropsForPp(e)),this._component.captions=new Is(this.__getPropsForCaptions(e))}_onUiBuild(e){this._dom.root=es("div",{className:"w-Ui-Overlays"}),this._dom.refs.logosContainer=es("div",{className:"w-Ui-Logos"}),this._dom.refs.ppContainer=es("div",{className:"w-Ui-PP"}),ts(this._dom.root).append(ts(this._dom.refs.logosContainer).append(this._component.logo.uiGetElement(),this._component.logoLive.uiGetElement()),ts(this._dom.refs.ppContainer).append(this._component.pp.uiGetElement()),this._component.captions.uiGetElement()),this.__setDisplayed(e.displayed),this.__setPpDisplayed(e)}_onUiCanUpdate(e){return e.displayed||this._props.displayed!=e.displayed}_onUiUpdate(e){this._props.displayed!=e.displayed&&this.__setDisplayed(e.displayed),this.__setPpDisplayed(e),this._component.logo.uiUpdate(this.__getPropsForLogo(e)),this._component.logoLive.uiUpdate(this.__getPropsForLogoLive(e)),this._component.pp.uiUpdate(this.__getPropsForPp(e)),this._component.captions.uiUpdate(this.__getPropsForCaptions(e))}__getPropsForLogo(e){return{className:"c-Ui-Logo",displayed:e.logo&&e.visibleElements.logo,src:e.logoSrc}}__getPropsForLogoLive(e){return{displayed:e.logoLive&&!e.controlPanelShown&&e.visibleElements.liveInfo,ppVisible:e.pp&&e.visibleElements.pp,textLive:e.logoLiveText}}__getPropsForPp(e){return{pp:{displayed:!0,color:"#ffffff"}}}__getPropsForCaptions(e){return{displayed:e.captions&&e.visibleElements.captions,cues:e.captionCues,regions:e.captionRegions}}__setDisplayed(e){ts(this._dom.root).setDisplayed(e)}__setPpDisplayed(e){const t=e.pp&&(!e.controlPanelShown||!e.visibleElements.contentInfo)&&e.visibleElements.pp;ts(this._dom.refs.ppContainer).setDisplayed(t)}}class Ms extends fs{constructor(e){super(e),this._dom={root:null,refs:{label:null,labelText:null}},this._component={icon:null},this._bind=["__clickOn"]}uiGetDeclaredProps(){return{displayed:"boolean",fullSizeLook:"boolean",labelDisplayed:"boolean",href:"string",onClick:["function","object"],target:"string",text:"string"}}uiGetDefaultProps(){return{displayed:!1,fullSizeLook:!1,labelDisplayed:!1,href:"",onClick:null,target:"",text:""}}_onUiInit(e){this._component.icon=new Ls(this.__getPropsForIcon(e.iconProps))}_onUiBuild(e){this._dom.root=es("a",{className:"c-ClickthroughLink",target:e.clickthroughTarget,tabIndex:e.fullSizeLook&&!e.labelDisplayed?-1:0}),e.labelDisplayed&&(this._dom.refs.label=es("div",{className:"c-ClickthroughLink__label"}),this._dom.refs.labelText=es("span",{className:"c-ClickthroughLink__text"}),ts(this._dom.root).append(ts(this._dom.refs.label).append(this._component.icon.uiGetElement(),this._dom.refs.labelText))),this.__setDisplayed(e.displayed),this.__setText(e),this.__setHref(e.href),this.__setTarget(e.target),this.__setFullSizeLook(e.fullSizeLook),this.__setAriaAttr(e),this._dom.root.addEventListener("click",this.__clickOn)}_onUiUpdate(e){this._props.displayed!=e.displayed&&this.__setDisplayed(e.displayed),this._props.fullSizeLook!=e.fullSizeLook&&this.__setFullSizeLook(e.fullSizeLook),this._props.href!=e.href&&this.__setHref(e.href),this._props.target!=e.target&&this.__setTarget(e.target),this._props.text==e.text&&this._props.fullSizeLook==e.fullSizeLook||this.__setText(e)}_onUiDestroy(){this._dom.root.removeEventListener("click",this.__clickOn)}__setDisplayed(e){ts(this._dom.root).setDisplayed(e)}__setFullSizeLook(e){ts(this._dom.root).cssClasses({"-fullsize":e})}__setText(e){e.labelDisplayed?this._dom.refs.labelText.innerHTML=e.text:this._dom.root.innerHTML=e.fullSizeLook?"":e.text}__setHref(e){this._dom.root.href=e}__setTarget(e){this._dom.root.target=e}__setAriaAttr(e){ts(this._dom.root).setAttr({"aria-label":e.text,role:"link"})}__getPropsForIcon(e){return{"info-round":{displayed:!0}}}__clickOn(e){this._props.onClick&&(e.stopPropagation(),this._props.onClick())}}class Ds extends fs{constructor(e){super(e),this._dom={root:null},this._bind=["__clickOn"]}uiGetDeclaredProps(){return{displayed:"boolean",onClick:["function","object"]}}uiGetDefaultProps(){return{displayed:!1,onClick:null}}_onUiBuild(e){this._dom.root=es("button",{className:"c-ActionArea","data-js-actionarea":"1",type:"button",tabIndex:-1,"aria-hidden":!0}),this.__setDisplayed(e.displayed),this._dom.root.addEventListener("click",this.__clickOn)}_onUiUpdate(e){this._props.displayed!=e.displayed&&this.__setDisplayed(e.displayed)}_onUiDestroy(){this._dom.root.removeEventListener("click",this.__clickOn)}__setDisplayed(e){ts(this._dom.root).setDisplayed(e)}__clickOn(e){this._props.onClick&&this._props.onClick(e)}}class Os extends fs{constructor(e){super(e),this._dom={root:null,refs:{}},this._component={icon:null},this._bind=["__clickOn"]}uiGetDeclaredProps(){return{cssClassWithExtraLook:"object",displayed:"boolean",mark:"string",enabled:"boolean",indicatorColor:"string",indicatorActivated:"boolean",ariaProps:"object",iconProps:"object",titleEnabled:"string",titleDisabled:"string",onClick:["function","object"]}}uiGetDefaultProps(){return{cssClassWithExtraLook:null,displayed:!0,mark:"",enabled:!0,indicatorColor:"",indicatorActivated:!1,titleEnabled:"",titleDisabled:"",ariaProps:null,iconProps:null,onClick:null}}_onUiInit(e){this._component.icon=new Ls(this.__getPropsForIcon(e.iconProps))}_onUiBuild(e){this._dom.root=es("button",{className:"c-IconButton",type:"button","data-mark":e.mark}),ts(this._dom.root).append(this._component.icon.uiGetElement()),this.__setDisplayed(e.displayed),this.__setEnabled(e.enabled),this.__setTitle(e.enabled?e.titleEnabled:e.titleDisabled),this.__setCssClassWithExtraLook(e.cssClassWithExtraLook),this._dom.root.addEventListener("click",this.__clickOn)}_onUiUpdate(e){this._props.displayed!=e.displayed&&this.__setDisplayed(e.displayed),this._props.enabled==e.enabled&&this._props.titleEnabled==e.titleEnabled&&this._props.titleDisabled==e.titleDisabled||(this.__setEnabled(e.enabled),this.__setTitle(e.enabled?e.titleEnabled:e.titleDisabled)),this._props.ariaProps!=e.ariaProps&&this.__setAriaAttr(e.ariaProps),this._props.cssClassWithExtraLook!=e.cssClassWithExtraLook&&this.__setCssClassWithExtraLook(e.cssClassWithExtraLook),this._props.iconProps!=e.iconProps&&this._component.icon.uiUpdate(this.__getPropsForIcon(e.iconProps))}_onUiDestroy(){this._dom.root.removeEventListener("click",this.__clickOn)}__setCssClassWithExtraLook(e){e&&ts(this._dom.root).cssClasses(e)}__getPropsForIcon(e){return Object.assign({},e)}__setDisplayed(e){ts(this._dom.root).setDisplayed(e)}__setEnabled(e){this._dom.root.disabled=!e,ts(this._dom.root).setAttr({"aria-disabled":!e,tabIndex:e?0:-1})}__setTitle(e){this._dom.root.title=e}__setAriaAttr(e){ts(this._dom.root).setAttr(e)}__clickOn(){this._props.onClick&&this._props.enabled&&this._props.onClick()}}class Rs extends fs{constructor(e){super(e),this._dom={root:null,refs:{fill:null}}}uiGetDeclaredProps(){return{color:"string",progress:"number"}}uiGetDefaultProps(){return{color:"",progress:0}}_onUiBuild(e){this._dom.root=es("div",{className:"c-SeekBarBox__progress"}),this._dom.refs.fill=es("div",{className:"c-SeekBarBox__fill",innerHTML:'\n\t\t\t\t<svg version="1.1" xmlns="http://www.w3.org/2000/svg"\n\t\t\t\t\txmlns:xlink="http://www.w3.org/2000/svg" tabIndex="-1"\n\t\t\t\t\tfocusable="false">\n\t\t\t\t\t<rect x="0" y="0" width="100%" height="100%"/>\n\t\t\t\t</svg>\n\t\t\t'}),ts(this._dom.root).append(this._dom.refs.fill),this.__setProgress(e.progress),this.__setColor(e.color)}_onUiUpdate(e){this._props.progress!=e.progress&&this.__setProgress(e.progress),this._props.color!=e.color&&this.__setColor(e.color)}__setProgress(e){let t=100*(isNaN(e)||!isFinite(e)?0:e);const i=this._dom.refs.fill.querySelector("svg");i&&ts(i).setStyle({transform:`scaleX(${t/100})`})}__setColor(e){const t=this._dom.refs.fill.querySelector("svg > rect");t&&ts(t).setStyle({fill:e,stroke:e})}}class Us extends fs{constructor(e){super(e),this._dom={root:null,refs:{slider:null,sliderButton:null,sliderFill:null,document:document}},this._bind=["_onMouseDown","_onMouseMove","_onMouseUp"],this._onMouseMoveTimeout=null,this._volumeBarDimensions={bottom:0,height:0,left:0,right:0,top:0,width:0,x:0,y:0}}uiGetDeclaredProps(){return{displayed:"boolean",volume:"number",onVolumeChange:["function","object"],onMouseMove:["function","object"],onMouseUp:["function","object"],title:"string",audioOnly:"boolean",progressBarColor:"string",titleValueOn:"string"}}uiGetDefaultProps(){return{displayed:!0,volume:0,onVolumeChange:null,onMouseMove:null,onMouseUp:null,title:"",audioOnly:!1,progressBarColor:"",titleValueOn:""}}_onUiBuild(e){this._dom.root=es("div",{className:"c-VolumeBar",tabindex:0}),this._dom.refs.slider=es("div",{className:"c-VolumeBarSlider"}),this._dom.refs.sliderFill=es("div",{className:"c-VolumeBarSlider__fill"}),this._dom.refs.sliderButton=es("div",{className:"c-VolumeBarSlider__thumb"}),ts(this._dom.root).append(ts(this._dom.refs.slider).append(this._dom.refs.sliderFill,this._dom.refs.sliderButton)),this.__setColor(e),this.__setDisplayed(e.displayed),this._updateVolume(e.volume),this._setTitle(e.title),this._dom.root.addEventListener("mousedown",this._onMouseDown)}_onUiUpdate(e){this._props.displayed!==e.displayed&&this.__setDisplayed(e.displayed),this._props.volume!=e.volume&&this._updateVolume(e.volume),this._props.title!=e.title&&this._setTitle(e.title),this._props.progressBarColor!==e.progressBarColor&&this.__setColor(e)}_onUiDestroy(){this._dom.root.removeEventListener("mousedown",this._onMouseDown),this._dom.refs.document.removeEventListener("mousemove",this._onMouseMove),this._dom.refs.document.removeEventListener("mouseup",this._onMouseUp)}setActive(e){ts(this._dom.root).cssClasses({"-active":e})}__setColor(e){ts(this._dom.refs.sliderFill).setStyle({background:e.audioOnly?e.progressBarColor:""}),ts(this._dom.refs.sliderButton).setStyle({background:e.audioOnly?e.progressBarColor:""})}__setDisplayed(e){ts(this._dom.root).setDisplayed(e)}_updateVolume(e){this._setAriaAttr(e);const t=100*e;ts(this._dom.refs.sliderFill).setStyle({width:`${t}%`}),ts(this._dom.refs.sliderButton).setStyle({left:`${t}%`})}_setTitle(e){this._dom.root.title=e}_setAriaAttr(e){const t=Math.round(100*e);ts(this._dom.root).setAttr({role:"slider","aria-label":this._props.title,"aria-valuemin":0,"aria-valuemax":100,"aria-valuenow":t,"aria-valuetext":`${this._props.titleValueOn} ${t}%`})}_onMouseDown(e){e.preventDefault(),this.__updateVolumeBarDimensionsRequest();const t=e.clientX,i=window.pageXOffset+t,s=this._volumeBarDimensions;this.__callOnVolumeChange(i,s),this._dom.refs.document.addEventListener("mousemove",this._onMouseMove),this._dom.refs.document.addEventListener("mouseup",this._onMouseUp)}_onMouseMove(e){if(this._props.onMouseMove&&this._props.onMouseMove(),!this._onMouseMoveTimeout){this._onMouseMoveTimeout=setTimeout(()=>{clearTimeout(this._onMouseMoveTimeout),this._onMouseMoveTimeout=null},16);const t=e.clientX,i=window.pageXOffset+t,s=this._volumeBarDimensions;this.__callOnVolumeChange(i,s)}}_onMouseUp(e){this._props.onMouseUp&&this._props.onMouseUp();const t=e.clientX,i=window.pageXOffset+t,s=this._volumeBarDimensions;this.__callOnVolumeChange(i,s),this._dom.refs.document.removeEventListener("mousemove",this._onMouseMove),this._dom.refs.document.removeEventListener("mouseup",this._onMouseUp)}__callOnVolumeChange(e,t){const i=this.__transformPartXOfClientRectToVolume(e,t);this._props.onVolumeChange&&this._props.onVolumeChange(i)}__transformPartXOfClientRectToVolume(e,t){const i=t.width,s=t.left;t.right;return Math.min(Math.max(e-s,0),i)/i}__updateVolumeBarDimensionsRequest(){const e=this._dom.root.getBoundingClientRect();this._volumeBarDimensions={bottom:e.bottom,height:e.height||0,left:e.left,right:e.right,top:e.top,width:e.width||0,x:e.x||0,y:e.y||0}}}class Vs extends fs{constructor(e){super(e),this._dom={root:null,refs:{volumeBarContainer:null}},this._component={volumeButton:null,volumeBar:null},this._bind=["_onVolumeChange","_onVolumeButtonClick","_onMouseEnter","_onMouseLeave","_onMouseMove","_onMouseUp"],this._enterTimeout=null,this._hideVolumeBarTimeout=null}uiGetDeclaredProps(){return{displayed:"boolean",touchMode:"boolean",muted:"boolean",onMuteClick:["function","object"],onVolumeChange:["function","object"],titleMute:"string",titleUnmute:"string",titleVolume:"string",titleVolumeValueOn:"string",progressBarColor:"string",volume:"number",vertical:"boolean",audioOnly:"boolean"}}uiGetDefaultProps(){return{displayed:!0,touchMode:!1,muted:!1,onMuteClick:null,onVolumeChange:null,titleMute:"",titleUnmute:"",titleVolume:"",titleVolumeValueOn:"",progressBarColor:"",volume:0,audioOnly:!1}}_onUiInit(e){this._component.volumeButton=new Os(this._getPropsForIconButton(e)),this._component.volumeBar=new Us(this._getPropsForVolumeBar(e))}_onUiBuild(e){this._dom.root=es("div",{className:"c-Volume"}),ts(this._dom.root).append(this._component.volumeButton.uiGetElement(),this._component.volumeBar.uiGetElement()),this.__setDisplayed(e.displayed),this._dom.root.addEventListener("mouseenter",this._onMouseEnter),this._dom.root.addEventListener("mouseleave",this._onMouseLeave)}_onUiUpdate(e){this._props.displayed!=e.displayed&&this.__setDisplayed(e.displayed),this._props.volume==e.volume&&this._props.muted==e.muted&&this._props.titleMute==e.titleMute&&this._props.titleUnmute==e.titleUnmute&&this._props.progressBarColor==e.progressBarColor||(this._component.volumeButton.uiUpdate(this._getPropsForIconButton(e)),this._component.volumeBar.uiUpdate(this._getPropsForVolumeBar(e))),this._props.titleVolume!=e.titleVolume&&this.__setTitleVolume(e.titleVolume)}getVolumeButton(){return this._dom.refs.iconContainer}_getPropsForIconButton(e){const t=this._isEvaluatedAsMuted(e.volume,e.muted);return{iconProps:{volume:{displayed:!t},mute:{displayed:t}},titleEnabled:e.muted?e.titleUnmute:e.titleMute,ariaProps:{"aria-label":e.muted?e.titleUnmute:e.titleMute},onClick:this._onVolumeButtonClick}}_getPropsForVolumeBar(e){return{displayed:!e.touchMode,volume:this.__getVolume(e.volume,e.muted),onMouseMove:this._onMouseMove,onMouseUp:this._onMouseUp,audioOnly:e.audioOnly,progressBarColor:e.progressBarColor,titleValueOn:e.titleVolumeValueOn,onVolumeChange:this._onVolumeChange}}__getVolume(e,t){return t?0:e}__setDisplayed(e){ts(this._dom.root).setDisplayed(e)}_isEvaluatedAsMuted(e,t){return 0===e||t}__updateVolumeBar(e,t){this._component.volumeBar.uiUpdate({volume:this.__getVolume(e,t)})}__volumeBarActive(e){ts(this._dom.root).cssClasses({"-volume-bar-active":e&&!this._props.touchMode}),this._component.volumeBar.setActive(e)}__setTitleVolume(e){this._component.volumeBar.uiUpdate({title:e})}_onMouseEnter(e){clearTimeout(this._hideVolumeBarTimeout),this._enterTimeout=setTimeout(()=>{this.__volumeBarActive(!0),clearTimeout(this._enterTimeout),this._enterTimeout=null},100)}_onMouseLeave(e){this._enterTimeout&&(clearTimeout(this._enterTimeout),this._enterTimeout=null),this._flags.mouseMoving||(this._hideVolumeBarTimeout=setTimeout(()=>{this.__volumeBarActive(!1)},200))}_onMouseMove(){this._flags.mouseMoving=!0}_onMouseUp(){this._flags.mouseMoving=!1}_onVolumeChange(e){this._props.onVolumeChange&&this._props.onVolumeChange(e)}_onVolumeButtonClick(e){this._props.onMuteClick&&this._props.onMuteClick()}}class Bs extends fs{constructor(e){super(e),this._dom={root:null,refs:{wrapper:null,volumeContainer:null,backgroundWrapper:null}},this._component={progressBar:null,volume:null},this._bind=["__onVolumeChange","__onMuteClick"]}uiGetDeclaredProps(){return{controlPanelFulltimeHidden:"boolean",currentTime:"number",duration:"number",progressBarColor:"string",textMute:"string",textUnmute:"string",textVolume:"string",textVolumeValueOn:"string",useTouch:"boolean",volume:"number",volumeMuted:"boolean",onMuteClick:["function","object"],onVolumeChange:["function","object"]}}_onUiInit(e){this._component.volume=new Vs(this.__getPropsForVolume(e)),this._component.progressBar=new Rs(this.__getPropsForProgressBar(e))}_onUiBuild(e){this._dom.root=es("div",{className:"w-AdOnlyCtrlPanelLayout"}),this._dom.refs.wrapper=es("div",{className:"w-AdOnlyCtrlPanelLayoutWrapper"}),this._dom.refs.backgroundWrapper=es("div",{className:"w-AdOnlyCtrlPanelLayoutBackground"}),this._dom.refs.volumeContainer=es("div",{className:"w-AdOnlyCtrlPanelLayoutVolume"}),ts(this._dom.root).append(ts(this._dom.refs.backgroundWrapper),ts(this._dom.refs.volumeContainer).append(this._component.volume.uiGetElement()),ts(this._dom.refs.wrapper).append(this._component.progressBar.uiGetElement())),this.__updateTouch(e)}_onUiUpdate(e){this._props.volume==e.volume&&this._props.volumeMuted==e.volumeMuted&&this._props.textMute==e.textMute&&this._props.textUnmute==e.textUnmute&&this._props.controlPanelFulltimeHidden==e.controlPanelFulltimeHidden||this._component.volume.uiUpdate(this.__getPropsForVolume(e)),this._props.useTouch===e.useTouch&&this._props.controlPanelFulltimeHidden===e.controlPanelFulltimeHidden||this.__updateProgressBarVisibility(e),this._props.useTouch!==e.useTouch&&this.__updateTouch(e),this._component.progressBar.uiUpdate(this.__getPropsForProgressBar(e))}__getVolume(e,t){return t?0:e}__onVolumeChange(e){this._props.onVolumeChange&&this._props.onVolumeChange(e)}__onMuteClick(){this._props.onMuteClick&&this._props.onMuteClick()}__getPropsForVolume(e){return{displayed:!e.controlPanelFulltimeHidden,volume:e.volume,muted:e.volumeMuted,titleMute:e.textMute,titleUnmute:e.textUnmute,titleVolume:e.textVolume,titleVolumeValueOn:e.textVolumeValueOn,vertical:!1,onMuteClick:this.__onMuteClick,onVolumeChange:this.__onVolumeChange}}__getPropsForProgressBar(e){return{color:e.progressBarColor,progress:e.currentTime/e.duration}}__setDisplayed(e){ts(this._dom.root).setDisplayed(e)}__updateProgressBarVisibility(e){ts(this._dom.refs.wrapper).cssClasses({"-always-visible":e.useTouch&&!e.controlPanelFulltimeHidden})}__updateTouch(e){ts(this._dom.refs.volumeContainer).cssClasses({"-no-bar":e.useTouch})}}class Fs extends fs{constructor(e){super(e),this._dom={root:null,refs:{adOnlyCtrlPanelLayout:null}},this._component={adOnlyCtrlPanelLayout:null},this._flags={mouseUsed:!1},this._bind=["__onMouseEnter","__onMouseLeave","__onVolumeChange","__onMuteClick"]}uiGetDeclaredProps(){return{visible:"boolean",controlPanelFulltimeHidden:"boolean",currentTime:"number",duration:"number",progressBarColor:"string",textMute:"string",textUnmute:"string",textVolume:"string",textVolumeValueOn:"string",volume:"number",volumeMuted:"boolean",useTouch:"boolean",onMuteClick:["function","object"],onVolumeChange:["function","object"],onHoverOn:["function","object"],onHoverOff:["function","object"]}}uiGetDefaultProps(){return{onHoverOn:null,onHoverOff:null}}_onUiInit(e){this._component.adOnlyCtrlPanelLayout=new Bs(this.__getPropsForControlPanelLayout(e))}_onUiBuild(e){this._dom.root=es("div",{className:"w-AdOnlyCtrlPanel"}),ts(this._dom.root).append(this._component.adOnlyCtrlPanelLayout.uiGetElement()),this._dom.root.addEventListener("mouseenter",this.__onMouseEnter),this._dom.root.addEventListener("mouseleave",this.__onMouseLeave),this.__setVisible(e.visible)}_onUiUpdate(e){this._props.visible!=e.visible&&this.__setVisible(e.visible),this._component.adOnlyCtrlPanelLayout.uiUpdate(this.__getPropsForControlPanelLayout(e))}_onUiDestroy(){this.__clearMouseUsedOffTimeout(),this._dom.root.removeEventListener("mouseenter",this.__onMouseEnter),this._dom.root.removeEventListener("mouseleave",this.__onMouseLeave)}__getPropsForControlPanelLayout(e){const{currentTime:t,controlPanelFulltimeHidden:i,duration:s,progressBarColor:n,textMute:o,textUnmute:r,textVolume:a,textVolumeValueOn:l,useTouch:h,volume:_,volumeMuted:d}=e;return{currentTime:t,controlPanelFulltimeHidden:i,duration:s,progressBarColor:n,textMute:o,textUnmute:r,textVolume:a,textVolumeValueOn:l,useTouch:h,volume:_,volumeMuted:d,onMuteClick:this.__onMuteClick,onVolumeChange:this.__onVolumeChange}}__setVisible(e){ts(this._dom.root).cssClasses({"-visible":e})}__saveMouseUsed(e){this._flags.mouseUsed=e,e&&this.__startMouseUsedOffTimeout()}__onMouseEnter(e){this.__saveMouseUsed(!0),this.__onHoverOn()}__onMouseLeave(e){this.__saveMouseUsed(!0),this.__onHoverOff()}__startMouseUsedOffTimeout(){this.__clearMouseUsedOffTimeout(),this._mouseUsedOffTimeout=setTimeout(()=>this.__saveMouseUsed(!1),25)}__clearMouseUsedOffTimeout(){this._mouseUsedOffTimeout&&(clearTimeout(this._mouseUsedOffTimeout),this._mouseUsedOffTimeout=0)}__onVolumeChange(e){this._props.onVolumeChange&&this._props.onVolumeChange(e)}__onMuteClick(){this._props.onMuteClick&&this._props.onMuteClick()}__onHoverOn(){this._props.onHoverOn&&this._props.onHoverOn()}__onHoverOff(){this._props.onHoverOff&&this._props.onHoverOff()}}const Hs="sznp-ui-widget-injections-container",Gs=.5,js=40;class qs extends fs{constructor(e){super(e),this._dom={root:null,refs:{span:null,a:null,button:null,img:null,iframe:null,iframeOverlap:null,video:null,canvas:null,videoCanvas:null}},this._component={closeButton:null},this._bind=["__clickOn","__onCloseButtonClick","__onLoadedMetadata"],this._position=null,this._dimensions=null,this._canvasRefreshTimeout=null,this._canvasCtx=null,this._videoCanvasCtx=null,this._lastDrawTime=null,this._isCanvasError=!1}getId(){return this._props.id}uiGetDeclaredProps(){return{id:"string",start:"object",src:"string",content:"string",type:"string",clickActions:"object",clickthrough:"string",clickthroughTarget:"string",closeButtonTitle:"string",closeButtonDisplayed:"boolean",position:"object",defaultPosition:"string",width:"string",maxWidth:"string",height:"string",maxHeight:"string",bgcolor:"string",animation:"object",videoDimensions:"object",controlPanelIntersectionHeight:"number",contentPlaying:"boolean",contentSeeking:"boolean",contentLoading:"boolean",contentStart:"number",contentTime:"number",contentDuration:"number",contentStreamingLive:"boolean",onClick:["function","object"],onClose:["function","object"],onError:["function","object"]}}uiGetDefaultProps(){return{clickActions:[],clickthroughTarget:"_blank",closeButtonTitle:"",closeButtonDisplayed:!1,controlPanelIntersectionHeight:0,onClick:null,onClose:null,onError:null}}_onUiInit(e){this._component.closeButton=new Os(this.__getPropsForCloseButton(e))}_onUiBuild(e){let t=null;this._dom.root=es("div",{className:"c-Injection"+(e.position?"":" -centered"),style:this._getStyleRules(e)}),e.clickthrough?(this._dom.refs.a=es("a",{className:"c-Injection__link",href:e.clickthrough,target:e.clickthroughTarget}),ts(this._dom.root).append(ts(this._dom.refs.a))):e.clickActions&&e.clickActions.length&&(this._dom.refs.button=es("button",{className:"c-Injection__button",type:"button"}),ts(this._dom.root).append(ts(this._dom.refs.button))),t=this._dom.refs.a?this._dom.refs.a:this._dom.refs.button?this._dom.refs.button:this._dom.root,e.src&&"video/mp4s"===e.type?(this._dom.refs.video=es("video",{className:"c-Injection__video",src:e.src,crossOrigin:"anonymous"}),this._dom.refs.video.addEventListener("loadedmetadata",this.__onLoadedMetadata),this._dom.refs.canvas=es("canvas",{className:"c-Injection__canvas"}),this._canvasCtx=this._dom.refs.canvas.getContext("2d"),this._dom.refs.videoCanvas=es("canvas",{className:"c-Injection__videoCanvas"}),this._videoCanvasCtx=this._dom.refs.videoCanvas.getContext("2d"),ts(t).append(ts(this._dom.refs.canvas)),this.__refreshCanvas()):e.src&&0===e.type.indexOf("image")?(this._dom.refs.img=es("img",{className:"c-Injection__img",src:e.src}),ts(t).append(ts(this._dom.refs.img)),e.position||ts(this._dom.root).append(this._component.closeButton.uiGetElement())):(e.src||e.content)&&"text/html"===e.type&&(this._dom.refs.iframe=this._createIframe(e),this._dom.refs.iframeOverlap=es("div",{className:"c-Injection__iframeOverlap"}),ts(t).append(ts(this._dom.refs.iframe),ts(this._dom.refs.iframeOverlap))),e.clickActions&&e.clickActions.length&&t.addEventListener("click",this.__clickOn)}_onUiCanUpdate(e){return this.__uiCanUpdate(e)||this.__uiCanSynchronize(e)}__uiCanUpdate(e){return JSON.stringify(e.videoDimensions)!=JSON.stringify(this._props.videoDimensions)||e.controlPanelIntersectionHeight!=this._props.controlPanelIntersectionHeight||e.closeButtonDisplayed!=this._props.closeButtonDisplayed||e.defaultPosition!=this._props.defaultPosition||this._dom.root&&"hidden"===ts(this._dom.root).node().style.visibility}__uiCanSynchronize(e){return!!this._dom.refs.video&&(e.contentTime!=this._props.contentTime||e.contentStart!=this._props.contentStart&&"afterStart"==e.start.type||e.contentDuration!=this._props.contentDuration&&"beforeEnd"==e.start.type||e.contentStreamingLive!=this._props.contentStreamingLive&&"beforeEnd"==e.start.type||e.contentPlaying!=this._props.contentPlaying||e.contentSeeking!=this._props.contentSeeking||e.contentLoading!=this._props.contentLoading)}_onUiUpdate(e){this.__uiCanUpdate(e)&&(this._component.closeButton.uiUpdate(this.__getPropsForCloseButton(e)),ts(this._dom.root).setStyle(this._getStyleRules(e)),this.__avoidControlPanelIntersection(e),ts(this._dom.root).setStyle(this._getAnimationStyleRules(e))),this.__uiCanSynchronize(e)&&this.__uiSynchronize(e)}_onUiDestroy(){this._dom.refs.video&&(this._dom.refs.video.removeEventListener("loadedmetadata",this.__onLoadedMetadata),this._canvasRefreshTimeout&&(cancelAnimationFrame(this._canvasRefreshTimeout),this._canvasRefreshTimeout=null),this._dom.refs.video.pause())}__uiSynchronize(e){let t=null;if("atTime"===e.start.type?t=e.start.time:"afterStart"===e.start.type&&e.contentStart>=0?t=e.contentStart+e.start.time:"beforeEnd"===e.start.type&&e.contentDuration&&!e.contentStreamingLive&&(t=e.contentDuration-e.start.time),null===t)return;const i=this.__getInjectionCurrentTime(e),s=e.contentTime-t;if(s>=0&&Math.abs(i-s)>Gs&&(this._dom.refs.video.currentTime=s),!e.contentPlaying||e.contentSeeking||e.contentLoading)this._dom.refs.video.paused||this._dom.refs.video.pause();else if(this._dom.refs.video.paused){const e=this._dom.refs.video.play();null!==e&&"object"==typeof e&&e.catch(()=>{})}}__refreshCanvas(e){this.__drawCanvas(e),this._isCanvasError||(this._canvasRefreshTimeout=requestAnimationFrame(e=>this.__refreshCanvas(e)))}__drawCanvas(e){if(this._dimensions&&!(null!==this._lastDrawTime&&e-this._lastDrawTime<=js)){this._lastDrawTime=e;try{this._videoCanvasCtx.drawImage(this._dom.refs.video,0,0,2*this._dimensions.width,this._dimensions.height);const e=this._videoCanvasCtx.getImageData(0,0,this._dimensions.width,this._dimensions.height),t=this._videoCanvasCtx.getImageData(this._dimensions.width,0,this._dimensions.width,this._dimensions.height),i=e.data.length/4;for(let s=0;s<i;s++)e.data[4*s+3]=t.data[4*s];this._canvasCtx.putImageData(e,0,0),this._isCanvasError=!1}catch(e){this._isCanvasError=!0,this.__onError(e)}}}__getInjectionCurrentTime(e){return this._dom.refs.video?this._dom.refs.video.currentTime:null}_getParentContainer(e){let t=e;for(;(t=t.parentNode)&&!t.classList.contains(Hs););return t}_createIframe(e){let t=es("iframe",{className:"c-Injection__iframe",src:e.src?e.src:"about:blank",sandbox:"allow-same-origin allow-scripts",scrolling:"no",style:{width:"100%",height:"100%"},allowTransparency:!0});return t.onload=(()=>{const i=t.contentWindow.document.createElement("style");if(i.type="text/css",i.innerHTML="body { margin: 0px; padding: 0px; }",t.contentWindow.document.head.appendChild(i),!e.src){let i=t.contentWindow.document.createElement("div");i.innerHTML=e.content,t.contentWindow.document.body.appendChild(i)}}),t.onerror=(()=>{this.__onError("Visual element of type text/html threw an error.")}),t}__getPropsForCloseButton(e){return{displayed:!0,titleEnabled:e.closeButtonTitle,iconProps:{cross:{displayed:e.closeButtonDisplayed}},onClick:this.__onCloseButtonClick}}_getStyleRules({position:e,defaultPosition:t,width:i,maxWidth:s,height:n,maxHeight:o,bgcolor:r}){const a={position:"absolute",visibility:"hidden"};if(r&&(a["background-color"]=`${r}`),!e)return a.left="0px",a.right="0px","top"===t?(a.top="0px",a.bottom="auto"):(a.top="auto",a.bottom="0px"),a;if("x"in e&&(a[e.x.origin]=`${e.x.value}`,e.x.center&&(a.transform="left"===e.x.origin?"translateX(-50%)":"translateX(50%)")),"y"in e&&(a[e.y.origin]=`${e.y.value}`,e.y.center)){let t="top"===e.y.origin?"translateY(-50%)":"translateY(50%)";"transform"in a?a.transform+=" "+t:a.transform=t}return i&&(a.width=`${i}`),s&&(a["max-width"]=`${s}`),n&&(a.height=`${n}`),o&&(a["max-height"]=`${o}`),a}_getAnimationStyleRules({position:e,animation:t}){const i={visibility:"visible"};return t&&"slide"===t.type&&(i["animation-name"]="sznp-slide-"+t.params.direction+"-"+("left"===t.params.direction||"right"===t.params.direction?e.x.origin:e.y.origin),i["animation-duration"]=t.params.duration+"ms"),i}__avoidControlPanelIntersection(e){ts(this._dom.root)}__onLoadedMetadata(e){this._dom.refs.video.videoWidth&&this._dom.refs.video.videoHeight&&(this._dimensions={width:this._dom.refs.video.videoWidth/2,height:this._dom.refs.video.videoHeight},this._dom.refs.videoCanvas.setAttribute("width",2*this._dimensions.width),this._dom.refs.videoCanvas.setAttribute("height",this._dimensions.height),this._dom.refs.canvas.setAttribute("width",this._dimensions.width),this._dom.refs.canvas.setAttribute("height",this._dimensions.height))}__clickOn(e){this._props.onClick&&this._props.onClick(this._props.id,this._props.clickActions)}__onCloseButtonClick(){this._props.onClose&&this._props.onClose(this._props.id)}__onError(e=""){this._props.onError&&this._props.onError(this._props.id,e)}}class Qs extends fs{constructor(e){super(e),this._dom={root:null},this._component={injections:[]}}uiGetDeclaredProps(){return{displayed:"boolean",injections:"object",playing:"boolean",seeking:"boolean",loading:"boolean",streamingLive:"boolean",startTime:"number",currentTime:"number",duration:"number",videoDimensions:"object",controlPanelIntersectionHeight:"number",onClick:["function","object"],onClose:["function","object"],onError:["function","object"]}}uiGetDefaultProps(){return{displayed:!0,injections:[],playing:!1,seeking:!1,loading:!1,startTime:-1,currentTime:0,duration:0,controlPanelIntersectionHeight:0,onClick:null,onClose:null,onError:null}}_onUiBuild(e){this._dom.root=es("div",{className:"c-Injections"})}_onUiCanUpdate(e){return JSON.stringify(e.injections)!=JSON.stringify(this._props.injections)||JSON.stringify(e.videoDimensions)!=JSON.stringify(this._props.videoDimensions)||e.controlPanelIntersectionHeight!=this._props.controlPanelIntersectionHeight||e.startTime!=this._props.startTime||e.currentTime!=this._props.currentTime||e.duration!=this._props.duration||e.playing!=this._props.playing||e.seeking!=this._props.seeking||e.displayed!=this._props.displayed||e.loading!=this._props.loading}_onUiUpdate(e){e.displayed!=this._props.displayed&&this.__setDisplayed(e.displayed);for(let t=this._component.injections.length-1;t>=0;t--){const i=this._component.injections[t],s=i.getId();e.injections.find(e=>e.id===s)||this.__removeInjection(i,t)}e.injections.forEach(t=>{const i=this._component.injections.find(e=>e.getId()===t.id);i?i.uiUpdate(this.__getPropsForInjection(e,t)):this.__addInjection(t,e)})}__getPropsForInjection(e,t){return Object.assign({contentPlaying:e.playing,contentSeeking:e.seeking,contentLoading:e.loading,contentStart:e.startTime,contentTime:e.currentTime,contentDuration:e.duration,contentStreamingLive:e.streamingLive,videoDimensions:e.videoDimensions,controlPanelIntersectionHeight:e.controlPanelIntersectionHeight,onClick:e.onClick,onClose:e.onClose,onError:e.onError},t)}__createComponent(e){const t=new qs(e);return t.uiInit(),t.uiSetEventEmitter(this.__eventEmitter),t.uiBuild(),t}__addInjection(e,t){const i=this.__createComponent(this.__getPropsForInjection(t,e));this._component.injections.push(i),ts(this._dom.root).append(i.uiGetElement()),i.uiForceUpdate()}__removeInjection(e,t){ts(this._dom.root).remove(e.uiGetElement()),this._component.injections.splice(t,1),e.uiDestroy()}__setDisplayed(e){ts(this._dom.root).setDisplayed(e)}}class Ys extends fs{constructor(e){super(e),this._dom={root:null,refs:{activeLayer:null,clickthroughContainer:null,injectionsContainer:null,ctrlPanelContainer:null,techContainer:null}},this._component={clickthrough:null,actionArea:null,adOnlyCtrlPanel:null,injections:null},this._bind=["__onClickThroughLinkClick","__onActionAreaClick","__onMouseEnter","__onMouseLeave","__onMouseMove","__onTouchStart","__onTouchEnd","__onControlPanelHoverOn","__onControlPanelHoverOff","__onMuteClick","__onVolumeChange","__onInjectionClick","__onInjectionClose","__onInjectionError"],this._flags={mouseUsed:!1,touchUsed:!1},this._lastMousePos={x:0,y:0},this._mouseUsedOffTimeout=0,this._mouseMoveTimeout=0}uiGetDeclaredProps(){return{adLayout:"string",adCanceled:"boolean",clickthroughTarget:"string",clickthroughUrl:"string",controlPanelShown:"boolean",controlPanelFulltimeHidden:"boolean",controlPanelPreventHidding:"boolean",startTime:"number",currentTime:"number",displayed:"boolean",adPoints:"object",buffered:"object",duration:"number",fullscreenEnabled:"boolean",fullscreenOn:"boolean",pipAvailable:"boolean",pipOn:"boolean",cinemaAvailable:"boolean",cinemaOn:"boolean",airPlayAvailable:"boolean",airPlayOn:"boolean",chromeCastAvailable:"boolean",chromeCastOn:"boolean",indicatorColor:"string",isEvent:"boolean",isLive:"boolean",layout:"string",loading:"boolean",seeking:"boolean",playing:"boolean",playingLive:"boolean",seekSource:"object",sourceReady:"boolean",progressBarColor:"string",qualities:"object",qualityId:["object","number"],qualityMenuShown:"boolean",subtitlesList:"object",subtitlesId:["object","number"],subtitlesMenuShown:"boolean",audioTrackList:"object",audioTrackId:["object","number"],audioTrackMenuShown:"boolean",videoTrackList:"object",videoTrackId:["object","number"],videoTrackMenuShown:"boolean",seekingEnabled:"boolean",additionalMenuShown:"boolean",settingsMenuShown:"boolean",settingsEnabled:"boolean",settingsVisible:"boolean",qualityEnabled:"boolean",subtitlesEnabled:"boolean",additionalEnabled:"boolean",audioTrackEnabled:"boolean",videoTrackEnabled:"boolean",pipEnabled:"boolean",cinemaEnabled:"boolean",airPlayEnabled:"boolean",chromeCastEnabled:"boolean",skippableAfter:"number",countdownBefore:"number",adsCountCurrent:"number",adsCountTotal:"number",allowedToSkip:"boolean",streamingLive:"boolean",tvMode:"boolean",subtitlesShown:"boolean",textLoading:"string",textPlay:"string",textPause:"string",textMute:"string",textUnmute:"string",textVolume:"string",textVolumeValueOn:"string",textSeekbarEnabled:"string",textSeekbarDisabled:"string",textSeekbarPlayed:"string",textSeekbarPlayedPrepos:"string",textSettings:"string",textSettingsClose:"string",textSettingsExpand:"string",textSubtitlesEnabled:"string",textSubtitlesDisabled:"string",textSubtitles:"string",textSubtitlesHide:"string",textQuality:"string",textQualityEnabled:"string",textQualityDisabled:"string",textAudioTracks:"string",textVideoTracks:"string",textFullscreenOn:"string",textFullscreenOff:"string",textPipOn:"string",textPipOff:"string",textCinemaOn:"string",textCinemaOff:"string",textAd:"string",textAdPoint:"string",textAdSkip:"string",textAdSkipAfter:"string",textAdCountdown:"string",textAdWeb:"string",textSponsor:"string",textPromo:"string",textLive:"string",textSetLive:"string",textIsLivePlaying:"string",textLiveFromStart:"string",textSetLiveFromStart:"string",textTvMode:"string",textAction:"string",textContentInfoTrigger:"string",textContentInfoOpen:"string",textContentInfoClose:"string",textContentInfoLinkLabel:"string",textReplayContent:"string",textReplayContentPlayed:"string",volume:"number",volumeMuted:"boolean",injections:"object",tech:"object",videoDimensions:"object",contentInfo:"object",splashInfoDisplayed:"boolean",ppShown:"boolean",controlPanelIntersectionHeight:"number",useTouch:"boolean",visibleElements:"object",contentInfoShown:"boolean",isLargeUi:"boolean",ppInContent:"boolean",isEnded:"boolean",followingShown:"boolean",followingTeasers:"object",followingPreviewShown:"boolean",followingTimerTime:"number",followingTimerProgress:"number",transitionEnabled:"boolean",transitionPreviewEnabled:"boolean",transitionTimerShown:"boolean",timerCanceled:"boolean",onTimerCancelClick:["function","object"],chaptersShown:"boolean",episodesShown:"boolean",castMenuShown:"boolean",programmeShown:"boolean",programmeData:"object",episodesData:"object",preventPauseOnClick:"boolean",chaptersData:"object",audioList:"object"}}_onUiInit(e){this._component.adOnlyCtrlPanel=new Fs(this.__getPropsForControlPanel(e)),this._component.actionArea=new Ds(this.__getPropsForActionArea(e)),this._component.clickthrough=new Ms(this.__getPropsForClickthrough(e)),this._component.injections=new Qs(this.__getPropsForInjections(e))}_onUiBuild(e){this._dom.root=es("div",{className:"w-AdOnlyLayout"}),this._dom.refs.activeLayer=es("div",{className:"w-AdOnlyLayoutActiveLayer"}),this._dom.refs.ctrlPanelContainer=es("div",{className:"w-AdOnlyLayoutCtrlPanel"}),this._dom.refs.techContainer=es("div",{className:"w-AdOnlyLayoutTech"}),this._dom.refs.clickthroughContainer=es("div",{className:"w-AdOnlyLayoutClickthrough"}),this._dom.refs.injectionsContainer=es("div",{className:"w-AdOnlyLayoutInjections"}),ts(this._dom.root).append(ts(this._dom.refs.activeLayer).append(ts(this._dom.refs.injectionsContainer).append(this._component.injections.uiGetElement()),this._component.actionArea.uiGetElement(),ts(this._dom.refs.clickthroughContainer).append(this._component.clickthrough.uiGetElement()),this._dom.refs.techContainer),ts(this._dom.refs.ctrlPanelContainer).append(this._component.adOnlyCtrlPanel.uiGetElement())),this.__setDisplayed(e.displayed),this.__setDisplayedTechContainer(e.tech&&e.tech.elm),e.tech&&e.tech.elm&&e.tech.adOnly&&this._dom.refs.techContainer.appendChild(e.tech.elm),this.__registerMouseOverEvents()}_onUiCanUpdate(e){return e.displayed||this._props.displayed!=e.displayed}_onUiUpdate(e){this._props.displayed!=e.displayed&&this.__setDisplayed(e.displayed),this.__setDisplayedTechContainer(e.tech&&e.tech.elm),e.tech!=this._props.tech&&(this._props.tech&&this._props.tech.elm&&this._dom.refs.techContainer.hasChildNodes()&&this._dom.refs.techContainer.removeChild(this._props.tech.elm),e.tech&&e.tech.elm&&e.tech.adOnly&&this._dom.refs.techContainer.appendChild(e.tech.elm)),this.__setDimensionsInjectionContainer(e.videoDimensions),this._component.adOnlyCtrlPanel.uiUpdate(this.__getPropsForControlPanel(e)),this._component.actionArea.uiUpdate(this.__getPropsForActionArea(e)),this._component.clickthrough.uiUpdate(this.__getPropsForClickthrough(e)),this._component.injections.uiUpdate(this.__getPropsForInjections(e))}_onUiDestroy(){this.__clearMouseUsedOffTimeout(),this.__clearMouseMoveTimeout(),this.__unregisterMouseOverEvents(),this.__unregisterTouchEvents()}__registerMouseOverEvents(){this._dom.root.addEventListener("mouseenter",this.__onMouseEnter),this._dom.root.addEventListener("mousemove",this.__onMouseMove),this._dom.root.addEventListener("mouseleave",this.__onMouseLeave)}__registerTouchEvents(){this._dom.refs.activeLayer.addEventListener("touchstart",this.__onTouchStart),this._dom.refs.activeLayer.addEventListener("touchcancel",this.__onTouchEnd),this._dom.refs.activeLayer.addEventListener("touchend",this.__onTouchEnd)}__unregisterMouseOverEvents(){this._dom.root.removeEventListener("mouseenter",this.__onMouseEnter),this._dom.root.removeEventListener("mousemove",this.__onMouseMove),this._dom.root.removeEventListener("mouseleave",this.__onMouseLeave)}__unregisterTouchEvents(){this._dom.refs.activeLayer.removeEventListener("touchstart",this.__onTouchStart),this._dom.refs.activeLayer.removeEventListener("touchcancel",this.__onTouchEnd),this._dom.refs.activeLayer.removeEventListener("touchend",this.__onTouchEnd)}__getPropsForControlPanel(e){const{controlPanelShown:t,controlPanelFulltimeHidden:i,currentTime:s,duration:n,progressBarColor:o,textMute:r,textUnmute:a,textVolume:l,textVolumeValueOn:h,useTouch:_,volume:d,volumeMuted:u}=e;return{visible:t&&!e.useTouch,controlPanelFulltimeHidden:i,currentTime:s,duration:n,progressBarColor:o,textMute:r,textUnmute:a,textVolume:l,textVolumeValueOn:h,volume:d,volumeMuted:u,useTouch:_,onMuteClick:this.__onMuteClick,onVolumeChange:this.__onVolumeChange,onHoverOn:this.__onControlPanelHoverOn,onHoverOff:this.__onControlPanelHoverOff}}__getPropsForActionArea(e){return{displayed:e.visibleElements.actionArea,onClick:this.__onActionAreaClick}}__getPropsForClickthrough(e){return{fullSizeLook:!1,displayed:!!e.clickthroughUrl&&e.visibleElements.adClickthrough,labelDisplayed:!0,href:e.clickthroughUrl,target:e.clickthroughTarget||"_blank",text:`${e.textAdWeb}`,onClick:this.__onClickThroughLinkClick}}__getPropsForInjections(e){return{displayed:e.visibleElements.injections,injections:e.injections,playing:e.playing,seeking:e.seeking,loading:e.loading,startTime:e.startTime,currentTime:e.currentTime,duration:e.duration,streamingLive:e.streamingLive,videoDimensions:e.videoDimensions,controlPanelIntersectionHeight:e.controlPanelIntersectionHeight||0,onClick:this.__onInjectionClick,onClose:this.__onInjectionClose,onError:this.__onInjectionError}}__setDisplayed(e){ts(this._dom.root).setDisplayed(e)}__setDisplayedTechContainer(e){ts(this._dom.refs.techContainer).setDisplayed(e)}__setDimensionsInjectionContainer(e){if(!e)return;ts(this._dom.refs.injectionsContainer).setStyle({top:`${e.y}px`,left:`${e.x}px`,width:`${e.width}px`,height:`${e.height}px`})}__mousePosChanged(e,t){return this._lastMousePos.x!=e||this._lastMousePos.y!=t}__saveMousePos(e,t){this._lastMousePos={x:e,y:t}}__saveMouseUsed(e){this._flags.mouseUsed=e,e&&this.__startMouseUsedOffTimeout()}__saveTouchUsed(e){this._flags.touchUsed=e,e&&this.__clearMouseMoveTimeout()}__startMouseUsedOffTimeout(){this.__clearMouseUsedOffTimeout(),this._mouseUsedOffTimeout=setTimeout(()=>this.__saveMouseUsed(!1))}__clearMouseUsedOffTimeout(){this._mouseUsedOffTimeout&&(clearTimeout(this._mouseUsedOffTimeout),this._mouseUsedOffTimeout=0)}__onMouseEnter(e){this._flags.touchUsed||(this.__saveMouseUsed(!0),this._uiEmitEvent(ys.SHOW_CONTROL_PANEL))}__onMouseLeave(e){}__onMouseMove(e){this.__clearMouseMoveTimeout(),this._mouseMoveTimeout=setTimeout(()=>{this._flags.touchUsed||(this.__saveMouseUsed(!0),this.__mousePosChanged(e.screenX,e.screenY)&&(this.__saveMousePos(e.screenX,e.screenY),this._uiEmitEvent(ys.SHOW_CONTROL_PANEL)))})}__clearMouseMoveTimeout(){this._mouseMoveTimeout&&(clearTimeout(this._mouseMoveTimeout),this._mouseMoveTimeout=0)}__onTouchStart(e){this._flags.mouseUsed||this.__saveTouchUsed(!0)}__onTouchEnd(e){this._flags.mouseUsed}__onControlPanelHoverOn(){this.__emitCtrlPanelHovered(!0)}__onControlPanelHoverOff(){this.__emitCtrlPanelHovered(!1)}__onVolumeChange(e){this._uiEmitEvent(ys.VOLUME_CHANGE_TO,{volume:e})}__onMuteClick(){this._uiEmitEvent(ys.VOLUME_MUTE_CLICK)}__onClickThroughLinkClick(){this._uiEmitEvent(ys.CLICK_ON_CLICKTHROUGH_LINK)}__onActionAreaClick(){this._uiEmitEvent(ys.VOLUME_MUTE_CLICK)}__onInjectionClick(e,t){this._uiEmitEvent(ys.CLICK_ON_INJECTION,{id:e,clickActions:t})}__onInjectionClose(e){this._uiEmitEvent(ys.CLOSE_INJECTION,{id:e})}__onInjectionError(e,t){this._uiEmitEvent(ys.ERROR_INJECTION,{id:e,error:t})}__emitCtrlPanelHovered(e){this._uiEmitEvent(ys.CTRL_PANEL_HOVERED,{hovered:e})}}const zs=720;class Ws extends fs{constructor(e){super(e),this._dom={root:null,refs:{title:null}},this._bind=["__onClick"]}uiGetDeclaredProps(){return{id:["string","number","object"],indicatorColor:"string",text:"string",data:"object",selected:"boolean",onClick:["function","object"]}}uiGetDefaultProps(){return{id:null,indicatorColor:"",text:"",data:null,selected:!1,onClick:null}}_onUiInit(e){}_onUiBuild(e){this._dom.root=es("button",{className:"c-HybridMenuListItem",type:"button"}),this._dom.refs.title=es("span",{className:"c-HybridMenuListItem__title"}),ts(this._dom.root).append(this._dom.refs.title),this._dom.root.addEventListener("click",this.__onClick),this.__updateTitle(e),this.__updateIndicatorColor(e),this.__updateSelected(e)}_onUiUpdate(e){this._props.text!==e.title&&this.__updateTitle(e),this._props.indicatorColor!==e.indicatorColor&&this.__updateIndicatorColor(e),this._props.selected!==e.selected&&this.__updateSelected(e)}_onUiDestroy(){this._dom.root.removeEventListener("click",this.__onClick)}__updateTitle(e){ts(this._dom.refs.title).setInnerHTML(e.text),e.data&&e.data.resolution&&e.data.resolution.height&&e.data.resolution.height>=zs&&ts(this._dom.refs.title).cssClasses({"-high-definition":!0})}__updateIndicatorColor(e){ts(this._dom.refs.title).setStyle({"border-color":e.indicatorColor})}__updateSelected(e){ts(this._dom.root).cssClasses({"-selected":e.selected})}__onClick(){this._props.onClick&&this._props.onClick(this._props.id)}}class Ks extends fs{constructor(e){super(e),this._dom={root:null,refs:{title:null,indicator:null}},this._bind=["__onClick"]}uiGetDeclaredProps(){return{displayed:"boolean",title:"string",selected:"boolean",indicatorColor:"string",onClick:["function","object"]}}uiGetDefaultProps(){return{displayed:!0,title:"",selected:!1,indicatorColor:"",onClick:null}}_onUiInit(e){}_onUiBuild(e){this._dom.root=es("button",{className:"c-HybridMenuCheckbox",type:"button"}),this._dom.refs.title=es("span",{className:"c-HybridMenuCheckbox__title"}),this._dom.refs.indicator=es("div",{className:"w-HybridMenuCheckboxIndicator",innerHTML:'\n\t\t\t\t<div class="w-HybridMenuCheckboxIndicator__svg">\n\t\t\t\t\t<svg version="1.1" xmlns="http://www.w3.org/2000/svg"\n\t\t\t\t\t\txmlns:xlink="http://www.w3.org/2000/svg" tabIndex="-1"\n\t\t\t\t\t\tfocusable="false">\n\t\t\t\t\t\t<rect x="0" y="0" width="100%" height="100%"/>\n\t\t\t\t\t</svg>\n\t\t\t\t</div>\n\t\t\t'}),ts(this._dom.root).append(this._dom.refs.title,this._dom.refs.indicator),this._dom.root.addEventListener("click",this.__onClick),this.__setDisplayed(e.displayed),this.__updateTitle(e),this.__updateSelected(e),this.__updateIndicatorColor(e)}_onUiUpdate(e){this._props.title!==e.title&&this.__updateTitle(e),this._props.selected!==e.selected&&this.__updateSelected(e),this._props.indicatorColor!==e.indicatorColor&&this.__updateIndicatorColor(e)}_onUiDestroy(){this._dom.root.removeEventListener("click",this.__onClick)}__setDisplayed(e){ts(this._dom.root).setDisplayed(e)}__updateTitle(e){ts(this._dom.refs.title).setInnerHTML(e.title)}__updateSelected(e){ts(this._dom.root).cssClasses({"-selected":e.selected})}__updateIndicatorColor(e){const t=this._dom.refs.indicator.querySelector("svg");t&&ts(t).setStyle({fill:e.indicatorColor,stroke:e.indicatorColor})}__onClick(e){this._props.onClick&&this._props.onClick()}}class $s extends fs{constructor(e){super(e),this._dom={root:null,refs:{title:null,indicator:null}},this._component={icon:null},this._bind=["__onClick"]}uiGetDeclaredProps(){return{displayed:"boolean",title:"string",iconProps:"object",selected:"boolean",indicatorColor:"string",onClick:["function","object"]}}uiGetDefaultProps(){return{displayed:!0,title:"",iconProps:null,selected:!1,indicatorColor:"",onClick:null}}_onUiInit(e){this._component.icon=new Ls(this.__getPropsForIcon(e))}_onUiBuild(e){this._dom.root=es("button",{className:"c-HybridMenuButton",type:"button"}),this._dom.refs.title=es("span",{className:"c-HybridMenuButton__title"}),this._dom.refs.indicator=es("div",{className:"w-HybridMenuCheckboxIndicator",innerHTML:'\n\t\t\t\t<div class="w-HybridMenuCheckboxIndicator__svg">\n\t\t\t\t\t<svg version="1.1" xmlns="http://www.w3.org/2000/svg"\n\t\t\t\t\t\txmlns:xlink="http://www.w3.org/2000/svg" tabIndex="-1"\n\t\t\t\t\t\tfocusable="false">\n\t\t\t\t\t\t<rect x="0" y="0" width="100%" height="100%"/>\n\t\t\t\t\t</svg>\n\t\t\t\t</div>\n\t\t\t'}),ts(this._dom.root).append(this._component.icon.uiGetElement(),this._dom.refs.title),this._dom.root.addEventListener("click",this.__onClick),this.__setDisplayed(e.displayed),this.__updateTitle(e)}_onUiUpdate(e){this._props.title!==e.title&&this.__updateTitle(e),this._component.icon.uiUpdate(this.__getPropsForIcon(e))}_onUiDestroy(){this._dom.root.removeEventListener("click",this.__onClick)}__getPropsForIcon(e){return e.iconProps||{}}__setDisplayed(e){ts(this._dom.root).setDisplayed(e)}__updateTitle(e){ts(this._dom.refs.title).setInnerHTML(e.title)}__onClick(e){this._props.onClick&&this._props.onClick()}}const Xs={DEFAULT:"default",CHECKBOX:"checkbox",BUTTON:"button"};class Zs extends fs{constructor(e){super(e),this._dom={root:null,refs:{trigger:null,triggerTitle:null,triggerIndicator:null,content:null}},this._component={triggerIcon:null,listItems:null},this._bind=["__onListItemClick","__onTriggerClick"]}uiGetDeclaredProps(){return{displayed:"boolean",type:"string",opened:"boolean",expanded:"boolean",indicatorColor:"string",items:"object",title:"string",onItemClick:["function","object"],onTriggerClick:["function","object"]}}uiGetDefaultProps(){return{displayed:!0,type:"default",opened:!1,expanded:!1,indicatorColor:"",items:[],title:"",onItemClick:null,onTriggerClick:null}}_onUiInit(e){this._component.triggerIcon=new Ls(this.__getPropsForTriggerIcon(e)),this._component.listItems=this.__createListItems(e)}_onUiBuild(e){this._dom.root=es("div",{className:"c-HybridMenuList"}),this._dom.refs.trigger=es("button",{className:"w-HybridMenuListTrigger",type:"button"}),this._dom.refs.triggerTitle=es("span",{className:"w-HybridMenuListTrigger__title"}),this._dom.refs.triggerIndicator=es("span",{className:"w-HybridMenuListTrigger__indicator"}),this._dom.refs.content=es("div",{className:"w-HybridMenuListContent"}),ts(this._dom.root).append(ts(this._dom.refs.trigger).append(this._component.triggerIcon.uiGetElement(),this._dom.refs.triggerTitle,this._dom.refs.triggerIndicator),this._dom.refs.content),this.__setDisplayed(e),this.__updateOpen(e),this.__updateExpanded(e),this.__updateTitle(e),this.__updateIndicator(e),this.__buildListItems(),this._dom.refs.trigger.addEventListener("click",this.__onTriggerClick)}_onUiUpdate(e){this._props.displayed!==e.displayed&&this.__setDisplayed(e),JSON.stringify(this._props.items)===JSON.stringify(e.items)&&this._props.indicatorColor===e.indicatorColor||(this._props.items.length===e.items.length?this.__updateListItems(e):(this.__destroyCurrentListItems(),this._component.listItems=this.__createListItems(e),this.__buildListItems())),this._props.title!==e.title&&this.__updateTitle(e),JSON.stringify(this._props.items)!==JSON.stringify(e.items)&&this.__updateIndicator(e),this._props.expanded!==e.expanded&&this.__updateExpanded(e),this._props.opened!==e.opened&&(this.__updateOpen(e),this._component.triggerIcon.uiUpdate(this.__getPropsForTriggerIcon(e)))}_onUiDestroy(){this._dom.refs.trigger.removeEventListener("click",this.__onTriggerClick)}__setDisplayed(e){ts(this._dom.root).setDisplayed(e.displayed)}__updateOpen(e){ts(this._dom.root).cssClasses({"-open":e.opened}),ts(this._dom.refs.triggerIndicator).setDisplayed(!e.opened)}__updateExpanded(e){ts(this._dom.root).cssClasses({"-expanded":e.expanded})}__updateTitle(e){ts(this._dom.refs.triggerTitle).setInnerHTML(e.title)}__updateIndicator(e){const t=e.items.filter(e=>e.selected);let i=1===t.length?t[0].text:"";ts(this._dom.refs.triggerIndicator).setInnerHTML(i)}__createListItems(e){switch(e.type){case Xs.DEFAULT:return e.items.map(t=>new Ws({indicatorColor:e.indicatorColor,id:t.id,text:t.text,data:t.data,selected:t.selected,onClick:this.__onListItemClick}));case Xs.CHECKBOX:return e.items.map(t=>new Ks({displayed:t.displayed,indicatorColor:e.indicatorColor,title:t.title,selected:t.selected,onClick:t.onClick}));case Xs.BUTTON:return e.items.map(t=>new $s({displayed:t.displayed,indicatorColor:e.indicatorColor,iconProps:t.iconProps,title:t.title,onClick:t.onClick}))}}__buildListItems(){ts(this._dom.refs.content).append(this._component.listItems.map(e=>(e.uiInited()||e.uiInit(),e.uiBuilt()||e.uiBuild(),e.uiGetElement())))}__updateListItems(e){switch(e.type){case Xs.DEFAULT:e.items.forEach((t,i)=>{this._component.listItems[i].uiUpdate({indicatorColor:e.indicatorColor,id:t.id,text:t.text,selected:t.selected,onClick:this.__onListItemClick})});break;case Xs.CHECKBOX:e.items.forEach((t,i)=>{this._component.listItems[i].uiUpdate({displayed:t.displayed,title:t.title,selected:t.selected,indicatorColor:e.indicatorColor,onClick:t.onClick})});break;case Xs.BUTTON:e.items.forEach((t,i)=>{this._component.listItems[i].uiUpdate({displayed:t.displayed,title:t.title,iconProps:t.iconProps,indicatorColor:e.indicatorColor,onClick:t.onClick})})}}__destroyCurrentListItems(){this._component.listItems.forEach(e=>e.uiDestroy()),ts(this._dom.refs.content).clear()}__getPropsForTriggerIcon(e){return{"chevron-right":{displayed:!e.opened},"chevron-left":{displayed:e.opened}}}__onTriggerClick(e){this._props.onTriggerClick&&this._props.onTriggerClick()}__onListItemClick(e){this._props.onItemClick&&this._props.onItemClick(e)}}class Js extends fs{constructor(e){super(e),this._dom={root:null,refs:{}},this._component={listMenus:null}}uiGetDeclaredProps(){return{indicatorColor:"string",listMenus:"object"}}uiGetDefaultProps(){return{indicatorColor:"",listMenus:[]}}_onUiInit(e){this._component.listMenus=this.__createListMenus(e)}_onUiBuild(e){this._dom.root=es("div",{className:"w-HybridMenuContent"}),this.__buildListMenus()}_onUiUpdate(e){JSON.stringify(this._props.listMenus)===JSON.stringify(e.listMenus)&&this._props.indicatorColor===e.indicatorColor||(this._props.listMenus.length===e.listMenus.length?this.__updateListMenus(e):(this.__destroyCurrentListMenus(),this._component.listMenus=this.__createListMenus(e),this.__buildListMenus()))}__createListMenus(e){return e.listMenus.map(t=>new Zs({displayed:t.displayed,type:t.type,expanded:t.expanded,opened:t.opened,indicatorColor:e.indicatorColor,items:t.items,title:t.title,onItemClick:t.onItemClick,onTriggerClick:t.onTriggerClick}))}__buildListMenus(){ts(this._dom.root).append(this._component.listMenus.map(e=>(e.uiInited()||e.uiInit(),e.uiBuilt()||e.uiBuild(),e.uiGetElement())))}__updateListMenus(e){e.listMenus.forEach((t,i)=>{this._component.listMenus[i].uiUpdate({displayed:t.displayed,type:t.type,expanded:t.expanded,opened:t.opened,indicatorColor:e.indicatorColor,items:t.items,title:t.title,onItemClick:t.onItemClick,onTriggerClick:t.onTriggerClick})})}__destroyCurrentListMenus(){this._component.listMenus.forEach(e=>e.uiDestroy()),ts(this._dom.root).clear()}}class en extends fs{constructor(e){super(e),this._dom={root:null,refs:{header:null,hybridMenuContent:null}},this._component={closeButton:null,hybridMenuContent:null},this._bind=["__onMouseEnter","__onMouseLeave","__onCloseButtonClick"],this._flags={}}uiGetDeclaredProps(){return{displayed:"boolean",indicatorColor:"string",title:"string",titleClose:"string",listMenus:"object",textSettingsExpand:"string",onHoverOn:["function","object"],onHoverOff:["function","object"],onCloseClick:["function","object"]}}uiGetDefaultProps(){return{displayed:!1,title:"",titleClose:"",indicatorColor:"",listMenus:null,textSettingsExpand:"",onHoverOn:null,onHoverOff:null,onCloseClick:null}}_onUiInit(e){this._component.closeButton=new Os(this.__getPropsForCloseButton(e)),this._component.hybridMenuContent=new Js(this.__getPropsForHybridMenuContent(e))}_onUiBuild(e){this._dom.root=es("div",{className:"c-HybridMenu"}),this._dom.refs.header=es("div",{className:"w-HybridMenuHeader"}),this._dom.refs.headerTitle=es("span",{className:"w-HybridMenuHeader__title"}),ts(this._dom.root).append(ts(this._dom.refs.header).append(this._dom.refs.headerTitle,this._component.closeButton.uiGetElement()),this._component.hybridMenuContent.uiGetElement()),this.__registerMouseEvents(),this.__setDisplayed(e.displayed),this.__updateTitle(e.title),this.__checkForOpenMenu(e)}_onUiCanUpdate(e){return e.displayed||this._props.displayed!=e.displayed}_onUiUpdate(e){this._props.displayed!==e.displayed&&this.__setDisplayed(e.displayed),this._props.title!==e.title&&this.__updateTitle(e.title),JSON.stringify(this._props.listMenus)!==JSON.stringify(e.listMenus)&&(this._component.hybridMenuContent.uiUpdate(this.__getPropsForHybridMenuContent(e)),this.__checkForOpenMenu(e)),this._component.closeButton.uiUpdate(this.__getPropsForCloseButton(e))}_onUiDestroy(e){this.__unregisterMouseEvents()}__registerMouseEvents(){this._dom.root.addEventListener("mouseenter",this.__onMouseEnter),this._dom.root.addEventListener("mouseleave",this.__onMouseLeave)}__unregisterMouseEvents(){this._dom.root.removeEventListener("mouseenter",this.__onMouseEnter),this._dom.root.removeEventListener("mouseleave",this.__onMouseLeave)}__setDisplayed(e){ts(this._dom.root).setDisplayed(e)}__checkForOpenMenu(e){const t=e.listMenus.filter(e=>e.opened),i=t.filter(e=>e.expanded);ts(this._dom.root).cssClasses({"-list-menu-open":!!t.length,"-expanded-open":!!i.length})}__updateTitle(e){ts(this._dom.refs.headerTitle).setInnerHTML(e)}__getPropsForCloseButton(e){return{displayed:!0,iconProps:{cross:{displayed:!0}},onClick:this.__onCloseButtonClick}}__getPropsForHybridMenuContent(e){return{listMenus:e.listMenus,indicatorColor:e.indicatorColor}}__onMouseEnter(e){this._props.onHoverOn&&this._props.onHoverOn()}__onMouseLeave(e){this._props.onHoverOff&&this._props.onHoverOff()}__onCloseButtonClick(e){this._props.onCloseClick&&(this._props.onHoverOff(),this._props.onCloseClick())}}class tn extends fs{constructor(e){super(e),this._dom={root:null,refs:{text:null}}}uiGetDeclaredProps(){return{text:"string",displayed:"boolean"}}uiGetDefaultProps(){return{text:"",displayed:!1}}_onUiBuild(e){this._dom.root=es("div",{className:"c-AdCaption"}),this._dom.refs.text=es("span",{className:"c-AdCaption__text"}),ts(this._dom.root).append(this._dom.refs.text),this.__setDisplayed(e.displayed),this.__setText(e.text)}_onUiUpdate(e){this._props.text!=e.text&&this.__setText(e.text),this._props.displayed!=e.displayed&&this.__setDisplayed(e.displayed)}__setText(e){this._dom.refs.text.innerHTML=e}__setDisplayed(e){ts(this._dom.root).setDisplayed(e)}}class sn extends fs{constructor(e){super(e),this._dom={root:null},this._bind=["__clickOn"]}uiGetDeclaredProps(){return{displayed:"boolean",text:"string",active:"boolean",indicatorColor:"string",onClick:"function",extraClass:"object"}}uiGetDefaultProps(){return{displayed:!0,active:!1,indicatorColor:"",onClick:null,extraClass:[]}}_onUiBuild(e){this._dom.root=es("button",{className:"c-TextButton",type:"button"}),this.__setText(e.text),this.__setClass(e.extraClass),this.__setDisplayed(e.displayed),this.__setAriaAttr(e),this._dom.root.addEventListener("click",this.__clickOn)}_onUiUpdate(e){this._props.active!=e.active&&this.__setActive(e.active),this._props.indicatorColor!=e.indicatorColor&&this.__setIndicatorColor(e.indicatorColor),this._props.text!=e.text&&this.__setText(e.text),this._props.extraClass!=e.extraClass&&this.__setClass(e.extraClass),this._props.displayed!=e.displayed&&this.__setDisplayed(e.displayed)}_onUiDestroy(){this._dom.root.removeEventListener("click",this.__clickOn)}__setClass(e=[]){const t="c-TextButton"+(e&&e.length?" "+e.join(" "):"");this._dom.root.setAttribute("class",t)}__setDisplayed(e){ts(this._dom.root).setDisplayed(e)}__setIndicatorColor(e){ts(this._dom.root).setStyle({"border-bottom-color":e})}__setText(e){this._dom.root.innerHTML=e}__setActive(e){ts(this._dom.root).cssClasses({"-active":e})}__setAriaAttr(e){ts(this._dom.root).setAttr({"aria-label":e.text})}__clickOn(){this._props.onClick&&this._props.onClick()}}class nn extends fs{constructor(e){super(e),this._dom={root:null,refs:{countdownTitle:null,content:null,contentFollowing:null,contentTitle:null,progress:null}},this._component={cancelButton:null,cancelTextButton:null},this._bind=["__onCancelClick"],this._startTime=null,this._requestId=0,this._stoppedCountdown=0}uiGetDeclaredProps(){return{displayed:"boolean",collapse:"boolean",currentTime:"number",countdownText:"string",cancelText:"string",followingText:"string",contentTitle:"string",onCancel:["function","object"],indicatorColor:"string",timerTime:"number",timerProgress:"number",timerCancelable:"boolean"}}uiGetDefaultProps(){return{displayed:!1,collapse:!1,currentTime:0,countdownText:"",cancelText:"",followingText:"",contentTitle:"",onCancel:null,indicatorColor:"#d90000",timerTime:0,timerProgress:0,timerCancelable:!0}}_onUiInit(e){this._component.cancelButton=new Os(this.__getPropsForCancelButton(e)),this._component.cancelTextButton=new sn(this.__getPropsForTextCancelButton(e))}_onUiBuild(e){this._dom.root=es("div",{className:"c-PlayTimer"}),this._dom.refs.countdownTitle=es("span",{className:"c-PlayTimer__countdown"}),this._dom.refs.progress=es("div",{className:"c-PlayTimer__progress",innerHTML:'\n\t\t\t\t<svg version="1.1" xmlns="http://www.w3.org/2000/svg"\n\t\t\t\t\txmlns:xlink="http://www.w3.org/2000/svg" tabIndex="-1"\n\t\t\t\t\tfocusable="false">\n\t\t\t\t\t<rect x="0" y="0" width="0" height="100%"/>\n\t\t\t\t</svg>\n\t\t\t'}),this._dom.refs.content=es("div",{className:"w-PlayTimerContent"}),this._dom.refs.contentFollowing=es("span",{className:"w-PlayTimerContent__following"}),this._dom.refs.contentTitle=es("div",{className:"w-PlayTimerContent__title"}),ts(this._dom.root).append(this._dom.refs.countdownTitle,ts(this._dom.refs.content).append(this._dom.refs.contentFollowing,this._dom.refs.contentTitle),this._component.cancelTextButton.uiGetElement(),this._component.cancelButton.uiGetElement(),this._dom.refs.progress),this.__setDisplayed(e.displayed),this.__setCollapsed(e.collapse),this.__setContentFollowing(e)}_onUiUpdate(e){this._props.displayed!=e.displayed&&this.__setDisplayed(e.displayed),this._props.collapse!==e.collapse&&this.__setCollapsed(e.collapse),this._props.contentTitle!==e.contentTitle&&this.__setContentTitle(e),this._props.followingText!==e.followingText&&this.__setContentFollowing(e),this._props.indicatorColor!==e.indicatorColor&&this.__setIndicatorColor(e),this._props.timerTime!==e.timerTime&&this.__buttonTitleCountdown(e,Math.round(e.timerTime)),this._props.timerProgress!==e.timerProgress&&this.__setIndicatorProgress(e),this._component.cancelButton.uiUpdate(this.__getPropsForCancelButton(e)),this._component.cancelTextButton.uiUpdate(this.__getPropsForTextCancelButton(e))}_onUiDestroy(){}__getPropsForCancelButton(e){return{displayed:e.timerCancelable,iconProps:{cross:{displayed:!0}},onClick:this.__onCancelClick}}__getPropsForTextCancelButton(e){return{displayed:e.timerCancelable,text:e.cancelText,onClick:this.__onCancelClick}}__setDisplayed(e){ts(this._dom.root).setDisplayed(e)}__setCollapsed(e){ts(this._dom.root).cssClasses({"-collapsed":e})}__setIndicatorColor(e){const t=e.indicatorColor,i=this._dom.refs.progress.querySelector("svg > rect");i&&ts(i).setStyle({fill:t,stroke:t})}__setIndicatorProgress(e){const t=this._dom.refs.progress.querySelector("svg > rect");if(t){const i=isNaN(e.timerProgress)?0:e.timerProgress;ts(t).setAttr({width:`${i}%`})}}__buttonTitleCountdown(e,t){ts(this._dom.refs.countdownTitle).setInnerHTML(`${e.countdownText} ${t}s`)}__setContentTitle(e){ts(this._dom.refs.contentTitle).setInnerHTML(e.contentTitle)}__setContentFollowing(e){ts(this._dom.refs.contentFollowing).setInnerHTML(e.followingText)}__onCancelClick(e){this._props.onCancel&&this._props.onCancel()}}const on=56.25;class rn extends fs{constructor(e){super(e),this._dom={root:null,refs:{poster:null,posterSprite:null,posterVideo:null,backdrop:null,duration:null,checkbox:null,title:null,label:null,progress:null}},this._bind=["_onTeaserClick"]}uiGetDeclaredProps(){return{displayed:"boolean",id:"string",poster:"string",label:"string",title:"string",timerProgress:"number",indicatorColor:"string",timerCanceled:"boolean",timerShown:"boolean",disabled:"boolean",onTeaserClick:["function","object"],previewSource:"object",duration:"number"}}uiGetDefaultProps(){return{displayed:!0,poster:"",label:"",title:"",timerProgress:0,timerCanceled:!1,timerShown:!1,indicatorColor:"",onTeaserClick:null,disabled:!1,duration:0,previewSource:null}}_onUiInit(e){}_onUiBuild(e){this._dom.root=es("div",{className:"c-TeaserPreview"}),this._dom.refs.poster=es("img",{className:"c-TeaserPreview__poster"}),this._dom.refs.posterVideo=es("video",{className:"c-TeaserPreview__video",muted:"muted",loop:"loop",playsinline:"playsinline"}),this._dom.refs.posterSprite=es("div",{className:"c-TeaserPreview__sprite"}),this._dom.refs.backdrop=es("div",{className:"c-TeaserPreview__backdrop"}),this._dom.refs.duration=es("div",{className:"w-TeaserPreviewDuration"}),this._dom.refs.durationTime=es("div",{className:"w-TeaserPreviewDuration__time"}),this._dom.refs.checkbox=es("div",{className:"w-TeaserPreviewCheckbox"}),this._dom.refs.texts=es("div",{className:"w-TeaserPreviewTexts"}),this._dom.refs.title=es("h1",{className:"w-TeaserPreviewTexts__title"}),this._dom.refs.label=es("span",{className:"w-TeaserPreviewTexts__label"}),this._dom.refs.progress=es("div",{className:"c-TeaserPreview__progress",innerHTML:'\n\t\t\t\t<svg version="1.1" xmlns="http://www.w3.org/2000/svg"\n\t\t\t\t\txmlns:xlink="http://www.w3.org/2000/svg" tabIndex="-1"\n\t\t\t\t\tfocusable="false">\n\t\t\t\t\t<rect x="0" y="0" width="0" height="100%"/>\n\t\t\t\t</svg>\n\t\t\t'}),ts(this._dom.root).append(this._dom.refs.poster,this._dom.refs.posterSprite,this._dom.refs.posterVideo,this._dom.refs.backdrop,ts(this._dom.refs.duration).append(this._dom.refs.durationTime),ts(this._dom.refs.checkbox),ts(this._dom.refs.texts).append(this._dom.refs.label,this._dom.refs.title),this._dom.refs.progress),this._dom.root.addEventListener("click",this._onTeaserClick),this._updateDuration(e),this._updateTitle(e),this._updateLabel(e),this._updateDisabled(e),this.__setIndicatorColor(e),this.__setProgressVisible(e),this.__setDisplayed(e.displayed),e.previewSource?this._createPosterElement(e):this._createStaticPoster(e),ts(this._dom.refs.checkbox).stopClickPropagation()}_onUiUpdate(e){if(this._props.displayed!==e.displayed&&this.__setDisplayed(e.displayed),this._props.duration!==e.duration&&this._updateDuration(e),this._props.title!==e.title&&this._updateTitle(e),this._props.label!==e.label&&this._updateLabel(e),this._props.indicatorColor!==e.indicatorColor&&this.__setIndicatorColor(e),this._props.timerProgress!==e.timerProgress&&this.__setIndicatorProgress(e),this._props.timerShown!==e.timerShown&&(this.__updatePreviewPlayback(e),this.__setProgressVisible(e)),this._props.disabled!==e.disabled&&this._updateDisabled(e),e.previewSource){if(JSON.stringify(e.previewSource)==JSON.stringify(this._props.previewSource))return;this._createPosterElement(e)}else e.poster!==this._props.poster&&this._createStaticPoster(e)}_onUiDestroy(){}_updatePoster(e){ts(this._dom.refs.poster).setAttr({src:e.poster||""})}_updateDuration(e){ts(this._dom.refs.duration).setDisplayed(!!e.duration),ts(this._dom.refs.durationTime).setInnerHTML(o.formatTime(e.duration))}_updateTitle(e){ts(this._dom.refs.title).setInnerHTML(e.title).setDisplayed(!!e.title)}_updateLabel(e){ts(this._dom.refs.label).setInnerHTML(e.label).setDisplayed(!!e.label)}_updateDisabled(e){ts(this._dom.root).cssClasses({"-disabled":e.disabled})}__setDisplayed(e){ts(this._dom.root).setDisplayed(e)}__setProgressVisible(e){ts(this._dom.refs.progress).setDisplayed(e.timerShown)}__setIndicatorColor(e){const t=e.indicatorColor,i=this._dom.refs.progress.querySelector("svg > rect");i&&ts(i).setStyle({fill:t,stroke:t})}__setIndicatorProgress(e){const t=this._dom.refs.progress.querySelector("svg > rect");if(t){const i=isNaN(e.timerProgress)?0:e.timerProgress;ts(t).setAttr({width:`${i}%`})}}_clearPosters(){ts(this._dom.refs.poster).setDisplayed(!1),ts(this._dom.refs.posterVideo).setDisplayed(!1),ts(this._dom.refs.posterSprite).setDisplayed(!1),this._dom.refs.posterVideo.removeAttribute("src")}_createStaticPoster(e){this._clearPosters(),""!==e.poster&&(this._dom.refs.poster.src=e.poster,ts(this._dom.refs.poster).setDisplayed(!0))}_createPosterElement(e){if(this._clearPosters(),e.previewSource.video_preview&&e.previewSource.video_preview.url){this._dom.refs.posterVideo.src=e.previewSource.video_preview.url,this._dom.refs.posterVideo.muted=!0;const t=this._dom.refs.posterVideo.play();if(null!==t&&"object"==typeof t)return void t.then(()=>{!this._props.timerCanceled&&this._props.timerShown||this._dom.refs.posterVideo.pause(),ts(this._dom.refs.posterVideo).setDisplayed(!0)}).catch(e=>{})}this._createPosterSprite(e)}_createPosterSprite(e){const t=e.previewSource.sprite_preview;if(!(t&&t.url&&t.rows&&t.columns))return void this._createStaticPoster(e);const i=t.width/t.height,s=on*i,n=t.columns,o=t.rows;ts(this._dom.refs.posterSprite).setStyle({backgroundImage:`url(${t.url})`,width:`${s}%`,height:"100%",backgroundSize:`${100*n}% ${100*o}%`,backgroundPosition:"left center",animationDuration:`${t.frame_duration*n}s`,animationTimingFunction:`steps(${n}, end)`}),this.__updatePreviewPlayback(e),ts(this._dom.refs.posterSprite).setDisplayed(!0)}__updatePreviewPlayback(e){const t=e.timerShown;e.previewSource&&e.previewSource.video_preview&&e.previewSource.video_preview.url&&(t?this._dom.refs.posterVideo.play():this._dom.refs.posterVideo.pause()),ts(this._dom.refs.posterSprite).cssClasses({"-anim-stop":!t})}_onTeaserClick(e){this._props.onTeaserClick&&this._props.onTeaserClick()}}class an extends fs{constructor(e){super(e),this._dom={root:null,refs:{header:null,headerTitle:null,teasersWrapper:null}},this._component={teaser:null,playTimer:null},this._bind=["__onTimerCancel"],this._flags={timerRunning:!1}}uiGetDeclaredProps(){return{displayed:"boolean",currentTime:"number",indicatorColor:"string",teaser:"object",timerTime:"number",timerProgress:"number",timerCancelable:"boolean",onTimerCancelClick:["function","object"]}}uiGetDefaultProps(){return{displayed:!1,currentTime:0,indicatorColor:"",teaser:null,timerTime:0,timerProgress:0,timerCancelable:!1,onTimerCancelClick:null}}_onUiInit(e){this._component.teaser=this.__createTeaser(e),this._component.playTimer=new nn(this.__getPropsForPlayTimer(e))}_onUiBuild(e){this._dom.root=es("div",{className:"c-Following -only-one-teaser -active-preview -timer-shown"}),this._dom.refs.header=es("div",{className:"w-FollowingHeader"}),this._dom.refs.headerTitle=es("span",{className:"w-FollowingHeader__title",innerHTML:"Následuje"}),this._dom.refs.teasersScroll=es("div",{className:"w-FollowingTeasersScroll"}),this._dom.refs.teasersWrapper=es("div",{className:"w-FollowingTeasers"}),ts(this._dom.root).append(ts(this._dom.refs.header).append(this._component.playTimer.uiGetElement(),this._dom.refs.headerTitle),ts(this._dom.refs.teasersScroll).append(this._dom.refs.teasersWrapper)),this.__buildTeaser(),this.__setDisplayed(e),this.__setBackground(e.teaser.displayed)}_onUiUpdate(e){this._props.displayed!==e.displayed&&this.__setDisplayed(e),this._props.teaser.displayed!==e.teaser.displayed&&this.__setBackground(e.teaser.displayed);const t=JSON.stringify(this._props.teaser)!==JSON.stringify(e.teaser);(t||this._props.indicatorColor!==e.indicatorColor||this._props.timerProgress!==e.timerProgres||this._propt.timerShown!==e.timerShown)&&(t?(this.__destroyTeaser(),this._component.teaser=this.__createTeaser(e),this.__buildTeaser()):this.__updateTeaser(e)),this._component.playTimer.uiUpdate(this.__getPropsForPlayTimer(e))}_onUiDestroy(){}__getPropsForPlayTimer(e){return{displayed:!0,collapse:!e.timerCancelable&&!e.teaser.displayed,currentTime:e.currentTime,countdownText:"Reklama začne za",cancelText:"Zrušit",followingText:"Následuje reklama",contentTitle:e.teaser?e.teaser.title:"",onCancel:this.__onTimerCancel,indicatorColor:e.indicatorColor,timerTime:e.timerTime,timerProgress:e.timerProgress,timerCancelable:e.timerCancelable}}__setDisplayed(e){ts(this._dom.root).setDisplayed(e.displayed)}__setBackground(e){ts(this._dom.root).cssClasses({"-no-background":!e})}__createTeaser(e){const t=e.teaser;return new rn({displayed:t.displayed,id:t.id,poster:t.poster,label:t.label,title:t.title,disabled:t.disabled,onTeaserClick:t.onClick,timerProgress:e.timerProgress,timerShown:!0,indicatorColor:e.indicatorColor,timerCanceled:!1,previewSource:t.previewSource,duration:t.duration})}__buildTeaser(){const e=this._component.teaser;e.uiSetEventEmitter(this.__eventEmitter),e.uiInited()||e.uiInit(),e.uiBuilt()||e.uiBuild(),ts(this._dom.refs.teasersWrapper).append(e.uiGetElement())}__updateTeaser(e){const t=e.teaser;this._component.teaser.uiUpdate({displayed:t.displayed,id:t.id,poster:t.poster,label:t.label,title:t.title,onTeaserClick:t.onClick,timerProgress:e.timerProgress,timerShown:!0,indicatorColor:e.indicatorColor,timerCanceled:!1,previewSource:t.previewSource,duration:t.duration})}__destroyTeaser(){this._component.teaser.uiDestroy(),ts(this._dom.refs.teasersWrapper).clear()}__onTimerCancel(e){this._props.onTimerCancelClick&&this._props.onTimerCancelClick()}}class ln extends fs{constructor(e){super(e),this._dom={root:null,refs:{title:null,iconContainer:null}},this._bind=["__clickOn","__onFocus","__onBlur","__onPlayBridgeFocus","__onVolumeBridgeFocus"],this._disabled=!0}uiGetDeclaredProps(){return{displayed:"boolean",skipAllowed:"boolean",text:"string",fill:"number",onClick:["function","object"],getVolumeButton:["function","object"],getPlayPauseButton:["function","object"]}}uiGetDefaultProps(){return{displayed:!1,skipAllowed:!1,text:"",fill:0,onClick:null,getVolumeButton:null,getPlayPauseButton:null}}_onUiBuild(e){this._dom.root=es("button",{className:"c-AdSkipButton",type:"button",tabIndex:-1}),this._dom.refs.title=es("span",{className:"c-AdSkipButton__title"}),this._dom.refs.countdown=es("div",{className:"c-AdSkipButton__countdown",innerHTML:'\n\t\t\t\t<svg\n\t\t\t\t\tversion="1.1"\n\t\t\t\t\txmlns="http://www.w3.org/2000/svg"\n\t\t\t\t\txmlns:xlink="http://www.w3.org/1999/xlink" tabindex="-1" focusable="false">\n\t\t\t\t\t<rect x="0" y="0" width="0" height="100%" opacity="0.2" class="sznp-ui-widget-ad-skip-button-countdown-fill"></rect>\n\t\t\t\t</svg>\n\t\t\t'}),this._dom.refs.playBridge=es("div",{className:"sznp-ui-widget-focus-bridge",tabIndex:-1}),this._dom.refs.volumeBridge=es("div",{className:"sznp-ui-widget-focus-bridge",tabIndex:-1}),ts(this._dom.root).append(this._dom.refs.countdown,this._dom.refs.title),this.__setDisplayed(e.displayed),this.__setDisabled(e.skipAllowed),this.__setText(e.text),this.__setAriaAttr(e),this._dom.root.addEventListener("click",this.__clickOn),this.__registerFocusEvents()}_onUiUpdate(e){this._props.displayed!=e.displayed&&this.__setDisplayed(e.displayed),this._props.skipAllowed!=e.skipAllowed&&this.__setDisabled(e.skipAllowed),this._props.text!=e.text&&(this.__setText(e.text),this.__setAriaAttr(e)),this._props.fill!=e.fill&&this.__setCountdownFill(e.fill)}_onUiDestroy(e){this.__unregisterFocusEvents()}getButton(){return this._dom.refs.button}__registerFocusEvents(){this._dom.root.addEventListener("focus",this.__onFocus),this._dom.root.addEventListener("blur",this.__onBlur),this._dom.refs.playBridge.addEventListener("focus",this.__onPlayBridgeFocus),this._dom.refs.volumeBridge.addEventListener("focus",this.__onVolumeBridgeFocus)}__unregisterFocusEvents(){this._dom.root.removeEventListener("focus",this.__onFocus),this._dom.root.removeEventListener("blur",this.__onBlur),this._dom.refs.playBridge.removeEventListener("focus",this.__onPlayBridgeFocus),this._dom.refs.volumeBridge.removeEventListener("focus",this.__onVolumeBridgeFocus)}__getCountdownElement(){return this._dom.root.querySelector(".sznp-ui-widget-ad-skip-button-countdown-fill")}__setCountdownFill(e){const t=this.__getCountdownElement();t&&ts(t).setAttr({width:`${e}%`})}__setDisplayed(e){ts(this._dom.root).setDisplayed(e)}__setDisabled(e){this._disabled=!e}__setText(e){this._dom.refs.title.innerHTML=e}__setAriaAttr(e){ts(this._dom.root).setAttr({"aria-label":e.text})}__updateTabIndex(e){ts(this._dom.refs.playBridge).setAttr({tabIndex:e?0:-1}),ts(this._dom.refs.volumeBridge).setAttr({tabIndex:e?0:-1})}__getVolumeButton(){if(this._props.getVolumeButton)return this._props.getVolumeButton()}__getPlayPauseButton(){if(this._props.getPlayPauseButton)return this._props.getPlayPauseButton()}__clickOn(e){this._props.onClick&&!this._disabled&&this._props.onClick()}__onFocus(){this.__updateTabIndex(!0)}__onBlur(){this.__updateTabIndex(!1)}__onPlayBridgeFocus(){const e=this.__getPlayPauseButton();e&&e.focus(),this.__updateTabIndex(!1)}__onVolumeBridgeFocus(){const e=this.__getVolumeButton();e&&e.focus(),this.__updateTabIndex(!1)}}class hn extends fs{constructor(e){super(e),this._dom={root:null,refs:{title:null}},this._bind=["__clickOn"]}uiGetDeclaredProps(){return{displayed:"boolean",skipAllowed:"boolean",text:"string",onClick:["function","object"]}}uiGetDefaultProps(){return{displayed:!1,skipAllowed:!1,text:"",onClick:null}}_onUiBuild(e){this._dom.root=es("button",{className:"c-AdSkipAllButton",type:"button",tabIndex:-1}),this._dom.refs.title=es("span",{className:"c-AdSkipAllButton__title"}),ts(this._dom.root).append(this._dom.refs.title),this.__setDisplayed(e.displayed),this.__setText(e.text),this.__setAriaAttr(e),this._dom.root.addEventListener("click",this.__clickOn)}_onUiUpdate(e){this._props.displayed!=e.displayed&&this.__setDisplayed(e.displayed),this._props.text!=e.text&&(this.__setText(e.text),this.__setAriaAttr(e))}_onUiDestroy(e){this.__unregisterFocusEvents()}__setDisplayed(e){ts(this._dom.root).setDisplayed(e)}__setDisabled(e){this._disabled=!e}__setText(e){this._dom.refs.title.innerHTML=e}__setAriaAttr(e){ts(this._dom.root).setAttr({"aria-label":e.text})}__clickOn(e){this._props.onClick&&this._props.onClick({skipAllAds:!0})}}class _n extends fs{constructor(e){super(e),this._dom={root:null,refs:{contentInfoInner:null,title:null,subtitle:null,description:null,authorContainer:null,authorName:null,link:null,footer:null,duration:null,pp:null}},this._component={closeButton:null,authorButton:null,shareButton:null,ppIcon:null},this._bind=["__onAuthorContainerClick","__onTriggerButtonClick","__onCloseButtonClick","__onLinkClick"],this._flags={authorOpen:!1}}uiGetDeclaredProps(){return{displayed:"boolean",isSplashScreen:"boolean",indicatorColor:"string",videoTitle:"string",videoSubtitle:"string",videoAuthor:"string",videoDescription:"string",videoDuration:"number",linkUrl:"string",linkLabel:"string",linkTarget:"string",channelSubscribe:"string",visibleElements:"object",textContentInfoOpen:"string",textContentInfoClose:"string",textContentInfoTrigger:"string",contentInfoShown:"boolean",followingShown:"boolean",followingEnabled:"boolean",onOpenClick:["function","object"],onLinkClick:["function","object"]}}uiGetDefaultProps(){return{displayed:!0,isSplashScreen:!1,indicatorColor:"",videoTitle:"",videoSubtitle:"",videoAuthor:"",videoDescription:"",videoDuration:0,linkUrl:"",linkLabel:"",linkTarget:"",channelSubscribe:"",visibleElements:null,textContentInfoOpen:"",textContentInfoClose:"",textContentInfoTrigger:"",contentInfoShown:!1,followingShown:!1,followingEnabled:!1,onOpenClick:null,onLinkClick:null}}_onUiInit(e){this._component.closeButton=new Os(this.__getPropsForCloseButton(e)),this._component.triggerButton=new sn(this.__getPropsForTriggerButton(e)),this._component.ppIcon=new Ls(this.__getPropsForPP(e)),this._component.shareButton=new Os(this.__getPropsForShareButton(e)),this._component.authorButton=new Os(this.__getPropsForAuthorButton(e))}_onUiBuild(e){this._dom.root=es("div",{className:"c-ContentInfo"}),this._dom.refs.header=es("div",{className:"w-ContentInfoHeader"}),this._dom.refs.contentInfoInner=es("div",{className:"w-ContentInfoInner"}),this._dom.refs.title=es("h1",{className:"c-ContentInfo__title"}),this._dom.refs.description=es("p",{className:"c-ContentInfo__description"}),this._dom.refs.link=es("a",{className:"c-ContentInfo__link"}),this._dom.refs.footer=es("div",{className:"w-ContentInfoFooter"}),this._dom.refs.duration=es("div",{className:"w-ContentInfoFooter__duration"}),this._dom.refs.pp=es("div",{className:"w-ContentInfoFooter__pp"}),this._dom.refs.authorContainer=es("div",{className:"w-ContentInfoAuthor"}),this._dom.refs.authorName=es("span",{className:"w-ContentInfoAuthor__name"}),ts(this._dom.root).append(ts(this._dom.refs.contentInfoInner).append(this._dom.refs.title,this._dom.refs.description,this._dom.refs.link,ts(this._dom.refs.footer).append(this._dom.refs.duration,ts(this._dom.refs.pp).append(this._component.ppIcon.uiGetElement()),this._component.shareButton.uiGetElement(),ts(this._dom.refs.authorContainer).append(this._component.authorButton.uiGetElement(),this._dom.refs.authorName)))),this.__setDisplayed(e),this.__setContentInfoState(e),this.__updateTitle(e),this.__updateDescription(e),this.__updateDuration(e),this.__updateLink(e),this.__updateAuthor(e),this.__updateProductPlacement(e),this.__updateForSplash(e),this.__updateFollowingEnabled(e),this.__updateFollowingShown(e),this._component.authorButton.uiGetElement().addEventListener("click",this.__onAuthorContainerClick),this._dom.refs.link.addEventListener("click",this.__onLinkClick)}_onUiUpdate(e){this._props.isSplashScreen!==e.isSplashScreen&&this.__updateForSplash(e),this._props.contentInfoShown!==e.contentInfoShown&&this.__setContentInfoState(e),this._props.followingShown!==e.followingShown&&this.__updateFollowingShown(e),this._props.displayed!==e.displayed&&this.__setDisplayed(e),this._props.videoTitle===e.videoTitle&&this._props.visibleElements.contentInfoTitle===e.visibleElements.contentInfoTitle||this.__updateTitle(e),this._props.videoDescription===e.videoDescription&&this._props.visibleElements.contentInfoDescription===e.visibleElements.contentInfoDescription||this.__updateDescription(e),this._props.videoDuration===e.videoDuration&&this._props.visibleElements.contentInfoDuration===e.visibleElements.contentInfoDuration||this.__updateDuration(e),this._props.linkUrl===e.linkUrl&&this._props.linkLabel===e.linkLabel&&this._props.linkTarget===e.linkTarget&&this._props.visibleElements.contentInfoLink===e.visibleElements.contentInfoLink||this.__updateLink(e),this._props.videoAuthor===e.videoAuthor&&this._props.visibleElements.contentInfoAuthor===e.visibleElements.contentInfoAuthor||this.__updateAuthor(e),this._props.visibleElements.contentInfoPp!==e.visibleElements.contentInfoPp&&this.__updateProductPlacement(e),this._props.followingEnabled!==e.followingEnabled&&this.__updateFollowingEnabled(e),this._component.triggerButton.uiUpdate(this.__getPropsForTriggerButton(e)),this._component.closeButton.uiUpdate(this.__getPropsForCloseButton(e))}_onUiDestroy(){}__setDisplayed(e){ts(this._dom.root).setDisplayed(e.displayed&&e.visibleElements.contentInfo)}__updateTitle(e){ts(this._dom.refs.title).setDisplayed(e.visibleElements.contentInfoTitle&&e.videoTitle).setInnerHTML(e.videoTitle)}__updateDuration(e){ts(this._dom.refs.duration).setDisplayed(e.visibleElements.contentInfoDuration&&e.videoDuration).setInnerHTML(o.formatTime(e.videoDuration))}__updateDescription(e){ts(this._dom.refs.description).setDisplayed(e.visibleElements.contentInfoDescription&&e.videoDescription).setInnerHTML(e.videoDescription)}__updateLink(e){ts(this._dom.refs.link).setDisplayed(e.visibleElements.contentInfoLink&&e.linkUrl).setInnerHTML(e.linkLabel).setAttr({href:e.linkUrl,target:e.linkTarget}).stopClickPropagation()}__updateAuthor(e){ts(this._dom.refs.authorContainer).setDisplayed(e.visibleElements.contentInfoAuthor&&e.videoAuthor),ts(this._dom.refs.authorName).setInnerHTML(e.videoAuthor)}__updateProductPlacement(e){ts(this._dom.refs.pp).setDisplayed(e.visibleElements.contentInfoPp)}__updateForSplash(e){ts(this._dom.root).cssClasses({"-splash-screen":e.isSplashScreen})}__setContentInfoState(e){ts(this._dom.root).cssClasses({"-open":e.contentInfoShown})}__updateFollowingShown(e){ts(this._dom.root).cssClasses({"-following-shown":e.followingShown})}__updateFollowingEnabled(e){ts(this._dom.root).cssClasses({"-following-enabled":e.followingEnabled})}__getPropsForPP(e){return{pp:{displayed:!0}}}__getPropsForShareButton(e){return{displayed:!1,iconProps:{share:{displayed:!0}}}}__getPropsForAuthorButton(e){return{displayed:!0,iconProps:{info:{displayed:!0}}}}__getPropsForCloseButton(e){return{displayed:e.contentInfoShown,iconProps:{cross:{displayed:!0}},onClick:this.__onCloseButtonClick}}__getPropsForTriggerButton(e){return{text:e.textContentInfoTrigger,active:e.contentInfoShown,indicatorColor:e.indicatorColor,onClick:this.__onTriggerButtonClick}}__onAuthorContainerClick(e){e.stopPropagation(),this._flags.authorOpen=!this._flags.authorOpen,ts(this._dom.refs.authorContainer).cssClasses({"-open":this._flags.authorOpen})}__onOpenClick(e){this._props.onOpenClick&&this._props.onOpenClick({contentInfoShown:e})}__onLinkClick(){this._props.onLinkClick&&this._props.onLinkClick({linkUrl:this._props.linkUrl,linkTarget:this._props.linkTarget})}__onTriggerButtonClick(e){this.__onOpenClick(!this._props.contentInfoShown)}__onCloseButtonClick(e){this.__onOpenClick(!1)}}class dn extends fs{constructor(e){super(e),this._dom={root:null,refs:{iconWrapper:null,iconBackground:null,title:null,indicator:null}},this._bind=["__onButtonClick"],this._component={icon:null}}uiGetDeclaredProps(){return{displayed:"boolean",ariaProps:"object",clear:"boolean",iconProps:"object",title:"string",active:"boolean",color:"string",onClick:["function","object"]}}uiGetDefaultProps(){return{displayed:!0,ariaProps:null,clear:!1,iconProps:null,title:"",active:!1,color:"",onClick:null}}_onUiInit(e){this._component.icon=new Ls(this._getPropsForIcon(e))}_onUiBuild(e){this._dom.root=es("button",{className:"c-RichMenuButton",type:"button"}),this._dom.refs.iconWrapper=es("div",{className:"w-RichMenuButtonIcon"}),this._dom.refs.iconBackground=es("div",{className:"w-RichMenuButtonIcon__background",innerHTML:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 64 64"><path d="m48.785 62.215c6.7289-1.454 11.975-6.7004 13.429-13.428 1.1696-5.4101 1.7853-11.026 1.7853-16.786 0-5.7599-0.61572-11.376-1.7853-16.786-1.4545-6.7278-6.6998-11.974-13.428-13.428-5.4106-1.1696-11.026-1.7859-16.786-1.7859-5.7598 0-11.376 0.61632-16.786 1.7859-6.7277 1.4545-11.974 6.7004-13.428 13.428-1.1696 5.4095-1.7859 11.025-1.7859 16.785 0 5.7605 0.61632 11.376 1.7859 16.786 1.4545 6.7278 6.7004 11.974 13.428 13.428 5.41 1.1702 11.026 1.7859 16.786 1.7859 5.7598 0 11.375-0.61573 16.785-1.7847"/></svg>'}),this._dom.refs.title=es("span",{className:"c-RichMenuButton__title"}),this._dom.refs.indicator=es("div",{className:"c-RichMenuButton__indicator",innerHTML:'<svg xmlns="http://www.w3.org/2000/svg"><rect width="100%" height="100%"></rect></svg>'}),ts(this._dom.root).append(ts(this._dom.refs.iconWrapper).append(this._dom.refs.iconBackground,this._component.icon.uiGetElement()),this._dom.refs.title,this._dom.refs.indicator),this.__setDisplayed(e.displayed),this.__setIndicatorColor(e.color),this.__setTitle(e.title),this.__setActive(e.active),this.__setClear(e.clear),this._dom.root.addEventListener("click",this.__onButtonClick)}_onUiUpdate(e){this._props.displayed!==e.displayed&&this.__setDisplayed(e.displayed),this._props.color!==e.color&&this.__setIndicatorColor(e.color),this._props.title!==e.title&&this.__setTitle(e.title),this._props.active!==e.active&&this.__setActive(e.active),this._props.clear!==e.clear&&this.__setClear(e.clear)}_getPropsForIcon(e){return e.iconProps||{}}__setDisplayed(e){ts(this._dom.root).setDisplayed(e)}__setIndicatorColor(e){ts(this._dom.refs.iconBackground).setStyle({fill:e,stroke:e}),ts(this._dom.refs.indicator).setStyle({fill:e,stroke:e})}__setTitle(e){ts(this._dom.refs.title).setInnerHTML(e)}__setActive(e){ts(this._dom.root).cssClasses({"-active":e})}__setClear(e){ts(this._dom.root).cssClasses({"-clear":e})}__onButtonClick(e){this._props.onClick&&this._props.onClick(e)}}class un extends fs{constructor(e){super(e),this._dom={root:null,refs:{inner:null,title:null,titleText:null}},this._component={backButton:null,contentInfoButton:null,followingButton:null,programmeButton:null,chaptersButton:null,aboutButton:null,episodesButton:null,menuButton:null},this._bind=["__onButtonClick","__onBackButtonClick","__onMenuButtonClick","__onMouseEnter","__onMouseLeave"],this._defaultComponentsShown={contentInfoShown:!1,followingShown:!1,programmeShown:!1,aboutShown:!1,chaptersShown:!1,episodesShown:!1}}uiGetDeclaredProps(){return{displayed:"boolean",indicatorColor:"string",isLargeUi:"boolean",contentInfo:"object",visibleElements:"object",contentInfoShown:"boolean",contentInfoEnabled:"boolean",followingShown:"boolean",followingTeasers:"object",chaptersShown:"boolean",chaptersData:"object",episodesShown:"boolean",episodesData:"object",programmeShown:"boolean",programmeData:"object",onButtonClick:["function","object"],onBackButtonClick:["function","object"],onHoverOn:["function","object"],onHoverOff:["function","object"]}}uiGetDefaultProps(){return{displayed:!0,indicatorColor:"",isLargeUi:!1,contentInfo:null,visibleElements:null,contentInfoShown:!1,contentInfoEnabled:!1,followingShown:!1,followingTeasers:[],chaptersShown:!1,chaptersData:[],episodesShown:!1,episodesData:null,programmeShown:!1,programmeData:null,onButtonClick:null,onBackButtonClick:null,onHoverOn:null,onHoverOff:null}}_onUiInit(e){this._component.backButton=new dn(this.__getPropsForBackButton(e)),this._component.contentInfoButton=new dn(this.__getPropsForContentInfoButton(e)),this._component.followingButton=new dn(this.__getPropsForFollowingButton(e)),this._component.programmeButton=new dn(this.__getPropsForTvProgramButton(e)),this._component.chaptersButton=new dn(this.__getPropsForChaptersButton(e)),this._component.aboutButton=new dn(this.__getPropsForAboutButton(e)),this._component.episodesButton=new dn(this.__getPropsForEpisodesButton(e)),this._component.menuButton=new Os(this.__getPropsForMenuButton(e))}_onUiBuild(e){this._dom.root=es("div",{className:"c-RichMenu"}),this._dom.refs.inner=es("div",{className:"w-RichMenuInner"}),this._dom.refs.title=es("div",{className:"w-RichMenuTitle"}),this._dom.refs.titleText=es("span",{className:"w-RichMenuTitle__text"}),ts(this._dom.root).append(this._component.backButton.uiGetElement(),ts(this._dom.refs.title).append(this._dom.refs.titleText),ts(this._dom.refs.inner).append(this._component.contentInfoButton.uiGetElement(),this._component.followingButton.uiGetElement(),this._component.programmeButton.uiGetElement(),this._component.chaptersButton.uiGetElement(),this._component.aboutButton.uiGetElement(),this._component.episodesButton.uiGetElement()),this._component.menuButton.uiGetElement()),this.__setDisplayed(e.displayed),this.__setTitle(e),this.__registerMouseEvents()}_onUiUpdate(e){this._props.displayed!==e.displayed&&this.__setDisplayed(e.displayed),this._props.contentInfo.videoTitle!==e.contentInfo.videoTitle&&this.__setTitle(e),this._component.backButton.uiUpdate(this.__getPropsForBackButton(e)),this._component.contentInfoButton.uiUpdate(this.__getPropsForContentInfoButton(e)),this._component.followingButton.uiUpdate(this.__getPropsForFollowingButton(e)),this._component.programmeButton.uiUpdate(this.__getPropsForTvProgramButton(e)),this._component.chaptersButton.uiUpdate(this.__getPropsForChaptersButton(e)),this._component.aboutButton.uiUpdate(this.__getPropsForAboutButton(e)),this._component.episodesButton.uiUpdate(this.__getPropsForEpisodesButton(e)),this._component.menuButton.uiUpdate(this.__getPropsForMenuButton(e))}_onUiDestroy(){this.__unregisterMouseEvents()}__registerMouseEvents(){this._dom.root.addEventListener("mouseenter",this.__onMouseEnter),this._dom.root.addEventListener("mouseleave",this.__onMouseLeave)}__unregisterMouseEvents(){this._dom.root.removeEventListener("mouseenter",this.__onMouseEnter),this._dom.root.removeEventListener("mouseleave",this.__onMouseLeave)}__getPropsForBackButton(e){return{displayed:e.visibleElements.backButton,color:e.indicatorColor,title:"Zpět",iconProps:{"arrow-left":{displayed:!0}},clear:!0,active:!1,onClick:this.__onBackButtonClick}}__getPropsForContentInfoButton(e){return{displayed:!e.isLargeUi&&e.visibleElements.contentInfo&&e.contentInfoEnabled,color:e.indicatorColor,title:"Nyní hraje",iconProps:{top:{displayed:!0}},active:e.contentInfoShown,onClick:this.__onButtonClick.bind(this,{contentInfoShown:!e.contentInfoShown})}}__getPropsForFollowingButton(e){return{displayed:!e.isLargeUi&&e.visibleElements.following&&e.followingTeasers.length>0,color:e.indicatorColor,title:"Následuje",iconProps:{top:{displayed:!0}},active:e.followingShown,onClick:this.__onButtonClick.bind(this,{followingShown:!e.followingShown})}}__getPropsForTvProgramButton(e){return{displayed:!e.isLargeUi&&!e.visibleElements.following&&e.visibleElements.programme&&!!(e.programmeData&&e.programmeData.listData&&e.programmeData.listData.length>0),color:e.indicatorColor,title:"Program",iconProps:{top:{displayed:!0}},active:e.programmeShown,onClick:this.__onButtonClick.bind(this,{programmeShown:!e.programmeShown})}}__getPropsForChaptersButton(e){return{displayed:!!(e.chaptersData&&e.chaptersData.listData&&e.chaptersData.listData.length>0&&e.visibleElements.chapters),color:e.indicatorColor,title:"Kapitoly",iconProps:{chapters:{displayed:!0}},active:e.chaptersShown,onClick:this.__onButtonClick.bind(this,{chaptersShown:!e.chaptersShown})}}__getPropsForAboutButton(e){return{displayed:!1,color:e.indicatorColor,title:"O pořadu",iconProps:{about:{displayed:!0}},onClick:this.__onButtonClick.bind(this,{aboutShown:!1})}}__getPropsForEpisodesButton(e){return{displayed:!!(e.episodesData&&e.episodesData.selectData&&e.episodesData.selectData.length>0&&e.visibleElements.episodes),color:e.indicatorColor,title:"Další epizody",iconProps:{episodes:{displayed:!0}},active:e.episodesShown,onClick:this.__onButtonClick.bind(this,{episodesShown:!e.episodesShown})}}__getPropsForMenuButton(e){const t=this.__anyComponentShown(e);return{displayed:!e.isLargeUi,iconProps:{burger:{displayed:!t},cross:{displayed:t}},onClick:this.__onMenuButtonClick}}__setDisplayed(e){ts(this._dom.root).setDisplayed(e)}__setTitle(e){ts(this._dom.refs.titleText).setInnerHTML(e.contentInfo.videoTitle)}__anyComponentShown(e){return e.contentInfoShown||e.followingShown||e.chaptersShown||e.episodesShown||e.programmeShown}__onBackButtonClick(){this._props.onBackButtonClick&&this._props.onBackButtonClick()}__onButtonClick(e={}){const t=Object.assign({},this._defaultComponentsShown,e);this._props.onButtonClick&&this._props.onButtonClick(t)}__onMenuButtonClick(){const e=this.__anyComponentShown(this._props);if(this._props.onButtonClick)if(e)this._props.onButtonClick(this._defaultComponentsShown);else{const e=Object.assign({},this._defaultComponentsShown,{contentInfoShown:!this._props.contentInfoShown});this._props.onButtonClick(e)}}__onMouseEnter(e){this._props.onHoverOn&&this._props.onHoverOn()}__onMouseLeave(e){this._props.onHoverOff&&this._props.onHoverOff()}}class cn extends fs{constructor(e){super(e),this._dom={root:null,refs:{poster:null,backdrop:null,duration:null,startTime:null,checkbox:null,title:null,label:null}},this._bind=["_onTeaserClick"]}uiGetDeclaredProps(){return{id:"string",poster:"string",label:"string",title:"string",disabled:"boolean",onTeaserClick:["function","object"],active:"boolean",indicatorColor:"string",startTime:"number",duration:"number"}}uiGetDefaultProps(){return{poster:"",label:"",title:"",disabled:!1,onTeaserClick:null,active:!1,indicatorColor:"",startTime:0,duration:0}}_onUiInit(e){}_onUiBuild(e){this._dom.root=es("div",{className:"c-Teaser"}),this._dom.refs.poster=es("img",{className:"c-Teaser__poster"}),this._dom.refs.backdrop=es("div",{className:"c-Teaser__backdrop"}),this._dom.refs.duration=es("div",{className:"w-TeaserDuration"}),this._dom.refs.durationTime=es("div",{className:"w-TeaserDuration__time"}),this._dom.refs.checkbox=es("div",{className:"w-TeaserCheckbox"}),this._dom.refs.texts=es("div",{className:"w-TeaserTexts"}),this._dom.refs.title=es("h1",{className:"w-TeaserTexts__title"}),this._dom.refs.label=es("span",{className:"w-TeaserTexts__label"}),this._dom.refs.startTime=es("span",{className:"w-TeaserTexts__start"}),ts(this._dom.root).append(this._dom.refs.poster,this._dom.refs.backdrop,ts(this._dom.refs.duration).append(this._dom.refs.durationTime),ts(this._dom.refs.checkbox),ts(this._dom.refs.texts).append(this._dom.refs.startTime,this._dom.refs.label,this._dom.refs.title)),this._dom.root.addEventListener("click",this._onTeaserClick),this._updatePoster(e),this._updateDuration(e),this._updateStartTime(e),this._updateTitle(e),this._updateLabel(e),this._updateActive(e),this._updateIndicatorColor(e),this._updateDisabled(e),ts(this._dom.refs.checkbox).stopClickPropagation()}_onUiUpdate(e){this._props.poster!==e.poster&&this._updatePoster(e),this._props.duration!==e.duration&&this._updateDuration(e),this._props.title!==e.title&&this._updateTitle(e),this._props.startTime!==e.startTime&&this._updateStartTime(e),this._props.label!==e.label&&this._updateLabel(e),this._props.active!==e.active&&this._updateActive(e),this._props.indicatorColor!==e.indicatorColor&&this._updateIndicatorColor(e),this._props.disabled!==e.disabled&&this._updateDisabled(e)}_updatePoster(e){ts(this._dom.refs.poster).setAttr({src:e.poster||""})}_updateDuration(e){ts(this._dom.refs.duration).setDisplayed(!!e.duration),ts(this._dom.refs.durationTime).setInnerHTML(o.formatTime(e.duration))}_updateStartTime(e){ts(this._dom.refs.startTime).setDisplayed(!!e.startTime),ts(this._dom.refs.startTime).setInnerHTML(o.formatTime(e.startTime))}_updateTitle(e){ts(this._dom.refs.title).setInnerHTML(e.title).setDisplayed(!!e.title)}_updateLabel(e){ts(this._dom.refs.label).setInnerHTML(e.label).setDisplayed(!!e.label)}_updateActive(e){ts(this._dom.root).cssClasses({"-active":e.active}),e.active&&(ts(this._dom.refs.duration).setDisplayed(e.active),ts(this._dom.refs.durationTime).setInnerHTML("Právě hraje"))}_updateIndicatorColor(e){ts(this._dom.root).setStyle({borderColor:e.indicatorColor})}_updateDisabled(e){ts(this._dom.root).cssClasses({"-disabled":e.disabled})}_onTeaserClick(e){this._props.onTeaserClick&&this._props.onTeaserClick()}}const pn="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7";class mn extends fs{constructor(e){super(e),this._dom={root:null,refs:{image:null,title:null}},this._bind=["__onClick"]}uiGetDeclaredProps(){return{displayed:"boolean",icon:"string",title:"string",disabled:"boolean",selected:"boolean",onClick:["function","object"]}}uiGetDefaultProps(){return{displayed:!0,icon:"",title:"",disabled:!1,selected:!1,onClick:null}}_onUiInit(e){}_onUiBuild(e){this._dom.root=es("button",{className:"c-SelectOption",type:"button"}),this._dom.refs.image=es("div",{className:"c-SelectOption__image",innerHTML:'\n\t\t\t\t<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 64 64">\n\t\t\t\t\t<image height="100%" width="100%" clip-path="url(#sznp-squircle)">\n\t\t\t\t</svg>'}),this._dom.refs.title=es("span",{className:"c-SelectOption__title"}),ts(this._dom.root).append(ts(this._dom.refs.image),ts(this._dom.refs.title)),this.__setIcon(e),this.__setTitle(e),this._dom.root.addEventListener("click",this.__onClick)}_onUiUpdate(e){this._props.icon!==e.icon&&this.__setIcon(e),this._props.title!==e.title&&this.__setTitle(e)}_onUiDestroy(){this._dom.root.removeEventListener("click",this.__onClick)}__setIcon(e){const t=this._dom.refs.image.querySelector("svg image");t&&ts(t).setAttrNS({"xlink:href":e.icon||pn}),ts(this._dom.refs.image).setDisplayed(!!e.icon)}__setTitle(e){ts(this._dom.refs.title).setInnerHTML(e.title)}__onClick(){this._props.onClick&&this._props.onClick()}}const gn="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7";class En extends fs{constructor(e){super(e),this._dom={root:null,refs:{trigger:null,triggerImage:null,triggerTitle:null,optionList:null,optionWrapper:null}},this._component={options:null,triggerIcon:null},this._bind=["__onTriggerClick"],this._flags={open:!1}}uiGetDeclaredProps(){return{displayed:"boolean",options:"object",disabled:"boolean"}}uiGetDefaultProps(){return{displayed:!1,options:[],disabled:!1}}_onUiInit(e){this._component.options=this.__createOptions(e),this._component.triggerIcon=new Ls(this.__getPropsForTriggerIcon(e))}_onUiBuild(e){this._dom.root=es("div",{className:"c-Select"}),this._dom.refs.trigger=es("button",{className:"w-SelectTrigger",type:"button"}),this._dom.refs.triggerImage=es("div",{className:"w-SelectTrigger__image",innerHTML:'\n\t\t\t\t<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 64 64">\n\t\t\t\t\t<image height="100%" width="100%" clip-path="url(#sznp-squircle)">\n\t\t\t\t</svg>'}),this._dom.refs.triggerTitle=es("span",{className:"w-SelectTrigger__title"}),this._dom.refs.optionList=es("div",{className:"w-SelectOptions"}),this._dom.refs.optionWrapper=es("div",{className:"w-SelectOptionsWrapper"}),ts(this._dom.root).append(ts(this._dom.refs.trigger).append(this._dom.refs.triggerImage,this._dom.refs.triggerTitle,this._component.triggerIcon.uiGetElement()),ts(this._dom.refs.optionList).append(ts(this._dom.refs.optionWrapper))),this.__setDisplayed(e),this.__updateSelectedOption(e),this.__buildOptions(),this._dom.refs.trigger.addEventListener("click",this.__onTriggerClick)}_onUiUpdate(e){this._props.displayed!==e.displayed&&this.__setDisplayed(e),JSON.stringify(this._props.options)!==JSON.stringify(e.options)&&(this._props.options.length===e.options.length?this.__updateOptions(e):(this.__destroyCurrentOptions(),this._component.options=this.__createOptions(e),this.__buildOptions()),this.__updateSelectedOption(e)),this._component.triggerIcon.uiUpdate(this.__getPropsForTriggerIcon(e))}_onUiDestroy(e){this.__destroyCurrentOptions(),this._dom.refs.trigger.removeEventListener("click",this.__onTriggerClick)}__getPropsForTriggerIcon(e){return{"chevron-up":{displayed:this._flags.open},"chevron-down":{displayed:!this._flags.open}}}__setDisplayed(e){ts(this._dom.root).setDisplayed(e.displayed)}__updateSelectedOption(e){e.options.forEach(e=>{if(e.selected){const t=this._dom.refs.triggerImage.querySelector("svg image");t&&ts(t).setAttrNS({"xlink:href":e.imgSrc||gn}),ts(this._dom.refs.triggerImage).setDisplayed(!!e.imgSrc),ts(this._dom.refs.triggerTitle).setInnerHTML(e.title)}})}__updateSelectOpen(e){this._flags.open=e,ts(this._dom.root).cssClasses({"-open":this._flags.open}),this.uiForceUpdate()}__createOptions(e){return e.options.map(e=>new mn({icon:e.imgSrc||"",title:e.title||"",disabled:e.disabled||!1,selected:e.selected||!1,onClick:()=>{e.onClick(),this.__updateSelectOpen(!1)}}))}__buildOptions(){ts(this._dom.refs.optionWrapper).append(this._component.options.map(e=>(e.uiInited()||e.uiInit(),e.uiBuilt()||e.uiBuild(),e.uiGetElement())))}__updateOptions(e){e.options.forEach((e,t)=>{this._component.options[t].uiUpdate({icon:e.imgSrc||"",title:e.title||"",disabled:e.disabled||!1,selected:e.selected||!1,onClick:()=>{e.onClick(),this.__updateSelectOpen(!1)}})})}__destroyCurrentOptions(){this._component.options.forEach(e=>e.uiDestroy()),ts(this._dom.refs.optionWrapper).clear()}__onTriggerClick(e){this.__updateSelectOpen(!this._flags.open)}}class Tn extends fs{constructor(e){super(e),this._dom={root:null,refs:{image:null,title:null}},this._bind=["__onClick"]}uiGetDeclaredProps(){return{displayed:"boolean",label:"string",image:"string",disabled:"boolean",onClick:["function","object"]}}uiGetDefaultProps(){return{displayed:!1,label:"",image:"",disabled:!1,onClick:null}}_onUiInit(e){}_onUiBuild(e){this._dom.root=es("button",{className:"c-ContentBoardListLink",type:"button"}),this._dom.refs.image=es("div",{className:"c-ContentBoardListLink__image",innerHTML:'\n\t\t\t\t<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 64 64">\n\t\t\t\t\t<image height="100%" width="100%" clip-path="url(#sznp-squircle)">\n\t\t\t\t</svg>'}),this._dom.refs.label=es("span",{className:"c-ContentBoardListLink__label"}),ts(this._dom.root).append(ts(this._dom.refs.image),ts(this._dom.refs.label)),this.__setIcon(e),this.__setTitle(e),this._dom.root.addEventListener("click",this.__onClick)}_onUiUpdate(e){this._props.displayed!==e.displayed&&this.__setDisplayed(e.displayed),this._props.image!==e.image&&this.__setIcon(e),this._props.label!==e.label&&this.__setTitle(e)}__setDisplayed(e){ts(this._dom.root).setDisplayed(e)}__setIcon(e){const t=this._dom.refs.image.querySelector("svg image");t&&ts(t).setAttrNS({"xlink:href":e.image})}__setTitle(e){ts(this._dom.refs.label).setInnerHTML(`Přejít na ${e.label}`)}__onClick(e){this._props.onClick&&this._props.onClick()}}const fn={EPISODE:"episode",SHOW:"show",NONE:""};class yn extends fs{constructor(e){super(e),this._dom={root:null,refs:{selectTitle:null,select:null,listTitle:null,listScroll:null,list:null}},this._component={select:null,items:null},this._currentSelectItem=0}uiGetDeclaredProps(){return{displayed:"boolean",selectTitle:"string",selectData:"object",listTitle:"string",listData:"object",indicatorColor:"string"}}uiGetDefaultProps(){return{displayed:!1,selectTitle:"",selectData:[],listTitle:"",listData:[],indicatorColor:""}}_onUiInit(e){this._component.select=new En(this.__getPropsForSelect(e)),this._component.items=this.__createItems(e)}_onUiBuild(e){this._dom.root=es("div",{className:"c-ContentBoardList"}),this._dom.refs.selectTitle=es("h1",{className:"c-ContentBoardList_selectTitle"}),this._dom.refs.listTitle=es("h1",{className:"c-ContentBoardList_listTitle"}),this._dom.refs.listScroll=es("div",{className:"w-ContentBoardListScroll"}),this._dom.refs.list=es("div",{className:"w-ContentBoardListWrapper"}),ts(this._dom.root).append(ts(this._dom.refs.selectTitle),this._component.select.uiGetElement(),ts(this._dom.refs.listTitle),ts(this._dom.refs.listScroll).append(ts(this._dom.refs.list))),this.__buildItems(e),this.__scrollIntoView(e),this.__setDisplayed(e.displayed),this.__setSelectTitle(e),this.__setListTitle(e.listTitle)}_onUiUpdate(e){this._props.displayed!==e.displayed&&this.__setDisplayed(e.displayed),this._component.select.uiUpdate(this.__getPropsForSelect(e)),this._props.selectTitle===e.selectTitle&&JSON.stringify(this._props.selectData)===JSON.stringify(e.selectData)||this.__setSelectTitle(e),this._props.listTitle!==e.listTitle&&this.__setListTitle(e.listTitle),JSON.stringify(this._props.listData)!==JSON.stringify(e.listData)&&(this.__destroyCurrentItems(),this._component.items=this.__createItems(e),this.__buildItems(),this.__scrollIntoView(e))}_onUiDestroy(e){}__setDisplayed(e){ts(this._dom.root).setDisplayed(e)}__setSelectTitle(e){ts(this._dom.refs.selectTitle).setInnerHTML(e.selectTitle).setDisplayed(e.selectData.length>1)}__setListTitle(e){ts(this._dom.refs.listTitle).setInnerHTML(e)}__getPropsForSelect(e){return{displayed:e.selectData.length>1,options:e.selectData}}__createItems(e){return e.listData.map(t=>{switch(t.type){case fn.EPISODE:return new cn({id:t.id,poster:t.poster||"",label:t.label||"",title:t.title||"",onTeaserClick:t.onClick,indicatorColor:e.indicatorColor||"",active:t.active,startTime:t.startTime||0,duration:t.duration||0});case fn.SHOW:return new Tn({label:t.label,image:t.imgSrc,onClick:t.onClick})}})}__buildItems(){ts(this._dom.refs.list).append(this._component.items.map(e=>(e.uiInited()||e.uiInit(),e.uiBuilt()||e.uiBuild(),e.uiGetElement())))}__updateItems(e){e.listData.forEach((t,i)=>{switch(t.type){case fn.EPISODE:this._component.items[i].uiUpdate({id:t.id,poster:t.poster||"",label:t.label||"",title:t.title||"",onTeaserClick:t.onClick,active:t.active||!1,indicatorColor:e.indicatorColor||"",startTime:t.startTime||0,duration:t.duration||0});break;case fn.SHOW:this._component.items[i].uiUpdate({label:t.label,image:t.imgSrc,onClick:t.onClick})}})}__destroyCurrentItems(){this._component.items.forEach(e=>e.uiDestroy()),ts(this._dom.refs.list).clear()}__scrollIntoView(e){e.listData.length>0&&e.listData.forEach((e,t)=>{if(e.active&&this._component.items[t]){const e=this._component.items[t].uiGetElement().offsetTop;this._dom.refs.listScroll.scrollTop=e}})}}class vn extends fs{constructor(e){super(e),this._dom={root:null,refs:{header:null,inner:null}},this._component={chapters:null,episodes:null,closeButton:null},this._bind=["__onCloseButtonClick"]}uiGetDeclaredProps(){return{displayed:"boolean",isLargeUi:"boolean",chaptersShown:"boolean",chaptersData:"object",episodesShown:"boolean",episodesData:"object",indicatorColor:"string",onCloseButtonClick:["function","object"]}}uiGetDefaultProps(){return{displayed:!1,isLargeUi:!1,chaptersShown:!1,chaptersData:null,episodesShown:!1,episodesData:null,indicatorColor:"",onCloseButtonClick:null}}_onUiInit(e){this._component.chapters=new yn(this.__getPropsForChapters(e)),this._component.episodes=new yn(this.__getPropsForEpisodes(e)),this._component.closeButton=new Os(this.__getPropsForCloseButton(e))}_onUiBuild(e){this._dom.root=es("div",{className:"c-ContentBoard"}),this._dom.refs.header=es("div",{className:"w-ContentBoardHeader"}),this._dom.refs.inner=es("div",{className:"w-ContentBoardInner"}),ts(this._dom.root).append(ts(this._dom.refs.header).append(this._component.closeButton.uiGetElement()),ts(this._dom.refs.inner).append(this._component.chapters.uiGetElement(),this._component.episodes.uiGetElement())),this.__setDisplayed(e.displayed)}_onUiUpdate(e){this._props.displayed!==e.displayed&&this.__setDisplayed(e.displayed),this._component.chapters.uiUpdate(this.__getPropsForChapters(e)),this._component.episodes.uiUpdate(this.__getPropsForEpisodes(e)),this._component.closeButton.uiUpdate(this.__getPropsForCloseButton(e))}__setDisplayed(e){ts(this._dom.root).setDisplayed(e)}__getPropsForChapters(e){return{displayed:e.chaptersShown,selectTitle:"",selectData:e.chaptersData&&e.chaptersData.selectData?e.chaptersData.selectData:[],listTitle:"Kapitoly",listData:e.chaptersData&&e.chaptersData.listData?e.chaptersData.listData:[],indicatorColor:e.indicatorColor}}__getPropsForEpisodes(e){return{displayed:e.episodesShown,selectTitle:"Série",selectData:e.episodesData&&e.episodesData.selectData?e.episodesData.selectData:[],listTitle:"Epizody",listData:e.episodesData&&e.episodesData.listData?e.episodesData.listData:[],indicatorColor:e.indicatorColor}}__getPropsForCloseButton(e){return{displayed:e.isLargeUi,iconProps:{cross:{displayed:!0}},onClick:this.__onCloseButtonClick}}__onCloseButtonClick(e){this._props.onCloseButtonClick&&this._props.onCloseButtonClick({chaptersShown:!1,episodesShown:!1,aboutShown:!1})}}class An extends fs{constructor(e){super(e),this._dom={root:null,refs:{header:null,headerTitle:null,teasersWrapper:null}},this._component={teasers:null,playTimer:null},this._bind=["__onTimerCancel","__onTouchStart","__onTouchEnd","__onMouseEnter","__onMouseLeave"],this._flags={timerRunning:!1}}uiGetDeclaredProps(){return{displayed:"boolean",currentTime:"number",indicatorColor:"string",followingShown:"boolean",followingTeasers:"object",followingPreviewShown:"boolean",followingTimerTime:"number",followingTimerProgress:"number",transitionEnabled:"boolean",transitionPreviewEnabled:"boolean",transitionTimerShown:"boolean",visibleElements:"object",useTouch:"boolean",isLargeUi:"boolean",isEnded:"boolean",timerCanceled:"boolean",onHoverOn:["function","object"],onTimerCancelClick:["function","object"],onComponentChange:["function","object"]}}uiGetDefaultProps(){return{displayed:!1,currentTime:0,indicatorColor:"",followingShown:!1,followingTeasers:[],followingPreviewShown:!1,followingTimerTime:0,followingTimerProgress:0,transitionEnabled:!1,transitionPreviewEnabled:!1,transitionTimerShown:!1,visibleElements:null,useTouch:!1,isLargeUi:!1,isEnded:!1,timerCanceled:!1,onHoverOn:null,onTimerCancelClick:null,onComponentChange:null}}_onUiInit(e){this._component.teasers=this.__createTeasers(e),this._component.playTimer=new nn(this.__getPropsForPlayTimer(e))}_onUiBuild(e){this._dom.root=es("div",{className:"c-Following -active"}),this._dom.refs.header=es("div",{className:"w-FollowingHeader"}),this._dom.refs.headerTitle=es("span",{className:"w-FollowingHeader__title",innerHTML:"Následuje"}),this._dom.refs.teasersScroll=es("div",{className:"w-FollowingTeasersScroll"}),this._dom.refs.teasersWrapper=es("div",{className:"w-FollowingTeasers"}),ts(this._dom.root).append(ts(this._dom.refs.header).append(this._component.playTimer.uiGetElement(),this._dom.refs.headerTitle),ts(this._dom.refs.teasersScroll).append(this._dom.refs.teasersWrapper)),this.__buildTeasers(),this.__setDisplayed(e),this.__setActive(e),this.__registerMouseEvents()}_onUiUpdate(e){this._props.displayed!==e.displayed&&this.__setDisplayed(e),this._props.followingShown===e.followingShown&&this._props.followingTeasers.length===e.followingTeasers.length&&this._props.followingPreviewShown===e.followingPreviewShown&&this._props.transitionEnabled===e.transitionEnabled&&this._props.transitionPreviewEnabled===e.transitionPreviewEnabled&&this._props.transitionTimerShown===e.transitionTimerShown&&this._props.timerCanceled===e.timerCanceled&&this._props.isEnded===e.isEnded&&(this._props.visibleElements&&this._props.visibleElements.following)===e.visibleElements.following||this.__setActive(e),JSON.stringify(this._props.followingTeasers)===JSON.stringify(e.followingTeasers)&&this._props.indicatorColor===e.indicatorColor&&this._props.followingTimerProgress===e.followingTimerProgres&&this._propt.timerShown===e.timerShown&&this._propt.timerCanceled===e.timerCanceled||(this._props.followingTeasers.length===e.followingTeasers.length?this.__updateTeasers(e):(this.__destroyCurrentTeasers(),this._component.teasers=this.__createTeasers(e),this.__buildTeasers())),this._component.playTimer.uiUpdate(this.__getPropsForPlayTimer(e))}_onUiDestroy(){this.__unregisterMouseEvents()}__registerMouseEvents(){this._dom.root.addEventListener("mouseenter",this.__onMouseEnter),this._dom.root.addEventListener("mouseleave",this.__onMouseLeave),this._dom.root.addEventListener("touchstart",this.__onTouchStart),this._dom.root.addEventListener("touchend",this.__onTouchEnd)}__unregisterMouseEvents(){this._dom.root.removeEventListener("mouseenter",this.__onMouseEnter),this._dom.root.removeEventListener("mouseleave",this.__onMouseLeave),this._dom.root.removeEventListener("touchstart",this.__onTouchStart),this._dom.root.removeEventListener("touchend",this.__onTouchEnd)}__getPropsForPlayTimer(e){const t=e.followingTeasers.length>0?e.followingTeasers[0].title:"";return{displayed:e.transitionTimerShown&&!e.timerCanceled,currentTime:e.currentTime,countdownText:"Další za",cancelText:"Zrušit",followingText:"Následuje",contentTitle:t,onCancel:this.__onTimerCancel,indicatorColor:e.indicatorColor,timerTime:e.followingTimerTime,timerProgress:e.followingTimerProgress}}__setDisplayed(e){ts(this._dom.root).setDisplayed(e.displayed)}__setActive(e){const t=e.visibleElements.following;ts(this._dom.root).cssClasses({"-no-content":0===e.followingTeasers.length,"-active":e.followingShown&&e.followingTeasers.length>0&&(e.transitionEnabled||t),"-active-preview":e.followingPreviewShown&&e.transitionPreviewEnabled,"-only-one-teaser":1===e.followingTeasers.length||!t&&!(e.isEnded&&e.transitionEnabled),"-timer-canceled":e.timerCanceled,"-timer-shown":e.transitionTimerShown})}__createTeasers(e){return e.followingTeasers.map((t,i)=>0===i?new rn({id:t.id,poster:t.poster,label:t.label,title:t.title,onTeaserClick:t.onClick,timerProgress:e.followingTimerProgress,timerShown:e.transitionTimerShown,indicatorColor:e.indicatorColor,timerCanceled:e.timerCanceled,previewSource:t.previewSource,duration:t.duration}):new cn({id:t.id,poster:t.poster,label:t.label,title:t.title,onTeaserClick:t.onClick,duration:t.duration}))}__buildTeasers(){ts(this._dom.refs.teasersWrapper).append(this._component.teasers.map(e=>(e.uiInited()||e.uiInit(),e.uiBuilt()||e.uiBuild(),e.uiGetElement())))}__updateTeasers(e){e.followingTeasers.forEach((t,i)=>{0===i?this._component.teasers[i].uiUpdate({id:t.id,poster:t.poster,label:t.label,title:t.title,onTeaserClick:t.onClick,timerProgress:e.followingTimerProgress,timerShown:e.transitionTimerShown,indicatorColor:e.indicatorColor,timerCanceled:e.timerCanceled,previewSource:t.previewSource,duration:t.duration}):this._component.teasers[i].uiUpdate({id:t.id,poster:t.poster,label:t.label,title:t.title,onTeaserClick:t.onClick,duration:t.duration})})}__destroyCurrentTeasers(){this._component.teasers.forEach(e=>e.uiDestroy()),ts(this._dom.refs.teasersWrapper).clear()}__changeVisibility(e){this._props.onComponentChange&&this._props.onComponentChange({followingShown:e})}__onTimerCancel(e){this._props.onTimerCancelClick&&this._props.onTimerCancelClick()}__onTouchStart(e){this._props.isLargeUi&&this.__changeVisibility(!0)}__onTouchEnd(e){e.stopPropagation()}__onMouseEnter(e){this._props.isLargeUi&&(this._props.onHoverOn&&this._props.onHoverOn(),this.__changeVisibility(!0))}__onMouseLeave(e){!this._props.isEnded&&this._props.isLargeUi&&this.__changeVisibility(!1)}}class Sn extends fs{constructor(e){super(e),this._dom={root:null,refs:{pointerWrapper:null}}}uiGetDeclaredProps(){return{displayed:"boolean",progressBarColor:"string",auxPointerProgress:"number"}}uiGetDefaultProps(){return{displayed:!1,progressBarColor:"",auxPointerProgress:0}}_onUiBuild(e){this._dom.root=es("span",{className:"c-AuxPointer"}),this._setDisplayed(e)}_onUiUpdate(e){this._props.displayed!==e.displayed&&this._setDisplayed(e),this._props.auxPointerProgress!==e.auxPointerProgress&&this._updateProgress(e.auxPointerProgress)}_setDisplayed(e){ts(this._dom.root).setDisplayed(e.displayed)}_updateProgress(e){const t=100*e;ts(this._dom.root).setStyle({left:`${t}%`})}}class bn extends fs{constructor(e){super(e),this._dom={root:null,refs:{fill:null}}}uiGetDeclaredProps(){return{progress:"number",color:"string"}}uiGetDefaultProps(){return{color:"",progress:0}}_onUiBuild(e){this._dom.root=es("div",{className:"c-SeekBarBox__buffer"}),this._dom.refs.fill=es("div",{className:"c-SeekBarBox__fill",innerHTML:'\n\t\t\t\t<svg version="1.1" xmlns="http://www.w3.org/2000/svg"\n\t\t\t\t\txmlns:xlink="http://www.w3.org/2000/svg" tabIndex="-1"\n\t\t\t\t\tfocusable="false">\n\t\t\t\t\t<rect x="0" y="0" width="100%" height="100%"/>\n\t\t\t\t</svg>\n\t\t\t'}),ts(this._dom.root).append(this._dom.refs.fill),this.__setProgress(e)}_onUiUpdate(e){this._props.progress===e.progress&&this._props.color===e.color||this.__setProgress(e)}__setProgress(e){const t=e.progress;let i=100*(isNaN(t)||!isFinite(t)?0:t);const s=this._dom.refs.fill.querySelector("svg");s&&ts(s).setStyle({fill:e.color,stroke:e.color,transform:`scaleX(${i/100})`})}}class Cn extends fs{constructor(e){super(e),this._dom={root:null,refs:{animatedBar:null,fallback:null,fallbackText:null}}}uiGetDeclaredProps(){return{displayed:"boolean",fallbackText:"string"}}uiGetDefaultProps(){return{displayed:!1,fallbackText:""}}_onUiBuild(e){this._dom.root=es("div",{className:"c-SeekBarBoxLoading",innerHTML:'\n\t\t\t\t<svg class="c-SeekBarBoxLoading__animated" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\n\t\t\t\t\t<defs>\n\t\t\t\t\t\t<pattern id="sznp-ui-loading-pattern" patternUnits="userSpaceOnUse" x="0" y="0" width="42" height="100%">\n\t\t\t\t\t\t\t<line x1="8" y1="-1" x2="2" y2="110%" stroke-width="4" stroke="#fff" stroke-opacity="0.8" stroke-linecap="butt"></line>\n\t\t\t\t\t\t\t<line x1="22" y1="-1" x2="16" y2="110%" stroke-width="4" stroke="#fff" stroke-opacity="0.8" stroke-linecap="butt"></line>\n\t\t\t\t\t\t\t<line x1="36" y1="-1" x2="30" y2="110%" stroke-width="4" stroke="#fff" stroke-opacity="0.8" stroke-linecap="butt"></line>\n\t\t\t\t\t\t</pattern>\n\t\t\t\t\t</defs>\n\t\t\t\t\t<rect fill="url(#sznp-ui-loading-pattern)" width="100%" height="100%"></rect>\n\t\t\t\t</svg>\n\t\t\t\t<div class="w-SeekBarBoxLoadingFallback ">\n\t\t\t\t\t<span class="w-SeekBarBoxLoadingFallback__text"></span>\n\t\t\t\t</div>\n\t\t\t'}),this._dom.refs.animatedBar=this._dom.root.querySelector(".c-SeekBarBoxLoading__animated"),this._dom.refs.fallback=this._dom.root.querySelector(".w-SeekBarBoxLoadingFallback"),this._dom.refs.fallbackText=this._dom.root.querySelector(".w-SeekBarBoxLoadingFallback__text"),this.__setDisplayed(e.displayed),this.__setFallbackText(e.fallbackText)}_onUiCanUpdate(e){return e.displayed||this._props.displayed!=e.displayed}_onUiUpdate(e){this._props.displayed!=e.displayed&&this.__setDisplayed(e.displayed),this._props.fallbackText!=e.fallbackText&&this.__setFallbackText(e.fallbackText)}__setDisplayed(e){ts(this._dom.root).setDisplayed(e),ts(this._dom.refs.animatedBar).setDisplayed(!p.isWindowsPhone()),ts(this._dom.refs.fallback).setDisplayed(p.isWindowsPhone())}__setFallbackText(e){this._dom.refs.fallbackText.innerHTML=e}}class Pn extends fs{constructor(e){super(e),this._dom={root:null}}uiGetDeclaredProps(){return{displayed:"boolean",time:"number",duration:"number"}}uiGetDefaultProps(){return{displayed:!1,time:null,duration:0}}_onUiBuild(e){this._dom.root=es("span",{className:"c-AdPoints__point"}),this.__setAdPointDisplayed(e),this.__setAdPointPosition(e)}_onUiUpdate(e){this._props.displayed!==e.displayed&&this.__setAdPointDisplayed(e),this._props.time===e.time&&this._props.duration===e.duration||this.__setAdPointPosition(e)}__setAdPointDisplayed(e){ts(this._dom.root).setDisplayed(e.displayed)}__setAdPointPosition(e){const t=e.duration&&e.time<e.duration?e.time/e.duration:1;!isFinite(t)||!e.duration||(e.time,e.duration);const i=100*t;ts(this._dom.root).setStyle({left:`${i}%`})}}class kn extends fs{constructor(e){super(e),this._dom={root:null},this._component={adPoints:[]}}uiGetDeclaredProps(){return{displayed:"boolean",adPoints:"object",duration:"number"}}uiGetDefaultProps(){return{displayed:!1,adPoints:[],duration:0}}_onUiInit(e){this._component.adPoints=this.__createPoints(e)}_onUiBuild(e){this._dom.root=es("div",{className:"c-AdPoints"}),this.__buildPoints()}_onUiUpdate(e){JSON.stringify(this._props.adPoints)===JSON.stringify(e.adPoints)&&this._props.duration===e.duration||(this._props.adPoints.length===e.adPoints.length?this.__updatePoints(e):(this.__destroyCurrentPoints(),this._component.adPoints=this.__createPoints(e),this.__buildPoints()))}__createPoints(e){return e.adPoints.map(t=>new Pn({displayed:e.displayed,time:t.time,duration:e.duration}))}__buildPoints(){ts(this._dom.root).append(this._component.adPoints.map(e=>(e.uiInited()||e.uiInit(),e.uiBuilt()||e.uiBuild(),e.uiGetElement())))}__updatePoints(e){e.adPoints.forEach((t,i)=>{this._component.adPoints[i].uiUpdate({displayed:e.displayed,time:t.time,duration:e.duration})})}__destroyCurrentPoints(){this._component.adPoints.forEach(e=>e.uiDestroy()),ts(this._dom.root).clear()}}class In extends fs{constructor(e){super(e),this._dom={root:null,refs:{pointWrapper:null}}}uiGetDeclaredProps(){return{time:"number",duration:"number"}}uiGetDefaultProps(){return{time:null,duration:0}}_onUiBuild(e){this._dom.root=es("span",{className:"c-ChapterPoints__point"}),this.__setChapterPointPosition(e)}_onUiUpdate(e){this._props.time===e.time&&this._props.duration===e.duration||this.__setChapterPointPosition(e)}__setChapterPointPosition(e){const t=e.duration&&e.time<e.duration?e.time/e.duration:1;if(!isFinite(t)||!e.duration>e.duration)return;const i=100*t;ts(this._dom.root).setStyle({left:`${i}%`})}}class wn extends fs{constructor(e){super(e),this._dom={root:null},this._component={chapterPoints:[]}}uiGetDeclaredProps(){return{displayed:"boolean",chapterPoints:"object",duration:"number"}}uiGetDefaultProps(){return{displayed:!1,chapterPoints:[],duration:0}}_onUiInit(e){this._component.chapterPoints=this.__createPoints(e)}_onUiBuild(e){this._dom.root=es("div",{className:"c-ChapterPoints"}),this.__setDisplayed(e),this.__buildPoints()}_onUiUpdate(e){this._props.displayed!==e.displayed&&this.__setDisplayed(e),JSON.stringify(this._props.chapterPoints)===JSON.stringify(e.chapterPoints)&&this._props.duration===e.duration||(this._props.chapterPoints.length===e.chapterPoints.length?this.__updatePoints(e):(this.__destroyCurrentPoints(),this._component.chapterPoints=this.__createPoints(e),this.__buildPoints()))}__createPoints(e){return e.chapterPoints.map(t=>new In({time:t.startTime,duration:e.duration}))}__buildPoints(){ts(this._dom.root).append(this._component.chapterPoints.map(e=>(e.uiInited()||e.uiInit(),e.uiBuilt()||e.uiBuild(),e.uiGetElement())))}__updatePoints(e){e.chapterPoints.forEach((t,i)=>{this._component.chapterPoints[i].uiUpdate({time:t.startTime,duration:e.duration})})}__destroyCurrentPoints(){this._component.chapterPoints.forEach(e=>e.uiDestroy()),ts(this._dom.root).clear()}__setDisplayed(e){ts(this._dom.root).setDisplayed(e.displayed)}}class Nn extends fs{constructor(e){super(e),this._dom={root:null,refs:{wrapper:null,auxPointerContainer:null,fullBar:null,loadingBar:null,bufferBar:null,seekingBar:null,thumb:null,document:document}},this._component={seekBarAuxiliaryPointer:null,seekBarProgressBar:null,seekBarLoadingBar:null,seekBarBufferBar:null,seekBarAdPoints:null,seekBarChapterPoints:null},this._flags={touchUsed:!1,mouseUsed:!1,holdingMouseDown:!1,mouseIntersected:!1,seeking:!1},this._bind=["__onMouseDown","__onMouseEnter","__onMouseLeave","__onMouseMove","__onMouseUp","__onTouchEnd","__onTouchMove","__onTouchStart"],this._mouseHoverTimeout=null,this._mouseMoveTimeout=null,this._touchMoveTimeout=null,this._mouseUsedOffTimeout=null,this._touchEndTimeout=null}uiGetDeclaredProps(){return{seekBarDimensions:"object",auxPointerShown:"boolean",auxPointerProgress:"number",adPoints:"object",currentTime:"number",chapterPoints:"object",duration:"number",buffered:"object",loading:"boolean",liveMode:"boolean",playingLive:"boolean",progress:"number",progressBarColor:"string",seekingEnabled:"boolean",sourceReady:"boolean",titleEnabled:"string",titleDisabled:"string",textSeekbarPlayed:"string",textSeekbarPlayedPrepos:"string",textIsLivePlaying:"string",textLoading:"string",touchMode:"boolean",onAuxPointerActivateRequest:["function","object"],onAuxPointerDeactivateRequest:["function","object"],onAuxPointerMoveRequest:["function","object"],onEndSeeking:["function","object"],onSeekTo:["function","object"],onSeeking:["function","object"],onStartSeeking:["function","object"],updateSeekBarDimensionsRequest:["function","object"]}}uiGetDefaultProps(){return{seekBarDimensions:null,auxPointerShown:!1,auxPointerProgress:0,adPoints:[],currentTime:0,chapterPoints:[],duration:0,buffered:null,loading:!1,liveMode:!1,playingLive:!1,progress:0,progressBarColor:"",seekingEnabled:!0,sourceReady:!1,titleEnabled:"",titleDisabled:"",textSeekbarPlayed:"",textSeekbarPlayedPrepos:"",textIsLivePlaying:"",textLoading:"",touchMode:!1,onAuxPointerActivateRequest:null,onAuxPointerDeactivateRequest:null,onAuxPointerMoveRequest:null,onEndSeeking:null,onSeeking:null,onSeekTo:null,onStartSeeking:null,updateSeekBarDimensionsRequest:null}}_onUiInit(e){this._component.seekBarAuxiliaryPointer=new Sn(this._getPropsForAuxPointer(e)),this._component.seekBarProgressBar=new Rs(this.__getPropsForSeekBarBoxProgressBar(e)),this._component.seekBarLoadingBar=new Cn(this.__getPropsForLoadingBar(e)),this._component.seekBarBufferBar=new bn(this.__getPropsForBufferBar(e)),this._component.seekBarAdPoints=new kn(this.__getPropsForAdPoints(e)),this._component.seekBarChapterPoints=new wn(this.__getPropsForChapterPoints(e))}_onUiBuild(e){this._dom.root=es("div",{className:"c-SeekBarBox",tabIndex:0}),this._dom.refs.fullBar=es("div",{className:"c-SeekBarBox__full"}),this._dom.refs.auxPointerContainer=es("div",{className:"w-AuxPoint"}),this._dom.refs.seekingBar=es("div",{className:"c-SeekBarBox__seek"}),this._dom.refs.thumb=es("div",{className:"c-SeekBarBox__thumb",innerHTML:'\n\t\t\t\t<svg version="1.1" xmlns="http://www.w3.org/2000/svg"\n\t\t\t\t\txmlns:xlink="http://www.w3.org/2000/svg" tabIndex="-1"\n\t\t\t\t\tfocusable="false" height="100%" width="100%">\n\t\t\t\t\t<circle cx="10" cy="10" r="10"/>\n\t\t\t\t</svg>\n\t\t\t'}),ts(this._dom.root).append(ts(this._dom.refs.fullBar).append(this._component.seekBarLoadingBar.uiGetElement(),this._component.seekBarBufferBar.uiGetElement(),this._component.seekBarProgressBar.uiGetElement(),this._dom.refs.seekingBar,this._component.seekBarAdPoints.uiGetElement(),this._component.seekBarChapterPoints.uiGetElement(),this._dom.refs.thumb),this._component.seekBarAuxiliaryPointer.uiGetElement()),this.__setSeekingEnabled(e.seekingEnabled&&e.sourceReady),this.__setTitle(e.seekingEnabled&&e.sourceReady?e.titleEnabled:e.titleDisabled),this.__updateAuxPointerPos(e.auxPointerProgress),this.__addSeekbarEvents(),this.__setThumbColor(e.progressBarColor),this.__setThumbDisplayed(e.progressBarColor.length>0&&!e.liveMode&&e.sourceReady)}_onUiUpdate(e){this._props.seekingEnabled===e.seekingEnabled&&this._props.titleEnabled===e.titleEnabled&&this._props.titleDisabled===e.titleDisabled&&this._props.sourceReady===e.sourceReady||(this.__setSeekingEnabled(e.seekingEnabled&&e.sourceReady),this.__setTitle(e.seekingEnabled&&e.sourceReady?e.titleEnabled:e.titleDisabled)),this._props.liveMode===e.liveMode&&this._props.progressBarColor===e.progressBarColor&&this._props.sourceReady===e.sourceReady||this.__setThumbDisplayed(e.progressBarColor.length>0&&!e.liveMode&&e.sourceReady),this._props.progress!=e.progress&&this.__setThumbProgress(e.progress),this._props.progressBarColor!==e.progressBarColor&&this.__setThumbColor(e.progressBarColor),this.__setAriaAttr(e),this._component.seekBarAuxiliaryPointer.uiUpdate(this._getPropsForAuxPointer(e)),this._component.seekBarProgressBar.uiUpdate(this.__getPropsForSeekBarBoxProgressBar(e)),this._component.seekBarLoadingBar.uiUpdate(this.__getPropsForLoadingBar(e)),this._component.seekBarBufferBar.uiUpdate(this.__getPropsForBufferBar(e)),this._component.seekBarAdPoints.uiUpdate(this.__getPropsForAdPoints(e)),this._component.seekBarChapterPoints.uiUpdate(this.__getPropsForChapterPoints(e))}_onUiDestroy(){this.__removeSeekbarEvents(),this.__removeMouseLeaveEvents(),this.__removeMovingEvents(),this.__removeSeekingEndEvents(),this.__clearTouchEndTimeout()}_getPropsForAuxPointer(e){return{displayed:e.auxPointerShown&&e.sourceReady,progressBarColor:e.progressBarColor,auxPointerProgress:e.auxPointerProgress}}__getPropsForSeekBarBoxProgressBar(e){return{progress:e.progress,color:e.progressBarColor}}__getPropsForLoadingBar(e){return{displayed:e.loading||!e.sourceReady,fallbackText:e.textLoading}}__getPropsForBufferBar(e){const t=e.buffered?e.buffered.end:0;return{progress:e.seekingEnabled?parseFloat((t/e.duration).toFixed(2),10):0}}__getPropsForAdPoints(e){return{displayed:e.sourceReady,adPoints:e.adPoints,duration:e.duration}}__getPropsForChapterPoints(e){return{displayed:e.sourceReady,chapterPoints:e.chapterPoints,duration:e.duration}}__setDisplayed(e){ts(this._dom.root).setDisplayed(e)}__setThumbDisplayed(e){ts(this._dom.refs.thumb).setDisplayed(e)}__setThumbColor(e){ts(this._dom.refs.thumb.querySelector("svg > circle")).setAttr({fill:e,stroke:e})}__setThumbProgress(e){let t=100*(isNaN(e)||!isFinite(e)?0:e);ts(this._dom.refs.thumb).setStyle({left:`${t}%`})}__setTitle(e){this._dom.root.title=e}__setAriaAttr(e){const t=e.seekingEnabled?e.titleEnabled:e.titleDisabled;let i=100,s="";if(e.playingLive)s=e.textIsLivePlaying;else{const t=e.duration*e.progress;i=Math.round(100*e.progress),s=`${e.textSeekbarPlayed} ${o.formatTime(t)} ${e.textSeekbarPlayedPrepos} ${o.formatTime(e.duration)}`}ts(this._dom.root).setAttr({role:"slider","aria-label":t,"aria-valuemin":0,"aria-valuemax":100,"aria-valuenow":i,"aria-valuetext":s})}__setSeekingEnabled(e){ts(this._dom.root).cssClasses({"-disabled":!e}),ts(this._dom.root).setAttr({tabIndex:e?0:-1})}__canSeek(){return this._props.seekingEnabled}__addSeekbarEvents(){const e=this._dom.root;e.addEventListener("touchstart",this.__onTouchStart),p.isIPhone()||p.isIPad()||p.isIPod()||p.isTouch()||(e.addEventListener("mouseenter",this.__onMouseEnter),e.addEventListener("mousedown",this.__onMouseDown))}__removeSeekbarEvents(){const e=this._dom.root;e.removeEventListener("touchstart",this.__onTouchStart),p.isIPhone()||p.isIPad()||p.isIPod()||p.isTouch()||(e.removeEventListener("mouseenter",this.__onMouseEnter),e.removeEventListener("mousedown",this.__onMouseDown))}__addMouseLeaveEvents(){this._dom.root.addEventListener("mouseleave",this.__onMouseLeave)}__removeMouseLeaveEvents(){this._dom.root.removeEventListener("mouseleave",this.__onMouseLeave)}__addMovingEvents(){const e=this._dom.refs.document;e.addEventListener("mousemove",this.__onMouseMove),e.addEventListener("touchmove",this.__onTouchMove,{passive:!1})}__removeMovingEvents(){const e=this._dom.refs.document;e.removeEventListener("mousemove",this.__onMouseMove),e.removeEventListener("touchmove",this.__onTouchMove,{passive:!1})}__addSeekingEndEvents(){const e=this._dom.refs.document;e.addEventListener("touchend",this.__onTouchEnd),e.addEventListener("touchcancel",this.__onTouchEnd),e.addEventListener("mouseup",this.__onMouseUp)}__removeSeekingEndEvents(){const e=this._dom.refs.document;e.removeEventListener("touchend",this.__onTouchEnd),e.removeEventListener("touchcancel",this.__onTouchEnd),e.removeEventListener("mouseup",this.__onMouseUp)}__setTouchUsed(e){this._flags.touchUsed=e}__setMouseUsed(e){this._flags.mouseUsed=e,e&&this.__startMouseUsedOffTimeout()}__setMouseIntersected(e){this._flags.mouseIntersected=e}__setHoldingMouseButton(e){this._flags.holdingMouseDown=e}__setSeeking(e){this._flags.seeking=e}__updateAuxPointerPos(e){const t=100*e;ts(this._dom.refs.auxPointerContainer).setStyle({left:`${t}%`})}__onAuxPointerProgressByMouse(e,t){const i=this._props.seekBarDimensions,s=t+e,n=this.__getPartFromClientRect(s,i);this.__onAuxPointerMoveRequest(n)}__startTouchEndTimeout(e){const t=e.changedTouches;this._touchEndTimeout=setTimeout(()=>{if(this.__removeMovingEvents(),this.__removeSeekingEndEvents(),this.__setTouchUsed(!1),this.__setSeeking(!1),1==t.length){const e=t[0],i=window.pageXOffset;this.__onAuxPointerProgressByMouse(e.clientX,i),this.__onMoveCurrentTimeToByPos(e.clientX,i),this.__onSeekToByPos(e.clientX,i)}this.__onEndSeeking()})}__clearTouchEndTimeout(){this._touchEndTimeout&&(clearTimeout(this._touchEndTimeout),this._touchEndTimeout=null)}__startMouseUsedOffTimeout(){this._mouseUsedOffTimeout||(this._mouseUsedOffTimeout=setTimeout(()=>this.__clearMouseUsedOffTimeout(),10),this.__setMouseUsed(!1))}__clearMouseUsedOffTimeout(){this._mouseUsedOffTimeout&&(clearTimeout(this._mouseUsedOffTimeout),this._mouseUsedOffTimeout=null)}__onTouchStart(e){if(!this.__canSeek())return;if(this._flags.mouseUsed)return;const t=e.changedTouches;if(1==t.length){const i=t[0],s=i.target,n=window.pageXOffset;(this._dom.root==s||this._dom.root.contains(s))&&(e.preventDefault(),this.__updateSeekBarDimensions(),this.__addMovingEvents(),this.__addSeekingEndEvents(),this.__setTouchUsed(!0),this.__setSeeking(!0),this.__onAuxPointerProgressByMouse(i.clientX,n),this.__onStartSeeking(),this.__onMoveCurrentTimeToByPos(i.clientX,n))}}__onTouchMove(e){this._flags.mouseUsed||(e.preventDefault(),this._touchMoveTimeout||(this._touchMoveTimeout=setTimeout(()=>{const t=e.changedTouches;if(1==t.length){const e=t[0],i=e.target,s=window.pageXOffset;(this._dom.root==i||this._dom.root.contains(i))&&(this.__onAuxPointerProgressByMouse(e.clientX,s),this.__onMoveCurrentTimeToByPos(e.clientX,s))}clearTimeout(this._touchMoveTimeout),this._touchMoveTimeout=null},10)))}__onTouchEnd(e){this._flags.mouseUsed||(this.__clearTouchEndTimeout(),this.__startTouchEndTimeout(e))}__onMouseEnter(){this.__canSeek()&&(this._flags.touchUsed||(this.__addMouseLeaveEvents(),this.__addMovingEvents(),this.__setMouseUsed(!0),this.__setMouseIntersected(!0),this._mouseHoverTimeout=setTimeout(()=>{this.__onAuxPointerActivateRequest(),this.__updateSeekBarDimensions()},100)))}__onMouseLeave(){this.__canSeek()&&(this._flags.touchUsed||(clearTimeout(this._mouseHoverTimeout),this._mouseHoverTimeout=null,this.__removeMouseLeaveEvents(),this.__setMouseUsed(!0),this.__setMouseIntersected(!1),this._flags.holdingMouseDown||(this.__removeMovingEvents(),this.__onAuxPointerDeactivateRequest())))}__onMouseDown(e){if(!this.__canSeek())return;if(this._flags.touchUsed)return;e.preventDefault(),this.__addSeekingEndEvents();const t=window.pageXOffset;this.__setMouseUsed(!0),this.__setSeeking(!0),this.__setHoldingMouseButton(!0),this.__onAuxPointerProgressByMouse(e.clientX,t),this.__onStartSeeking(),this.__onMoveCurrentTimeToByPos(e.clientX,t)}__onMouseMove(e){if(!this._flags.touchUsed&&!this._mouseMoveTimeout){this._mouseMoveTimeout=setTimeout(()=>{clearTimeout(this._mouseMoveTimeout),this._mouseMoveTimeout=null},16);const t=window.pageXOffset;this.__setMouseUsed(!0),this.__onAuxPointerProgressByMouse(e.clientX,t),this._flags.holdingMouseDown&&this.__onMoveCurrentTimeToByPos(e.clientX,t)}}__onMouseUp(e){if(this._flags.touchUsed)return;this.__removeSeekingEndEvents();const t=window.pageXOffset;this.__setMouseUsed(!0),this.__setHoldingMouseButton(!1),this.__setSeeking(!1),this.__onAuxPointerProgressByMouse(e.clientX,t),this._flags.mouseIntersected||(this.__removeMovingEvents(),this.__onAuxPointerDeactivateRequest()),this.__onSeekToByPos(e.clientX,t),this.__onEndSeeking()}__onAuxPointerActivateRequest(){this._props.onAuxPointerActivateRequest&&this._props.onAuxPointerActivateRequest()}__onAuxPointerMoveRequest(e){this._props.onAuxPointerMoveRequest&&this._props.onAuxPointerMoveRequest(e)}__onAuxPointerDeactivateRequest(){this._props.onAuxPointerDeactivateRequest&&this._props.onAuxPointerDeactivateRequest()}__onStartSeeking(){this._props.onStartSeeking&&this._props.onStartSeeking()}__onSeekToByPos(e,t){if(this._props.onSeekTo){const i=t+e,s=this._props.seekBarDimensions,n=this.__getPartFromClientRect(i,s);this._props.onSeekTo(n)}}__onMoveCurrentTimeToByPos(e,t){if(this._props.onSeeking){const i=t+e,s=this._props.seekBarDimensions,n=this.__getPartFromClientRect(i,s);this._props.onSeeking(n)}}__onEndSeeking(){this._props.onEndSeeking&&this._props.onEndSeeking()}__getPartFromClientRect(e,t){const i=t.width,s=t.left;t.right;return Math.min(Math.max(e-s,0),i)/i}__updateSeekBarDimensions(){this._props.updateSeekBarDimensionsRequest&&this._props.updateSeekBarDimensionsRequest()}}const Ln=72;class xn extends fs{constructor(e){super(e),this._dom={root:null,refs:{frame:null,time:null}},this._component={chapterTeaser:null}}uiGetDeclaredProps(){return{displayed:"boolean",auxPointerShown:"boolean",auxPointerProgress:"number",auxPointerOnMidroll:"boolean",auxOnChapter:"object",settingsMenuShown:"boolean",duration:"number",time:"number",textAdPoint:"string",seekSource:"object",touchMode:"boolean",seeking:"boolean",seekBarWidth:"number"}}uiGetDefaultProps(){return{displayed:!1,auxPointerShown:!1,auxPointerProgress:0,auxPointerOnMidroll:!1,auxOnChapter:[],settingsMenuShown:!1,time:0,textAdPoint:"",duration:0,seekSource:null,touchMode:!1,seeking:!1,seekBarWidth:0}}_onUiInit(e){this._component.chapterTeaser=new cn(this.__getPropsForChapterTeaser(e))}_onUiBuild(e){this._dom.root=es("div",{className:"c-PreviewBox"}),this._dom.refs.frame=es("div",{className:"c-PreviewBox__frame"}),this._dom.refs.chapterLabel=es("span",{className:"c-PreviewBox__label",innerHTML:"Kapitola"}),this._dom.refs.chapterAd=es("span",{className:"c-PreviewBox__ad",innerHTML:"REKLAMA"}),this._dom.refs.time=es("span",{className:"c-PreviewBox__time"}),ts(this._dom.root).append(this._dom.refs.frame,this._component.chapterTeaser.uiGetElement(),this._dom.refs.chapterLabel,this._dom.refs.chapterAd,this._dom.refs.time),this._setDisplayed(!1),this._updateTime(e)}_onUiCanUpdate(e){return e.displayed||this._props.displayed!==e.displayed}_onUiUpdate(e){if(this._props.time!==e.time||e.auxPointerShown!==this._props.auxPointerShown||e.auxPointerProgress!==this._props.auxPointerProgress||e.auxOnChapter.length!==this._props.auxOnChapter.length||e.auxPointerOnMidroll!==this._props.auxPointerOnMidroll){if(this._updateRootClass(e),e.seekSource&&e.seekSource.rows&&e.seekSource.columns&&e.seekSource.width&&e.seekSource.height){if(JSON.stringify(e.seekSource)==JSON.stringify(this._props.seekSource)&&e.duration===this._props.duration&&e.auxPointerShown===this._props.auxPointerShown&&e.auxPointerProgress===this._props.auxPointerProgress&&e.auxPointerOnMidroll===this._props.auxPointerOnMidroll&&e.settingsMenuShown===this._props.settingsMenuShown)return;const t=e.seekSource.width/e.seekSource.height;let i=null;i=t>=1?{width:`${Ln*t}px`,height:`${Ln}px`}:{width:`${Ln}px`,height:`${Ln/t}px`},ts(this._dom.root).setStyle(i),this._updatePreviewBoxContent(e)}else ts(this._dom.root).setStyle({width:"auto",height:"auto"});this._updatePreviewBoxPosition(e,e.seekBarWidth),this._props.time===e.time&&this._props.auxPointerOnMidroll===e.auxPointerOnMidroll||this._updateTime(e),this._component.chapterTeaser.uiUpdate(this.__getPropsForChapterTeaser(e))}this._setDisplayed(e.displayed)}_updateTime(e){ts(this._dom.refs.time).setInnerHTML(e.auxPointerOnMidroll?e.textAdPoint:e.touchMode?"":o.formatTime(e.time))}_updateRootClass(e){const t=e.seekSource&&e.seekSource.rows&&e.seekSource.columns&&e.seekSource.width&&e.seekSource.height;ts(this._dom.root).cssClasses({"-with-preview-image":t&&!e.auxPointerOnMidroll,"-on-ad-point":e.auxPointerOnMidroll,"-on-chapter-point":e.auxOnChapter.length>0})}_updatePreviewBoxContent(e){const t=e.seekSource,i=t.columns,s=t.rows,n=i*s,o=Math.floor(e.duration*e.auxPointerProgress/t.frame_duration)+1,r=o%n;let a=r%i*(100/Math.max(i-1,1)),l=(Math.ceil((r+1)/i)-1)*(100/Math.max(s-1,1)),h=Math.floor(o/n);h>=t.urls.length&&(h=t.urls.length-1,a=100,l=100),ts(this._dom.refs.frame).setStyle({backgroundImage:`url(${t.urls[h]})`,backgroundSize:`${100*i}% ${100*s}%`,backgroundPosition:`${a}% ${l}%`})}_updatePreviewBoxPosition(e,t){let i=100*e.auxPointerProgress,s=Math.round(this._dom.root.offsetWidth/2)+8;const n=s/t*100,o=(t-s)/t*100;ts(this._dom.root).setStyle({left:`${i}%`}).cssClasses({"-stick-left":i<n,"-stick-right":i>o})}_setDisplayed(e){ts(this._dom.root).setDisplayed(e)}__getPropsForChapterTeaser(e){const t=e.auxOnChapter.length>0;return{poster:t?e.auxOnChapter[0].poster:"",title:t?e.auxOnChapter[0].title:"",startTime:t?e.auxOnChapter[0].startTime:0}}}class Mn extends fs{constructor(e){super(e),this._dom={root:null,refs:{container:null,previewBoxContainer:null,document:document}},this._component={seekBarBox:null,previewBox:null},this._flags={auxTimeShown:!1,auxPointerActivated:!1,auxPointerShown:!1,seeking:!1},this._values={auxProgress:0,auxTime:0},this._bind=["__onStartSeeking","__onEndSeeking","__onSeekTo","__onSeeking","__onAuxPointerActivateRequest","__onAuxPointerDeactivateRequest","__onAuxPointerMoveRequest","__updateSeekBarDimensionsRequest"],this._seekBarDimensions={bottom:0,height:0,left:0,right:0,top:0,width:0,x:0,y:0}}uiGetDeclaredProps(){return{displayed:"boolean",buffered:"object",eventMode:"boolean",liveMode:"boolean",loading:"boolean",onEndSeeking:["function","object"],onLiveClick:["function","object"],onLiveRewindClick:["function","object"],onSeekTo:["function","object"],onSeeking:["function","object"],onStartSeeking:["function","object"],playingLive:"boolean",seekSource:"object",sourceReady:"boolean",progressBarColor:"string",seeking:"boolean",seekingEnabled:"boolean",streamingLive:"boolean",settingsMenuShown:"boolean",tvMode:"boolean",touchMode:"boolean",currentTime:"number",adPoints:"object",chapterPoints:"object",duration:"number",titleEnabled:"string",titleDisabled:"string",textSeekbarPlayed:"string",textSeekbarPlayedPrepos:"string",textLoading:"string",textLive:"string",textSetLive:"string",textIsLivePlaying:"string",textLiveFromStart:"string",textSetLiveFromStart:"string",textTvMode:"string",textAdPoint:"string",updateAuxPointerShown:["function","object"]}}uiGetDefaultProps(){return{displayed:!1,buffered:null,eventMode:!1,liveMode:!1,loading:!1,onEndSeeking:null,onLiveClick:null,onLiveRewindClick:null,onSeeking:null,onSeekTo:null,onStartSeeking:null,seekSource:null,sourceReady:!1,progressBarColor:"",seeking:!1,seekingEnabled:!0,streamingLive:!1,settingsMenuShown:!1,tvMode:!1,touchMode:!1,currentTime:0,adPoints:[],chapterPoints:[],duration:0,titleEnabled:"",titleDisabled:"",textSeekbarPlayed:"",textSeekbarPlayedPrepos:"",textLoading:"",textLive:"",textSetLive:"",textIsLivePlaying:"",textLiveFromStart:"",textSetLiveFromStart:"",textTvMode:"",textAdPoint:"",updateAuxPointerShown:null}}_onUiInit(e){this._component.seekBarBox=new Nn(this.__getPropsForSeekBarBox(e)),this._component.previewBox=new xn(this.__getPropsForPreviewBox(e))}_onUiBuild(e){this._dom.root=es("div",{className:"c-SeekBar"}),ts(this._dom.root).append(this._component.seekBarBox.uiGetElement(),this._component.previewBox.uiGetElement()),this.__updateSeekBarDimensionsRequest()}_onUiUpdate(e){this._props.seekingEnabled!=e.seekingEnabled&&(this.__setAuxPointerShown(!1),this.__setAuxTimeShown(!1)),this._component.seekBarBox.uiUpdate(this.__getPropsForSeekBarBox(e)),this._component.previewBox.uiUpdate(this.__getPropsForPreviewBox(e))}__getPropsForSeekBarBox(e){let t=0;return t=(e.liveMode||e.playingLive||e.duration&&e.currentTime>=e.duration)&&!this._flags.seeking?1:e.currentTime/e.duration,isFinite(t)||(t=0),{seekBarDimensions:this._seekBarDimensions,auxPointerShown:this._flags.auxPointerShown,auxPointerProgress:this._flags.auxPointerActivated?this._values.auxProgress:t,adPoints:e.adPoints,currentTime:e.currentTime,chapterPoints:e.chapterPoints,duration:e.duration,buffered:e.buffered,loading:e.loading,progress:t,liveMode:e.liveMode,playingLive:e.playingLive,progressBarColor:e.progressBarColor,seekingEnabled:e.seekingEnabled,sourceReady:e.sourceReady,titleEnabled:e.titleEnabled,titleDisabled:e.titleDisabled,textSeekbarPlayed:e.textSeekbarPlayed,textSeekbarPlayedPrepos:e.textSeekbarPlayedPrepos,textIsLivePlaying:e.textIsLivePlaying,textLoading:e.textLoading,touchMode:e.touchMode,onAuxPointerActivateRequest:this.__onAuxPointerActivateRequest,onAuxPointerDeactivateRequest:this.__onAuxPointerDeactivateRequest,onAuxPointerMoveRequest:this.__onAuxPointerMoveRequest,onEndSeeking:this.__onEndSeeking,onSeekTo:this.__onSeekTo,onSeeking:this.__onSeeking,onStartSeeking:this.__onStartSeeking,updateSeekBarDimensionsRequest:this.__updateSeekBarDimensionsRequest}}__setDisplayed(e){ts(this._dom.root).setDisplayed(e)}__getPropsForPreviewBox(e){const t=this._seekBarDimensions.width,i=this._values.auxTime,s=t&&e.duration?t/e.duration:1;let n=0;n=!e.liveMode&&!e.playingLive||this._flags.seeking?e.currentTime/e.duration:1,isFinite(n)||(n=0);const o=e.adPoints.some(e=>{const t=8/s/2;void 0===e.visible||e.visible;return Math.abs(e.time-i)<t}),r=e.chapterPoints.filter(e=>{const t=8/s/2;return Math.abs(e.startTime-i)<t});return{displayed:!(e.settingsMenuShown||!(this._flags.auxPointerShown||e.seeking&&(o||e.seekSource))||!e.sourceReady),auxPointerShown:this._flags.auxPointerShown,auxPointerProgress:this._flags.auxPointerActivated?this._values.auxProgress:n,auxPointerOnMidroll:o,auxOnChapter:r,textAdPoint:e.textAdPoint,time:i,duration:e.duration,seekSource:e.seekSource,settingsMenuShown:e.settingsMenuShown,seeking:e.seeking,touchMode:e.touchMode,seekBarWidth:t}}__setAuxPointerActivated(e){this._flags.auxPointerActivated=e}__setAuxPointerShown(e){this._flags.auxPointerShown=e,this._props.updateAuxPointerShown&&this._props.updateAuxPointerShown(this._flags.auxPointerShown)}__setAuxTimeShown(e){this._flags.auxTimeShown=e}__setSeeking(e){this._flags.seeking=e}__onAuxPointerActivateRequest(){this.__setAuxPointerActivated(!0);let e=!0,t=!0;this._props.seekingEnabled||(e=!1,t=!1),this.__setAuxPointerShown(e),this.__setAuxTimeShown(t),this.uiForceUpdate()}__onAuxPointerDeactivateRequest(){this.__setAuxPointerActivated(!1);this.__setAuxPointerShown(!1),this.__setAuxTimeShown(!1),this.uiForceUpdate()}__onAuxPointerMoveRequest(e){this._values.auxProgress=e,this._values.auxTime=e*this._props.duration,this.uiForceUpdate()}__onStartSeeking(){this.__setSeeking(!0),this.uiForceUpdate(),this._props.onStartSeeking&&this._props.onStartSeeking()}__onSeekTo(e){this._props.onSeekTo&&this._props.onSeekTo(e*this._props.duration)}__onSeeking(e){this._props.onSeeking&&this._props.onSeeking(e*this._props.duration)}__onEndSeeking(){this.__setSeeking(!1),this.uiForceUpdate(),this._props.onEndSeeking&&this._props.onEndSeeking()}__updateSeekBarDimensionsRequest(){const e=this._dom.root.getBoundingClientRect();this._seekBarDimensions={bottom:e.bottom,height:e.height||0,left:e.left,right:e.right,top:e.top,width:e.width||0,x:e.x||0,y:e.y||0}}}class Dn extends fs{constructor(e){super(e),this._dom={root:null,refs:{currentTime:null,duration:null,valueText:null}}}uiGetDeclaredProps(){return{time:"number",duration:"number",streamingLive:"boolean",isEvent:"boolean",isLive:"boolean",playingLive:"boolean",desc:"string",displayed:"boolean"}}uiGetDefaultProps(){return{time:0,duration:0,streamingLive:!1,isEvent:!1,isLive:!1,playingLive:!1,desc:"",displayed:!1}}_onUiBuild(e){this._dom.root=es("div",{className:"c-TimeInfo"}),this._dom.refs.currentTime=es("span",{className:"c-TimeInfo__currentTime"}),this._dom.refs.duration=es("span",{className:"c-TimeInfo__duration"}),ts(this._dom.root).append(this._dom.refs.currentTime,this._dom.refs.duration),this._setDisplayed(e),this._setDurationDisplayed(e),this._updateTime(e.time),this._updateDuration(e.duration,e.desc)}_onUiUpdate(e){this._props.displayed!==e.displayed&&this._setDisplayed(e),this._props.time!=e.time&&this._updateTime(e.time),this._props.duration===e.duration&&this._props.desc==e.desc||this._updateDuration(e.duration,e.desc),this._props.streamingLive!==e.streamingLive&&this._setDurationDisplayed(e)}_setDisplayed(e){ts(this._dom.root).setDisplayed(e.displayed)}_setDurationDisplayed(e){ts(this._dom.refs.duration).setDisplayed(!e.streamingLive)}_updateTime(e){ts(this._dom.refs.currentTime).setInnerHTML(o.formatTime(e))}_updateDuration(e,t){ts(this._dom.refs.duration).setInnerHTML(t||o.formatTime(e))}}class On extends fs{constructor(e){super(e),this._dom={root:null,refs:{text:null,arrow:null}},this._bind=["__clickOn"]}uiGetDeclaredProps(){return{displayed:"boolean",liveText:"string",textSetLive:"string",playingLive:"boolean",onClick:["function","object"]}}uiGetDefaultProps(){return{displayed:!1,liveText:"",textSetLive:"",playingLive:!1,onClick:null}}_onUiInit(e){}_onUiBuild(e){this._dom.root=es("button",{className:"c-LiveBubble",type:"button"}),this._dom.refs.text=es("span",{className:"c-LiveBubble__text"}),ts(this._dom.root).append(this._dom.refs.text),this.__setDisplayed(e.displayed),this.__setText(e.liveText),this.__setPlayingLive(e),this.__setAriaAttr(e),this._dom.root.addEventListener("click",this.__clickOn)}_onUiCanUpdate(e){return e.displayed||this._props.displayed!=e.displayed}_onUiUpdate(e){this._props.displayed!=e.displayed&&this.__setDisplayed(e.displayed),this._props.liveText!=e.liveText&&this.__setText(e.liveText),this._props.playingLive!==e.playingLive&&this.__setPlayingLive(e)}_onUiDestroy(){this._dom.root.removeEventListener("click",this.__clickOn)}__setDisplayed(e){ts(this._dom.root).setDisplayed(e)}__setText(e){this._dom.refs.text.innerHTML=e}__setPlayingLive(e){ts(this._dom.root).cssClasses({"-live-playing":e.playingLive})}__setAriaAttr(e){ts(this._dom.root).setAttr({title:e.textSetLive,"aria-label":e.textSetLive})}__clickOn(e){this._props.onClick&&this._props.onClick()}}class Rn extends fs{constructor(e){super(e),this._dom={root:null,refs:{seekBarBox:null,buttonsWrapper:null,buttonsGroupLeft:null,buttonsGroupRight:null,controlGroup:null,moreGroup:null,loadingBox:null}},this._component={previousButton:null,playPauseButton:null,volume:null,seekBar:null,timeInfo:null,settingButton:null,subtitlesButton:null,castButton:null,cinemaButton:null,pipButton:null,fullscreenButton:null,moreButton:null,liveBubble:null},this._bind=["__onPipButtonClick","__onCastButtonClick","__onCinemaButtonClick","__onFullscreenButtonClick","__onEndSeeking","__onPreviousButtonClick","__onPlayPauseButtonClick","__onSettingsButtonClick","__onSubtitlesButtonClick","__onSeeking","__onSeekTo","__onStartSeeking","__onMuteClick","__onLiveClick","__onVolumeChange","__onMoreButtonClick"],this._flags={moreVisible:!1}}uiGetDeclaredProps(){return{visible:"boolean",currentTime:"number",adPoints:"object",auxPointerShown:"boolean",duration:"number",buffered:"object",fullscreenEnabled:"boolean",fullscreenOn:"boolean",pipAvailable:"boolean",pipOn:"boolean",cinemaAvailable:"boolean",cinemaOn:"boolean",airPlayAvailable:"boolean",airPlayOn:"boolean",chromeCastAvailable:"boolean",chromeCastOn:"boolean",indicatorColor:"string",isEvent:"boolean",isLive:"boolean",layout:"string",loading:"boolean",seeking:"boolean",playing:"boolean",playingLive:"boolean",seekSource:"object",sourceReady:"boolean",progressBarColor:"string",qualityMenuShown:"boolean",subtitlesMenuShown:"boolean",seekingEnabled:"boolean",settingsMenuShown:"boolean",settingsEnabled:"boolean",qualityEnabled:"boolean",subtitlesEnabled:"boolean",pipEnabled:"boolean",cinemaEnabled:"boolean",airPlayEnabled:"boolean",chromeCastEnabled:"boolean",streamingLive:"boolean",tvMode:"boolean",subtitlesShown:"boolean",subtitlesList:"object",textLoading:"string",textPlay:"string",textPause:"string",textMute:"string",textUnmute:"string",textVolume:"string",textVolumeValueOn:"string",textSeekbarEnabled:"string",textSeekbarDisabled:"string",textSeekbarPlayed:"string",textSeekbarPlayedPrepos:"string",textSubtitlesEnabled:"string",textSubtitlesDisabled:"string",textQualityEnabled:"string",textQualityDisabled:"string",textFullscreenOn:"string",textFullscreenOff:"string",textSettings:"string",textSettingsClose:"string",textPipOn:"string",textPipOff:"string",textCinemaOn:"string",textCinemaOff:"string",textLive:"string",textSetLive:"string",textIsLivePlaying:"string",textLiveFromStart:"string",textSetLiveFromStart:"string",textTvMode:"string",textAdPoint:"string",useTouch:"boolean",visibleElements:"object",volume:"number",volumeMuted:"boolean",isLargeUi:"boolean",castMenuShown:"boolean",chapterPoints:"object",updateAuxPointerShown:["function","object"]}}_onUiInit(e){this._component.seekBar=new Mn(this.__getPropsForSeekBar(e)),this._component.previousButton=new Os(this.__getPropsForPreviousButton(e)),this._component.playPauseButton=new Os(this.__getPropsForPlayPauseButton(e)),this._component.timeInfo=new Dn(this.__getPropsForTimeInfo(e)),this._component.volume=new Vs(this.__getPropsForVolume(e)),this._component.liveBubble=new On(this.__getPropsForLiveBubble(e)),this._component.settingButton=new Os(this.__getPropsForSettingButton(e)),this._component.subtitlesButton=new Os(this.__getPropsForSubtitlesButton(e)),this._component.cinemaButton=new Os(this.__getPropsForCinemaButton(e)),this._component.pipButton=new Os(this.__getPropsForPipButton(e)),this._component.castButton=new Os(this.__getPropsForCastButton(e)),this._component.fullscreenButton=new Os(this.__getPropsForFullscreenButton(e)),this._component.moreButton=new Os(this.__getPropsForMoreButton(e))}_onUiBuild(e){this._dom.root=es("div",{className:"w-DefaultCtrlPanelLayout"}),this._dom.refs.buttonsWrapper=es("div",{className:"w-DefaultCtrlPanelGroups"}),this._dom.refs.buttonsGroupLeft=es("div",{className:"w-DefaultCtrlPanelGroup -left"}),this._dom.refs.buttonsGroupRight=es("div",{className:"w-DefaultCtrlPanelGroup -right"}),this._dom.refs.controlGroup=es("div",{className:"w-DefaultCtrlPanelSubGroup -controls"}),this._dom.refs.moreGroup=es("div",{className:"w-DefaultCtrlPanelSubGroup -more"}),this._dom.refs.loadingBox=es("span",{className:"w-DefaultCtrlPanelSubGroup -loading",innerHTML:e.textLoading}),ts(this._dom.root).append(this._component.seekBar.uiGetElement(),ts(this._dom.refs.buttonsWrapper).append(ts(this._dom.refs.buttonsGroupLeft).append(ts(this._dom.refs.controlGroup).append(this._component.previousButton.uiGetElement(),this._component.playPauseButton.uiGetElement()),this._component.volume.uiGetElement(),this._component.timeInfo.uiGetElement(),this._component.liveBubble.uiGetElement(),this._dom.refs.loadingBox),ts(this._dom.refs.buttonsGroupRight).append(this._component.subtitlesButton.uiGetElement(),this._component.settingButton.uiGetElement(),ts(this._dom.refs.moreGroup).append(this._component.castButton.uiGetElement(),this._component.pipButton.uiGetElement()),this._component.cinemaButton.uiGetElement(),this._component.fullscreenButton.uiGetElement(),this._component.moreButton.uiGetElement())))}_onUiUpdate(e){e.sourceReady?ts(this._dom.refs.loadingBox).setDisplayed(!1):ts(this._dom.refs.loadingBox).setDisplayed(!0),this._component.seekBar.uiUpdate(this.__getPropsForSeekBar(e)),this._component.previousButton.uiUpdate(this.__getPropsForPreviousButton(e)),this._component.playPauseButton.uiUpdate(this.__getPropsForPlayPauseButton(e)),this._component.volume.uiUpdate(this.__getPropsForVolume(e)),this._component.timeInfo.uiUpdate(this.__getPropsForTimeInfo(e)),this._component.liveBubble.uiUpdate(this.__getPropsForLiveBubble(e)),this._component.pipButton.uiUpdate(this.__getPropsForPipButton(e)),this._component.castButton.uiUpdate(this.__getPropsForCastButton(e)),this._component.cinemaButton.uiUpdate(this.__getPropsForCinemaButton(e)),this._component.settingButton.uiUpdate(this.__getPropsForSettingButton(e)),this._component.subtitlesButton.uiUpdate(this.__getPropsForSubtitlesButton(e)),this._component.fullscreenButton.uiUpdate(this.__getPropsForFullscreenButton(e)),this._component.moreButton.uiUpdate(this.__getPropsForMoreButton(e))}getSettingsButton(){return this._component.settingButton}getCastButton(){return this._component.castButton}getMoreButton(){return this._component.moreButton}getMoreContainer(){return this._dom.refs.moreGroup}getMoreVisibility(){return this._flags.moreVisible}setMoreVisibility(e=!1){this._flags.moreVisible=e,ts(this._dom.refs.moreGroup).cssClasses({"-active":this._flags.moreVisible}),ts(this._dom.refs.buttonsWrapper).cssClasses({"-right-more-active":this._flags.moreVisible})}__getPropsForSeekBar(e){return{displayed:e.visible,currentTime:e.currentTime,adPoints:e.adPoints,chapterPoints:e.chapterPoints,buffered:e.buffered,duration:e.duration,eventMode:e.isEvent,liveMode:e.isLive,loading:e.loading,playingLive:e.playingLive,seekSource:e.seekSource,sourceReady:e.sourceReady,seeking:e.seeking,progressBarColor:e.progressBarColor,seekingEnabled:e.seekingEnabled,streamingLive:e.streamingLive,settingsMenuShown:e.settingsMenuShown,tvMode:e.tvMode,touchMode:e.useTouch,titleDisabled:e.textSeekbarDisabled,titleEnabled:e.textSeekbarEnabled,textSeekbarPlayed:e.textSeekbarPlayed,textSeekbarPlayedPrepos:e.textSeekbarPlayedPrepos,textLoading:e.textLoading,textLive:e.textLive,textSetLive:e.textSetLive,textIsLivePlaying:e.textIsLivePlaying,textLiveFromStart:e.textLiveFromStart,textSetLiveFromStart:e.textSetLiveFromStart,textTvMode:e.textTvMode,textAdPoint:e.textAdPoint,updateAuxPointerShown:e.updateAuxPointerShown,onEndSeeking:this.__onEndSeeking,onSeeking:this.__onSeeking,onSeekTo:this.__onSeekTo,onStartSeeking:this.__onStartSeeking}}__getPropsForPlayPauseButton(e){return{displayed:e.sourceReady,mark:"play",titleEnabled:e.playing?e.textPause:e.textPlay,ariaProps:{"aria-label":e.playing?e.textPause:e.textPlay},iconProps:{play:{displayed:!e.playing},pause:{displayed:e.playing}},onClick:this.__onPlayPauseButtonClick}}__getPropsForPreviousButton(e){return{displayed:e.isEvent&&e.sourceReady,iconProps:{previous:{displayed:!1},reload:{displayed:e.isEvent}},titleEnabled:e.textSetLiveFromStart,ariaProps:{"aria-label":e.textSetLiveFromStart},onClick:this.__onPreviousButtonClick}}__getPropsForTimeInfo(e){return{displayed:!e.isLive&&e.sourceReady,isEvent:e.isEvent,isLive:e.isLive,playingLive:e.playingLive,streamingLive:e.streamingLive,duration:e.duration,time:e.currentTime}}__getPropsForVolume(e){return{displayed:e.sourceReady,touchMode:e.useTouch,volume:e.volume,muted:e.volumeMuted,titleMute:e.textMute,titleUnmute:e.textUnmute,titleVolume:e.textVolume,titleVolumeValueOn:e.textVolumeValueOn,vertical:!1,onMuteClick:this.__onMuteClick,onVolumeChange:this.__onVolumeChange}}__getPropsForLiveBubble(e){return{displayed:e.isEvent&&e.streamingLive&&e.isLargeUi&&e.sourceReady,textSetLive:e.textSetLive,liveText:e.tvMode?e.textTvMode:e.textLive,playingLive:e.playingLive,onClick:this.__onLiveClick}}__getPropsForSettingButton(e){return{displayed:e.visibleElements.settingsButton&&e.sourceReady,enabled:e.settingsEnabled,titleEnabled:e.settingsMenuShown?e.textSettingsClose:e.textSettings,iconProps:{settings:{displayed:!0}},cssClassWithExtraLook:{"-rotate":e.settingsMenuShown},onClick:this.__onSettingsButtonClick}}__getPropsForSubtitlesButton(e){return{displayed:e.visibleElements.subtitlesButton&&e.subtitlesList.length>0&&e.sourceReady,enabled:e.subtitlesList.length>0,titleEnabled:e.subtitlesShown?"Vypnout titulky":"Zapnout titulky",iconProps:{"captions-on":{displayed:e.subtitlesShown},"captions-off":{displayed:!e.subtitlesShown}},onClick:this.__onSubtitlesButtonClick}}__getPropsForCinemaButton(e){return{displayed:e.cinemaAvailable&&e.visibleElements.cinemaButton&&!e.fullscreenOn&&e.sourceReady,enabled:e.cinemaEnabled,titleEnabled:e.cinemaOn?e.textCinemaOff:e.textCinemaOn,iconProps:{"cinema-on":{displayed:!e.cinemaOn},"cinema-off":{displayed:e.cinemaOn}},onClick:this.__onCinemaButtonClick}}__getPropsForPipButton(e){return{displayed:e.pipAvailable&&e.visibleElements.pipButton&&e.sourceReady,enabled:e.pipEnabled,titleEnabled:e.pipOn?e.textPipOff:e.textPipOn,iconProps:{"pip-on":{displayed:!e.pipOn},"pip-off":{displayed:e.pipOn}},onClick:this.__onPipButtonClick}}__getPropsForCastButton(e){const t=(e.airPlayAvailable||e.chromeCastAvailable)&&e.visibleElements.castButton&&e.sourceReady,i=e.airPlayAvailable&&!e.chromeCastAvailable;return{displayed:t,enabled:t,titleEnabled:"",iconProps:{"chromecast-off":{displayed:!i},"airplay-off":{displayed:i}},onClick:this.__onCastButtonClick}}__getPropsForFullscreenButton(e){return{displayed:e.visibleElements.fullscreenButton&&e.sourceReady,enabled:e.fullscreenEnabled,titleEnabled:e.fullscreenOn?e.textFullscreenOff:e.textFullscreenOn,ariaProps:{"aria-label":e.fullscreenOn?e.textFullscreenOff:e.textFullscreenOn},iconProps:{"fullscreen-on":{displayed:!e.fullscreenOn},"fullscreen-off":{displayed:e.fullscreenOn}},onClick:this.__onFullscreenButtonClick}}__getPropsForMoreButton(e){return{displayed:(e.pipAvailable&&e.visibleElements.pipButton||(e.airPlayAvailable||e.chromeCastAvailable)&&e.visibleElements.castButton)&&e.sourceReady,iconProps:{more:{displayed:!0}},onClick:this.__onMoreButtonClick,cssClassWithExtraLook:{"-no-padding":!0}}}__onStartSeeking(){this._uiEmitEvent(ys.START_SEEKING)}__onSeeking(e){this._uiEmitEvent(ys.MOVE_CURRENT_TIME_TO,{time:e})}__onSeekTo(e){this._uiEmitEvent(ys.SEEK_TO,{time:e})}__onEndSeeking(){this._uiEmitEvent(ys.END_SEEKING)}__onVolumeChange(e){this._uiEmitEvent(ys.VOLUME_CHANGE_TO,{volume:e})}__onMuteClick(){this._uiEmitEvent(ys.VOLUME_MUTE_CLICK)}__onLiveClick(){this._uiEmitEvent(ys.CLICK_ON_LIVE)}__onLiveRewindClick(){this._uiEmitEvent(ys.SEEK_TO,{time:0})}__onPlayPauseButtonClick(e){this._props.playing?this._uiEmitEvent(ys.PAUSE_REQUEST):this._uiEmitEvent(ys.PLAY_REQUEST)}__onSettingsButtonClick(e){this._props.settingsMenuShown?this._uiEmitEvent(ys.CLOSE_SETTINGS_MENU_REQUEST):this._uiEmitEvent(ys.OPEN_SETTINGS_MENU_REQUEST)}__onSubtitlesButtonClick(e){this._uiEmitEvent(ys.TOGGLE_SUBTITLES_REQUEST)}__onPreviousButtonClick(e){this._props.isEvent&&this.__onLiveRewindClick()}__onCinemaButtonClick(e){this._props.cinemaOn?this._uiEmitEvent(ys.CINEMA_OFF_REQUEST):this._uiEmitEvent(ys.CINEMA_ON_REQUEST)}__onPipButtonClick(e){this._props.pipOn?this._uiEmitEvent(ys.PIP_OFF_REQUEST):this._uiEmitEvent(ys.PIP_ON_REQUEST)}__onCastButtonClick(e){this._props.airPlayAvailable?this._uiEmitEvent(ys.AP_ON_REQUEST):this._props.chromeCastAvailable?this._uiEmitEvent(ys.CC_ON_REQUEST):this._props.castMenuShown?this._uiEmitEvent(ys.CLOSE_CAST_MENU_REQUEST):this._uiEmitEvent(ys.OPEN_CAST_MENU_REQUEST)}__onFullscreenButtonClick(e){this._props.fullscreenOn?this._uiEmitEvent(ys.FS_OFF_REQUEST):this._uiEmitEvent(ys.FS_ON_REQUEST)}__onMoreButtonClick(e){this.setMoreVisibility(!this._flags.moreVisible)}}class Un extends fs{constructor(e){super(e),this._dom={root:null,refs:{defaultCtrlPanelLayout:null}},this._component={defaultCtrlPanelLayout:null},this._flags={touchUsed:!1,mouseUsed:!1},this._bind=["__onMouseEnter","__onMouseLeave","__onTouchStart","__onTouchCancel","__onTouchEnd"],this._mouseUsedTimeout=null,this._touchEndTimeout=null}uiGetDeclaredProps(){return{visible:"boolean",currentTime:"number",auxPointerShown:"boolean",adPoints:"object",chapterPoints:"object",duration:"number",buffered:"object",fullscreenEnabled:"boolean",fullscreenOn:"boolean",pipAvailable:"boolean",pipOn:"boolean",cinemaAvailable:"boolean",cinemaOn:"boolean",airPlayAvailable:"boolean",airPlayOn:"boolean",chromeCastAvailable:"boolean",chromeCastOn:"boolean",indicatorColor:"string",isEvent:"boolean",layout:"string",isLive:"boolean",loading:"boolean",seeking:"boolean",playing:"boolean",playingLive:"boolean",seekSource:"object",sourceReady:"boolean",progressBarColor:"string",qualityMenuShown:"boolean",subtitlesMenuShown:"boolean",seekingEnabled:"boolean",settingsMenuShown:"boolean",settingsEnabled:"boolean",qualityEnabled:"boolean",subtitlesEnabled:"boolean",pipEnabled:"boolean",cinemaEnabled:"boolean",airPlayEnabled:"boolean",chromeCastEnabled:"boolean",streamingLive:"boolean",tvMode:"boolean",subtitlesShown:"boolean",subtitlesList:"object",textLoading:"string",textPlay:"string",textPause:"string",textMute:"string",textUnmute:"string",textVolume:"string",textVolumeValueOn:"string",textSeekbarEnabled:"string",textSeekbarDisabled:"string",textSeekbarPlayed:"string",textSeekbarPlayedPrepos:"string",textSettings:"string",textSettingsClose:"string",textSubtitlesEnabled:"string",textSubtitlesDisabled:"string",textQualityEnabled:"string",textQualityDisabled:"string",textFullscreenOn:"string",textFullscreenOff:"string",textPipOn:"string",textPipOff:"string",textCinemaOn:"string",textCinemaOff:"string",textLive:"string",textSetLive:"string",textIsLivePlaying:"string",textLiveFromStart:"string",textSetLiveFromStart:"string",textTvMode:"string",textAdPoint:"string",useTouch:"boolean",visibleElements:"object",volume:"number",volumeMuted:"boolean",isLargeUi:"boolean",castMenuShown:"boolean",updateAuxPointerShown:["function","object"],onHoverOn:["function","object"],onHoverOff:["function","object"]}}_onUiInit(e){this._component.defaultCtrlPanelLayout=new Rn(this.__getPropsForDefaultCtrlPanelLayout(e))}_onUiBuild(e){this._dom.root=es("div",{className:"w-DefaultCtrlPanel"}),ts(this._dom.root).append(this._component.defaultCtrlPanelLayout.uiGetElement()),this.__setVisible(e.visible),this.__registerMouseEvents(),this.__registerTouchEvents()}_onUiCanUpdate(e){return e.visible||this._props.visible!=e.visible}_onUiUpdate(e){this._props.visible!=e.visible&&(this.__setVisible(e.visible),e.visible||this.setMoreVisibility(!1)),e.visible&&this._component.defaultCtrlPanelLayout.uiUpdate(this.__getPropsForDefaultCtrlPanelLayout(e))}_onUiDestroy(){this.__unregisterMouseEvents(),this.__unregisterTouchEvents()}__registerMouseEvents(){this._dom.root.addEventListener("mouseenter",this.__onMouseEnter),this._dom.root.addEventListener("mouseleave",this.__onMouseLeave)}__unregisterMouseEvents(){this._dom.root.removeEventListener("mouseenter",this.__onMouseEnter),this._dom.root.removeEventListener("mouseleave",this.__onMouseLeave)}__registerTouchEvents(){this._dom.root.addEventListener("touchstart",this.__onTouchStart),this._dom.root.addEventListener("touchcancel",this.__onTouchCancel),this._dom.root.addEventListener("touchend",this.__onTouchEnd)}__unregisterTouchEvents(){this._dom.root.removeEventListener("touchstart",this.__onTouchStart),this._dom.root.removeEventListener("touchcancel",this.__onTouchCancel),this._dom.root.removeEventListener("touchend",this.__onTouchEnd)}__setVisible(e){ts(this._dom.root).cssClasses({"-hidden":!e})}getSettingsButton(){return this._component.defaultCtrlPanelLayout.getSettingsButton()}getCastButton(){return this._component.defaultCtrlPanelLayout.getCastButton()}getMoreButton(){return this._component.defaultCtrlPanelLayout.getMoreButton()}getMoreContainer(){return this._component.defaultCtrlPanelLayout.getMoreContainer()}getMoreVisibility(){return this._component.defaultCtrlPanelLayout.getMoreVisibility()}setMoreVisibility(e=!1){this._component.defaultCtrlPanelLayout.setMoreVisibility(e)}__getPropsForDefaultCtrlPanelLayout(e){const{visible:t,currentTime:i,adPoints:s,auxPointerShown:n,duration:o,buffered:r,fullscreenEnabled:a,fullscreenOn:l,pipAvailable:h,pipOn:_,cinemaAvailable:d,cinemaOn:u,airPlayAvailable:c,airPlayOn:p,chromeCastAvailable:m,chromeCastOn:g,indicatorColor:E,isEvent:T,isLive:f,loading:y,seeking:v,layout:A,playing:S,playingLive:b,seekSource:C,sourceReady:P,progressBarColor:k,qualityMenuShown:I,subtitlesMenuShown:w,qualityEnabled:N,seekingEnabled:L,settingsMenuShown:x,settingsEnabled:M,subtitlesEnabled:D,pipEnabled:O,cinemaEnabled:R,airPlayEnabled:U,chromeCastEnabled:V,streamingLive:B,tvMode:F,subtitlesShown:H,subtitlesList:G,textLoading:j,textPlay:q,textPause:Q,textMute:Y,textUnmute:z,textVolume:W,textVolumeValueOn:K,textSeekbarEnabled:$,textSeekbarDisabled:X,textSeekbarPlayed:Z,textSeekbarPlayedPrepos:J,textSubtitlesEnabled:ee,textSubtitlesDisabled:te,textQualityEnabled:ie,textQualityDisabled:se,textFullscreenOn:ne,textFullscreenOff:oe,textPipOn:re,textPipOff:ae,textCinemaOn:le,textCinemaOff:he,textLive:_e,textSetLive:de,textIsLivePlaying:ue,textLiveFromStart:ce,textSetLiveFromStart:pe,textSettings:me,textSettingsClose:ge,textTvMode:Ee,textAdPoint:Te,useTouch:fe,visibleElements:ye,volume:ve,volumeMuted:Ae,isLargeUi:Se,updateAuxPointerShown:be,castMenuShown:Ce,chapterPoints:Pe}=e;return{visible:t,currentTime:i,auxPointerShown:n,adPoints:s,duration:o,buffered:r,fullscreenEnabled:a,fullscreenOn:l,pipAvailable:h,pipOn:_,cinemaAvailable:d,cinemaOn:u,airPlayAvailable:c,airPlayOn:p,chromeCastAvailable:m,chromeCastOn:g,indicatorColor:E,isEvent:T,isLive:f,loading:y,seeking:v,layout:A,playing:S,playingLive:b,seekSource:C,sourceReady:P,progressBarColor:k,qualityMenuShown:I,subtitlesMenuShown:w,qualityEnabled:N,seekingEnabled:L,settingsMenuShown:x,settingsEnabled:M,subtitlesEnabled:D,pipEnabled:O,cinemaEnabled:R,airPlayEnabled:U,chromeCastEnabled:V,streamingLive:B,tvMode:F,subtitlesShown:H,subtitlesList:G,textLoading:j,textPlay:q,textPause:Q,textMute:Y,textUnmute:z,textVolume:W,textVolumeValueOn:K,textSeekbarEnabled:$,textSeekbarDisabled:X,textSeekbarPlayed:Z,textSeekbarPlayedPrepos:J,textSubtitlesEnabled:ee,textSubtitlesDisabled:te,textQualityEnabled:ie,textQualityDisabled:se,textFullscreenOn:ne,textFullscreenOff:oe,textPipOn:re,textPipOff:ae,textCinemaOn:le,textCinemaOff:he,textLive:_e,textSetLive:de,textIsLivePlaying:ue,textLiveFromStart:ce,textSetLiveFromStart:pe,textTvMode:Ee,textAdPoint:Te,textSettings:me,textSettingsClose:ge,useTouch:fe,visibleElements:ye,volume:ve,volumeMuted:Ae,isLargeUi:Se,updateAuxPointerShown:be,castMenuShown:Ce,chapterPoints:Pe}}__clearTimeout(e){this[e]&&(clearTimeout(this[e]),this[e]=null)}__createTimeout(e,t,i=0){this.__clearTimeout(e),this[e]||(this[e]=setTimeout(t,i))}__saveTouchUsed(e){this._flags.touchUsed=e,e&&this.__clearTimeout("_touchEndTimeout")}__saveMouseUsed(e){this._flags.mouseUsed=e,e&&this.__createTimeout("_mouseUsedTimeout",()=>{this.__saveMouseUsed(!1)},25)}__onMouseEnter(e){this._flags.touchUsed||(this.__saveMouseUsed(!0),this.__onHoverOn())}__onMouseLeave(e){this._flags.touchUsed||(this.__saveMouseUsed(!0),this.__onHoverOff())}__onTouchStart(e){this._flags.mouseUsed||(this.__saveTouchUsed(!0),this.__onHoverOn())}__onTouchCancel(e){this._flags.mouseUsed||(this.__saveTouchUsed(!1),this.__onHoverOff())}__onTouchEnd(e){this._flags.mouseUsed||(this.__createTimeout("_touchEndTimeout",()=>{this.__saveTouchUsed(!1)},250),this.__onHoverOff())}__onHoverOn(){this._props.onHoverOn&&this._props.onHoverOn()}__onHoverOff(){this._props.onHoverOff&&this._props.onHoverOff()}}class Vn extends fs{constructor(e){super(e),this._dom={root:null,refs:{previousButton:null,playPauseButton:null}},this._component={previousButton:null,playPauseButton:null,liveBubble:null},this._flags={touchUsed:!1,mouseUsed:!1},this._bind=["__onPreviousButtonClick","__onPlayPauseButtonClick","__onMouseEnter","__onMouseMove","__onMouseLeave","__onTouchStart","__onTouchCancel","__onTouchEnd","__onLiveClick"],this._mouseUsedTimeout=null,this._touchEndTimeout=null}uiGetDeclaredProps(){return{visible:"boolean",currentTime:"number",auxPointerShown:"boolean",adPoints:"object",duration:"number",buffered:"object",fullscreenEnabled:"boolean",fullscreenOn:"boolean",pipAvailable:"boolean",pipOn:"boolean",cinemaAvailable:"boolean",cinemaOn:"boolean",airPlayAvailable:"boolean",airPlayOn:"boolean",chromeCastAvailable:"boolean",chromeCastOn:"boolean",indicatorColor:"string",isEvent:"boolean",layout:"string",isLive:"boolean",loading:"boolean",seeking:"boolean",playing:"boolean",playingLive:"boolean",seekSource:"object",sourceReady:"boolean",progressBarColor:"string",qualityMenuShown:"boolean",subtitlesMenuShown:"boolean",seekingEnabled:"boolean",settingsMenuShown:"boolean",settingsEnabled:"boolean",qualityEnabled:"boolean",subtitlesEnabled:"boolean",pipEnabled:"boolean",cinemaEnabled:"boolean",airPlayEnabled:"boolean",chromeCastEnabled:"boolean",streamingLive:"boolean",tvMode:"boolean",subtitlesShown:"boolean",subtitlesList:"object",textLoading:"string",textPlay:"string",textPause:"string",textMute:"string",textUnmute:"string",textVolume:"string",textVolumeValueOn:"string",textSeekbarEnabled:"string",textSeekbarDisabled:"string",textSeekbarPlayed:"string",textSeekbarPlayedPrepos:"string",textSettings:"string",textSettingsClose:"string",textSubtitlesEnabled:"string",textSubtitlesDisabled:"string",textQualityEnabled:"string",textQualityDisabled:"string",textFullscreenOn:"string",textFullscreenOff:"string",textPipOn:"string",textPipOff:"string",textCinemaOn:"string",textCinemaOff:"string",textLive:"string",textSetLive:"string",textIsLivePlaying:"string",textLiveFromStart:"string",textSetLiveFromStart:"string",textSettings:"string",textSettingsClose:"string",textTvMode:"string",textAdPoint:"string",useTouch:"boolean",visibleElements:"object",volume:"number",volumeMuted:"boolean",isLargeUi:"boolean",castMenuShown:"boolean",chapterPoints:"object",updateAuxPointerShown:["function","object"],onHoverOn:["function","object"],onHoverOff:["function","object"]}}_onUiInit(e){this._component.previousButton=new Os(this.__getPropsForPreviousButton(e)),this._component.playPauseButton=new Os(this.__getPropsForPlayPauseButton(e)),this._component.liveBubble=new On(this.__getPropsForLiveBubble(e))}_onUiBuild(e){this._dom.root=es("div",{className:"w-DefaultCtrlPanelCenter"}),ts(this._dom.root).append(this._component.previousButton.uiGetElement(),this._component.playPauseButton.uiGetElement(),this._component.liveBubble.uiGetElement()),this.__setVisible(e),this.__registerMouseEvents(),this.__registerTouchEvents()}_onUiCanUpdate(e){return e.visible||this._props.visible!=e.visible}_onUiUpdate(e){this._props.visible===e.visible&&this._props.seeking===e.seeking&&this._props.auxPointerShown===e.auxPointerShown||this.__setVisible(e),this._component.previousButton.uiUpdate(this.__getPropsForPreviousButton(e)),this._component.playPauseButton.uiUpdate(this.__getPropsForPlayPauseButton(e)),this._component.liveBubble.uiUpdate(this.__getPropsForLiveBubble(e))}_onUiDestroy(){this.__unregisterMouseEvents(),this.__unregisterTouchEvents()}__registerMouseEvents(){this._dom.root.addEventListener("mouseenter",this.__onMouseEnter),this._dom.root.addEventListener("mouseleave",this.__onMouseLeave)}__unregisterMouseEvents(){this._dom.root.removeEventListener("mouseenter",this.__onMouseEnter),this._dom.root.removeEventListener("mouseleave",this.__onMouseLeave)}__registerTouchEvents(){this._dom.root.addEventListener("touchstart",this.__onTouchStart),this._dom.root.addEventListener("touchcancel",this.__onTouchCancel),this._dom.root.addEventListener("touchend",this.__onTouchEnd)}__unregisterTouchEvents(){this._dom.root.removeEventListener("touchstart",this.__onTouchStart),this._dom.root.removeEventListener("touchcancel",this.__onTouchCancel),this._dom.root.removeEventListener("touchend",this.__onTouchEnd)}__setVisible(e){ts(this._dom.root).cssClasses({"-hidden":!e.visible||e.auxPointerShown||e.seeking&&e.useTouch})}__getPropsForPlayPauseButton(e){return{displayed:e.sourceReady,mark:"play",titleEnabled:e.playing?e.textPause:e.textPlay,ariaProps:{"aria-label":e.playing?e.textPause:e.textPlay},iconProps:{play:{displayed:!e.playing},pause:{displayed:e.playing}},onClick:this.__onPlayPauseButtonClick}}__getPropsForPreviousButton(e){return{displayed:e.isEvent&&e.sourceReady,iconProps:{previous:{displayed:!1},reload:{displayed:e.isEvent}},titleEnabled:e.textSetLiveFromStart,ariaProps:{"aria-label":e.textSetLiveFromStart},onClick:this.__onPreviousButtonClick}}__getPropsForLiveBubble(e){return{displayed:e.isEvent&&e.streamingLive&&!e.isLargeUi&&e.sourceReady,textSetLive:e.textSetLive,liveText:e.textLive,playingLive:e.playingLive,onClick:this.__onLiveClick}}__clearTimeout(e){this[e]&&(clearTimeout(this[e]),this[e]=null)}__createTimeout(e,t,i=0){this.__clearTimeout(e),this[e]||(this[e]=setTimeout(t,i))}__saveTouchUsed(e){this._flags.touchUsed=e,e&&this.__clearTimeout("_touchEndTimeout")}__saveMouseUsed(e){this._flags.mouseUsed=e,e&&this.__createTimeout("_mouseUsedTimeout",()=>{this.__saveMouseUsed(!1)},25)}__onMouseEnter(e){this._flags.touchUsed||(this.__saveMouseUsed(!0),this.__onHoverOn())}__onMouseMove(e){}__onMouseLeave(e){this._flags.touchUsed||(this.__saveMouseUsed(!0),this.__onHoverOff())}__onTouchStart(e){this._flags.mouseUsed||(this.__saveTouchUsed(!0),this.__onHoverOn())}__onTouchCancel(e){this._flags.mouseUsed||(this.__saveTouchUsed(!1),this.__onHoverOff())}__onTouchEnd(e){this._flags.mouseUsed||(this.__createTimeout("_touchEndTimeout",()=>{this.__saveTouchUsed(!1)},250),this.__onHoverOff())}__onHoverOn(){this._props.onHoverOn&&this._props.onHoverOn()}__onHoverOff(){this._props.onHoverOff&&this._props.onHoverOff()}__onPlayPauseButtonClick(e){this._props.playing?this._uiEmitEvent(ys.PAUSE_REQUEST):this._uiEmitEvent(ys.PLAY_REQUEST)}__onPreviousButtonClick(e){this._props.isEvent&&this.__onLiveRewindClick()}__onLiveClick(){this._uiEmitEvent(ys.CLICK_ON_LIVE)}__onLiveRewindClick(){this._uiEmitEvent(ys.SEEK_TO,{time:0})}}class Bn extends fs{constructor(e){super(e),this._dom={root:null,refs:{timeWrapper:null,timeHours:null,timeMinutes:null,contentWrapper:null,title:null,description:null,watchButton:null,buttonTitle:null,buttonIconBackground:null,progressFull:null,progressLine:null}},this._component={icon:null,playIcon:null},this._flags={open:!1},this._bind=["__onProgramClick","__onWatchClick"],this._updateInterval=null}uiGetDeclaredProps(){return{displayed:"boolean",disabled:"boolean",isRunning:"boolean",start:"number",end:"number",epgStart:"number",title:"string",description:"string",color:"string",link:"string",onButtonClick:["function","object"]}}uiGetDefaultProps(){return{displayed:!1,disabled:!1,isRunning:!1,start:0,end:0,epgStart:0,title:"",description:"",color:"",link:"",onButtonClick:null}}_onUiInit(e){this._component.icon=new Ls(this.__getPropsForIcon(e)),this._component.playIcon=new Ls(this.__getPropsForPlayIcon(e))}_onUiBuild(e){this._dom.root=es("div",{className:"c-TimelineProgram"}),this._dom.refs.progressFull=es("div",{className:"w-TimelineProgram__progFull",innerHTML:'\n\t\t\t\t<svg version="1.1" xmlns="http://www.w3.org/2000/svg"\n\t\t\t\txmlns:xlink="http://www.w3.org/2000/svg" tabIndex="-1"\n\t\t\t\tfocusable="false">\n\t\t\t\t\t<rect x="0" y="0" width="100%" height="100%"/>\n\t\t\t\t</svg>'}),this._dom.refs.progressLine=es("div",{className:"w-TimelineProgram__progLine",innerHTML:'\n\t\t\t\t<svg version="1.1" xmlns="http://www.w3.org/2000/svg"\n\t\t\t\txmlns:xlink="http://www.w3.org/2000/svg" tabIndex="-1"\n\t\t\t\tfocusable="false">\n\t\t\t\t\t<rect x="0" y="0" width="100%" height="100%"/>\n\t\t\t\t</svg>\n\t\t\t\t'}),this._dom.refs.timeWrapper=es("div",{className:"w-TimelineProgramTime"}),this._dom.refs.timeHours=es("span",{className:"w-TimelineProgramTime__hours"}),this._dom.refs.timeMinutes=es("span",{className:"w-TimelineProgramTime__minutes"}),this._dom.refs.contentWrapper=es("div",{className:"w-TimelineProgramContent"}),this._dom.refs.title=es("span",{className:"w-TimelineProgramContent__title"}),this._dom.refs.description=es("span",{className:"w-TimelineProgramContent__description"}),this._dom.refs.watchButton=es("button",{type:"button",className:"w-TimelineProgramButton"}),this._dom.refs.buttonIconBackground=es("div",{className:"w-TimelineProgramButton__background",innerHTML:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 64 64"><path d="m48.785 62.215c6.7289-1.454 11.975-6.7004 13.429-13.428 1.1696-5.4101 1.7853-11.026 1.7853-16.786 0-5.7599-0.61572-11.376-1.7853-16.786-1.4545-6.7278-6.6998-11.974-13.428-13.428-5.4106-1.1696-11.026-1.7859-16.786-1.7859-5.7598 0-11.376 0.61632-16.786 1.7859-6.7277 1.4545-11.974 6.7004-13.428 13.428-1.1696 5.4095-1.7859 11.025-1.7859 16.785 0 5.7605 0.61632 11.376 1.7859 16.786 1.4545 6.7278 6.7004 11.974 13.428 13.428 5.41 1.1702 11.026 1.7859 16.786 1.7859 5.7598 0 11.375-0.61573 16.785-1.7847"/></svg>'}),this._dom.refs.buttonTitle=es("span",{className:"w-TimelineProgramButton__title",innerHTML:"Přehrát video"}),ts(this._dom.root).append(this._dom.refs.progressFull,ts(this._dom.refs.timeWrapper).append(this._dom.refs.timeHours,this._dom.refs.timeMinutes),ts(this._dom.refs.contentWrapper).append(this._dom.refs.title,this._dom.refs.progressLine,this._dom.refs.description,ts(this._dom.refs.watchButton).append(ts(this._dom.refs.buttonIconBackground).append(this._component.playIcon.uiGetElement()),this._dom.refs.buttonTitle)),this._component.icon.uiGetElement()),this.__setDisabled(e),this.__setStartTime(e),this.__setTitle(e),this.__setDescription(e),this.__setColor(e),e.isRunning&&(this.__setRunning(e),this.__setProgress(e),e.isRunning?this.__createProgressInterval():this.__clearInterval("_updateInterval")),this.__setVisibleWatchButton(e),this._dom.root.addEventListener("click",this.__onProgramClick),this._dom.refs.watchButton.addEventListener("click",this.__onWatchClick)}_onUiUpdate(e){this._props.disabled!==e.disabled&&this.__setDisabled(e),this._props.epgStart!==e.epgStart&&this.__setStartTime(e),this._props.title!==e.title&&this.__setTitle(e),this._props.description!==e.description&&this.__setDescription(e),this._props.color!==e.color&&this.__setColor(e),this._props.isRunning!==e.isRunning&&(this.__setRunning(e),this.__setProgress(e),e.isRunning?this.__createProgressInterval():this.__clearInterval("_updateInterval")),this._props.link!==e.link&&this.__setVisibleWatchButton(e),this._component.icon.uiUpdate(this.__getPropsForIcon(e)),this._component.playIcon.uiUpdate(this.__getPropsForPlayIcon(e))}_onUiDestroy(){this.__clearInterval("_updateInterval")}__createProgressInterval(){this.__createInterval("_updateInterval",()=>{this.__setProgress(this._props)},6e4)}__clearInterval(e){clearInterval(this[e]),this[e]=null}__createInterval(e,t,i=0){this.__clearInterval(e),this[e]||(this[e]=setInterval(t.bind(this),i))}__getPropsForIcon(e){return{"chevron-down":{displayed:!this._flags.open},"chevron-up":{displayed:this._flags.open}}}__getPropsForPlayIcon(e){return{play:{displayed:!0}}}__setDisplayed(e){ts(this._dom.root).setDisplayed(e.displayed)}__setDisabled(e){ts(this._dom.root).cssClasses({"-disabled":e.disabled})}__setVisibleWatchButton(e){ts(this._dom.refs.watchButton).setDisplayed(!!e.link)}__setStartTime(e){const t=1e3*e.epgStart,i=new Date(t),s=("0"+i.getHours()).substr(-2),n=("0"+i.getMinutes()).substr(-2);ts(this._dom.refs.timeHours).setInnerHTML(s),ts(this._dom.refs.timeMinutes).setInnerHTML(n)}__setTitle(e){ts(this._dom.refs.title).setInnerHTML(e.title)}__setDescription(e){ts(this._dom.refs.description).setInnerHTML(e.description)}__setRunning(e){ts(this._dom.root).cssClasses({"-running":e.isRunning})}__setProgress(e){const t=(new Date).getTime()/1e3,i=e.end-e.start,s=e.end-t,n=Math.max(Math.min(1-s/i,1),0),o=this._dom.refs.progressLine.querySelector("svg"),r=this._dom.refs.progressFull.querySelector("svg");o&&ts(o).setStyle({transform:`scaleX(${n})`}),r&&ts(r).setStyle({transform:`scaleX(${n})`})}__setColor(e){const t=this._dom.refs.progressLine.querySelector("svg > rect"),i=this._dom.refs.progressFull.querySelector("svg > rect");t&&ts(t).setStyle({fill:e.color,stroke:e.color}),i&&ts(i).setStyle({fill:e.color,stroke:e.color}),ts(this._dom.refs.buttonIconBackground).setStyle({fill:e.color,stroke:e.color})}__onProgramClick(){this._flags.open=!this._flags.open,ts(this._dom.root).cssClasses({"-open":this._flags.open}),this.uiForceUpdate()}__onWatchClick(e){e.stopPropagation(),this._props.link&&this._props.onButtonClick&&this._props.onButtonClick()}}class Fn extends fs{constructor(e){super(e),this._dom={root:null,refs:{header:null,title:null,date:null,wrapper:null,programs:null}},this._component={select:null,programs:[]},this._bind=["__onMouseEnter","__onMouseLeave","__onTouchStart","__onTouchEnd"]}uiGetDeclaredProps(){return{displayed:"boolean",programmeShown:"boolean",programmeData:"object",color:"string",isLargeUi:"boolean",visibleElements:"object",onComponentChange:["function","object"]}}uiGetDefaultProps(){return{displayed:!1,programmeShown:!1,programmeData:null,color:"",isLargeUi:!1,visibleElements:null,onComponentChange:null}}_onUiInit(e){this._component.programs=this.__createPrograms(e),this._component.select=new En(this.__getPropsForSelect(e))}_onUiBuild(e){this._dom.root=es("div",{className:"c-Timeline"}),this._dom.refs.header=es("div",{className:"w-TimelineHeader"}),this._dom.refs.title=es("span",{className:"w-TimelineHeader__title",innerHTML:"Program"}),this._dom.refs.wrapper=es("div",{className:"w-TimelineWrapper"}),this._dom.refs.programs=es("div",{className:"w-TimelinePrograms"}),ts(this._dom.root).append(ts(this._dom.refs.header).append(this._dom.refs.title),ts(this._dom.refs.wrapper).append(this._component.select.uiGetElement(),this._dom.refs.programs)),this.__setDisplayed(e),this.__setActive(e),this.__registerMouseEvents(),this.__buildPrograms()}_onUiUpdate(e){this._props.displayed!==e.displayed&&this.__setDisplayed(e),this._props.programmeShown===e.programmeShown&&(this._props.visibleElements&&this._props.visibleElements.programme)===e.visibleElements.programme&&this._props.programmeData.listData.length===e.programmeData.listData.length||this.__setActive(e),JSON.stringify(this._props.programmeData.listData)===JSON.stringify(e.programmeData.listData)&&this._props.indicatorColor===e.indicatorColor||(this._props.programmeData.listData.length===e.programmeData.listData.length?this.__updatePrograms(e):(this.__destroyCurrentPrograms(),this._component.programs=this.__createPrograms(e),this.__buildPrograms())),this._component.select.uiUpdate(this.__getPropsForSelect(e))}__registerMouseEvents(){this._dom.root.addEventListener("mouseenter",this.__onMouseEnter),this._dom.root.addEventListener("mouseleave",this.__onMouseLeave),this._dom.root.addEventListener("touchstart",this.__onTouchStart),this._dom.root.addEventListener("touchend",this.__onTouchEnd)}__unregisterMouseEvents(){this._dom.root.removeEventListener("mouseenter",this.__onMouseEnter),this._dom.root.removeEventListener("mouseleave",this.__onMouseLeave),this._dom.root.removeEventListener("touchstart",this.__onTouchStart),this._dom.root.removeEventListener("touchend",this.__onTouchEnd)}__createPrograms(e){const t=(new Date).getTime()/1e3;return e.programmeData.listData.map((i,s)=>new Bn({start:i.start,end:i.end,epgStart:i.epgStart,disabled:i.start>t,title:i.title,description:i.description,isRunning:i.isRunning,color:e.color,link:i.link,onButtonClick:i.onButtonClick}))}__buildPrograms(){ts(this._dom.refs.programs).append(this._component.programs.map(e=>(e.uiInited()||e.uiInit(),e.uiSetEventEmitter(this.__eventEmitter),e.uiBuilt()||e.uiBuild(),e.uiGetElement())))}__updatePrograms(e){const t=(new Date).getTime()/1e3;e.programmeData.listData.forEach((i,s)=>{this._component.programs[s].uiUpdate({start:i.start,end:i.end,epgStart:i.epgStart,disabled:i.start>t,title:i.title,description:i.description,isRunning:i.isRunning,color:e.color,link:i.link,onButtonClick:i.onButtonClick})})}__destroyCurrentPrograms(){this._component.programs.forEach(e=>e.uiDestroy()),ts(this._dom.refs.programs).clear()}__getPropsForSelect(e){return{displayed:e.programmeData.selectData.length>0,options:[...e.programmeData.selectData]}}__setDisplayed(e){ts(this._dom.root).setDisplayed(e.displayed)}__setTitle(e){ts(this._dom.refs.title).setInnerHTML(e.title)}__setActive(e){const t=e.visibleElements.programme;ts(this._dom.root).cssClasses({"-active":e.programmeShown&&t,"-no-content":0===e.programmeData.listData.length})}__changeVisibility(e){this._props.onComponentChange&&this._props.onComponentChange({programmeShown:e})}__onTouchStart(e){this._props.isLargeUi&&this.__changeVisibility(!0)}__onTouchEnd(e){e.stopPropagation()}__onMouseEnter(e){this._props.isLargeUi&&(this._props.onHoverOn&&this._props.onHoverOn(),this.__changeVisibility(!0))}__onMouseLeave(e){const t=this._dom.root.contains(document.elementFromPoint(e.clientX,e.clientY));this._props.isEnded||!this._props.isLargeUi||t||this.__changeVisibility(!1)}}const Hn="//d53-a.sdn.szn.cz/d_53/"+parseInt("11.2.8",10)+"/11.2.8/ad-next-video.mp4",Gn="//d53-a.sdn.szn.cz/d_53/"+parseInt("11.2.8",10)+"/11.2.8/ad-next-video.png";class jn extends fs{constructor(e){super(e),this._dom={root:null,refs:{richLayout:null,richComponents:null,adWrapper:null,adWrapperButtons:null,endPosterContainer:null,endPoster:null,endReplay:null,endReplayButton:null,endReplayButtonTitle:null,endReplayText:null,endReplayTextTitle:null,endReplayTextName:null,document:document}},this._component={defaultCtrlPanel:null,defaultCtrlPanelCenter:null,adSkipButton:null,adSkipAllButton:null,adCaption:null,adFollowing:null,clickthroughLink:null,injections:null,settingsMenu:null,castMenu:null,endReplayIcon:null,following:null,richMenu:null,contentBoard:null,timeline:null},this._bind=["__onCtrlPanelHoverOn","__onCtrlPanelHoverOff","__onAdSkipButtonClick","__onInjectionClick","__onInjectionClose","__onInjectionError","__onQualityItemSelect","__onQualityTriggerClick","__onSubtitlesItemSelect","__onSubtitlesTriggerClick","__onAudioTrackSelect","__onAudioTrackTriggerClick","__onVideoTrackSelect","__onVideoTrackTriggerClick","__onAdditionalTriggerClick","__onMouseEnter","__onMouseMove","__onClick","__onTouchStart","__onTouchEnd","__onContentLinkClick","__onClickThroughLinkClick","__onActionAreaClick","__onSettingsMenuCloseClick","__onSettingsMenuHoverOn","__onSettingsMenuHoverOff","__onDocumentClick","__onAuxPointerUpdate","__onComponentChange","__onBackButtonClick","__onReplayButtonClick","__onFollowingHover"],this._flags={touchUsed:!1,mouseUsed:!1,auxPointerShown:!1,richComponentShown:!1,contentIsEnded:!1},this._lastMousePos={x:0,y:0},this._mouseUsedTimeout=null,this._touchEndTimeout=null,this._mouseEnterTimeout=null,this._mouseMoveTimeout=null,this._adFollowingShown=!1}uiGetDeclaredProps(){return{adLayout:"string",adCanceled:"boolean",clickthroughTarget:"string",clickthroughUrl:"string",controlPanelShown:"boolean",controlPanelPreventHidding:"boolean",startTime:"number",currentTime:"number",buffered:"object",displayed:"boolean",adPoints:"object",duration:"number",fullscreenEnabled:"boolean",fullscreenOn:"boolean",pipAvailable:"boolean",pipOn:"boolean",cinemaAvailable:"boolean",cinemaOn:"boolean",airPlayAvailable:"boolean",airPlayOn:"boolean",chromeCastAvailable:"boolean",chromeCastOn:"boolean",indicatorColor:"string",isEvent:"boolean",isLive:"boolean",layout:"string",loading:"boolean",seeking:"boolean",playing:"boolean",playingLive:"boolean",seekSource:"object",sourceReady:"boolean",progressBarColor:"string",qualities:"object",qualityId:["object","number"],qualityMenuShown:"boolean",subtitlesList:"object",subtitlesId:["object","number"],subtitlesMenuShown:"boolean",audioTrackList:"object",audioTrackId:["object","number"],audioTrackMenuShown:"boolean",videoTrackList:"object",videoTrackId:["object","number"],videoTrackMenuShown:"boolean",additionalMenuShown:"boolean",seekingEnabled:"boolean",settingsMenuShown:"boolean",settingsEnabled:"boolean",qualityEnabled:"boolean",subtitlesEnabled:"boolean",additionalEnabled:"boolean",audioTrackEnabled:"boolean",videoTrackEnabled:"boolean",pipEnabled:"boolean",cinemaEnabled:"boolean",airPlayEnabled:"boolean",chromeCastEnabled:"boolean",skippableAfter:"number",countdownBefore:"number",adsCountCurrent:"number",adsCountTotal:"number",allowedToSkip:"boolean",streamingLive:"boolean",tvMode:"boolean",subtitlesShown:"boolean",textLoading:"string",textPlay:"string",textPause:"string",textMute:"string",textUnmute:"string",textVolume:"string",textVolumeValueOn:"string",textSeekbarEnabled:"string",textSeekbarDisabled:"string",textSeekbarPlayed:"string",textSeekbarPlayedPrepos:"string",textSettings:"string",textSettingsClose:"string",textSettingsExpand:"string",textSubtitles:"string",textSubtitlesHide:"string",textSubtitlesEnabled:"string",textSubtitlesDisabled:"string",textQuality:"string",textQualityEnabled:"string",textQualityDisabled:"string",textAudioTracks:"string",textVideoTracks:"string",textFullscreenOn:"string",textFullscreenOff:"string",textPipOn:"string",textPipOff:"string",textCinemaOn:"string",textCinemaOff:"string",textAd:"string",textAdPoint:"string",textAdSkip:"string",textAdSkipAfter:"string",textAdCountdown:"string",textAdWeb:"string",textSponsor:"string",textPromo:"string",textLive:"string",textSetLive:"string",textIsLivePlaying:"string",textLiveFromStart:"string",textSetLiveFromStart:"string",textTvMode:"string",textAction:"string",textContentInfoTrigger:"string",textContentInfoOpen:"string",textContentInfoClose:"string",textContentInfoLinkLabel:"string",textReplayContent:"string",textReplayContentPlayed:"string",volume:"number",volumeMuted:"boolean",injections:"object",tech:"object",videoDimensions:"object",contentInfo:"object",splashInfoDisplayed:"boolean",ppShown:"boolean",controlPanelIntersectionHeight:"number",useTouch:"boolean",visibleElements:"object",contentInfoShown:"boolean",isLargeUi:"boolean",ppInContent:"boolean",isEnded:"boolean",followingShown:"boolean",followingTeasers:"object",followingPreviewShown:"boolean",followingTimerTime:"number",followingTimerProgress:"number",timerCanceled:"boolean",onTimerCancelClick:["function","object"],transitionEnabled:"boolean",transitionPreviewEnabled:"boolean",transitionTimerShown:"boolean",chaptersShown:"boolean",episodesShown:"boolean",castMenuShown:"boolean",programmeShown:"boolean",programmeData:"object",episodesData:"object",preventPauseOnClick:"boolean",chaptersData:"object",audioList:"object"}}_onUiInit(e){this._component.defaultCtrlPanel=new Un(this.__getPropsForControlPanel(e)),this._component.defaultCtrlPanelCenter=new Vn(this.__getPropsForControlPanel(e)),this._component.actionArea=new Ds(this.__getPropsForActionArea(e)),this._component.adSkipButton=new ln(this.__getPropsForAdSkipButton(e)),this._component.adSkipAllButton=new hn(this.__getPropsForAdSkipAllButton(e)),this._component.adCaption=new tn(this.__getPropsForAdCaption(e)),this._component.adFollowing=new an(this.__getPropsForAdFollowing(e)),this._component.clickthroughLink=new Ms(this.__getPropsForClickthroughLink(e)),this._component.injections=new Qs(this.__getPropsForInjections(e)),this._component.settingsMenu=new en(this.__getPropsForSettingsMenu(e)),this._component.castMenu=new en(this.__getPropsForCastMenu(e)),this._component.contentInfo=new _n(this.__getPropsForContentInfo(e)),this._component.endReplayIcon=new Ls(this.__getPropsForEndReplayIcon(e)),this._component.following=new An(this.__getPropsForFollowing(e)),this._component.richMenu=new un(this.__getPropsForRichMenu(e)),this._component.contentBoard=new vn(this.__getPropsForContentBoard(e)),this._component.timeline=new Fn(this.__getPropsForTimeline(e))}_onUiBuild(e){this._dom.root=es("div",{className:"w-DefaultLayout"}),this._dom.refs.richLayout=es("div",{className:"w-DefaultLayoutRich"}),this._dom.refs.richComponents=es("div",{className:"w-RichComponents"}),this._dom.refs.adWrapper=es("div",{className:"w-AdComponents"}),this._dom.refs.adWrapperButtons=es("div",{className:"w-AdComponentsButtons"}),this._dom.refs.techContainer=es("div",{className:"w-TechControls"}),this._dom.refs.clickthroughContainer=es("div",{className:"w-ClickThrough"}),this._dom.refs.endReplayContainer=es("div",{className:"w-EndReplay"}),this._dom.refs.endReplayText=es("div",{className:"w-EndReplayText"}),this._dom.refs.endReplayTextTitle=es("span",{className:"w-EndReplayText__title"}),this._dom.refs.endReplayTextName=es("div",{className:"w-EndReplayText__name"}),this._dom.refs.endReplayButton=es("button",{className:"w-EndReplayButton",type:"button"}),this._dom.refs.endReplayButtonTitle=es("div",{className:"w-EndReplayButton__title"}),this._dom.refs.endPosterContainer=es("div",{className:"w-EndPoster"}),this._dom.refs.endPoster=es("img",{className:"w-EndPoster__img"}),ts(this._dom.root).append(ts(this._dom.refs.endPosterContainer).append(this._dom.refs.endPoster),ts(this._dom.refs.richLayout).append(this._component.richMenu.uiGetElement(),ts(this._dom.refs.richComponents).append(this._component.injections.uiGetElement(),this._component.actionArea.uiGetElement(),this._component.contentInfo.uiGetElement(),ts(this._dom.refs.clickthroughContainer).append(this._component.clickthroughLink.uiGetElement()),ts(this._dom.refs.endReplayContainer).append(ts(this._dom.refs.endReplayText).append(this._dom.refs.endReplayTextTitle,this._dom.refs.endReplayTextName),ts(this._dom.refs.endReplayButton).append(this._component.endReplayIcon.uiGetElement(),this._dom.refs.endReplayButtonTitle)),this._component.contentBoard.uiGetElement(),this._component.following.uiGetElement(),this._component.adFollowing.uiGetElement(),this._component.timeline.uiGetElement())),this._dom.refs.techContainer,ts(this._dom.refs.adWrapper).append(this._component.adCaption.uiGetElement(),ts(this._dom.refs.adWrapperButtons).append(this._component.adSkipButton.uiGetElement(),this._component.adSkipAllButton.uiGetElement())),this._component.defaultCtrlPanelCenter.uiGetElement(),this._component.defaultCtrlPanel.uiGetElement(),this._component.settingsMenu.uiGetElement(),this._component.castMenu.uiGetElement()),this.__setDisplayed(e.displayed),this.__setDisplayedTechContainer(e.tech&&e.tech.elm),this.__setDisplayedClickthroughContainer("ad"==e.layout&&!!e.clickthroughUrl),e.tech&&e.tech.elm&&!e.tech.adOnly&&this._dom.refs.techContainer.appendChild(e.tech.elm),this.__setEndScreenComponentsVisibility(!1),this.__updateReplayButtonTitle(e),this.__updateReplayTextTitle(e),e.contentInfo&&e.contentInfo.videoTitle&&this.__updateReplayTextName(e),this.__registerMouseEvents(),this.__registerTouchEvents(),this.__registerDocumentEvents()}_onUiCanUpdate(e){return e.displayed||this._props.displayed!=e.displayed}_onUiUpdate(e){this._props.displayed!=e.displayed&&this.__setDisplayed(e.displayed),this._props.layout==e.layout&&this._props.clickthroughUrl==e.clickthroughUrl||this.__setDisplayedClickthroughContainer("ad"==e.layout&&!!e.clickthroughUrl),e.sourceReady?ts(this._dom.refs.richLayout).setDisplayed(!0):ts(this._dom.refs.richLayout).setDisplayed(!1),this.__setDisplayedTechContainer(e.tech&&e.tech.elm),e.tech!=this._props.tech&&(this._props.tech&&this._props.tech.elm&&this._dom.refs.techContainer.hasChildNodes()&&this._dom.refs.techContainer.removeChild(this._props.tech.elm),e.tech&&e.tech.elm&&!e.tech.adOnly&&this._dom.refs.techContainer.appendChild(e.tech.elm)),this._props.textReplayContentPlayed!==e.textReplayContentPlayed&&this.__updateReplayTextTitle(e),e.contentInfo&&e.contentInfo.videoTitle&&this.__updateReplayTextName(e),this._props.textReplayContent!==e.textReplayContent&&this.__updateReplayButtonTitle(e),this._props.isEnded!==e.isEnded&&this.__contentEnded(e),this.__updateComponentsShown(e),this.__setDimensionsInjectionContainer(e.videoDimensions),this._component.defaultCtrlPanel.uiUpdate(this.__getPropsForControlPanel(e)),this._component.defaultCtrlPanelCenter.uiUpdate(this.__getPropsForControlPanel(e)),this._component.actionArea.uiUpdate(this.__getPropsForActionArea(e)),this._component.adCaption.uiUpdate(this.__getPropsForAdCaption(e)),this._component.adFollowing.uiUpdate(this.__getPropsForAdFollowing(e)),this._component.adSkipButton.uiUpdate(this.__getPropsForAdSkipButton(e)),this._component.adSkipAllButton.uiUpdate(this.__getPropsForAdSkipAllButton(e)),this._component.clickthroughLink.uiUpdate(this.__getPropsForClickthroughLink(e)),this._component.injections.uiUpdate(this.__getPropsForInjections(e)),this._component.settingsMenu.uiUpdate(this.__getPropsForSettingsMenu(e)),this._component.castMenu.uiUpdate(this.__getPropsForCastMenu(e)),this._component.contentInfo.uiUpdate(this.__getPropsForContentInfo(e)),this._component.following.uiUpdate(this.__getPropsForFollowing(e)),this._component.timeline.uiUpdate(this.__getPropsForTimeline(e)),this._component.richMenu.uiUpdate(this.__getPropsForRichMenu(e)),this._component.contentBoard.uiUpdate(this.__getPropsForContentBoard(e))}_onUiDestroy(){this.__unregisterMouseEvents(),this.__unregisterTouchEvents(),this.__unregisterDocumentEvents()}__registerDocumentEvents(){this._dom.refs.document.addEventListener("click",this.__onDocumentClick,!0)}__unregisterDocumentEvents(){this._dom.refs.document.removeEventListener("click",this.__onDocumentClick,!0)}__registerMouseEvents(){this._dom.root.addEventListener("mouseenter",this.__onMouseEnter,!0),this._dom.root.addEventListener("mousemove",this.__onMouseMove,!0),this._dom.root.addEventListener("click",this.__onClick,!0),this._dom.refs.endReplayButton.addEventListener("click",this.__onReplayButtonClick)}__unregisterMouseEvents(){this._dom.root.removeEventListener("mouseenter",this.__onMouseEnter,!0),this._dom.root.removeEventListener("mousemove",this.__onMouseMove,!0),this._dom.root.removeEventListener("click",this.__onClick,!0),this._dom.refs.endReplayButton.removeEventListener("click",this.__onReplayButtonClick)}__registerTouchEvents(){this._dom.root.addEventListener("touchstart",this.__onTouchStart,!0),this._dom.root.addEventListener("touchcancel",this.__onTouchEnd,!0),this._dom.root.addEventListener("touchend",this.__onTouchEnd,!0)}__unregisterTouchEvents(){this._dom.root.removeEventListener("touchstart",this.__onTouchStart,!0),this._dom.root.removeEventListener("touchcancel",this.__onTouchEnd,!0),this._dom.root.removeEventListener("touchend",this.__onTouchEnd,!0)}__setDisplayed(e){ts(this._dom.root).setDisplayed(e)}__setDisplayedTechContainer(e){ts(this._dom.refs.techContainer).setDisplayed(e)}__setDisplayedClickthroughContainer(e){ts(this._dom.refs.clickthroughContainer).setDisplayed(e)}__setDimensionsInjectionContainer(e){if(!e)return;ts(this._component.injections.uiGetElement()).setStyle({top:`${e.y}px`,left:`${e.x}px`,width:`${e.width}px`,height:`${e.height}px`})}__setEndPosterDisplayed(e){ts(this._dom.refs.endPosterContainer).setDisplayed(e)}__setEndReplayDisplayed(e){ts(this._dom.refs.endReplayContainer).setDisplayed(e)}__contentEnded(e){this._flags.contentIsEnded=e.isEnded,this.__setEndScreenComponentsVisibility(e.isEnded),ts(this._dom.refs.endPoster).setAttr({src:e.contentInfo?e.contentInfo.videoPoster:"",srcset:e.contentInfo?e.contentInfo.videoPosterSrcset:"",sizes:e.contentInfo?e.contentInfo.videoPosterSizes:""}).cssClasses({"-arph":!0}),ts(this._dom.root).cssClasses({"-ended":e.isEnded})}__setEndScreenComponentsVisibility(e){this.__setEndPosterDisplayed(e),this.__setEndReplayDisplayed(e)}__updateReplayTextTitle(e){ts(this._dom.refs.endReplayTextTitle).setInnerHTML(e.textReplayContentPlayed)}__updateReplayTextName(e){ts(this._dom.refs.endReplayTextName).setInnerHTML(e.contentInfo.videoTitle)}__updateReplayButtonTitle(e){ts(this._dom.refs.endReplayButtonTitle).setInnerHTML(e.textReplayContent)}__updateComponentsShown(e){const t=e.contentInfoShown||e.followingShown||e.programmeShown||e.chaptersShown||e.episodesShown;this._flags.richComponentShown=t,ts(this._dom.root).cssClasses({"-rich-component-open":t})}__clearTimeout(e){clearTimeout(this[e]),this[e]=null}__createTimeout(e,t,i=0){this.__clearTimeout(e),this[e]||(this[e]=setTimeout(t.bind(this),i))}__saveMouseUsed(e){this._flags.mouseUsed=e,e&&this.__createTimeout("_mouseUsedTimeout",()=>{this.__saveMouseUsed(!1)})}__saveTouchUsed(e){this._flags.touchUsed=e,e&&this.__clearTimeout("_mouseMoveTimeout")}__saveMousePos(e,t){this._lastMousePos={x:e,y:t}}__mousePosChanged(e,t){return this._lastMousePos.x!=e||this._lastMousePos.y!=t}__createSubtitlesList(e){const t={displayed:e.subtitlesEnabled,type:"default",opened:e.subtitlesMenuShown,expanded:!1,indicatorColor:e.indicatorColor,title:e.textSubtitles,items:[],onItemClick:this.__onSubtitlesItemSelect,onTriggerClick:this.__onSubtitlesTriggerClick};return t.items=e.subtitlesList.map(t=>({text:t.text,id:t.id,data:t.data||null,selected:e.subtitlesId===t.id})),t.items.push({id:null,text:e.textSubtitlesHide,data:null,selected:null===e.subtitlesId}),t.items.reverse(),t}__createQualitiesList(e){const t={displayed:e.qualityEnabled,type:"default",opened:e.qualityMenuShown,expanded:!1,indicatorColor:e.indicatorColor,title:e.textQuality,items:[],onItemClick:this.__onQualityItemSelect,onTriggerClick:this.__onQualityTriggerClick};return t.items=e.qualities.map(t=>({text:t.text,id:t.id,data:t.data||null,selected:e.qualityId===t.id})).reverse(),t}__createAudioTrackList(e){const t={displayed:e.audioTrackEnabled,type:"default",opened:e.audioTrackMenuShown,expanded:!1,indicatorColor:e.indicatorColor,title:e.textAudioTracks,items:[],onItemClick:this.__onAudioTrackSelect,onTriggerClick:this.__onAudioTrackTriggerClick};return t.items=e.audioTrackList.map(t=>({text:t.text,id:t.id,data:t.data||null,selected:e.audioTrackId===t.id})).reverse(),t}__createVideoTrackList(e){const t={displayed:e.videoTrackEnabled,type:"default",opened:e.videoTrackMenuShown,expanded:!1,indicatorColor:e.indicatorColor,title:e.textVideoTracks,items:[],onItemClick:this.__onVideoTrackSelect,onTriggerClick:this.__onVideoTrackTriggerClick};return t.items=e.videoTrackList.map(t=>({text:t.text,id:t.id,data:t.data||null,selected:e.videoTrackId===t.id})).reverse(),t}__createAdditionalSettingsMenu(e){const t=[];return{displayed:e.additionalEnabled&&t.length>0,type:"checkbox",opened:e.additionalMenuShown,expanded:!0,indicatorColor:e.indicatorColor,title:e.textSettingsExpand,items:t,onItemClick:null,onTriggerClick:this.__onAdditionalTriggerClick}}__createCastItems(e){const t={displayed:!0,type:"button",opened:!0,expanded:!0,indicatorColor:e.indicatorColor,title:"Výběr zařízení",items:[],onItemClick:null,onTriggerClick:null};return e.chromeCastAvailable&&t.items.push({displayed:e.chromeCastAvailable,title:"Chromecast",iconProps:{"chromecast-off":{displayed:!0}},indicatorColor:e.indicatorColor,onClick:null}),e.airPlayAvailable&&t.items.push({displayed:e.airPlayAvailable,title:"AirPlay",iconProps:{"airplay-off":{displayed:!0}},indicatorColor:e.indicatorColor,onClick:null}),t}__getPropsForControlPanel(e){const{controlPanelShown:t,currentTime:i,adPoints:s,duration:n,buffered:o,fullscreenEnabled:r,fullscreenOn:a,pipAvailable:l,pipOn:h,cinemaAvailable:_,cinemaOn:d,airPlayAvailable:u,airPlayOn:c,chromeCastAvailable:p,chromeCastOn:m,indicatorColor:g,isEvent:E,isLive:T,loading:f,seeking:y,layout:v,playing:A,playingLive:S,seekSource:b,sourceReady:C,progressBarColor:P,qualityMenuShown:k,qualityEnabled:I,seekingEnabled:w,subtitlesMenuShown:N,subtitlesList:L,settingsMenuShown:x,settingsEnabled:M,subtitlesEnabled:D,pipEnabled:O,cinemaEnabled:R,airPlayEnabled:U,chromeCastEnabled:V,streamingLive:B,tvMode:F,subtitlesShown:H,textLoading:G,textPlay:j,textPause:q,textMute:Q,textUnmute:Y,textVolume:z,textVolumeValueOn:W,textSeekbarEnabled:K,textSeekbarDisabled:$,textSeekbarPlayed:X,textSeekbarPlayedPrepos:Z,textSettings:J,textSettingsClose:ee,textSubtitlesEnabled:te,textSubtitlesDisabled:ie,textQualityEnabled:se,textQualityDisabled:ne,textFullscreenOn:oe,textFullscreenOff:re,textPipOn:ae,textPipOff:le,textCinemaOn:he,textCinemaOff:_e,textLive:de,textSetLive:ue,textIsLivePlaying:ce,textLiveFromStart:pe,textSetLiveFromStart:me,textTvMode:ge,textAdPoint:Ee,useTouch:Te,visibleElements:fe,volume:ye,volumeMuted:ve,isLargeUi:Ae,castMenuShown:Se}=e;return{currentTime:i,visible:t,auxPointerShown:this._flags.auxPointerShown,adPoints:s,chapterPoints:e.chaptersData&&e.chaptersData.listData?e.chaptersData.listData:[],duration:n,buffered:o,fullscreenEnabled:r,fullscreenOn:a,pipAvailable:l,pipOn:h,cinemaAvailable:_,cinemaOn:d,airPlayAvailable:u,airPlayOn:c,chromeCastAvailable:p,chromeCastOn:m,isEvent:E,isLive:T,loading:f,seeking:y,layout:v,indicatorColor:g,playing:A,playingLive:S,seekSource:b,sourceReady:C,progressBarColor:P,qualityMenuShown:k,qualityEnabled:I,seekingEnabled:w,subtitlesMenuShown:N,settingsMenuShown:x,settingsEnabled:M,subtitlesEnabled:D,pipEnabled:O,cinemaEnabled:R,airPlayEnabled:U,chromeCastEnabled:V,streamingLive:B,tvMode:F,subtitlesShown:H,subtitlesList:L,textLoading:G,textPlay:j,textPause:q,textMute:Q,textUnmute:Y,textVolume:z,textVolumeValueOn:W,textSettings:J,textSettingsClose:ee,textSeekbarEnabled:K,textSeekbarDisabled:$,textSeekbarPlayed:X,textSeekbarPlayedPrepos:Z,textSubtitlesEnabled:te,textSubtitlesDisabled:ie,textQualityEnabled:se,textQualityDisabled:ne,textFullscreenOn:oe,textFullscreenOff:re,textPipOn:ae,textPipOff:le,textCinemaOn:he,textCinemaOff:_e,textLive:de,textSetLive:ue,textIsLivePlaying:ce,textLiveFromStart:pe,textSetLiveFromStart:me,textTvMode:ge,textAdPoint:Ee,useTouch:Te,visibleElements:fe,volume:ye,volumeMuted:ve,isLargeUi:Ae,castMenuShown:Se,updateAuxPointerShown:this.__onAuxPointerUpdate,onHoverOn:this.__onCtrlPanelHoverOn,onHoverOff:this.__onCtrlPanelHoverOff}}__getPropsForRichMenu(e){const t=!(!e.contentInfo||!(e.contentInfo.videoTitle||e.contentInfo.videoSubtitle||e.contentInfo.videoAuthor||e.contentInfo.videoDescription||e.contentInfo.linkUrl)),i=!e.isLargeUi&&(e.visibleElements.contentInfo&&t||e.visibleElements.following||e.visibleElements.programmeShown),s=!!(e.chaptersData&&e.chaptersData.listData&&e.chaptersData.listData.length>0&&e.visibleElements.chapters),n=!!(e.episodesData&&e.episodesData.selectData&&e.episodesData.selectData.length>0&&e.visibleElements.episodes);return{displayed:"ad"!==e.layout&&e.controlPanelShown&&!(e.followingPreviewShown||e.isEnded||this.__getAdFollowingShown(e))&&(i||e.visibleElements.richMenu&&(e.visibleElements.backButton||n||s)),indicatorColor:e.indicatorColor,isLargeUi:e.isLargeUi,visibleElements:e.visibleElements,contentInfo:{videoTitle:e.contentInfo&&e.contentInfo.videoTitle||""},contentInfoShown:e.contentInfoShown,contentInfoEnabled:t,followingShown:e.followingShown,followingTeasers:e.followingTeasers,chaptersShown:e.chaptersShown,chaptersData:e.chaptersData,episodesShown:e.episodesShown,episodesData:e.episodesData,programmeShown:e.programmeShown,programmeData:e.programmeData,onButtonClick:this.__onComponentChange,onBackButtonClick:this.__onBackButtonClick,onHoverOn:this.__onCtrlPanelHoverOn,onHoverOff:this.__onCtrlPanelHoverOff}}__getPropsForContentBoard(e){return{displayed:e.chaptersShown||e.episodesShown,indicatorColor:e.indicatorColor,isLargeUi:e.isLargeUi,chaptersShown:e.chaptersShown,chaptersData:e.chaptersData,episodesShown:e.episodesShown,episodesData:e.episodesData,onCloseButtonClick:this.__onComponentChange}}__getPropsForActionArea(e){return{displayed:e.visibleElements.actionArea,onClick:this.__onActionAreaClick}}__getSettingsMenuId(){if(this._component.settingsMenu.uiInited())return this._component.settingsMenu.getId()}__getPropsForAdCaption(e){return{text:("sponsor"===e.adLayout?e.textSponsor:"promo"===e.adLayout?e.textPromo:e.textAd)+(e.adsCountTotal>1?` ${e.adsCountCurrent} / ${e.adsCountTotal}`:""),displayed:"ad"==e.layout&&e.visibleElements.adInfo}}__getPropsForAdSkipButton(e){const t=this.__getTimeToSkip(e.skippableAfter,e.currentTime,e.duration);let i="";return 0===t?i=e.textAdSkip:t>0&&(i=`${e.textAdSkipAfter} ${t}s`),{displayed:"ad"==e.layout&&-1!==t&&e.visibleElements.adSkip,skipAllowed:"ad"==e.layout&&(e.allowedToSkip||0===t),text:i,fill:this.__getTimeToSkipFill(e.skippableAfter,e.currentTime,e.duration),onClick:this.__onAdSkipButtonClick}}__getPropsForAdSkipAllButton(e){const t=this.__getTimeToSkip(e.skippableAfter,e.currentTime,e.duration);return{displayed:"ad"==e.layout&&(0===t||-1===e.skippableAfter)&&e.visibleElements.adSkipAll&&e.adCanceled,text:"Přeskočit všechny reklamy",onClick:this.__onAdSkipButtonClick}}__getPropsForAdFollowing(e){const t=this.__getAdFollowingShown(e),i=this.__getTimeToAdFollowing(e.adPoints,e.countdownBefore,e.currentTime);return this._adFollowingShown!==t&&(this._adFollowingShown=t,t&&this.__closeAllComponents()),{displayed:t,currentTime:e.currentTime,indicatorColor:e.indicatorColor,teaser:{displayed:e.visibleElements.adInfoNextTeaser,id:"ad-following",label:"",title:"",poster:Gn,disabled:!0,onClick:null,previewSource:{video_preview:{url:Hn}},duration:NaN},timerTime:i.timeToAd,timerProgress:e.countdownBefore&&i.timeToAd?100-i.timeToAd/e.countdownBefore*100:0,timerCancelable:!!i.adPoint&&!!i.adPoint.cancelable,onTimerCancelClick:this.__onAdCancelButtonClick.bind(this,i.adPoint)}}__getPropsForClickthroughLink(e){return{displayed:"ad"==e.layout&&!!e.clickthroughUrl&&e.visibleElements.adClickthrough,href:e.clickthroughUrl,fullSizeLook:!e.useTouch,target:e.clickthroughTarget||"_blank",text:`${e.textAdWeb} »`,onClick:this.__onClickThroughLinkClick}}__getPropsForInjections(e){return{displayed:e.visibleElements.injections,injections:e.injections,playing:e.playing,seeking:e.seeking,loading:e.loading,startTime:e.startTime,currentTime:e.currentTime,duration:e.duration,streamingLive:e.streamingLive,videoDimensions:e.videoDimensions,controlPanelIntersectionHeight:e.controlPanelIntersectionHeight||0,onClick:this.__onInjectionClick,onClose:this.__onInjectionClose,onError:this.__onInjectionError}}__getPropsForSettingsMenu(e){const t=[this.__createQualitiesList(e),this.__createSubtitlesList(e),this.__createAudioTrackList(e),this.__createVideoTrackList(e),this.__createAdditionalSettingsMenu(e)];return{displayed:e.settingsMenuShown,indicatorColor:e.indicatorColor,title:e.textSettings,titleClose:e.textSettingsClose,listMenus:t,textSettingsExpand:e.textSettingsExpand,onHoverOn:this.__onSettingsMenuHoverOn,onHoverOff:this.__onSettingsMenuHoverOff,onCloseClick:this.__onSettingsMenuCloseClick}}__getPropsForCastMenu(e){const t=[this.__createCastItems(e)];return{displayed:e.castMenuShown,listMenus:t}}__getPropsForContentInfo(e){const t=this.__getAdFollowingShown(e);return{displayed:e.controlPanelShown&&e.visibleElements.contentInfo&&!("ad"==e.layout)&&!(e.chaptersShown||e.episodesShown),indicatorColor:e.indicatorColor,videoTitle:e.contentInfo&&e.contentInfo.videoTitle||"",videoSubtitle:e.contentInfo&&e.contentInfo.videoSubtitle||"",videoAuthor:e.contentInfo&&e.contentInfo.videoAuthor||"",videoDescription:e.contentInfo&&e.contentInfo.videoDescription||"",videoDuration:e.contentInfo&&e.contentInfo.videoDuration||0,linkUrl:e.contentInfo&&e.contentInfo.linkUrl||"",linkLabel:e.contentInfo&&e.contentInfo.linkLabel||"",linkTarget:e.contentInfo&&e.contentInfo.linkTarget||"_blank",channelSubscribe:"",textContentInfoOpen:e.textContentInfoOpen,textContentInfoClose:e.textContentInfoClose,textContentInfoTrigger:e.textContentInfoTrigger,visibleElements:{contentInfo:e.visibleElements.contentInfo,contentInfoTitle:e.visibleElements.contentInfoTitle,contentInfoDescription:e.visibleElements.contentInfoDescription,contentInfoDuration:!1,contentInfoPp:e.visibleElements.contentInfoPp&&e.ppInContent,contentInfoShare:!1,contentInfoLink:e.visibleElements.contentInfoLink,contentInfoAuthor:e.visibleElements.contentInfoAuthor},contentInfoShown:e.contentInfoShown,followingShown:e.followingShown&&e.visibleElements.following||e.programmeShown&&e.visibleElements.programme||e.followingPreviewShown||t||e.isEnded&&e.transitionEnabled&&e.followingTeasers.length>0,followingEnabled:e.visibleElements.following||e.visibleElements.programme,onOpenClick:this.__onComponentChange,onLinkClick:this.__onContentLinkClick}}__getPropsForEndReplayIcon(){return{reload:{displayed:!0}}}__getPropsForFollowing(e){const t=this.__getAdFollowingShown(e);return{displayed:!("ad"==e.layout)&&!t&&(e.controlPanelShown&&e.visibleElements.following||e.followingPreviewShown||e.isEnded&&e.transitionEnabled),currentTime:e.currentTime,indicatorColor:e.indicatorColor,followingShown:e.followingShown,followingTeasers:e.followingTeasers,followingPreviewShown:e.followingPreviewShown,transitionEnabled:e.transitionEnabled,transitionPreviewEnabled:e.transitionPreviewEnabled,transitionTimerShown:e.transitionTimerShown,followingTimerTime:e.followingTimerTime,followingTimerProgress:e.followingTimerProgress,visibleElements:e.visibleElements,useTouch:e.useTouch,isLargeUi:e.isLargeUi,isEnded:e.isEnded,timerCanceled:e.timerCanceled,onTimerCancelClick:e.onTimerCancelClick,onComponentChange:this.__onComponentChange,onHoverOn:this.__onFollowingHover}}__getPropsForTimeline(e){const t=this.__getAdFollowingShown(e);return{displayed:!("ad"==e.layout)&&!t&&!e.visibleElements.following&&e.controlPanelShown&&e.visibleElements.programme&&!e.isEnded&&!e.followingPreviewShown,programmeShown:e.programmeShown,programmeData:{selectData:e.programmeData&&e.programmeData.selectData||[],listData:e.programmeData&&e.programmeData.listData||[]},color:e.indicatorColor,isLargeUi:e.isLargeUi,visibleElements:e.visibleElements,onComponentChange:this.__onComponentChange}}__getTimeToSkip(e,t,i){if(e>i)return-1;if(-1==e)return-1;let s=e-t,n=Math.max(s,0);return Math.ceil(n)}__getTimeToSkipFill(e,t,i){if(e<=0)return 100;let s=100-(e-t)/e*100;return s=Math.min(s,100)}__getTimeToAdFollowing(e,t,i){let s=0,n=null;return e.forEach(e=>{const o=e.time-i;o>0&&o<=t&&(!s||s>o)&&(s=o,n=e)}),{timeToAd:s,adPoint:n}}__getAdFollowingShown(e){const t=this.__getTimeToAdFollowing(e.adPoints,e.countdownBefore,e.currentTime);return"ad"!=e.layout&&!!t.timeToAd&&e.visibleElements.adInfoNext}__onMouseEnter(e){this.__clearTimeout("_mouseEnterTimeout"),this._mouseEnterTimeout=setTimeout(()=>{this._flags.touchUsed||(this.__saveMouseUsed(!0),this._uiEmitEvent(ys.SHOW_CONTROL_PANEL))})}__onMouseMove(e){this._flags.touchUsed||this._mouseMoveTimeout||(this._mouseMoveTimeout=setTimeout(()=>{this.__clearTimeout("_mouseMoveTimeout")},2400),this.__saveMouseUsed(!0),this.__mousePosChanged(e.screenX,e.screenY)&&(this.__saveMousePos(e.screenX,e.screenY),this._uiEmitEvent(ys.SHOW_CONTROL_PANEL)))}__onClick(e){const t=e.target,i=this._component.actionArea.uiGetElement()===t,s=this._component.following.uiGetElement().contains(t),n=this._dom.refs.adWrapper.contains(t);this._props.controlPanelShown||i||s||n||(e.stopPropagation(),e.preventDefault(),this._uiEmitEvent(ys.SHOW_CONTROL_PANEL))}__onTouchStart(e){this._flags.mouseUsed||this.__saveTouchUsed(!0)}__onTouchEnd(e){this._flags.mouseUsed||this.__createTimeout("_touchEndTimeout",()=>{this.__saveTouchUsed(!1)},250)}__onActionAreaClick(e){this._flags.contentIsEnded?this._uiEmitEvent(ys.REPLAY_REQUEST):(this._props.useTouch?this._props.controlPanelShown?this._uiEmitEvent(ys.HIDE_CONTROL_PANEL):this._uiEmitEvent(ys.SHOW_CONTROL_PANEL):this._props.preventPauseOnClick||(this._props.playing?this._uiEmitEvent(ys.PAUSE_REQUEST):this._uiEmitEvent(ys.PLAY_REQUEST)),this._uiEmitEvent(ys.CLICK_ON_ACTION_AREA))}__onAdCancelButtonClick(e){this._uiEmitEvent(ys.CLICK_ON_CANCEL_AD,e)}__onAdSkipButtonClick(e=null){this._uiEmitEvent(ys.CLICK_ON_SKIP_VIDEO,e)}__onSettingsMenuCloseClick(){this._uiEmitEvent(ys.CLOSE_SETTINGS_MENU_REQUEST)}__onSettingsMenuHoverOn(){this.__emitCtrlPanelHovered(!0)}__onSettingsMenuHoverOff(){this.__emitCtrlPanelHovered(!1)}__onSubtitlesTriggerClick(){this._props.subtitlesMenuShown?this._uiEmitEvent(ys.CLOSE_SUBTITLES_MENU_REQUEST):this._uiEmitEvent(ys.OPEN_SUBTITLES_MENU_REQUEST)}__onSubtitlesItemSelect(e){this._uiEmitEvent(ys.CHANGE_SUBTITLES_REQUEST,{id:e})}__onQualityTriggerClick(){this._props.qualityMenuShown?this._uiEmitEvent(ys.CLOSE_QUALITY_MENU_REQUEST):this._uiEmitEvent(ys.OPEN_QUALITY_MENU_REQUEST)}__onQualityItemSelect(e){this.__onCtrlPanelHoverOff(),this._uiEmitEvent(ys.CHANGE_QUALITY_REQUEST,{id:e})}__onAdditionalTriggerClick(){this._props.additionalMenuShown?this._uiEmitEvent(ys.CLOSE_ADDITIONAL_MENU_REQUEST):this._uiEmitEvent(ys.OPEN_ADDITIONAL_MENU_REQUEST)}__onAudioTrackSelect(e){this.__onCtrlPanelHoverOff(),this._uiEmitEvent(ys.CHANGE_AUDIO_TRACK_REQUEST,{id:e})}__onAudioTrackTriggerClick(){this._props.audioTrackMenuShown?this._uiEmitEvent(ys.CLOSE_AUDIO_TRACK_MENU_REQUEST):this._uiEmitEvent(ys.OPEN_AUDIO_TRACK_MENU_REQUEST)}__onVideoTrackSelect(e){this.__onCtrlPanelHoverOff(),this._uiEmitEvent(ys.CHANGE_VIDEO_TRACK_REQUEST,{id:e})}__onVideoTrackTriggerClick(){this._props.videoTrackMenuShown?this._uiEmitEvent(ys.CLOSE_VIDEO_TRACK_MENU_REQUEST):this._uiEmitEvent(ys.OPEN_VIDEO_TRACK_MENU_REQUEST)}__onDocumentClick(e){if(this._props.settingsMenuShown||this._props.castMenuShown){const t=e.target;if(this._component.settingsMenu.uiHasElement(t))return;if(this._component.castMenu.uiHasElement(t))return;const i=this._component.defaultCtrlPanel.getSettingsButton(),s=this._component.defaultCtrlPanel.getCastButton();if(i.uiHasElement(t))return;if(s.uiHasElement(t))return;this._component.actionArea.uiHasElement(t)&&e.stopPropagation(),this._uiEmitEvent(ys.CLOSE_SETTINGS_MENU_REQUEST),this._uiEmitEvent(ys.CLOSE_CAST_MENU_REQUEST)}if(this._component.defaultCtrlPanel.getMoreVisibility()){const t=e.target,i=this._component.defaultCtrlPanel.getMoreContainer(),s=this._component.defaultCtrlPanel.getMoreButton();if(i.contains(t)||s.uiHasElement(t))return;this._component.defaultCtrlPanel.setMoreVisibility(!1)}}__onVolumeChange(e){this._uiEmitEvent(ys.VOLUME_CHANGE_TO,{volume:e})}__onMuteClick(){this._uiEmitEvent(ys.VOLUME_MUTE_CLICK)}__onAuxPointerUpdate(e){this._flags.auxPointerShown=e}__onClickThroughLinkClick(){this._uiEmitEvent(ys.CLICK_ON_CLICKTHROUGH_LINK)}__onContentLinkClick(e){this._uiEmitEvent(ys.CLICK_ON_CONTENT_LINK,e)}__onInjectionClick(e,t){this._uiEmitEvent(ys.CLICK_ON_INJECTION,{id:e,clickActions:t})}__onInjectionClose(e){this._uiEmitEvent(ys.CLOSE_INJECTION,{id:e})}__onInjectionError(e,t){this._uiEmitEvent(ys.ERROR_INJECTION,{id:e,error:t})}__onFollowingHover(){this._uiEmitEvent(ys.SHOW_CONTROL_PANEL)}__onCtrlPanelHoverOn(){this.__emitCtrlPanelHovered(!0)}__onCtrlPanelHoverOff(){this.__emitCtrlPanelHovered(!1)}__onReplayButtonClick(){this._uiEmitEvent(ys.REPLAY_REQUEST)}__onComponentChange(e={}){this._uiEmitEvent(ys.COMPONENT_SHOWN,e)}__onBackButtonClick(){this._uiEmitEvent(ys.CLICK_ON_BACK)}__closeAllComponents(){this._uiEmitEvent(ys.COMPONENT_ALL_HIDE)}__emitCtrlPanelHovered(e){this._uiEmitEvent(ys.CTRL_PANEL_HOVERED,{hovered:e})}}class qn extends fs{constructor(e){super(e),this._dom={root:null,refs:{animatedBar:null,fallback:null,fallbackText:null}}}uiGetDeclaredProps(){return{displayed:"boolean",fallbackText:"string"}}uiGetDefaultProps(){return{displayed:!1,fallbackText:""}}_onUiBuild(e){this._dom.root=es("div",{className:"c-SeekBarBoxLoading",innerHTML:'\n\t\t\t\t<svg class="c-SeekBarBoxLoading__animated" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\n\t\t\t\t\t<defs>\n\t\t\t\t\t\t<pattern id="sznp-ui-loading-pattern-2" patternUnits="userSpaceOnUse" x="0" y="0" width="42" height="100%">\n\t\t\t\t\t\t\t<line x1="8" y1="-1" x2="2" y2="110%" stroke-width="4" stroke="#fff" stroke-opacity="0.8" stroke-linecap="butt"></line>\n\t\t\t\t\t\t\t<line x1="22" y1="-1" x2="16" y2="110%" stroke-width="4" stroke="#fff" stroke-opacity="0.8" stroke-linecap="butt"></line>\n\t\t\t\t\t\t\t<line x1="36" y1="-1" x2="30" y2="110%" stroke-width="4" stroke="#fff" stroke-opacity="0.8" stroke-linecap="butt"></line>\n\t\t\t\t\t\t</pattern>\n\t\t\t\t\t</defs>\n\t\t\t\t\t<rect fill="url(#sznp-ui-loading-pattern-2)" width="100%" height="100%"></rect>\n\t\t\t\t</svg>\n\t\t\t\t<div class="w-SeekBarBoxLoadingFallback ">\n\t\t\t\t\t<span class="w-SeekBarBoxLoadingFallback__text"></span>\n\t\t\t\t</div>\n\t\t\t'}),this._dom.refs.animatedBar=this._dom.root.querySelector(".c-SeekBarBoxLoading__animated"),this._dom.refs.fallback=this._dom.root.querySelector(".w-SeekBarBoxLoadingFallback"),this._dom.refs.fallbackText=this._dom.root.querySelector(".w-SeekBarBoxLoadingFallback__text"),this.__setDisplayed(e.displayed),this.__setFallbackText(e.fallbackText)}_onUiCanUpdate(e){return e.displayed||this._props.displayed!=e.displayed}_onUiUpdate(e){this._props.displayed!=e.displayed&&this.__setDisplayed(e.displayed),this._props.fallbackText!=e.fallbackText&&this.__setFallbackText(e.fallbackText)}__setDisplayed(e){ts(this._dom.root).setDisplayed(e),ts(this._dom.refs.animatedBar).setDisplayed(!p.isWindowsPhone()),ts(this._dom.refs.fallback).setDisplayed(p.isWindowsPhone())}__setFallbackText(e){this._dom.refs.fallbackText.innerHTML=e}}class Qn extends fs{constructor(e){super(e),this._dom={root:null,refs:{bars:null}},this._auxElms=null,this._progressElms=null,this._vizualBars=null,this._lastProgressBarIdx=null,this._lastAuxBarIdx=null}uiGetDeclaredProps(){return{audioLevels:"object",audioLevelsFrequency:"number",duration:"number",color:"string",progress:"number",sourceReady:"boolean",seekBarDimensions:"object",auxPointerPosition:"number",isLive:"boolean"}}uiGetDefaultProps(){return{audioLevels:[],audioLevelsFrequency:0,duration:0,color:"",progress:0,sourceReady:!1,seekBarDimensions:{},auxPointerPosition:0,isLive:!1}}_onUiInit(e){}_onUiBuild(e){this._dom.root=es("div",{className:"c-AudioVisualization"}),this._dom.refs.bars=es("div",{className:"c-AudioVisualizationBars"}),ts(this._dom.root).append(ts(this._dom.refs.bars)),this.__setDisabled(e.isLive),this.__setDisplayed(!e.isLive&&e.sourceReady),this._vizualBars=this._dom.refs.bars.childNodes}_onUiUpdate(e){this._props.isLive===e.isLive&&this._props.sourceReady===e.sourceReady||(this.__setDisplayed(!e.isLive&&e.sourceReady),this.__setDisabled(e.isLive)),this.__updateBars(e)}__setDisabled(e){ts(this._dom.root).cssClasses({"-disabled":e})}__setDisplayed(e){ts(this._dom.root).setDisplayed(e)}__updateBars(e){if(e.isLive)return;const t=Math.floor(e.seekBarDimensions.width/Qn.BAR_LENGTH),i=this._vizualBars.length;if(t!==i||e.duration!==this._props.duration&&!isNaN(e.duration)){const s=Math.abs(t-i);if(i-t>0)for(let e=0;e<s;e++)this.__removeVisualizationBar();else for(let e=0;e<s;e++)this.__addVisualizationBar();this.__setVisualizationBarsLevels(e)}}__addVisualizationBar(){const e=es("div",{className:"c-AudioVisualizationBar"});ts(e).append(es("div",{className:"c-AudioVisualizationBar__level"}),es("div",{className:"c-AudioVisualizationBar__round"})),this._dom.refs.bars.appendChild(e)}__removeVisualizationBar(){this._dom.refs.bars.removeChild(this._vizualBars[0])}__setVisualizationBarsLevels(e){let t=this._vizualBars;for(let i=0;i<t.length;i++){let s=t[i].childNodes[0];if(s){let n=0;if(e.audioLevels&&e.audioLevels.length&&e.audioLevelsFrequency&&!e.isLive)if(t.length!==e.audioLevels.length){const s=e.duration/t.length,o=i*s,r=o+s;let a=0,l=0;for(let t=Math.floor(o/e.audioLevelsFrequency);t<e.audioLevels.length;t++){const i=t*e.audioLevelsFrequency,s=i+e.audioLevelsFrequency;if(!(r>=i&&o<=s))break;{const n=Math.min(r,s)-Math.max(o,i);l+=e.audioLevels[t]*n,a+=n}}n=a?l/a:0}else n=e.audioLevels[i];else n=Math.floor(Math.random()*Math.floor(100));ts(s).setStyle({height:`${100-n}%`})}}}}Qn.BAR_LENGTH=6;class Yn extends fs{constructor(e){super(e),this._dom={root:null,refs:{seekBarBoxWrapper:null,auxBarWrapper:null,document:document}},this._component={audioVisualization:null,progressBar:null,auxBar:null,buffer:null,loading:null},this._bind=["__onMouseEnter","__onMouseMove","__onMouseLeave","__onMouseUp","__onMouseDown","__onTouchStart","__onTouchMove","__onTouchEnd"],this._flags={touchUsed:!1,mouseUsed:!1,holdingMouseDown:!1,mouseIntersected:!1,seeking:!1,seekingEnabled:!1},this._seekBarDimensionsUpdateInterval=null,this._auxPointerPosition=0,this._seekBarDimensions={bottom:0,height:0,left:0,right:0,top:0,width:0,x:0,y:0}}uiGetDeclaredProps(){return{audioLevels:"object",audioLevelsFrequency:"number",duration:"number",isLive:"boolean",loading:"boolean",playing:"boolean",buffered:"object",sourceReady:"boolean",progressBarColor:"string",progress:"number",onSeekTo:["function","object"],onSeeking:["function","object"],onStartSeeking:["function","object"],onEndSeeking:["function","object"]}}uiGetDefaultProps(){return{audioLevels:[],audioLevelsFrequency:0,duration:0,playing:!1,progressBarColor:"",isLive:!1,loading:!1,buffered:null,sourceReady:!1,progress:0,onSeekTo:null,onSeeking:null,onStartSeeking:null,onEndSeeking:null}}_onUiInit(e){this._component.audioVisualization=new Qn(this.__getPropsForProgressBarVisualization(e)),this._component.progressBar=new Rs(this.__getPropsForProgressBar(e)),this._component.auxBar=new Rs(this.__getPropsForAuxBar(e)),this._component.loading=new qn(this.__getPropsForLoadingBar(e)),this._component.buffer=new bn(this.__getPropsForBufferBar(e))}_onUiBuild(e){this._dom.root=es("div",{className:"c-AudioOnlySeekBar",tabIndex:0}),this._dom.refs.seekBarBoxWrapper=es("div",{className:"w-AudioOnlySeekBarBoxWrapper"}),this._dom.refs.auxBarWrapper=es("div",{className:"w-AudioOnlyAuxBarWrapper"}),ts(this._dom.root).append(this._component.audioVisualization.uiGetElement(),ts(this._dom.refs.seekBarBoxWrapper).append(this._component.progressBar.uiGetElement(),ts(this._dom.refs.auxBarWrapper).append(this._component.auxBar.uiGetElement()),this._component.buffer.uiGetElement(),this._component.loading.uiGetElement())),this._seekBarDimensionsUpdateInterval=setInterval(()=>{this.__updateSeekBarDimensionsRequest()},200),this.__addSeekbarEvents(),this.__updateBars(e),this.__setInactive(e),this.__setSeekingEnabled(e),this.__setDisplayed(e.sourceReady)}_onUiUpdate(e){this._props.sourceReady!==e.sourceReady&&this.__setDisplayed(e.sourceReady),this._props.isLive!==e.isLive&&this.__setSeekingEnabled(e),this._props.isLive===e.isLive&&this._props.playing===e.playing||this.__setInactive(e),this._component.audioVisualization.uiUpdate(this.__getPropsForProgressBarVisualization(e)),this._component.loading.uiUpdate(this.__getPropsForLoadingBar(e)),this._component.buffer.uiUpdate(this.__getPropsForBufferBar(e)),this.__updateBars(e)}_onUiDestroy(){clearInterval(this._seekBarDimensionsUpdateInterval),this.__removeSeekbarEvents()}__setDisplayed(e){ts(this._dom.root).setDisplayed(e)}__setSeekingEnabled(e){this._flags.seekingEnabled=!e.isLive}__setInactive(e){ts(this._dom.refs.seekBarBoxWrapper).cssClasses({"-inactive":!e.playing&&e.isLive})}__updateBars(e){const t=e.sourceReady?e.isLive?1:e.progress:0,i=e.sourceReady?!e.isLive&&this._auxPointerPosition||t:0;ts(this._dom.refs.seekBarBoxWrapper).cssClasses({"-seeking-back":i<t}),this._component.progressBar.uiUpdate({progress:t,color:e.progressBarColor}),this._component.auxBar.uiUpdate({progress:i,color:e.progressBarColor})}__getPropsForProgressBar(e){return{color:e.progressBarColor,progress:e.sourceReady?e.isLive?1:e.progress:0}}__getPropsForAuxBar(e){return{color:e.progressBarColor,progress:e.sourceReady?this._auxPointerPosition||e.progress:0}}__getPropsForBufferBar(e){const t=e.buffered?e.buffered.end:0,i=e.isLive?0:parseFloat((t/e.duration).toFixed(2),10);return{color:e.progressBarColor,progress:i}}__getPropsForLoadingBar(e){return{displayed:e.loading||!e.sourceReady}}__getPropsForProgressBarVisualization(e){return{audioLevels:e.audioLevels,audioLevelsFrequency:e.audioLevelsFrequency,duration:e.duration,color:e.progressBarColor,sourceReady:e.sourceReady,progress:e.progress,isLive:e.isLive,auxPointerPosition:this._auxPointerPosition,seekBarDimensions:this._seekBarDimensions}}__addSeekbarEvents(){const e=this._dom.root;e.addEventListener("touchstart",this.__onTouchStart),p.isIPhone()||p.isIPad()||p.isIPod()||p.isTouch()||(e.addEventListener("mouseenter",this.__onMouseEnter),e.addEventListener("mousedown",this.__onMouseDown))}__removeSeekbarEvents(){const e=this._dom.root;e.removeEventListener("touchstart",this.__onTouchStart),p.isIPhone()||p.isIPad()||p.isIPod()||p.isTouch()||(e.removeEventListener("mouseenter",this.__onMouseEnter),e.addEventListener("mousedown",this.__onMouseDown))}__addMouseLeaveEvents(){this._dom.root.addEventListener("mouseleave",this.__onMouseLeave)}__removeMouseLeaveEvents(){this._dom.root.removeEventListener("mouseleave",this.__onMouseLeave)}__addMovingEvents(){const e=this._dom.refs.document;e.addEventListener("mousemove",this.__onMouseMove),e.addEventListener("touchmove",this.__onTouchMove,{passive:!1})}__removeMovingEvents(){const e=this._dom.refs.document;e.removeEventListener("mousemove",this.__onMouseMove),e.removeEventListener("touchmove",this.__onTouchMove,{passive:!1})}__addSeekingEndEvents(){const e=this._dom.refs.document;e.addEventListener("touchend",this.__onTouchEnd),e.addEventListener("touchcancel",this.__onTouchEnd),e.addEventListener("mouseup",this.__onMouseUp)}__removeSeekingEndEvents(){const e=this._dom.refs.document;e.removeEventListener("touchend",this.__onTouchEnd),e.removeEventListener("touchcancel",this.__onTouchEnd),e.removeEventListener("mouseup",this.__onMouseUp)}__onMouseEnter(){!this._flags.touchUsed&&this._flags.seekingEnabled&&(this._flags.mouseIntersected=!0,this._flags.mouseUsed=!0,this.__addMouseLeaveEvents(),this.__addMovingEvents())}__onMouseLeave(){!this._flags.touchUsed&&this._flags.seekingEnabled&&(this._flags.mouseIntersected=!1,this._flags.mouseUsed=!0,this.__removeMouseLeaveEvents(),this._flags.holdingMouseDown||(this.__removeMovingEvents(),this._auxPointerPosition=0),this.uiForceUpdate())}__onMouseDown(e){!this._flags.touchUsed&&this._flags.seekingEnabled&&(this._flags.holdingMouseDown=!0,e.preventDefault(),this.__addSeekingEndEvents(),this.__onStartSeeking())}__onMouseUp(e){!this._flags.touchUsed&&this._flags.seekingEnabled&&(this._flags.holdingMouseDown=!1,this.__removeSeekingEndEvents(),this._props.onSeekTo(this._auxPointerPosition*this._props.duration),this._flags.mouseIntersected||(this.__removeMovingEvents(),this._auxPointerPosition=0),this.__onEndSeeking(),this.uiForceUpdate())}__onMouseMove(e){!this._flags.touchUsed&&this._flags.seekingEnabled&&(this._auxPointerPosition=this.__getPartFromClientRect(e.clientX),this.uiForceUpdate())}__onTouchStart(e){if(this._flags.mouseUsed||!this._flags.seekingEnabled)return;const t=e.changedTouches;if(1==t.length){const i=t[0],s=i.target;(this._dom.root==s||this._dom.root.contains(s))&&(e.preventDefault(),this.__addMovingEvents(),this.__addSeekingEndEvents(),this._flags.touchUsed=!0,this._auxPointerPosition=this.__getPartFromClientRect(i.clientX),this.__onStartSeeking())}this.uiForceUpdate()}__onTouchMove(e){if(this._flags.mouseUsed||!this._flags.seekingEnabled)return;e.preventDefault();const t=e.changedTouches;if(1===t.length){const e=t[0],i=e.target;(this._dom.root===i||this._dom.root.contains(i))&&(this._auxPointerPosition=this.__getPartFromClientRect(e.clientX))}this.uiForceUpdate()}__onTouchEnd(e){!this._flags.mouseUsed&&this._flags.seekingEnabled&&(this._props.onSeekTo(this._auxPointerPosition*this._props.duration),this.__removeMovingEvents(),this.__removeSeekingEndEvents(),this._flags.touchUsed=!1,this._auxPointerPosition=0,this.__onEndSeeking(),this.uiForceUpdate())}__getPartFromClientRect(e){const t=window.pageXOffset,i=this._seekBarDimensions.width,s=this._seekBarDimensions.left;return Math.min(Math.max(e+t-s,0),i)/i}__onStartSeeking(){this._props.onStartSeeking&&this._props.onStartSeeking()}__onEndSeeking(){this._props.onEndSeeking&&this._props.onEndSeeking()}__updateSeekBarDimensionsRequest(){const e=this._dom.root.getBoundingClientRect();this._seekBarDimensions={bottom:e.bottom,height:e.height||0,left:e.left,right:e.right,top:e.top,width:e.width||0,x:e.x||0,y:e.y||0}}}class zn extends fs{constructor(e){super(e),this._dom={root:null,refs:{playPauseButtonContainer:null,playPauseButtonBackground:null,buttonsWrapper:null,buttonsGroupLeft:null,buttonsGroupRight:null,seekBarWrapper:null}},this._component={playPauseButton:null,volume:null,timeInfo:null,seekBar:null},this._bind=["__onPlayPauseButtonClick","__onVolumeChange","__onMuteClick","__onSeeking","__onSeekTo","__onStartSeeking","__onEndSeeking"]}uiGetDeclaredProps(){return{audioLevels:"object",audioLevelsFrequency:"number",currentTime:"number",duration:"number",loading:"boolean",buffered:"object",isEvent:"boolean",isLive:"boolean",playingLive:"boolean",streamingLive:"boolean",progressBarColor:"string",playing:"boolean",textPlay:"string",textPause:"string",textMute:"string",textUnmute:"string",textVolume:"string",textVolumeValueOn:"string",textLive:"string",useTouch:"boolean",sourceReady:"boolean",volume:"number",volumeMuted:"boolean"}}_onUiInit(e){this._component.playPauseButton=new Os(this.__getPropsForPlayPauseButton(e)),this._component.volume=new Vs(this.__getPropsForVolume(e)),this._component.timeInfo=new Dn(this.__getPropsForTimeInfo(e)),this._component.seekBar=new Yn(this.__getPropsForSeekBar(e))}_onUiBuild(e){this._dom.root=es("div",{className:"w-AudioOnlyCtrlPanelLayout"}),this._dom.refs.buttonsWrapper=es("div",{className:"w-AudioOnlyCtrlPanelGroups"}),this._dom.refs.buttonsGroupLeft=es("div",{className:"w-AudioOnlyCtrlPanelGroup -left"}),this._dom.refs.buttonsGroupRight=es("div",{className:"w-AudioOnlyCtrlPanelGroup -right"}),this._dom.refs.playPauseButtonContainer=es("div",{className:"w-PlayPauseButtonContainer"}),this._dom.refs.playPauseButtonBackground=es("div",{className:"w-PlayPauseButtonContainer__background",innerHTML:'<svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 64 64"><path d="m48.785 62.215c6.7289-1.454 11.975-6.7004 13.429-13.428 1.1696-5.4101 1.7853-11.026 1.7853-16.786 0-5.7599-0.61572-11.376-1.7853-16.786-1.4545-6.7278-6.6998-11.974-13.428-13.428-5.4106-1.1696-11.026-1.7859-16.786-1.7859-5.7598 0-11.376 0.61632-16.786 1.7859-6.7277 1.4545-11.974 6.7004-13.428 13.428-1.1696 5.4095-1.7859 11.025-1.7859 16.785 0 5.7605 0.61632 11.376 1.7859 16.786 1.4545 6.7278 6.7004 11.974 13.428 13.428 5.41 1.1702 11.026 1.7859 16.786 1.7859 5.7598 0 11.375-0.61573 16.785-1.7847"/></svg>'}),this._dom.refs.seekBarWrapper=es("div",{className:"w-AudioOnlyCtrlPanelSeekBarWrapper"}),this._dom.refs.liveWrap=es("div",{className:"w-AudioOnlyCtrlPanelLive"}),this._dom.refs.liveText=es("span",{className:"w-AudioOnlyCtrlPanelLive__text"}),ts(this._dom.root).append(ts(this._dom.refs.buttonsWrapper).append(ts(this._dom.refs.buttonsGroupLeft).append(ts(this._dom.refs.playPauseButtonContainer).append(this._dom.refs.playPauseButtonBackground,this._component.playPauseButton.uiGetElement()),this._component.volume.uiGetElement(),this._component.timeInfo.uiGetElement(),ts(this._dom.refs.liveWrap).append(this._dom.refs.liveText))),ts(this._dom.refs.seekBarWrapper).append(this._component.seekBar.uiGetElement())),this.__setButtonVisible(e),this.__setLiveText(e),this.__setLive(e),this.__setColor(e)}_onUiUpdate(e){this._props.isLive===e.isLive&&this._props.sourceReady===e.sourceReady&&this._props.playing===e.playing||this.__setLive(e),this._props.textLive!==e.textLive&&this.__setLiveText(e),this._props.progressBarColor!==e.progressBarColor&&this.__setColor(e),this._props.sourceReady!==e.sourceReady&&this.__setButtonVisible(e),this._component.playPauseButton.uiUpdate(this.__getPropsForPlayPauseButton(e)),this._component.volume.uiUpdate(this.__getPropsForVolume(e)),this._component.timeInfo.uiUpdate(this.__getPropsForTimeInfo(e)),this._component.seekBar.uiUpdate(this.__getPropsForSeekBar(e))}__setButtonVisible(e){ts(this._dom.refs.playPauseButtonContainer).setDisplayed(e.sourceReady)}__setColor(e){ts(this._dom.refs.playPauseButtonBackground).setStyle({fill:e.progressBarColor,stroke:e.progressBarColor}),ts(this._dom.refs.liveWrap).setStyle({background:e.progressBarColor})}__setLive(e){ts(this._dom.refs.liveWrap).setDisplayed(e.isLive&&e.sourceReady&&e.playing)}__setLiveText(e){ts(this._dom.refs.liveText).setInnerHTML(e.textLive)}__getPropsForPlayPauseButton(e){return{displayed:e.sourceReady,titleEnabled:e.playing?e.textPause:e.textPlay,ariaProps:{"aria-label":e.playing?e.textPause:e.textPlay},iconProps:{play:{displayed:!e.playing},pause:{displayed:e.playing}},onClick:this.__onPlayPauseButtonClick}}__getPropsForTimeInfo(e){return{displayed:!e.isLive&&e.sourceReady,isEvent:e.isEvent,isLive:e.isLive,playingLive:e.playingLive,streamingLive:e.streamingLive,duration:e.duration,time:e.currentTime}}__getPropsForVolume(e){return{displayed:e.sourceReady,touchMode:e.useTouch,volume:e.volume,muted:e.volumeMuted,titleMute:e.textMute,titleUnmute:e.textUnmute,titleVolume:e.textVolume,titleVolumeValueOn:e.textVolumeValueOn,progressBarColor:e.progressBarColor,audioOnly:!0,onMuteClick:this.__onMuteClick,onVolumeChange:this.__onVolumeChange}}__getPropsForSeekBar(e){return{audioLevels:e.audioLevels,audioLevelsFrequency:e.audioLevelsFrequency,duration:e.duration,isLive:e.isLive,loading:e.loading,buffered:e.buffered,playing:e.playing,sourceReady:e.sourceReady,progressBarColor:e.progressBarColor,progress:e.currentTime/e.duration,onSeekTo:this.__onSeekTo,onSeeking:this.__onSeeking,onStartSeeking:this.__onStartSeeking,onEndSeeking:this.__onEndSeeking}}__onStartSeeking(){this._uiEmitEvent(ys.START_SEEKING)}__onSeeking(e){this._uiEmitEvent(ys.MOVE_CURRENT_TIME_TO,{time:e})}__onSeekTo(e){this._uiEmitEvent(ys.SEEK_TO,{time:e})}__onEndSeeking(){this._uiEmitEvent(ys.END_SEEKING)}__onPlayPauseButtonClick(e){this._props.playing?this._uiEmitEvent(ys.PAUSE_REQUEST):this._uiEmitEvent(ys.PLAY_REQUEST)}__onVolumeChange(e){this._uiEmitEvent(ys.VOLUME_CHANGE_TO,{volume:e})}__onMuteClick(){this._uiEmitEvent(ys.VOLUME_MUTE_CLICK)}}class Wn extends fs{constructor(e){super(e),this._dom={root:null,refs:{audioOnlyCtrlPanelLayout:null}},this._component={audioOnlyCtrlPanelLayout:null},this._flags={},this._bind=[]}uiGetDeclaredProps(){return{visible:"boolean",audioLevels:"object",audioLevelsFrequency:"number",currentTime:"number",duration:"number",isEvent:"boolean",isLive:"boolean",loading:"boolean",buffered:"object",playingLive:"boolean",streamingLive:"boolean",progressBarColor:"string",playing:"boolean",textPlay:"string",textPause:"string",textMute:"string",textUnmute:"string",textVolume:"string",textVolumeValueOn:"string",textLive:"string",volume:"number",volumeMuted:"boolean",useTouch:"boolean",sourceReady:"boolean"}}uiGetDefaultProps(){return{visible:!1,audioLevels:[],audioLevelsFrequency:0,currentTime:0,duration:0,isEvent:!1,isLive:!1,loading:!1,buffered:null,playingLive:!1,streamingLive:!1,progressBarColor:"",playing:!1,textPlay:"",textPause:"",textMute:"",textUnmute:"",textVolume:"",textVolumeValueOn:"",textLive:"",volume:0,volumeMuted:!1,useTouch:!1,sourceReady:!1}}_onUiInit(e){this._component.audioOnlyCtrlPanelLayout=new zn(this.__getPropsForControlPanelLayout(e))}_onUiBuild(e){this._dom.root=es("div",{className:"w-AudioOnlyCtrlPanel"}),ts(this._dom.root).append(this._component.audioOnlyCtrlPanelLayout.uiGetElement()),this.__setVisible(e.visible)}_onUiUpdate(e){this._props.visible!==e.visible&&this.__setVisible(e.visible),this._component.audioOnlyCtrlPanelLayout.uiUpdate(this.__getPropsForControlPanelLayout(e))}_onUiDestroy(){}__getPropsForControlPanelLayout(e){const{audioLevels:t,audioLevelsFrequency:i,currentTime:s,duration:n,isEvent:o,isLive:r,loading:a,buffered:l,playingLive:h,streamingLive:_,progressBarColor:d,playing:u,textPlay:c,textPause:p,textMute:m,textUnmute:g,textVolume:E,textVolumeValueOn:T,textLive:f,sourceReady:y,useTouch:v,volume:A,volumeMuted:S}=e;return{audioLevels:t,audioLevelsFrequency:i,currentTime:s,duration:n,isEvent:o,isLive:r,loading:a,buffered:l,playingLive:h,streamingLive:_,progressBarColor:d,playing:u,textPlay:c,textPause:p,textMute:m,textUnmute:g,textVolume:E,textVolumeValueOn:T,textLive:f,sourceReady:y,useTouch:v,volume:A,volumeMuted:S}}__setVisible(e){ts(this._dom.root).cssClasses({"-visible":e})}}class Kn extends fs{constructor(e){super(e),this._dom={root:null,refs:{title:null,content:null}}}uiGetDeclaredProps(){return{title:"string",content:"string"}}uiGetDefaultProps(){return{title:"",content:""}}_onUiBuild(e){this._dom.root=es("article",{className:"c-Article"}),this._dom.refs.title=es("h1",{className:"c-Article__title"}),this._dom.refs.content=es("div",{className:"c-Article__content"}),ts(this._dom.root).append(this._dom.refs.title,this._dom.refs.content),this.__setTitle(e.title),this.__setContent(e.content)}_onUiUpdate(e){this._props.title!==e.title&&this.__setTitle(e.title),this._props.content!==e.content&&this.__setContent(e.content)}__setTitle(e){this._dom.refs.title.innerHTML=e,this.__setDisplayed("title",!!e)}__setContent(e){this._dom.refs.content.innerHTML=e,this.__setDisplayed("content",!!e)}__setDisplayed(e,t){ts(this._dom.refs[e]).setDisplayed(t)}}class $n extends fs{constructor(e){super(e),this._dom={root:null,refs:{img:null,name:null}},this._flags={nameChanged:!1},this._marqueeTimeout=null}uiGetDeclaredProps(){return{authorPic:"string",authorName:"string"}}uiGetDefaultProps(){return{authorPic:"",authorName:""}}_onUiBuild(e){this._dom.root=es("div",{className:"c-Author"}),this._dom.refs.wrapper=es("div",{className:"w-AuthorName"}),this._dom.refs.img=es("img",{className:"c-Author__img"}),this._dom.refs.name=es("div",{className:"w-AuthorName__text"}),ts(this._dom.root).append(ts(this._dom.refs.img),ts(this._dom.refs.wrapper).append(ts(this._dom.refs.name))),this.__setAuthorPic(e.authorPic),this.__setName(e.authorName),this._marqueeTimeout=setTimeout(()=>{clearTimeout(this._marqueeTimeout),this.__setMarquee()},1e3)}_onUiUpdate(e){this._props.authorPic!==e.authorPic&&this.__setAuthorPic(e.authorPic),this._props.authorName!==e.authorName&&this.__setName(e.authorName),this._flags.nameChanged&&this.__setMarquee()}_onUiDestroy(){clearTimeout(this._marqueeTimeout)}__setAuthorPic(e){ts(this._dom.refs.img).setAttr({src:e}),this.__setDisplayed("img",!!e)}__setName(e){this._flags.nameChanged=!0,ts(this._dom.refs.name).setInnerHTML(e),this.__setDisplayed("name",!!e)}__setMarquee(){this._flags.nameChanged=!1,ts(this._dom.refs.name).cssClasses({"-marquee":this._dom.refs.wrapper.scrollWidth>this._dom.refs.wrapper.clientWidth})}__setDisplayed(e,t){ts(this._dom.refs[e]).setDisplayed(t)}}class Xn extends fs{constructor(e){super(e),this._dom={root:null,refs:{poster:null,description:null}},this._component={author:null,article:null},this._bind=["__onClick"]}uiGetDeclaredProps(){return{id:"string",authorPic:"string",authorName:"string",title:"string",subtitle:"string",description:"string",poster:"string",playing:"boolean",active:"boolean",progressBarColor:"string",useTouch:"boolean",onClick:["object","function"]}}uiGetDefaultProps(){return{id:"",authorPic:"",authorName:"",title:"",description:"",subtitle:"",poster:"",playing:!1,active:!1,progressBarColor:"",useTouch:!1,onClick:null}}_onUiInit(e){this._component.author=new $n(this.__getPropsForAuthor(e)),this._component.article=new Kn(this.__getPropsForArticle(e))}_onUiBuild(e){this._dom.root=es("div",{className:"c-AudioOnlyContentInfo"}),this._dom.refs.posterShadow=es("div",{className:"c-AudioOnlyContentInfo__posterShadow"}),this._dom.refs.poster=es("img",{className:"c-AudioOnlyContentInfo__poster"}),this._dom.refs.description=es("div",{className:"w-AudioOnlyContentInfoDescription"}),ts(this._dom.root).append(this._dom.refs.posterShadow,this._dom.refs.poster,ts(this._dom.refs.description).append(this._component.article.uiGetElement(),this._component.author.uiGetElement())),this.__updatePosterImg(e),this.__setActive(e),this.__setHover(e),this._dom.root.addEventListener("click",this.__onClick)}_onUiUpdate(e){e.poster!==this._props.poster&&this.__updatePosterImg(e),e.active!==this._props.active&&this.__setActive(e),e.useTouch!==this._props.useTouch&&this.__setHover(e),e.playing===this._props.playing&&e.active===this._props.active||this.__setPlaying(e),e.progressBarColor!==this._props.progressBarColor&&this.__setColor(e),this._component.article.uiUpdate(this.__getPropsForArticle(e)),this._component.author.uiUpdate(this.__getPropsForAuthor(e))}__setActive(e){ts(this._dom.root).cssClasses({"-active":e.active})}__setColor(e){ts(this._dom.refs.posterShadow).setBoxShadow(`0 0 0 2px ${e.progressBarColor}`)}__setPlaying(e){ts(this._dom.root).cssClasses({"-playing":e.playing&&e.active})}__setHover(e){ts(this._dom.root).cssClasses({"-no-touch":!e.useTouch})}__updatePosterImg(e){ts(this._dom.refs.poster).setAttr({src:e.poster})}__getPropsForArticle(e){return{title:e.title,content:e.subtitle}}__getPropsForAuthor(e){return{authorPic:e.authorPic,authorName:e.authorName}}__onClick(){this._props.onClick&&!this._props.active?this._props.onClick(this._props.id):this._props.active&&this._uiEmitEvent(ys.PLAY_REQUEST)}}class Zn extends fs{constructor(e){super(e),this._dom={root:null,refs:{contentInfoContainer:null,ctrlPanelContainer:null}},this._component={contentInfos:[],audioOnlyCtrlPanel:null}}uiGetDeclaredProps(){return{adLayout:"string",audioLevels:"object",audioLevelsFrequency:"number",adCanceled:"boolean",clickthroughTarget:"string",clickthroughUrl:"string",controlPanelShown:"boolean",controlPanelFulltimeHidden:"boolean",controlPanelPreventHidding:"boolean",startTime:"number",currentTime:"number",displayed:"boolean",adPoints:"object",buffered:"object",duration:"number",fullscreenEnabled:"boolean",fullscreenOn:"boolean",pipAvailable:"boolean",pipOn:"boolean",cinemaAvailable:"boolean",cinemaOn:"boolean",airPlayAvailable:"boolean",airPlayOn:"boolean",chromeCastAvailable:"boolean",chromeCastOn:"boolean",indicatorColor:"string",isEvent:"boolean",isLive:"boolean",layout:"string",loading:"boolean",seeking:"boolean",playing:"boolean",playingLive:"boolean",seekSource:"object",sourceReady:"boolean",progressBarColor:"string",qualities:"object",qualityId:["object","number"],qualityMenuShown:"boolean",subtitlesList:"object",subtitlesId:["object","number"],subtitlesMenuShown:"boolean",audioTrackList:"object",audioTrackId:["object","number"],audioTrackMenuShown:"boolean",videoTrackList:"object",videoTrackId:["object","number"],videoTrackMenuShown:"boolean",seekingEnabled:"boolean",additionalMenuShown:"boolean",settingsMenuShown:"boolean",settingsEnabled:"boolean",settingsVisible:"boolean",qualityEnabled:"boolean",subtitlesEnabled:"boolean",additionalEnabled:"boolean",audioTrackEnabled:"boolean",videoTrackEnabled:"boolean",pipEnabled:"boolean",cinemaEnabled:"boolean",airPlayEnabled:"boolean",chromeCastEnabled:"boolean",skippableAfter:"number",countdownBefore:"number",adsCountCurrent:"number",adsCountTotal:"number",allowedToSkip:"boolean",streamingLive:"boolean",tvMode:"boolean",subtitlesShown:"boolean",textLoading:"string",textPlay:"string",textPause:"string",textMute:"string",textUnmute:"string",textVolume:"string",textVolumeValueOn:"string",textSeekbarEnabled:"string",textSeekbarDisabled:"string",textSeekbarPlayed:"string",textSeekbarPlayedPrepos:"string",textSettings:"string",textSettingsClose:"string",textSettingsExpand:"string",textSubtitlesEnabled:"string",textSubtitlesDisabled:"string",textSubtitles:"string",textSubtitlesHide:"string",textQuality:"string",textQualityEnabled:"string",textQualityDisabled:"string",textAudioTracks:"string",textVideoTracks:"string",textFullscreenOn:"string",textFullscreenOff:"string",textPipOn:"string",textPipOff:"string",textCinemaOn:"string",textCinemaOff:"string",textAd:"string",textAdPoint:"string",textAdSkip:"string",textAdSkipAfter:"string",textAdCountdown:"string",textAdWeb:"string",textSponsor:"string",textPromo:"string",textLive:"string",textSetLive:"string",textIsLivePlaying:"string",textLiveFromStart:"string",textSetLiveFromStart:"string",textTvMode:"string",textAction:"string",textContentInfoTrigger:"string",textContentInfoOpen:"string",textContentInfoClose:"string",textContentInfoLinkLabel:"string",textReplayContent:"string",textReplayContentPlayed:"string",volume:"number",volumeMuted:"boolean",injections:"object",tech:"object",videoDimensions:"object",contentInfo:"object",splashInfoDisplayed:"boolean",ppShown:"boolean",controlPanelIntersectionHeight:"number",useTouch:"boolean",visibleElements:"object",contentInfoShown:"boolean",isLargeUi:"boolean",ppInContent:"boolean",isEnded:"boolean",followingShown:"boolean",followingTeasers:"object",followingPreviewShown:"boolean",followingTimerTime:"number",followingTimerProgress:"number",transitionEnabled:"boolean",transitionPreviewEnabled:"boolean",transitionTimerShown:"boolean",timerCanceled:"boolean",onTimerCancelClick:["function","object"],chaptersShown:"boolean",episodesShown:"boolean",castMenuShown:"boolean",programmeShown:"boolean",programmeData:"object",episodesData:"object",preventPauseOnClick:"boolean",chaptersData:"object",audioList:"object"}}_onUiInit(e){this._component.contentInfos=this.__createContentInfos(e),this._component.audioOnlyCtrlPanel=new Wn(this.__getPropsForControlPanel(e))}_onUiBuild(e){this._dom.root=es("div",{className:"w-AudioOnlyLayout"}),this._dom.refs.contentInfoContainer=es("div",{className:"w-AudioOnlyLayoutWrapper"}),this._dom.refs.ctrlPanelContainer=es("div",{className:"w-AudioOnlyLayoutCtrlPanel"}),ts(this._dom.root).append(ts(this._dom.refs.contentInfoContainer),ts(this._dom.refs.ctrlPanelContainer).append(this._component.audioOnlyCtrlPanel.uiGetElement())),this.__buildContentInfos(),this.__setDisplayed(e.displayed),this.__setLive(e.isLive)}_onUiCanUpdate(e){return e.displayed||this._props.displayed!==e.displayed}_onUiUpdate(e){this._props.displayed!==e.displayed&&this.__setDisplayed(e.displayed),this._props.isLive!==e.live&&this.__setLive(e.isLive),this._component.audioOnlyCtrlPanel.uiUpdate(this.__getPropsForControlPanel(e)),JSON.stringify(this._props.audioList)===JSON.stringify(e.audioList)&&JSON.stringify(this._props.contentInfo)===JSON.stringify(e.contentInfo)&&this._props.progressBarColor===e.progressBarColor&&this._props.playing===e.playing||(this._props.audioList.length===e.audioList.length?this.__updateContentInfos(e):(this.__destroyCurrentContentInfos(),this._component.contentInfos=this.__createContentInfos(e),this.__buildContentInfos()))}__setLive(e){ts(this._dom.root).cssClasses({"-live":e})}__setDisplayed(e){ts(this._dom.root).setDisplayed(e)}__createContentInfos(e){return e.audioList.map((t,i)=>new Xn({id:t.id||"",authorPic:t.contentInfo&&t.contentInfo.authorPic||"",authorName:t.contentInfo&&t.contentInfo.author||"",title:t.title||"",subtitle:t.subtitle||"",description:t.contentInfo&&t.contentInfo.description||"",poster:t.poster||"",active:t.active||!1,progressBarColor:e.progressBarColor,playing:e.playing,useTouch:e.useTouch,onClick:t.onClick}))}__buildContentInfos(){ts(this._dom.refs.contentInfoContainer).append(this._component.contentInfos.map(e=>(e.uiInited()||e.uiInit(),e.uiSetEventEmitter(this.__eventEmitter),e.uiBuilt()||e.uiBuild(),e.uiGetElement())))}__updateContentInfos(e){e.audioList.forEach((t,i)=>{this._component.contentInfos[i].uiUpdate({id:t.id||"",authorPic:t.active?e.contentInfo&&e.contentInfo.videoAuthorPic?e.contentInfo.videoAuthorPic:t.contentInfo&&t.contentInfo.videoAuthorPic||"":"",authorName:t.active?e.contentInfo&&e.contentInfo.videoAuthor?e.contentInfo.videoAuthor:t.contentInfo&&t.contentInfo.videoAuthor||"":"",title:t.title||"",subtitle:t.subtitle||"",description:t.contentInfo&&t.contentInfo.description||"",poster:t.poster||"",active:t.active||!1,progressBarColor:e.progressBarColor,playing:e.playing,useTouch:e.useTouch,onClick:t.onClick})})}__destroyCurrentContentInfos(){this._component.contentInfos.forEach(e=>e.uiDestroy()),ts(this._dom.refs.contentInfoContainer).clear()}__getPropsForControlPanel(e){const{audioLevels:t,audioLevelsFrequency:i,currentTime:s,duration:n,isEvent:o,isLive:r,loading:a,buffered:l,playingLive:h,streamingLive:_,progressBarColor:d,playing:u,textPlay:c,textPause:p,textMute:m,textUnmute:g,textVolume:E,textVolumeValueOn:T,textLive:f,useTouch:y,volume:v,volumeMuted:A,sourceReady:S}=e;return{visible:!0,audioLevels:t,audioLevelsFrequency:i,currentTime:s,duration:n,isEvent:o,isLive:r,loading:a,buffered:l,playingLive:h,streamingLive:_,progressBarColor:d,playing:u,textPlay:c,textPause:p,textMute:m,textUnmute:g,textVolume:E,textVolumeValueOn:T,textLive:f,volume:v,volumeMuted:A,useTouch:y,sourceReady:S}}}class Jn extends fs{constructor(e){super(e),this._dom={root:null,refs:{controls:null}},this._component={adOnlyLayout:null,defaultLayout:null,audioOnlyLayout:null}}uiGetDeclaredProps(){return{adLayout:"string",adOnly:"boolean",audioOnly:"boolean",audioLevels:"object",audioLevelsFrequency:"number",adCanceled:"boolean",clickthroughTarget:"string",clickthroughUrl:"string",controlPanelShown:"boolean",controlPanelHovered:"boolean",controlPanelFulltimeHidden:"boolean",startTime:"number",currentTime:"number",buffered:"object",displayed:"boolean",adPoints:"object",duration:"number",fullscreenEnabled:"boolean",fullscreenOn:"boolean",pipAvailable:"boolean",pipOn:"boolean",cinemaAvailable:"boolean",cinemaOn:"boolean",airPlayAvailable:"boolean",airPlayOn:"boolean",chromeCastAvailable:"boolean",chromeCastOn:"boolean",indicatorColor:"string",isEvent:"boolean",isLive:"boolean",layout:"string",loading:"boolean",seeking:"boolean",playing:"boolean",playingLive:"boolean",seekSource:"object",sourceReady:"boolean",progressBarColor:"string",qualityEnabled:"boolean",qualities:"object",qualityId:["object","number"],subtitlesList:"object",subtitlesId:["object","number"],qualityMenuShown:"boolean",audioTrackList:"object",audioTrackId:["object","number"],audioTrackMenuShown:"boolean",videoTrackList:"object",videoTrackId:["object","number"],videoTrackMenuShown:"boolean",additionalMenuShown:"boolean",subtitlesMenuShown:"boolean",settingsMenuShown:"boolean",settingsEnabled:"boolean",subtitlesEnabled:"boolean",additionalEnabled:"boolean",audioTrackEnabled:"boolean",audioTrackVisible:"boolean",videoTrackEnabled:"boolean",videoTrackVisible:"boolean",cinemaEnabled:"boolean",pipEnabled:"boolean",airPlayEnabled:"boolean",chromeCastEnabled:"boolean",seekingEnabled:"boolean",skippableAfter:"number",countdownBefore:"number",adsCountCurrent:"number",adsCountTotal:"number",allowedToSkip:"boolean",streamingLive:"boolean",tvMode:"boolean",subtitlesShown:"boolean",textLoading:"string",textPlay:"string",textPause:"string",textMute:"string",textUnmute:"string",textVolume:"string",textVolumeValueOn:"string",textSeekbarEnabled:"string",textSeekbarDisabled:"string",textSeekbarPlayed:"string",textSeekbarPlayedPrepos:"string",textSettings:"string",textSettingsClose:"string",textSettingsExpand:"string",textSubtitlesEnabled:"string",textSubtitlesDisabled:"string",textSubtitles:"string",textSubtitlesHide:"string",textQuality:"string",textQualityEnabled:"string",textQualityDisabled:"string",textAudioTracks:"string",textVideoTracks:"string",textFullscreenOn:"string",textFullscreenOff:"string",textPipOn:"string",textPipOff:"string",textCinemaOn:"string",textCinemaOff:"string",textAd:"string",textAdPoint:"string",textAdSkip:"string",textAdSkipAfter:"string",textAdCountdown:"string",textAdWeb:"string",textSponsor:"string",textPromo:"string",textLive:"string",textSetLive:"string",textIsLivePlaying:"string",textLiveFromStart:"string",textSetLiveFromStart:"string",textTvMode:"string",textAction:"string",textContentInfoTrigger:"string",textContentInfoOpen:"string",textContentInfoClose:"string",textContentInfoLinkLabel:"string",textReplayContent:"string",textReplayContentPlayed:"string",useTouch:"boolean",volume:"number",volumeMuted:"boolean",injections:"object",tech:"object",videoDimensions:"object",contentInfo:"object",splashInfoDisplayed:"boolean",ppShown:"boolean",controlPanelIntersectionHeight:"number",visibleElements:"object",contentInfoShown:"boolean",isLargeUi:"boolean",ppInContent:"boolean",isEnded:"boolean",followingShown:"boolean",followingTeasers:"object",followingPreviewShown:"boolean",followingTimerTime:"number",followingTimerProgress:"number",transitionEnabled:"boolean",transitionPreviewEnabled:"boolean",transitionTimerShown:"boolean",timerCanceled:"boolean",onTimerCancelClick:["function","object"],chaptersShown:"boolean",episodesShown:"boolean",castMenuShown:"boolean",programmeShown:"boolean",programmeData:"object",episodesData:"object",preventPauseOnClick:"boolean",chaptersData:"object",audioList:"object"}}_onUiInit(e){this._component.defaultLayout=new jn(Object.assign({useTouch:e.useTouch},this.__getPropsForLayout(e,{displayed:!e.adOnly&&!e.audioOnly}))),this._component.audioOnlyLayout=new Zn(Object.assign({useTouch:e.useTouch,audioLevels:e.audioLevels,audioLevelsFrequency:e.audioLevelsFrequency},this.__getPropsForLayout(e,{displayed:!e.adOnly&&e.audioOnly}))),this._component.adOnlyLayout=new Ys(Object.assign({useTouch:e.useTouch,controlPanelFulltimeHidden:e.controlPanelFulltimeHidden},this.__getPropsForLayout(e,{displayed:e.adOnly})))}_onUiBuild(e){this._dom.root=es("div",{className:"w-Ui-Controls"}),this._dom.refs.controls=es("div",{className:"w-Controls"}),ts(this._dom.root).append(ts(this._dom.refs.controls).append(this._component.defaultLayout.uiGetElement(),this._component.adOnlyLayout.uiGetElement(),this._component.audioOnlyLayout.uiGetElement())),this.__setDisplayed(e.displayed)}_onUiCanUpdate(e){return e.displayed||this._props.displayed!=e.displayed}_onUiUpdate(e){this._props.displayed!=e.displayed&&this.__setDisplayed(e.displayed),this._component.defaultLayout.uiUpdate(Object.assign({useTouch:e.useTouch},this.__getPropsForLayout(e,{displayed:!e.adOnly&&!e.audioOnly}))),this._component.audioOnlyLayout.uiUpdate(Object.assign({useTouch:e.useTouch,audioLevels:e.audioLevels,audioLevelsFrequency:e.audioLevelsFrequency},this.__getPropsForLayout(e,{displayed:!e.adOnly&&e.audioOnly}))),this._component.adOnlyLayout.uiUpdate(Object.assign({useTouch:e.useTouch,controlPanelFulltimeHidden:e.controlPanelFulltimeHidden},this.__getPropsForLayout(e,{displayed:e.adOnly})))}__getPropsForLayout(e,t={}){let i=!1;"displayed"in t&&(i=t.displayed);const{adLayout:s,adCanceled:n,clickthroughTarget:o,clickthroughUrl:r,controlPanelShown:a,startTime:l,currentTime:h,buffered:_,adPoints:d,duration:u,fullscreenEnabled:c,fullscreenOn:p,pipAvailable:m,pipOn:g,cinemaAvailable:E,cinemaOn:T,airPlayAvailable:f,airPlayOn:y,chromeCastAvailable:v,chromeCastOn:A,indicatorColor:S,isEvent:b,isLive:C,layout:P,loading:k,seeking:I,playing:w,playingLive:N,seekSource:L,sourceReady:x,progressBarColor:M,qualityEnabled:D,qualityId:O,qualityMenuShown:R,qualities:U,subtitlesId:V,audioTrackList:B,audioTrackId:F,audioTrackMenuShown:H,videoTrackList:G,videoTrackId:j,videoTrackMenuShown:q,additionalMenuShown:Q,subtitlesMenuShown:Y,subtitlesList:z,seekingEnabled:W,settingsMenuShown:K,settingsEnabled:$,subtitlesEnabled:X,audioTrackEnabled:Z,videoTrackEnabled:J,additionalEnabled:ee,pipEnabled:te,cinemaEnabled:ie,airPlayEnabled:se,chromeCastEnabled:ne,skippableAfter:oe,countdownBefore:re,adsCountCurrent:ae,adsCountTotal:le,allowedToSkip:he,streamingLive:_e,tvMode:de,subtitlesShown:ue,textLoading:ce,textPlay:pe,textPause:me,textMute:ge,textUnmute:Ee,textVolume:Te,textVolumeValueOn:fe,textSeekbarEnabled:ye,textSeekbarDisabled:ve,textSeekbarPlayed:Ae,textSeekbarPlayedPrepos:Se,textSettings:be,textSettingsClose:Ce,textSettingsExpand:Pe,textSubtitlesEnabled:ke,textSubtitlesDisabled:Ie,textSubtitles:we,textSubtitlesHide:Ne,textQuality:Le,textQualityEnabled:xe,textQualityDisabled:Me,textAudioTracks:De,textVideoTracks:Oe,textFullscreenOn:Re,textFullscreenOff:Ue,textPipOn:Ve,textPipOff:Be,textCinemaOn:Fe,textCinemaOff:He,textAd:Ge,textAdPoint:je,textAdSkip:qe,textAdSkipAfter:Qe,textAdCountdown:Ye,textAdWeb:ze,textSponsor:We,textPromo:Ke,textLive:$e,textSetLive:Xe,textIsLivePlaying:Ze,textLiveFromStart:Je,textSetLiveFromStart:et,textTvMode:tt,textAction:it,textContentInfoTrigger:st,textContentInfoOpen:nt,textContentInfoClose:ot,textContentInfoLinkLabel:rt,textReplayContent:at,textReplayContentPlayed:lt,volume:ht,volumeMuted:_t,injections:dt,tech:ut,videoDimensions:ct,contentInfo:pt,splashInfoDisplayed:mt,ppShown:gt,controlPanelIntersectionHeight:Et,visibleElements:Tt,contentInfoShown:ft,isLargeUi:yt,ppInContent:vt,isEnded:At,followingShown:St,followingTeasers:bt,followingPreviewShown:Ct,followingTimerTime:Pt,followingTimerProgress:kt,transitionEnabled:It,transitionPreviewEnabled:wt,transitionTimerShown:Nt,timerCanceled:Lt,onTimerCancelClick:xt,chaptersShown:Mt,episodesShown:Dt,castMenuShown:Ot,programmeShown:Rt,episodesData:Ut,programmeData:Vt,preventPauseOnClick:Bt,chaptersData:Ft,audioList:Ht}=e;return{adLayout:s,adCanceled:n,clickthroughTarget:o,clickthroughUrl:r,controlPanelShown:a,startTime:l,currentTime:h,buffered:_,displayed:i,adPoints:d,duration:u,fullscreenEnabled:c,fullscreenOn:p,pipAvailable:m,pipOn:g,cinemaAvailable:E,cinemaOn:T,airPlayAvailable:f,airPlayOn:y,chromeCastAvailable:v,chromeCastOn:A,indicatorColor:S,isEvent:b,isLive:C,layout:P,loading:k,seeking:I,playing:w,playingLive:N,seekSource:L,sourceReady:x,progressBarColor:M,qualityEnabled:D,qualityId:O,qualityMenuShown:R,qualities:U,subtitlesId:V,subtitlesMenuShown:Y,subtitlesList:z,audioTrackList:B,audioTrackId:F,audioTrackMenuShown:H,videoTrackList:G,videoTrackId:j,videoTrackMenuShown:q,seekingEnabled:W,additionalMenuShown:Q,settingsMenuShown:K,settingsEnabled:$,subtitlesEnabled:X,audioTrackEnabled:Z,videoTrackEnabled:J,additionalEnabled:ee,pipEnabled:te,cinemaEnabled:ie,airPlayEnabled:se,chromeCastEnabled:ne,skippableAfter:oe,countdownBefore:re,adsCountCurrent:ae,adsCountTotal:le,allowedToSkip:he,streamingLive:_e,tvMode:de,subtitlesShown:ue,textLoading:ce,textPlay:pe,textPause:me,textMute:ge,textUnmute:Ee,textVolume:Te,textVolumeValueOn:fe,textSeekbarEnabled:ye,textSeekbarDisabled:ve,textSeekbarPlayed:Ae,textSeekbarPlayedPrepos:Se,textSettings:be,textSettingsClose:Ce,textSettingsExpand:Pe,textSubtitlesEnabled:ke,textSubtitlesDisabled:Ie,textSubtitles:we,textSubtitlesHide:Ne,textQuality:Le,textQualityEnabled:xe,textQualityDisabled:Me,textAudioTracks:De,textVideoTracks:Oe,textFullscreenOn:Re,textFullscreenOff:Ue,textPipOn:Ve,textPipOff:Be,textCinemaOn:Fe,textCinemaOff:He,textAd:Ge,textAdPoint:je,textAdSkip:qe,textAdSkipAfter:Qe,textAdCountdown:Ye,textAdWeb:ze,textSponsor:We,textPromo:Ke,textLive:$e,textSetLive:Xe,textIsLivePlaying:Ze,textLiveFromStart:Je,textSetLiveFromStart:et,textTvMode:tt,textAction:it,textContentInfoTrigger:st,textContentInfoOpen:nt,textContentInfoClose:ot,textContentInfoLinkLabel:rt,textReplayContent:at,textReplayContentPlayed:lt,volume:ht,volumeMuted:_t,injections:dt,tech:ut,videoDimensions:ct,contentInfo:pt,splashInfoDisplayed:mt,ppShown:gt,controlPanelIntersectionHeight:Et,visibleElements:Tt,contentInfoShown:ft,isLargeUi:yt,ppInContent:vt,isEnded:At,followingShown:St,followingTeasers:bt,followingPreviewShown:Ct,followingTimerTime:Pt,followingTimerProgress:kt,transitionEnabled:It,transitionPreviewEnabled:wt,transitionTimerShown:Nt,timerCanceled:Lt,onTimerCancelClick:xt,chaptersShown:Mt,episodesShown:Dt,castMenuShown:Ot,episodesData:Ut,programmeShown:Rt,programmeData:Vt,preventPauseOnClick:Bt,chaptersData:Ft,audioList:Ht}}__setDisplayed(e){ts(this._dom.root).setDisplayed(e)}}class eo extends fs{constructor(e){super(e),this._dom={root:null,refs:{svgDefs:null}},this._component={techContainer:null,overlaysContainer:null,controlsContainer:null}}uiGetDeclaredProps(){return{tech:"object",overlays:"object",controls:"object"}}_onUiInit(e){this._component.techContainer=new vs(e.tech),this._component.overlaysContainer=new xs(e.overlays),this._component.controlsContainer=new Jn(e.controls)}_onUiBuild(e){this._dom.root=es("div",{className:"w-Ui"}),this._dom.refs.svgDefs=es("div",{className:"c-SvgDefs",innerHTML:'\n\t\t\t\t<svg xmlns="http://www.w3.org/2000/svg" width="0" height="0">\n\t\t\t\t\t<defs>\n\t\t\t\t\t\t<clipPath id="sznp-squircle">\n\t\t\t\t\t\t\t<path d="m48.785 62.215c6.7289-1.454 11.975-6.7004 13.429-13.428 1.1696-5.4101 1.7853-11.026 1.7853-16.786 0-5.7599-0.61572-11.376-1.7853-16.786-1.4545-6.7278-6.6998-11.974-13.428-13.428-5.4106-1.1696-11.026-1.7859-16.786-1.7859-5.7598 0-11.376 0.61632-16.786 1.7859-6.7277 1.4545-11.974 6.7004-13.428 13.428-1.1696 5.4095-1.7859 11.025-1.7859 16.785 0 5.7605 0.61632 11.376 1.7859 16.786 1.4545 6.7278 6.7004 11.974 13.428 13.428 5.41 1.1702 11.026 1.7859 16.786 1.7859 5.7598 0 11.375-0.61573 16.785-1.7847"></path>\n\t\t\t\t\t\t</clipPath>\n\t\t\t\t\t</defs>\n\t\t\t\t</svg>\n\t\t\t'}),ts(this._dom.root).append(this._component.techContainer.uiGetElement(),this._component.overlaysContainer.uiGetElement(),this._component.controlsContainer.uiGetElement(),this._dom.refs.svgDefs)}_onUiUpdate(e){this._component.techContainer.uiUpdate(e.tech),this._component.overlaysContainer.uiUpdate(e.overlays),this._component.controlsContainer.uiUpdate(e.controls)}}class to{constructor(e){this._defaultState=Object.assign({},e),this._state=e}reset(){this._state=this._defaultState}get(){return this._state}update(e){this._state=function e(t,i){const s=Object.assign({},t);for(let n of Object.keys(i))t[n]&&Array.isArray(t[n])?s[n]=i[n].slice():t[n]&&"object"==typeof t[n]&&i[n]?s[n]=e(t[n],i[n]):s[n]=i[n];return s}(this._state,e)}}const io={displayed:!0,controlsEnabled:!1,elm:null};class so extends to{constructor(){super(io)}}const no={displayed:!0,logoSrc:"",logo:!1,logoLive:!1,logoLiveText:"Živě",pp:!1,captions:!1,captionCues:[],captionRegions:[],visibleElements:null,isLargeUi:!1,controlPanelShown:!1};class oo extends to{constructor(){super(no)}}const ro={adLayout:"default",adCanceled:!1,adOnly:!1,audioOnly:!1,audioLevels:[],audioLevelsFrequency:0,clickthroughTarget:"_blank",clickthroughUrl:"",controlPanelShown:!1,controlPanelHovered:!1,controlPanelFulltimeHidden:!1,startTime:-1,currentTime:0,buffered:null,displayed:!0,adPoints:[],duration:0,fullscreenEnabled:!0,fullscreenOn:!1,pipAvailable:!1,pipOn:!1,cinemaAvailable:!1,cinemaOn:!1,airPlayAvailable:!1,airPlayOn:!1,chromeCastAvailable:!1,chromeCastOn:!1,indicatorColor:"",isEvent:!1,isLive:!1,layout:"default",loading:!1,seeking:!1,playing:!1,playingLive:!1,seekSource:null,sourceReady:!1,progressBarColor:"",qualityId:-1,qualities:[],qualityMenuShown:!1,subtitlesId:-1,subtitlesList:[],subtitlesMenuShown:!1,audioTrackList:[],audioTrackId:-1,audioTrackMenuShown:!1,videoTrackList:[],videoTrackId:-1,videoTrackMenuShown:!1,additionalMenuShown:!1,settingsMenuShown:!1,settingsEnabled:!1,subtitlesEnabled:!1,qualityEnabled:!1,audioTrackEnabled:!1,videoTrackEnabled:!1,additionalEnabled:!1,fullscreenEnabled:!1,pipEnabled:!1,cinemaEnabled:!1,chromeCastEnabled:!1,airPlayEnabled:!1,subtitlesShown:!1,seekingEnabled:!0,skippableAfter:-1,countdownBefore:0,adsCountCurrent:0,adsCountTotal:0,allowedToSkip:!1,streamingLive:!1,tvMode:!1,textLoading:"Načítání…",textPlay:"Přehrát video",textPause:"Pozastavit přehrávání",textMute:"Vypnout zvuk",textUnmute:"Zapnout zvuk",textVolume:"Nastavit hlasitost",textVolumeValueOn:"Hlasitost na",textSeekbarEnabled:"Posuňte se ve videu",textSeekbarDisabled:"V tomto videu se nelze posouvat",textSeekbarPlayed:"Přehráno",textSeekbarPlayedPrepos:"z",textSettings:"Nastavení přehrávání",textSettingsClose:"Zavřít nastavení",textSettingsExpand:"Další nastavení",textSubtitlesEnabled:"Vypnout/zapnout titulky",textSubtitlesDisabled:"U tohoto videa nejsou titulky dostupné",textQuality:"Kvalita",textSubtitles:"Titulky",textSubtitlesHide:"Bez titulků",textQualityEnabled:"Nastavení kvality videa",textQualityDisabled:"U tohoto videa nelze nastavit kvalitu",textAudioTracks:"Jazyk",textVideoTracks:"Úhel pohledu",textFullscreenOn:"Zapnout přehrávání přes celou obrazovku",textFullscreenOff:"Vypnout přehrávání přes celou obrazovku",textPipOn:"Zapnout režim PIP",textPipOff:"Vypnout režim PIP",textCinemaOn:"Zapnout režim kino",textCinemaOff:"Vypnout režim kino",textAd:"Reklama",textAdPoint:"REKLAMA",textAdSkip:"Přeskočit reklamu",textAdSkipAfter:"Přeskočit za",textAdCountdown:"Reklama začne za",textAdWeb:"Zjistit více",textSponsor:"Sponzor pořadu",textPromo:"Upoutávka",textLive:"Živě",textIsLivePlaying:"Probíhá živý přenos",textSetLive:"Přejít na živý přenos",textLiveFromStart:"Začátek přenosu",textSetLiveFromStart:"Přejít na začátek přenosu",textTvMode:"Právě vysíláme",textAction:"",textContentInfoTrigger:"Nyní hraje",textContentInfoOpen:"Zobrazit informace",textContentInfoClose:"Skrýt informace",textContentInfoLinkLabel:"Zobrazit informace",textReplayContent:"Přehrát znovu",textReplayContentPlayed:"Právě dohrálo",useTouch:!1,volume:0,volumeMuted:!1,injections:[],tech:null,videoDimensions:null,contentInfo:null,splashInfoDisplayed:!1,ppShown:!1,controlPanelIntersectionHeight:0,visibleElements:null,contentInfoShown:!1,isLargeUi:!1,ppInContent:!1,isEnded:!1,followingShown:!1,followingTeasers:[],followingPreviewShown:!1,followingTimerTime:0,followingTimerProgress:0,transitionEnabled:!0,transitionPreviewEnabled:!0,transitionTimerShown:!1,timerCanceled:!1,onTimerCancelClick:null,chaptersShown:!1,episodesShown:!1,castMenuShown:!1,programmeShown:!1,programmeData:null,episodesData:null,preventPauseOnClick:!1,chaptersData:null,audioList:[]};class ao extends to{constructor(){super(ro)}}var lo=function(){if("undefined"!=typeof Map)return Map;function e(e,t){var i=-1;return e.some(function(e,s){return e[0]===t&&(i=s,!0)}),i}return function(){function t(){this.__entries__=[]}var i={size:{configurable:!0}};return i.size.get=function(){return this.__entries__.length},t.prototype.get=function(t){var i=e(this.__entries__,t),s=this.__entries__[i];return s&&s[1]},t.prototype.set=function(t,i){var s=e(this.__entries__,t);~s?this.__entries__[s][1]=i:this.__entries__.push([t,i])},t.prototype.delete=function(t){var i=this.__entries__,s=e(i,t);~s&&i.splice(s,1)},t.prototype.has=function(t){return!!~e(this.__entries__,t)},t.prototype.clear=function(){this.__entries__.splice(0)},t.prototype.forEach=function(e,t){void 0===t&&(t=null);for(var i=0,s=this.__entries__;i<s.length;i+=1){var n=s[i];e.call(t,n[1],n[0])}},Object.defineProperties(t.prototype,i),t}()}(),ho="undefined"!=typeof window&&"undefined"!=typeof document&&window.document===document,_o=void 0!==Ee&&Ee.Math===Math?Ee:"undefined"!=typeof self&&self.Math===Math?self:"undefined"!=typeof window&&window.Math===Math?window:Function("return this")(),uo="function"==typeof requestAnimationFrame?requestAnimationFrame.bind(_o):function(e){return setTimeout(function(){return e(Date.now())},1e3/60)},co=2,po=["top","right","bottom","left","width","height","size","weight"],mo="undefined"!=typeof MutationObserver,go=function(){this.connected_=!1,this.mutationEventsAdded_=!1,this.mutationsObserver_=null,this.observers_=[],this.onTransitionEnd_=this.onTransitionEnd_.bind(this),this.refresh=function(e,t){var i=!1,s=!1,n=0;function o(){i&&(i=!1,e()),s&&a()}function r(){uo(o)}function a(){var e=Date.now();if(i){if(e-n<co)return;s=!0}else i=!0,s=!1,setTimeout(r,t);n=e}return a}(this.refresh.bind(this),20)};go.prototype.addObserver=function(e){~this.observers_.indexOf(e)||this.observers_.push(e),this.connected_||this.connect_()},go.prototype.removeObserver=function(e){var t=this.observers_,i=t.indexOf(e);~i&&t.splice(i,1),!t.length&&this.connected_&&this.disconnect_()},go.prototype.refresh=function(){this.updateObservers_()&&this.refresh()},go.prototype.updateObservers_=function(){var e=this.observers_.filter(function(e){return e.gatherActive(),e.hasActive()});return e.forEach(function(e){return e.broadcastActive()}),e.length>0},go.prototype.connect_=function(){ho&&!this.connected_&&(document.addEventListener("transitionend",this.onTransitionEnd_),window.addEventListener("resize",this.refresh),mo?(this.mutationsObserver_=new MutationObserver(this.refresh),this.mutationsObserver_.observe(document,{attributes:!0,childList:!0,characterData:!0,subtree:!0})):(document.addEventListener("DOMSubtreeModified",this.refresh),this.mutationEventsAdded_=!0),this.connected_=!0)},go.prototype.disconnect_=function(){ho&&this.connected_&&(document.removeEventListener("transitionend",this.onTransitionEnd_),window.removeEventListener("resize",this.refresh),this.mutationsObserver_&&this.mutationsObserver_.disconnect(),this.mutationEventsAdded_&&document.removeEventListener("DOMSubtreeModified",this.refresh),this.mutationsObserver_=null,this.mutationEventsAdded_=!1,this.connected_=!1)},go.prototype.onTransitionEnd_=function(e){var t=e.propertyName;void 0===t&&(t=""),po.some(function(e){return!!~t.indexOf(e)})&&this.refresh()},go.getInstance=function(){return this.instance_||(this.instance_=new go),this.instance_},go.instance_=null;var Eo=function(e,t){for(var i=0,s=Object.keys(t);i<s.length;i+=1){var n=s[i];Object.defineProperty(e,n,{value:t[n],enumerable:!1,writable:!1,configurable:!0})}return e},To=function(e){return e&&e.ownerDocument&&e.ownerDocument.defaultView||_o},fo=Co(0,0,0,0);function yo(e){return parseFloat(e)||0}function vo(e){for(var t=[],i=arguments.length-1;i-- >0;)t[i]=arguments[i+1];return t.reduce(function(t,i){return t+yo(e["border-"+i+"-width"])},0)}function Ao(e){var t=e.clientWidth,i=e.clientHeight;if(!t&&!i)return fo;var s=To(e).getComputedStyle(e),n=function(e){for(var t={},i=0,s=["top","right","bottom","left"];i<s.length;i+=1){var n=s[i],o=e["padding-"+n];t[n]=yo(o)}return t}(s),o=n.left+n.right,r=n.top+n.bottom,a=yo(s.width),l=yo(s.height);if("border-box"===s.boxSizing&&(Math.round(a+o)!==t&&(a-=vo(s,"left","right")+o),Math.round(l+r)!==i&&(l-=vo(s,"top","bottom")+r)),!function(e){return e===To(e).document.documentElement}(e)){var h=Math.round(a+o)-t,_=Math.round(l+r)-i;1!==Math.abs(h)&&(a-=h),1!==Math.abs(_)&&(l-=_)}return Co(n.left,n.top,a,l)}var So="undefined"!=typeof SVGGraphicsElement?function(e){return e instanceof To(e).SVGGraphicsElement}:function(e){return e instanceof To(e).SVGElement&&"function"==typeof e.getBBox};function bo(e){return ho?So(e)?function(e){var t=e.getBBox();return Co(0,0,t.width,t.height)}(e):Ao(e):fo}function Co(e,t,i,s){return{x:e,y:t,width:i,height:s}}var Po=function(e){this.broadcastWidth=0,this.broadcastHeight=0,this.contentRect_=Co(0,0,0,0),this.target=e};Po.prototype.isActive=function(){var e=bo(this.target);return this.contentRect_=e,e.width!==this.broadcastWidth||e.height!==this.broadcastHeight},Po.prototype.broadcastRect=function(){var e=this.contentRect_;return this.broadcastWidth=e.width,this.broadcastHeight=e.height,e};var ko=function(e,t){var i,s,n,o,r,a,l,h=(s=(i=t).x,n=i.y,o=i.width,r=i.height,a="undefined"!=typeof DOMRectReadOnly?DOMRectReadOnly:Object,l=Object.create(a.prototype),Eo(l,{x:s,y:n,width:o,height:r,top:n,right:s+o,bottom:r+n,left:s}),l);Eo(this,{target:e,contentRect:h})},Io=function(e,t,i){if(this.activeObservations_=[],this.observations_=new lo,"function"!=typeof e)throw new TypeError("The callback provided as parameter 1 is not a function.");this.callback_=e,this.controller_=t,this.callbackCtx_=i};Io.prototype.observe=function(e){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if("undefined"!=typeof Element&&Element instanceof Object){if(!(e instanceof To(e).Element))throw new TypeError('parameter 1 is not of type "Element".');var t=this.observations_;t.has(e)||(t.set(e,new Po(e)),this.controller_.addObserver(this),this.controller_.refresh())}},Io.prototype.unobserve=function(e){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if("undefined"!=typeof Element&&Element instanceof Object){if(!(e instanceof To(e).Element))throw new TypeError('parameter 1 is not of type "Element".');var t=this.observations_;t.has(e)&&(t.delete(e),t.size||this.controller_.removeObserver(this))}},Io.prototype.disconnect=function(){this.clearActive(),this.observations_.clear(),this.controller_.removeObserver(this)},Io.prototype.gatherActive=function(){var e=this;this.clearActive(),this.observations_.forEach(function(t){t.isActive()&&e.activeObservations_.push(t)})},Io.prototype.broadcastActive=function(){if(this.hasActive()){var e=this.callbackCtx_,t=this.activeObservations_.map(function(e){return new ko(e.target,e.broadcastRect())});this.callback_.call(e,t,e),this.clearActive()}},Io.prototype.clearActive=function(){this.activeObservations_.splice(0)},Io.prototype.hasActive=function(){return this.activeObservations_.length>0};var wo="undefined"!=typeof WeakMap?new WeakMap:new lo,No=function(e){if(!(this instanceof No))throw new TypeError("Cannot call a class as a function.");if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");var t=go.getInstance(),i=new Io(e,t,this);wo.set(this,i)};["observe","unobserve","disconnect"].forEach(function(e){No.prototype[e]=function(){return(t=wo.get(this))[e].apply(t,arguments);var t}});var Lo=void 0!==_o.ResizeObserver?_o.ResizeObserver:No;class xo extends E{constructor(e){super(),this._resObserver=new Lo(this._handleUiComponentsResize.bind(this)),this._observedElements=[],this._lastSizes=[]}observe(e){this._observedElements.push(e),this._resObserver.observe(e)}unobserve(e){const t=this.isElementObserved(e);t>-1&&(this._observedElements.splice(t,1),this._resObserver.unobserve(e))}disconnect(){this._observedElements=[],this._resObserver.disconnect()}getObservedElements(){return this._observedElements}isElementObserved(e){return this._observedElements.indexOf(e)}_handleUiComponentsResize(e){e.forEach(e=>{let t=!1;this._lastSizes.forEach((i,s)=>{i.target===e.target&&(this._lastSizes[s]=e,t=!0)}),t||this._lastSizes.push(e)}),this.emit(xo.EVENT_UI_RESIZE,e)}}xo.EVENT_UI_RESIZE="ui-resize";var Mo={PREFIX:"-width-",DEFAULT:{minWidth:0,minHeight:0,className:"-width-0"},LARGE_UI_MIN_WIDTH:576,ROOT:[{minWidth:1024,className:"-width-1024"},{minWidth:768,className:"-width-768"},{minWidth:576,className:"-width-576"},{minWidth:480,className:"-width-480"},{minWidth:320,className:"-width-320"},{minWidth:256,className:"-width-256"}]};class Do extends S{constructor(){super(),this._currentElements=[],this._uiResizeObserver=new xo,this._resizeEventMap=new Map([[xo.EVENT_UI_RESIZE,this._handleUiResize]]),this.bindAll(this._resizeEventMap),this.addListeners(this._uiResizeObserver,this._resizeEventMap)}destroy(){this._currentElements=[],this._uiResizeObserver.disconnect()}addElement(e,t=[]){-1===this._uiResizeObserver.isElementObserved(e)&&(this._currentElements.push({target:e,breakpoints:t,lastClassName:""}),this._uiResizeObserver.observe(e))}getElement(e){const t=this._getElementIdx(e);return t>-1?this._currentElements[t]:null}getElements(){return this._currentElements}_getElementIdx(e){for(let t=0;t<this._currentElements.length;t++)if(this._currentElements[t].target===e)return t;return-1}_getClassName(e,t){let i=Mo.DEFAULT;return t.forEach(t=>{e.width>=t.minWidth&&t.minWidth>=i.minWidth&&(i=t)}),i.className}_isLargeUi(e){return!!(e.width>=Mo.LARGE_UI_MIN_WIDTH)}_handleUiResize(e){e.forEach(e=>{const t=this._getElementIdx(e.target),i=this._currentElements[t],s=i.breakpoints,n=this._getClassName(e.contentRect,s),o=this._isLargeUi(e.contentRect);n!==i.lastClassName&&(this._emitUiResize(i,n,o),i.lastClassName=n)})}_emitUiResize(e,t,i){this.emit(Do.EVENT_UI_RESIZE,{target:e.target,className:t,isLargeUi:i})}}Do.EVENT_UI_RESIZE="ui-resize";const Oo="episode";var Ro={initUi(e,t={}){this._uiTechElm=e,this._cmode=t.cmode?t.cmode:"standard",this._adOnly=!!t.adOnlyMode,this._audioOnly=!!t.audioOnlyMode,this._customCinemaMode=!!t.customCinemaMode,this._uiDom={root:es("div",{className:"w-Ui-Html -width-0"})},this._ui=null,this._uiState={tech:new so,overlays:new oo,controls:new ao},this._uiLayout="default",this._uiIsLarge=!1,this._contentEnded=!1,this._defaultUiLayoutOptions={tvMode:!1,videoSkippableAfter:-1,videoCountdownBefore:0,videoCountCurrent:0,videoCountTotal:0,allowedToSkip:!1,adUrl:"",adUrlTarget:"",adLayout:"default",adCanceled:!1,colors:{progressBar:"",indicator:""},seekingEnabled:!0,showLoading:!1,seekSource:null,chapters:null,contentInfo:null,ppInContent:!1,settingsEnabled:!1,subtitlesEnabled:!1,qualityEnabled:!1,audioTrackEnabled:!1,videoTrackEnabled:!1,additionalEnabled:!1,fullscreenEnabled:!1,pipEnabled:!1,cinemaEnabled:!1,chromeCastEnabled:!1,airPlayEnabled:!1},this._defaulVisibleUiElements={actionArea:!0,logo:!0,pp:!0,liveInfo:!0,captions:!0,injections:!0,adInfoNext:!0,adInfoNextTeaser:!1,adInfo:!0,adSkip:!0,adSkipAll:!0,adClickthrough:!0,contentInfo:!0,contentInfoTitle:!0,contentInfoDescription:!0,contentInfoDuration:!0,contentInfoPp:!0,contentInfoShare:!1,contentInfoLink:!0,contentInfoAuthor:!0,richMenu:!1,backButton:!1,chapters:!0,episodes:!0,following:!1,programme:!1,pipButton:!0,castButton:!0,cinemaButton:!1,settingsButton:!0,subtitlesButton:!0,fullscreenButton:!0},this._defaultComponentsShown={settingsMenuShown:!1,subtitlesMenuShown:!1,qualityMenuShown:!1,audioTrackMenuShown:!1,videoTrackMenuShown:!1,additionalMenuShown:!1,contentInfoShown:!1,followingShown:!1,programmeShown:!1,chaptersShown:!1,episodesShown:!1,castMenuShown:!1},this._defaultFollowingOptions={followingTeasers:[],followingPreviewShown:!1,transitionEnabled:!0,transitionPreviewEnabled:!0,transitionTimerShown:!1,followingTimerTime:0,followingTimerProgress:0,timerCanceled:!1,onTimerCancelClick:null},this._uiLayoutOptions=Object.assign({},this._defaultUiLayoutOptions),this._visibleUiElements=Object.assign({},this._defaulVisibleUiElements),this._uiComponentsShown=Object.assign({},this._defaultComponentsShown),this._followingOptions=Object.assign({},this._defaultFollowingOptions),this._uiEventEmitter=new E,this._uiFs=null,this._uiPip=null,this._uiCinema=null,this._uiAirPlay=null,this._veProcessor=new Es,this._uiResizeController=new Do,this._adPoints=[],this._audioList=[],this._adPointsShown=!0,this._resizeTimeout=null,this._adSkipTimeout=null,this._adSkipRemainingTime=5e3,this._adLoadingStarted=0,this._volumeControlUsed=!1,this._sourceReady=!1,this._lastTextTrack=null,this._uiEventsMap=new Map([[ys.SHOW_CONTROL_PANEL,this.__onUiShowCtrlPanel],[ys.CTRL_PANEL_HOVERED,this.__onUiCtrlPanelHovered],[ys.HIDE_CONTROL_PANEL,this.__onUiHideCtrlPanel],[ys.PLAY_REQUEST,this.__onUiPlayRequest],[ys.PAUSE_REQUEST,this.__onUiPauseRequest],[ys.REPLAY_REQUEST,this.__onUiReplayRequest],[ys.OPEN_QUALITY_MENU_REQUEST,this.__onUiOpenQualityMenuRequest],[ys.CLOSE_QUALITY_MENU_REQUEST,this.__onUiCloseQualityMenuRequest],[ys.CHANGE_QUALITY_REQUEST,this.__onUiChangeQualityRequest],[ys.OPEN_SUBTITLES_MENU_REQUEST,this.__onUiOpenSubtitlesMenuRequest],[ys.CLOSE_SUBTITLES_MENU_REQUEST,this.__onUiCloseSubtitlesMenuRequest],[ys.CHANGE_SUBTITLES_REQUEST,this.__onUiChangeSubtitlesRequest],[ys.TOGGLE_SUBTITLES_REQUEST,this.__onUiToggleSubtitlesRequest],[ys.OPEN_AUDIO_TRACK_MENU_REQUEST,this.__onUiOpenAudioTrackMenuRequest],[ys.CLOSE_AUDIO_TRACK_MENU_REQUEST,this.__onUiCloseAudioTrackMenuRequest],[ys.CHANGE_AUDIO_TRACK_REQUEST,this.__onUiChangeAudioTrackRequest],[ys.OPEN_VIDEO_TRACK_MENU_REQUEST,this.__onUiOpenVideoTrackMenuRequest],[ys.CLOSE_VIDEO_TRACK_MENU_REQUEST,this.__onUiCloseVideoTrackMenuRequest],[ys.CHANGE_VIDEO_TRACK_REQUEST,this.__onUiChangeVideoTrackRequest],[ys.OPEN_SETTINGS_MENU_REQUEST,this.__onUiOpenSettingsMenuRequest],[ys.CLOSE_SETTINGS_MENU_REQUEST,this.__onUiCloseSettingsMenuRequest],[ys.OPEN_ADDITIONAL_MENU_REQUEST,this.__onUiOpenAdditionalMenuRequest],[ys.CLOSE_ADDITIONAL_MENU_REQUEST,this.__onUiCloseAdditionalMenuRequest],[ys.OPEN_CAST_MENU_REQUEST,this.__onUiOpenCastMenuRequest],[ys.CLOSE_CAST_MENU_REQUEST,this.__onUiCloseCastMenuRequest],[ys.FS_ON_REQUEST,this.enterFullscreen],[ys.FS_OFF_REQUEST,this.exitFullscreen],[ys.PIP_ON_REQUEST,this.enterPip],[ys.PIP_OFF_REQUEST,this.exitPip],[ys.AP_ON_REQUEST,this.showAirPlayTargetPicker],[ys.CINEMA_ON_REQUEST,this.enterCinema],[ys.CINEMA_OFF_REQUEST,this.exitCinema],[ys.CLICK_ON_SKIP_VIDEO,this.__onUiSkipVideo],[ys.CLICK_ON_CANCEL_AD,this.__onUiCancelAd],[ys.CLICK_ON_CLICKTHROUGH_LINK,this.__onUiClickThruAreaClick],[ys.CLICK_ON_INJECTION,this.__onUiInjectionClick],[ys.CLICK_ON_ACTION_AREA,this.__onUiClickActionArea],[ys.CLICK_ON_BACK,this.__onUiClickBack],[ys.CLICK_ON_CONTENT_LINK,this.__onUiClickContentLink],[ys.CLOSE_INJECTION,this.__onUiInjectionClose],[ys.ERROR_INJECTION,this.__onUiInjectionError],[ys.START_SEEKING,this.__onUiStartSeeking],[ys.END_SEEKING,this.__onUiEndSeeking],[ys.SEEK_TO,this.__onUiSeekTo],[ys.MOVE_CURRENT_TIME_TO,this.__onUiMoveCurrentTimeTo],[ys.VOLUME_CHANGE_TO,this.__onUiVolumeChangeTo],[ys.VOLUME_MUTE_CLICK,this.__onUiVolumeMuteClick],[ys.CLICK_ON_LIVE,this.__onUiClickOnLive],[ys.COMPONENT_SHOWN,this.__onUiComponentShown],[ys.COMPONENT_ALL_HIDE,this.__onUiCloseAllComponents]]),this._uiTechEventsMap=new Map([[X.EVENT_LOADED_META,this.__handleTechLoadedMeta],[X.EVENT_CAN_PLAY,this.__handleTechCanPlay],[X.EVENT_DURATION_CHANGE,this.__handleTechDurationChange],[X.EVENT_PLAY,this.__handleTechPlay],[X.EVENT_PLAYING,this.__handleTechPlaying],[X.EVENT_PAUSED,this.__handleTechPaused],[X.EVENT_SEEKED,this.__handleTechSeeked],[X.EVENT_VOLUME_CHANGE,this.__handleTechVolumeChange],[X.EVENT_ENDED,this.__handleTechEnded],[X.EVENT_BUFFER_EMPTY,this.__handleTechBufferEmpty],[X.EVENT_QUALITY_SET,this.__handleTechQualitySet],[X.EVENT_TRACK_SET,this.__handleTechTrackSet],[X.EVENT_SOURCE_SET,this.__handleTechSourceSet],[X.EVENT_SOURCE_READY,this.__handleTechSourceReady],[X.EVENT_TEXT_SOURCE_SET,this.__handleTechTextSourceSet],[X.EVENT_TEXT_TRACK_SET,this.__handleTechTextTrackSet],[X.EVENT_CUE_CHANGE,this.__handleTechTextTrackCue],[X.EVENT_LIVE_PLAYING_CHANGE,this.__handleLivePlayingChange],[X.EVENT_LIVE_STREAMING_CHANGE,this.__handleLiveStreamingChange],[X.EVENT_SKIPPABLE_STATE_CHANGE,this.__handleSkippableStateChange]]),this._uiFsEventsMap=new Map([[is.EVENT_CHANGE,this.__handleFullscreenChange]]),this._uiPipEventsMap=new Map([[ns.EVENT_CHANGE,this.__handlePipChange]]),this._uiCinemaEventsMap=new Map([[ss.EVENT_CHANGE,this.__handleCinemaChange]]),this._uiAirPlayEventsMap=new Map([[as.EVENT_AP_CHANGE,this.__handleAirPlayChange]]),this._uiVEProcessorEventsMap=new Map([[Es.EVENT_CHANGE,this.__handleVisualElementChange],[Es.EVENT_VE_DISPLAYED,this.__handleVisualElementDisplayed],[Es.EVENT_VE_HIDDEN,this.__handleVisualElementHidden],[Es.EVENT_VE_ERROR,this.__handleVisualElementError]]),this._uiResizeControllerEventsMap=new Map([[Do.EVENT_UI_RESIZE,this.__handleUiResize]]),this._uiRaf={gettingVideoProgress:0},this._uiTimeout={controlsHide:0},this.bindAll(this._uiEventsMap),this.bindAll(this._uiTechEventsMap),this.bindAll(this._uiFsEventsMap),this.bindAll(this._uiPipEventsMap),this.bindAll(this._uiCinemaEventsMap),this.bindAll(this._uiAirPlayEventsMap),this.bindAll(this._uiVEProcessorEventsMap),this.bindAll(this._uiResizeControllerEventsMap),this.__handleResize=this.__handleResize.bind(this),this.__handleResizeTimeout=this.__handleResizeTimeout.bind(this),this.__buildUi(),this.__initUiState()},canConfigureFullscreen:()=>!0,configureFullscreen({element:e}){if(!e||"object"!=typeof e)throw new Error('Invalid argument "element".');if(this._uiFs)throw new Error("Fullscreen has already been configured.");this._uiFs=new is(this._env,e,this._uiTechElm),this.addListeners(this._uiFs,this._uiFsEventsMap)},canConfigurePip:()=>!0,configurePip(){if(this._uiPip)throw new Error("PIP has already been configured.");this._uiPip=new ns(this._env,this[this.MP_ORIGIN].getElement.call(this)),this.addListeners(this._uiPip,this._uiPipEventsMap)},canConfigureCinema:()=>!0,configureCinema({element:e}){if(!e||"object"!=typeof e)throw new Error('Invalid argument "element".');if(this._uiCinema)throw new Error("Cinema Mode has already been configured.");this._uiCinema=new ss(this._env,e,this._customCinemaMode),this.addListeners(this._uiCinema,this._uiCinemaEventsMap)},canConfigureAirPlay:()=>!0,configureAirPlay(){if(this._uiAirPlay)throw new Error("AirPlay has already been configured.");this._uiAirPlay=new as(this._env,this[this.MP_ORIGIN].getElement.call(this)),this.addListeners(this._uiAirPlay,this._uiAirPlayEventsMap)},setDefaultLayout(e={}){this.__setUiLayout("default",e)},setAdvertLayout(e={}){this.__setUiLayout("ad",e)},hide(){this._uiDom.root.style.display="none"},show(){this._uiDom.root.style.display="",this.__updateUiVideoDimensions()},setLogo(e){this.__updateUiState("overlays",{logoSrc:e})},showLogo(){this.__updateUiState("overlays",{logo:!0})},hideLogo(){this.__updateUiState("overlays",{logo:!1})},setActionArea(e){this.__updateUiState("controls",{textAction:e})},setNoPauseOnClick(e){this.__updateUiState("controls",{preventPauseOnClick:e}),this.__updateRootElement({preventPauseOnClick:e})},showPp(){this.__updateUiState("overlays",{pp:!0}),this.__updateUiState("controls",{splashInfoDisplayed:!0,ppShown:!0})},hidePp(){this.__updateUiState("overlays",{pp:!1}),this.__updateUiState("controls",{splashInfoDisplayed:!1,ppShown:!1})},setControlsHidden(e){e?(this.__updateUiControls({controlPanelShown:!1,forceControlPanelUpdate:!0}),this.__updateUiState("controls",{controlPanelFulltimeHidden:!0}),this.__updateRootElement({settingsMenuShown:!1})):(this.__updateUiState("controls",{controlPanelFulltimeHidden:!1}),this.__canControlsHide()||this.__updateUiControls({controlPanelShown:!0}))},setUiFollowing(e={}){this.__updateUiFollowing(e)},setUiEpisodes(e={}){this.__updateUiEpisodes(e)},setUiTvProgram(e={}){this.__updateUiTvProgram(e)},setVisibleUiElements(e={}){this.__updateUiElementsVisibility(e)},getVisibleUiElements(){return this._visibleUiElements},resetVisibleUiElements(){this.__updateUiElementsVisibility(this._defaulVisibleUiElements)},setContentInfo(e={}){this.__updateUiContentInfo(e)},setContentEnded(e){this._contentEnded=e,this.__updateUiContentEnded()},resetContentInfo(){this.__updateUiContentInfo(null)},canRunVisualElementType(e,t=!1){return this._veProcessor.canRunType(e,t)},isVisualElementShown(e){return this._veProcessor.isShown(e)},getVisualElements(){return this._veProcessor.get()},addVisualElement(e){this._veProcessor.add(e)},showVisualElement(e){this._veProcessor.show(e)},showVisualElementClose(e){this._veProcessor.showClose(e)},hideVisualElement(e){this._veProcessor.hide(e)},abortVisualElement(e){this._veProcessor.abort(e)},removeVisualElement(e){this._veProcessor.remove(e)},removeVisualElements(){this._veProcessor.removeAll()},setVisualElementDefaultPosition(e,t){this._veProcessor.setDefaultPosition(e,t)},setAdPoints(e){this[this.MP_ORIGIN].setAdPoints.call(this,e),this.__updateAdPoints(e)},setAudioList(e){this._audioList=e,this.__updateUiState("controls",{audioList:this._audioList})},showControls(e){this._uiState.controls.get().controlPanelFulltimeHidden||this.__onUiShowCtrlPanel(e)},closeMenu(){const e=this._uiState.controls.get();return e.settingsMenuShown?(this.__updateUiSettingsMenu({settingsMenuShown:!1}),this.__onUiShowCtrlPanel(),""):e.castMenuShown?(this.__updateUiSettingsMenu({castMenuShown:!1}),this.__onUiShowCtrlPanel(),""):null},getElement(){return this._uiDom.root},isFullscreen(){return!!this._uiFs&&this._uiFs.isFullscreen()},enterFullscreen(){this._uiFs&&(this._uiFs.enterFullscreen(),this.__updateUiControls({controlPanelHovered:!1}))},exitFullscreen(){this._uiFs&&(this._uiFs.exitFullscreen(),this.__updateUiControls({controlPanelHovered:!1}))},isPipActive(){return!!this._uiPip&&this._uiPip.isPipActive()},isPipAvailable(){return!!this._uiPip&&this._uiPip.isPipAvailable()},enterPip(){this._uiPip&&this._uiPip.enterPip()},exitPip(){this._uiPip&&this._uiPip.exitPip()},isCinemaAvailable(){return!!this._uiCinema&&this._uiCinema.isCinemaAvailable()},isCinemaActive(){return!!this._uiCinema&&this._uiCinema.isCinemaActive()},enterCinema(){this._uiCinema&&this._uiCinema.enterCinema()},exitCinema(){this._uiCinema&&this._uiCinema.exitCinema()},isAirPlayActive(){return!!this._uiAirPlay&&this._uiAirPlay.isAirPlayActive()},isAirPlayAvailable(){return!!this._uiAirPlay&&this._uiAirPlay.isAirPlayAvailable()},showAirPlayTargetPicker(){(this._uiAirPlay||this.isAirPlayAvailable())&&this._uiAirPlay.showAirPlayTargetPicker()},focusPlayButton(){let e=null;(e=this._uiIsLarge?this._uiDom.root.querySelector('.w-DefaultCtrlPanelLayout button[data-mark="play"]'):this._uiDom.root.querySelector('.w-DefaultCtrlPanelCenter button[data-mark="play"]'))&&e.focus()},reset(...e){this.__clearControlsHideTimeout(),this.__stopCheckingVideoProgress(),this.__clearResizeTimeout(),this[this.MP_ORIGIN].reset.apply(this,e),this._uiLayout="default",this._uiLayoutOptions=Object.assign({},this._defaultUiLayoutOptions),this.__resetUiState(),this.__initUiState()},destroy(...e){this.__destroyUi(),this[this.MP_ORIGIN].destroy.apply(this,e)},__resetUiState(){this._uiState.tech.reset(),this._uiState.overlays.reset(),this._uiState.controls.reset()},__updateUiState(e,t){this._uiState[e].update(t),this.__updateUi()},__buildUi(){const e=Object.assign({},this._uiState.overlays.get(),{visibleElements:this._defaulVisibleUiElements}),t=Object.assign({},this._uiState.controls.get(),{visibleElements:this._defaulVisibleUiElements});this._ui=new eo({tech:this._uiState.tech.get(),overlays:e,controls:t}),this.addListeners(this,this._uiTechEventsMap),this.addListeners(this._uiEventEmitter,this._uiEventsMap),this.addListeners(this._veProcessor,this._uiVEProcessorEventsMap),this.addListeners(this._uiResizeController,this._uiResizeControllerEventsMap),window.addEventListener("resize",this.__handleResize),this._ui.uiInit(),this._ui.uiSetEventEmitter(this._uiEventEmitter),this._ui.uiBuild(),this._uiResizeController.addElement(this._uiDom.root,Mo.ROOT),ts(this._uiDom.root).append(this._ui.uiGetElement())},__updateUi(){this._ui.uiUpdate({tech:this._uiState.tech.get(),overlays:this._uiState.overlays.get(),controls:this._uiState.controls.get()})},__destroyUi(){this.__clearControlsHideTimeout(),this.__stopCheckingVideoProgress(),this.__clearResizeTimeout(),this.removeListeners(this,this._uiTechEventsMap),this.removeListeners(this._uiEventEmitter,this._uiEventsMap),this._uiFs&&this.removeListeners(this._uiFs,this._uiFsEventsMap),this._uiPip&&this.removeListeners(this._uiPip,this._uiPipEventsMap),this._uiAirPlay&&this.removeListeners(this._uiAirPlay,this._uiAirPlayEventsMap),this.removeListeners(this._veProcessor,this._uiVEProcessorEventsMap),this.removeListeners(this._uiResizeController,this._uiResizeControllerEventsMap),window.removeEventListener("resize",this.__handleResize),this._uiResizeController.destroy(),this._ui.uiDestroy(),ts(this._uiDom.root).clear()},__onUiShowCtrlPanel(e){this.__updateUiControls({controlPanelShown:!0,cursorVisible:!0,splashInfoDisplayed:!0,controlPanelShownLongTimeout:e})},__onUiCtrlPanelHovered(e){this.__updateUiControls({controlPanelHovered:e.hovered})},__onUiHideCtrlPanel(){this.__canControlsHide()&&this.__updateUiControls({controlPanelShown:!1,cursorVisible:!this.isFullscreen()})},__onUiPlayRequest(){this.play()},__onUiPauseRequest(){this.pause()},__onUiReplayRequest(){this.emit(X.EVENT_REPLAY_REQUEST)},__onUiOpenQualityMenuRequest(){this.showControls(),this.__updateUiQualityMenu({qualityMenuShown:!0}),this.__updateUiComponentsShown({additionalMenuShown:!1,subtitlesMenuShown:!1,audioTrackMenuShown:!1,videoTrackMenuShown:!1})},__onUiCloseQualityMenuRequest(){this.__updateUiQualityMenu({qualityMenuShown:!1})},__onUiChangeQualityRequest(e){this.__updateUiSettingsMenu({settingsMenuShown:!1}),this.setQuality(e.id)},__onUiOpenSubtitlesMenuRequest(){this.showControls(),this.__updateUiSubtitlesMenu({subtitlesMenuShown:!0}),this.__updateUiComponentsShown({additionalMenuShown:!1,qualityMenuShown:!1,audioTrackMenuShown:!1,videoTrackMenuShown:!1})},__onUiCloseSubtitlesMenuRequest(){this.__updateUiSubtitlesMenu({subtitlesMenuShown:!1})},__onUiChangeSubtitlesRequest(e){this.__updateUiSettingsMenu({settingsMenuShown:!1}),this.setTextTrack(e.id)},__onUiToggleSubtitlesRequest(e){if(null===this.getTextTrack()){const e=this.getSupportedTextTracks();if(!e.length)return;this._lastTextTrack=this._lastTextTrack||e[0].id,this.setTextTrack(this._lastTextTrack)}else this._lastTextTrack=this.getTextTrack(),this.setTextTrack()},__onUiOpenAudioTrackMenuRequest(){this.showControls(),this.__updateUiAudioTrackMenu({audioTrackMenuShown:!0}),this.__updateUiComponentsShown({additionalMenuShown:!1,qualityMenuShown:!1,subtitlesMenuShown:!1,videoTrackMenuShown:!1})},__onUiCloseAudioTrackMenuRequest(){this.__updateUiAudioTrackMenu({audioTrackMenuShown:!1})},__onUiChangeAudioTrackRequest(e){this.__updateUiSettingsMenu({settingsMenuShown:!1}),this.setTrack(e.id,C.TYPE_AUDIO)},__onUiOpenVideoTrackMenuRequest(){this.showControls(),this.__updateUiVideoTrackMenu({videoTrackMenuShown:!0}),this.__updateUiComponentsShown({additionalMenuShown:!1,qualityMenuShown:!1,subtitlesMenuShown:!1,audioTrackMenuShown:!1})},__onUiCloseVideoTrackMenuRequest(){this.__updateUiVideoTrackMenu({videoTrackMenuShown:!1})},__onUiChangeVideoTrackRequest(e){this.__updateUiSettingsMenu({settingsMenuShown:!1}),this.setTrack(e.id,C.TYPE_VIDEO)},__onUiOpenSettingsMenuRequest(){this.showControls(),this.__updateUiSettingsMenu({settingsMenuShown:!0}),this.__updateUiCastMenu({castMenuShown:!1})},__onUiCloseSettingsMenuRequest(){this.__updateUiSettingsMenu({settingsMenuShown:!1})},__onUiOpenAdditionalMenuRequest(){this.showControls(),this.__updateUiAdditionalMenu({additionalMenuShown:!0}),this.__updateUiComponentsShown({subtitlesMenuShown:!1,qualityMenuShown:!1,audioTrackMenuShown:!1,videoTrackMenuShown:!1})},__onUiCloseAdditionalMenuRequest(){this.__updateUiAdditionalMenu({additionalMenuShown:!1})},__onUiOpenCastMenuRequest(){this.showControls(),this.__updateUiCastMenu({castMenuShown:!0}),this.__updateUiSettingsMenu({settingsMenuShown:!1})},__onUiCloseCastMenuRequest(){this.__updateUiCastMenu({castMenuShown:!1})},__onUiSkipVideo(e){this.__stopCheckingVideoProgress(),this.emit(X.EVENT_SKIP_VIDEO_REQUEST,e)},__onUiCancelAd(e){this.emit(X.EVENT_CANCEL_AD_REQUEST,e)},__onUiStartSeeking(){this.__updateUiState("controls",{seeking:!0}),this.__stopCheckingVideoProgress()},__onUiEndSeeking(){this.__updateUiState("controls",{seeking:!1}),this.__startCheckingVideoProgress()},__onUiSeekTo(e){let t=e.time;p.isMac()&&p.isSafari()&&this.isEvent()&&t<.5&&(t=.5),this.seek(t,!1)},__onUiMoveCurrentTimeTo(e){const t=e.time;this.__updateUiCurrentTime({currentTime:t})},__onUiVolumeChangeTo(e){this._volumeControlUsed=!0;const t=e.volume,i=this.isMuted();this.setVolume(t),t||i?t&&i&&this.setMute(!1):this.setMute(!0)},__onUiVolumeMuteClick(){this._volumeControlUsed=!0;const e=this.getVolume(),t=this.isMuted();e||t?(this.setMute(!t),t&&!e&&this.setVolume(1)):this.setVolume(1)},__onUiClickThruAreaClick(e){this.emit(X.EVENT_VIDEO_CLICKTHROUGH,e)},__onUiInjectionClick(e){this.emit(X.EVENT_VE_CLICK,e)},__onUiInjectionClose(e){this.emit(X.EVENT_VE_CLOSE,e)},__onUiInjectionError(e){this.emit(X.EVENT_VE_ERROR,e)},__onUiClickActionArea(e){this.emit(X.EVENT_ACTION_CLICKTHROUGH,e)},__onUiClickBack(e){this.emit(X.EVENT_ACTION_BACK,e)},__onUiClickContentLink(e){this.emit(X.EVENT_ACTION_CONTENT_LINK,e)},__onUiCloseAllComponents(){this.__updateUiCloseAllComponents()},__onUiClickOnLive(){!this.isLivePlaying()&&this.isLiveStreaming()&&this.seekToLive()},__onUiComponentShown(e={}){this.__updateUiComponentsShown(e)},__handleTechLoadedMeta(){this.__updateUiCurrentTime(),this.__updateUiDuration(),this.__updateUiVideoDimensions()},__handleTechCanPlay(){this._adSkipTimeout&&(this.__clearAdSkipTimeout(),this._adSkipRemainingTime=Math.max(0,this._adSkipRemainingTime-((new Date).getTime()-this._adLoadingStarted))),this.__updateUiLoading({loading:!1})},__handleTechDurationChange(){this.__updateUiDuration()},__handleTechPlay(){this.__updateUiPlayPauseButton(),this.__startCheckingVideoProgress(),this.__updateUiContentEnded()},__handleTechPlaying(e){},__handleTechPaused(){this.__stopCheckingVideoProgress(),this.__updateUiPlayPauseButton(),this.__updateUiLoading({loading:!1}),this.isEnded()||this.__updateUiControls({controlPanelShown:!0})},__handleTechSeeked(){this.__updateUiCurrentTime()},__handleTechVolumeChange(){this.__updateUiVolume()},__handleTechBufferEmpty(){this._adSkipTimeout||"ad"!==this._uiLayout||(this._adLoadingStarted=(new Date).getTime(),this._adSkipTimeout=setTimeout(()=>{this.__updateUiState("controls",{skippableAfter:0})},this._adSkipRemainingTime)),this.__updateUiLoading({loading:!0})},__handleTechEnded(){this.__stopCheckingVideoProgress(),this.__updateUiPlayPauseButton(),this.__updateUiContentEnded(),this.__updateUiLoading({loading:!1})},__handleTechQualitySet(){this.__updateUiQualityButton(),this.__updateUiQualityMenu()},__handleTechTrackSet(){this.__updateUiAudioTrackButton(),this.__updateUiAudioTrackMenu(),this.__updateUiVideoTrackButton(),this.__updateUiVideoTrackMenu()},__handleTechSourceSet(){this.__updateUiQualityButton(),this.__updateUiQualityMenu(),this.__updateUiLiveInfo(),this.__updateUiSeekingAvailability(),this.__updateUiAudioTrackButton(),this.__updateUiAudioTrackMenu(),this.__updateUiVideoTrackButton(),this.__updateUiVideoTrackMenu()},__handleTechSourceReady(){this._sourceReady=!0,this.__updateUiSourceReady()},__handleTechTextSourceSet(){this.__updateUiSubtitlesButton(),this.__updateUiSubtitlesMenu()},__handleTechTextTrackSet(e){const t=null!==e.textTrackIdx;this.__updateUiState("overlays",{captions:t}),this.__updateUiSubtitlesIndication({subtitlesShown:t})},__handleTechTextTrackCue(e){this.__updateUiState("overlays",{captionCues:e.cues?e.cues:[],captionRegions:e.regions?e.regions:[]})},__handleLivePlayingChange(){this.__updateUiLiveInfo(),this.__updateUiDuration(),this.__updateUiSeekingAvailability()},__handleLiveStreamingChange(){this.__updateUiLiveInfo(),this.__updateUiDuration(),this.__updateUiSeekingAvailability()},__handleSkippableStateChange(e){this.__updateUiState("controls",{allowedToSkip:e.isSkippable})},__handleFullscreenChange(e){this.__updateUiFullscreenButton(),this.setViewMode(e.isFullscreen?"fullscreen":"normal"),this.emit(X.EVENT_FULLSCREEN_CHANGE,e)},__handlePipChange(e){this.__updateUiPipButton(),this.emit(X.EVENT_PIP_CHANGE,e)},__handleCinemaChange(e){this.__updateUiCinemaButton(),this.emit(X.EVENT_CINEMA_CHANGE,e)},__handleAirPlayChange(e){this.__updateUiAirPlayButton(),this.emit(X.EVENT_AP_CHANGE,e)},__handleVisualElementChange(e){this.__updateInjections(e)},__handleVisualElementDisplayed(e){this.emit(X.EVENT_VE_DISPLAYED,e)},__handleVisualElementHidden(e){this.emit(X.EVENT_VE_HIDDEN,e)},__handleVisualElementError(e){this.emit(X.EVENT_VE_ERROR,e)},__handleUiResize(e){e.target===this._uiDom.root&&(this.__updateRootElement({widthQuery:e.className}),this.__updateUiSize({isLargeUi:e.isLargeUi})),this.emit(X.EVENT_UI_RESIZE,e)},__handleResize(){this._resizeTimeout||(this._resizeTimeout=requestAnimationFrame(this.__handleResizeTimeout))},__handleResizeTimeout(){this.__updateUiVideoDimensions(),this._resizeTimeout=null},__clearResizeTimeout(){this._resizeTimeout&&(cancelAnimationFrame(this._resizeTimeout),this._resizeTimeout=null)},__clearAdSkipTimeout(){this._adSkipTimeout&&(clearTimeout(this._adSkipTimeout),this._adSkipTimeout=null)},__togglePlay(){this.isPaused()?this.play():this.pause()},__initUiState(){this.__updateUiElementsVisibility(),this.__updateUiContentEnded(),this.__updateUiFullscreenButton(),this.__updateUiCinemaButton(),this.__updateUiAirPlayButton(),this.__updateUiPipButton(),this.__updateUiTech(),this.__updateUiFromEnv(),this.__updateUiVolume(),this.__updateUiVideoDimensions()},__setUiLayout(e,t={}){this._uiLayout=e,this._uiLayoutOptions=Object.assign({},this._defaultUiLayoutOptions,t),this.__clearAdSkipTimeout(),this._adSkipRemainingTime=5e3,this._adLoadingStarted=0,this.__updateUiLayout(),this.__updateUiSize(),this.__updateUiContentInfo(this._uiLayoutOptions.contentInfo),this.__updateUiElementsVisibility(),this.__updateUiComponentsShown(this._defaultComponentsShown),this.__updateUiFollowing(),this.__updateUiSeekingAvailability(),this.__updateUiPp(),this.__updateUiSubtitlesButton(),this.__updateUiAudioTrackButton(),this.__updateUiVideoTrackButton(),this.__updateUiQualityButton(),this.__updateUiSettingsButton(),this.__updateUiAdditionalButton(),this.__updateUiFullscreenButton(),this.__updateUiAirPlayButton(),this.__updateUiCinemaButton(),this.__updateUiPipButton(),this.__updateUiLoading({loading:this._uiLayoutOptions.showLoading}),this.__updateUiVolume(),this.__updateUiClickthrough(),this.__updateUiAdCanceled(),this.__updateUiSkippableAfter(),this.__updateUiCountdownBefore(),this.__updateUiCount(),this.__updateUiTvMode(),this.__updateUiAdLayout(),this.__updateUiColors(),this.__updateUiSeekSource(),this.__updateUiChaptersData(),this.__updateRootElement({settingsMenuShown:!1})},__updateUiSize(e={}){"isLargeUi"in e&&(this._uiIsLarge!==e.isLargeUi&&e.isLargeUi&&this.__updateUiComponentsShown({contentInfoShown:!1}),this._uiIsLarge=e.isLargeUi),this.__updateUiState("controls",{isLargeUi:this._uiIsLarge}),this.__updateUiState("overlays",{isLargeUi:this._uiIsLarge})},__updateUiTech(){this.__updateUiState("tech",{displayed:"standard"===this._cmode,elm:"standard"===this._cmode?this._uiTechElm:null}),this.__updateUiState("controls",{tech:"transparent"===this._cmode?{elm:this._uiTechElm,adOnly:this._adOnly}:{},adOnly:this._adOnly,audioOnly:this._audioOnly,audioLevels:[],audioLevelsFrequency:1,audioList:this._audioList})},__updateUiFromEnv(){const e=this.isCustomUiCapable(),t=p.isTouch(),i=!e,s=e,n=e;this.__updateUiState("tech",{controlsEnabled:i}),this.__updateUiState("controls",{displayed:s,useTouch:t}),this.__updateUiState("overlays",{displayed:n})},__updateUiLayout(){this.__updateUiState("controls",{layout:this._uiLayout})},__updateUiClickthrough(){this.__updateUiState("controls",{clickthroughUrl:this._uiLayoutOptions.adUrl,clickthroughTarget:this._uiLayoutOptions.adUrlTarget})},__updateUiAdCanceled(){this.__updateUiState("controls",{adCanceled:this._uiLayoutOptions.adCanceled})},__updateUiSkippableAfter(){this.__updateUiState("controls",{skippableAfter:this._uiLayoutOptions.videoSkippableAfter})},__updateUiCountdownBefore(){this.__updateUiState("controls",{countdownBefore:this._uiLayoutOptions.videoCountdownBefore})},__updateUiCount(){this.__updateUiState("controls",{adsCountCurrent:this._uiLayoutOptions.videoCountCurrent,adsCountTotal:this._uiLayoutOptions.videoCountTotal})},__updateUiTvMode(){this.__updateUiState("controls",{tvMode:this._uiLayoutOptions.tvMode})},__updateUiAdLayout(){this.__updateUiState("controls",{adLayout:this._uiLayoutOptions.adLayout})},__updateUiColors(){const e=this._uiLayoutOptions.colors;this.__updateUiState("controls",{progressBarColor:e.progressBar,indicatorColor:e.indicator})},__updateUiSeekSource(){this.__updateUiState("controls",{seekSource:this._uiLayoutOptions.seekSource}),this.__preloadSeekPreview()},__updateUiSourceReady(){this.__updateUiState("controls",{sourceReady:this._sourceReady})},__updateUiChaptersData(){const e=this._uiLayoutOptions.chapters,t=[];e&&e.forEach(e=>{t.push(Object.assign({},e,{id:"",active:!1,onClick:this.seek.bind(this,e.startTime),type:Oo}))}),this.__updateUiState("controls",{chaptersData:{selectData:null,listData:t}})},__updateUiContentInfo(e){!(!e||!(e.videoTitle||e.videoSubtitle||e.videoAuthor||e.videoDescription||e.videoDuration||e.linkUrl))||this.__updateUiComponentsShown({contentInfoShown:!1}),this.__updateUiState("controls",{contentInfo:e})},__preloadSeekPreview(){const e=this._uiLayoutOptions.seekSource;e&&e.urls.forEach((e,t)=>{setTimeout(()=>{(new Image).src=e},1500*t)})},__updateUiPp(){this.__updateUiState("controls",{ppInContent:this._uiLayoutOptions.ppInContent})},__updateUiPlayPauseButton(){this.__updateUiState("controls",{playing:this.isPlaying()})},__updateUiVolume(){const e=this.getVolume(),t=!e||this.isMuted();this.__updateUiState("controls",{volume:e,volumeMuted:t})},__updateUiLiveInfo(){const e=this._uiState.controls.get().tvMode,t=this.isLive(),i=this.isEvent(),s=this.isLivePlaying(),n=this.isLiveStreaming();this.__updateUiState("controls",{isLive:t,isEvent:i,playingLive:s,streamingLive:n}),this.__updateUiState("overlays",{logoLive:s&&n&&!e})},__updateUiSeekingAvailability(){this.__updateUiState("controls",{seekingEnabled:this._uiLayoutOptions.seekingEnabled&&!this.isLive()})},__updateUiDuration(){this.__updateUiState("controls",{duration:this.getDuration()})},__updateUiCurrentTime(e={}){let t=this.getCurrentTime();"currentTime"in e&&(t=e.currentTime),this.__updateUiState("controls",{currentTime:t,buffered:this.getBuffered(t),startTime:this.getStartTime()||0})},__updateUiLoading(e={}){if("loading"in e){let t=e.loading;this.__updateUiState("controls",{loading:t}),t&&this.__updateUiControls({controlPanelShown:!0})}},__updateUiSubtitlesButton(){const e=this.getSupportedTextTracks(),t=!(!this._uiLayoutOptions.subtitlesEnabled||!e.length);this.__updateUiState("controls",{subtitlesEnabled:t})},__updateUiAudioTrackButton(){const e=this.getResolvedSource(),t=e&&"function"==typeof e.getAvailableTracks?e.getAvailableTracks(C.TYPE_AUDIO,this.isNative()):null;t&&t.length>1?this.__updateUiState("controls",{audioTrackVisible:!0,audioTrackEnabled:!0}):this.__updateUiState("controls",{audioTrackVisible:!1,audioTrackEnabled:!1})},__updateUiVideoTrackButton(){const e=this.getResolvedSource(),t=e&&"function"==typeof e.getAvailableTracks?e.getAvailableTracks(C.TYPE_VIDEO,this.isNative()):null;t&&t.length>1?this.__updateUiState("controls",{videoTrackVisible:!0,videoTrackEnabled:!0}):this.__updateUiState("controls",{videoTrackVisible:!1,videoTrackEnabled:!1})},__updateUiSubtitlesMenu(e={}){const t=this.getSupportedTextTracks();if(t.length){const e=t.map((e,t)=>({id:e.id,text:void 0===e.label?this._uiState.controls.get().textSubtitles+" "+(t+1):e.label})),i=this.getTextTrack();this.__updateUiState("controls",{subtitlesId:i,subtitlesList:e})}else this.__updateUiState("controls",{subtitlesId:-1,subtitlesList:[]});this.__updateUiSettingsButton(),"subtitlesMenuShown"in e&&this.__updateUiComponentsShown({subtitlesMenuShown:e.subtitlesMenuShown})},__updateUiAudioTrackMenu(e={}){const t=this.getResolvedSource(),i=t&&"function"==typeof t.getAvailableTracks?t.getAvailableTracks(C.TYPE_AUDIO,this.isNative()):null;if(i&&i.length){const e=i.map(e=>({id:e.getId(),text:e.getName()})),t=this.getTrack(C.TYPE_AUDIO);this.__updateUiState("controls",{audioTrackId:"number"==typeof t?t:-1,audioTrackList:e})}else this.__updateUiState("controls",{audioTrackId:-1,audioTrackList:[]});this.__updateUiSettingsButton(),"audioTrackMenuShown"in e&&this.__updateUiComponentsShown({audioTrackMenuShown:e.audioTrackMenuShown})},__updateUiVideoTrackMenu(e={}){const t=this.getResolvedSource(),i=t&&"function"==typeof t.getAvailableTracks?t.getAvailableTracks(C.TYPE_VIDEO,this.isNative()):null;if(i&&i.length){const e=i.map(e=>({id:e.getId(),text:e.getName()})),t=this.getTrack(C.TYPE_VIDEO);this.__updateUiState("controls",{videoTrackId:"number"==typeof t?t:-1,videoTrackList:e})}else this.__updateUiState("controls",{videoTrackId:-1,videoTrackList:[]});this.__updateUiSettingsButton(),"videoTrackMenuShown"in e&&this.__updateUiComponentsShown({videoTrackMenuShown:e.videoTrackMenuShown})},__updateUiSubtitlesIndication(e={}){let t=this._uiState.controls.get().subtitlesShown;"subtitlesShown"in e&&(t=e.subtitlesShown),this.__updateUiState("controls",{subtitlesShown:t})},__updateUiQualityButton(){const e=this.getResolvedSource(),t=!!(this._uiLayoutOptions.qualityEnabled&&e&&"function"==typeof e.getAvailableQualitySettings&&e.getAvailableQualitySettings(this.isNative()).length>1);this.__updateUiState("controls",{qualityEnabled:t})},__updateUiQualityMenu(e={}){const t=this.getResolvedSource();if(t&&"function"==typeof t.getAvailableQualitySettings){const e=t.getAvailableQualitySettings(this.isNative()),i=e.map(t=>{const i=e.some(e=>t.name===e.name&&t.idx!==e.idx);let s=t.name;return i&&t.framerate&&(s+=t.framerate.toString()),{id:t.idx,data:{resolution:t.resolution},text:""!==s?s:"Auto"}}),s=this.getQuality();this.__updateUiState("controls",{qualityId:s,qualities:i})}else this.__updateUiState("controls",{qualityId:-1,qualities:[]});this.__updateUiSettingsButton(),"qualityMenuShown"in e&&this.__updateUiComponentsShown({qualityMenuShown:e.qualityMenuShown})},__updateUiSettingsButton(){const e=this._uiState.controls.get(),t=!(!this._uiLayoutOptions.settingsEnabled||!(e.subtitlesList.length>0||e.qualities.length>1||e.videoTrackList.length>1||e.audioTrackList.length>1));this.__updateUiState("controls",{settingsEnabled:t})},__updateUiSettingsMenu(e={}){this.__updateUiSubtitlesMenu(),this.__updateUiQualityMenu(),this.__updateUiAudioTrackMenu(),this.__updateUiVideoTrackMenu(),"settingsMenuShown"in e&&(this.__updateUiComponentsShown({settingsMenuShown:e.settingsMenuShown}),this.__updateRootElement({settingsMenuShown:e.settingsMenuShown})),this._settingsResetTimeout=setTimeout(()=>{this.__updateUiComponentsShown({additionalMenuShown:!1,subtitlesMenuShown:!1,qualityMenuShown:!1,audioTrackMenuShown:!1,videoTrackMenuShown:!1})},250)},__updateUiAdditionalMenu(e={}){"additionalMenuShown"in e&&this.__updateUiState("controls",{additionalMenuShown:e.additionalMenuShown})},__updateUiCastMenu(e={}){"castMenuShown"in e&&this.__updateUiComponentsShown({castMenuShown:e.castMenuShown})},__updateUiFullscreenButton(){const e=this.isFullscreen(),t=this._uiLayoutOptions.fullscreenEnabled;this.__updateUiState("controls",{fullscreenOn:e,fullscreenEnabled:t})},__updateUiAdditionalButton(){const e=this._uiLayoutOptions.additionalEnabled;this.__updateUiState("controls",{additionalEnabled:e})},__updateUiPipButton(){const e=this._uiLayoutOptions.pipEnabled,t=this.isPipAvailable(),i=!!t&&this.isPipActive();this.__updateUiState("controls",{pipOn:i,pipAvailable:t,pipEnabled:e})},__updateUiAirPlayButton(){const e=this._uiLayoutOptions.airPlayEnabled,t=this.isAirPlayAvailable(),i=!!t&&this.isAirPlayActive();this.__updateUiState("controls",{airPlayOn:i,airPlayAvailable:t,airPlayEnabled:e})},__updateUiCinemaButton(){const e=this._uiLayoutOptions.cinemaEnabled,t=this.isCinemaAvailable(),i=!!t&&this.isCinemaActive();this.__updateUiState("controls",{cinemaOn:i,cinemaAvailable:t,cinemaEnabled:e})},__updateUiFollowing(e={}){"followingTeasers"in e&&(this._followingOptions.followingTeasers=e.followingTeasers),"followingPreviewShown"in e&&(this._followingOptions.followingPreviewShown=e.followingPreviewShown,e.followingPreviewShown&&this.__updateUiCloseAllComponents()),"transitionEnabled"in e&&(this._followingOptions.transitionEnabled=e.transitionEnabled),"transitionPreviewEnabled"in e&&(this._followingOptions.transitionPreviewEnabled=e.transitionPreviewEnabled),"transitionTimerShown"in e&&(this._followingOptions.transitionTimerShown=e.transitionTimerShown),"followingTimerTime"in e&&(this._followingOptions.followingTimerTime=e.followingTimerTime),"followingTimerProgress"in e&&(this._followingOptions.followingTimerProgress=e.followingTimerProgress),"timerCanceled"in e&&(this._followingOptions.timerCanceled=e.timerCanceled),"onTimerCancelClick"in e&&(this._followingOptions.onTimerCancelClick=e.onTimerCancelClick),this.__updateUiState("controls",{followingTeasers:this._followingOptions.followingTeasers,followingPreviewShown:this._followingOptions.followingPreviewShown,transitionEnabled:this._followingOptions.transitionEnabled,transitionPreviewEnabled:this._followingOptions.transitionPreviewEnabled,transitionTimerShown:this._followingOptions.transitionTimerShown,followingTimerTime:this._followingOptions.followingTimerTime,followingTimerProgress:this._followingOptions.followingTimerProgress,timerCanceled:this._followingOptions.timerCanceled,onTimerCancelClick:this._followingOptions.onTimerCancelClick})},__updateUiEpisodes(e={}){this.__updateUiState("controls",{episodesData:{selectData:e.selectData||[],listData:e.listData||[]}})},__updateUiTvProgram(e={}){this.__updateUiState("controls",{programmeData:{selectData:e.selectData||[],listData:e.listData||[]}})},__updateUiElementsVisibility(e={}){this._visibleUiElements=Object.assign(this._visibleUiElements,e),this.__updateUiState("controls",{visibleElements:this._visibleUiElements}),this.__updateUiState("overlays",{visibleElements:this._visibleUiElements}),this.__updateUiComponentsShown({followingShown:!1,programmeShown:!1})},__getVideoControlPanelIntersection(){const e=this.getVideoDimensions();return e?(this._adOnly?50:75)-e.y:0},__isControlPanelShown(){return this._uiState.controls.get().controlPanelShown},__isAnyComponentShown(){return!!(Object.keys(this._uiComponentsShown).filter(e=>this._uiComponentsShown[e]).length>0)},__updateUiVideoDimensions(){const e=this.getVideoDimensions();e&&this.__updateUiState("controls",{videoDimensions:e}),this.__updateUiControlPanelIntersectionHeight(),this.__updateInjections(this._veProcessor.getShown())},__updateUiControlPanelIntersectionHeight(){const e=this.__isControlPanelShown()?this.__getVideoControlPanelIntersection():0;this.__updateUiState("controls",{controlPanelIntersectionHeight:e})},__updateUiControls(e={}){if("controlPanelHovered"in e&&this.__updateUiState("controls",{controlPanelHovered:e.controlPanelHovered}),"splashInfoDisplayed"in e&&this.__updateUiState("controls",{splashInfoDisplayed:e.splashInfoDisplayed}),"controlPanelShown"in e){const t=this._uiState.controls.get(),i=t.controlPanelHovered,s=t.controlPanelFulltimeHidden,n=t.visibleElements.contentInfo,o=this.__isAnyComponentShown();if(!i&&!o&&!s||e.forceControlPanelUpdate){const t=e.controlPanelShown;this.__clearControlsHideTimeout(),t?(this.__updateUiState("controls",{controlPanelShown:!0,splashInfoDisplayed:!0}),this.__updateUiState("overlays",{controlPanelShown:!0}),this.__updateRootElement({controlPanel:!0}),"controlPanelShownLongTimeout"in e&&e.controlPanelShownLongTimeout?this.__startControlsHideTimeout(5e3):this.__startControlsHideTimeout(2500)):(this.__updateUiState("controls",{controlPanelShown:!1,splashInfoDisplayed:!1}),this.__updateUiState("overlays",{controlPanelShown:!1}),this.__updateUiComponentsShown({qualityMenuShown:!1,subtitlesMenuShown:!1,settingsMenuShown:!1,additionalMenuShown:!1,contentInfoShown:!1,castMenuShown:!1}),this.__updateRootElement({controlPanel:!1}))}else n&&(this.__clearControlsHideTimeout(),"controlPanelShownLongTimeout"in e&&e.controlPanelShownLongTimeout?this.__startControlsHideTimeout(5e3):this.__startControlsHideTimeout(2500));this.__updateUiControlPanelIntersectionHeight(),this.__updateInjections(this._veProcessor.getShown())}if("cursorVisible"in e){const t=!e.cursorVisible;this.__updateRootElement({cursor:!t})}},__updateInjections(e){this.__updateUiState("controls",{injections:e})},__updateAdPoints(e){this.__updateUiState("controls",{adPoints:e})},__updateUiContentEnded(){this.__updateUiState("controls",{isEnded:this._contentEnded}),this.__updateUiComponentsShown({followingShown:this._contentEnded}),this.__updateUiControls({controlPanelShown:!0})},__updateUiComponentsShown(e={}){this._uiComponentsShown=Object.assign(this._uiComponentsShown,e),this.__updateUiState("controls",{settingsMenuShown:this._uiComponentsShown.settingsMenuShown,subtitlesMenuShown:this._uiComponentsShown.subtitlesMenuShown,qualityMenuShown:this._uiComponentsShown.qualityMenuShown,audioTrackMenuShown:this._uiComponentsShown.audioTrackMenuShown,videoTrackMenuShown:this._uiComponentsShown.videoTrackMenuShown,additionalMenuShown:this._uiComponentsShown.additionalMenuShown,contentInfoShown:this._uiComponentsShown.contentInfoShown,followingShown:this._uiComponentsShown.followingShown,programmeShown:this._uiComponentsShown.programmeShown,chaptersShown:this._uiComponentsShown.chaptersShown,episodesShown:this._uiComponentsShown.episodesShown,castMenuShown:this._uiComponentsShown.castMenuShown})},__updateUiCloseAllComponents(){this.__updateUiComponentsShown({contentInfoShown:!1,aboutShown:!1,chaptersShown:!1,episodesShown:!1})},__startCheckingVideoProgress(){this._uiRaf.gettingVideoProgress||(this._uiRaf.gettingVideoProgress=requestAnimationFrame(()=>this.__checkVideoProgress()))},__checkVideoProgress(){this.__updateUiCurrentTime(),this._uiRaf.gettingVideoProgress=requestAnimationFrame(()=>this.__checkVideoProgress())},__stopCheckingVideoProgress(){cancelAnimationFrame(this._uiRaf.gettingVideoProgress),this._uiRaf.gettingVideoProgress=0},__clearControlsHideTimeout(){this._uiTimeout.controlsHide&&(clearTimeout(this._uiTimeout.controlsHide),this._uiTimeout.controlsHide=0)},__startControlsHideTimeout(e){this._uiTimeout.controlsHide=setTimeout(()=>{this._uiTimeout.controlsHide=0,this.__tryControlsHide()||this.__startControlsHideTimeout(e)},e)},__tryControlsHide(){return!!this.__canControlsHide()&&(this.__updateUiControls({controlPanelShown:!1,splashInfoDisplayed:!1,cursorVisible:!this.isFullscreen()}),!0)},__canControlsHide(){const e=this._uiState.controls.get(),t=this.__isAnyComponentShown();return(!e.useTouch||!t)&&!e.controlPanelHovered&&!e.loading&&e.playing},__updateRootElement(e={}){if("controlPanel"in e&&ts(this._uiDom.root).cssClasses({"-controls-active":e.controlPanel}),"cursor"in e&&ts(this._uiDom.root).cssClasses({"-cursor-hidden":!e.cursor}),"preventPauseOnClick"in e&&ts(this._uiDom.root).cssClasses({"-pointer":e.preventPauseOnClick}),"widthQuery"in e){const t=this._uiDom.root,i=t.className.split(" ").filter(e=>-1===e.lastIndexOf(Mo.PREFIX));t.className=i.join(" ").trim(),t.classList.add(e.widthQuery)}"settingsMenuShown"in e&&ts(this._uiDom.root).cssClasses({"-settings-open":e.settingsMenuShown})}};function Uo(e={}){const t=Xi(e);if("html"===t.constructor.getTechName()){const i=t.getElement();t.MP_ORIGIN=Symbol("MediaPlayerOrigin"),o.decorate(t,Ro,t.MP_ORIGIN),t.initUi(i,{adOnlyMode:!!e.adOnlyMode,audioOnlyMode:!!e.audioOnlyMode,customCinemaMode:!!e.customCinemaMode})}return t}var Vo={indicator:"#DE0000",progressBarDefault:"#DE0000",progressBarAdvert:"#FFDE00"},Bo={indicator:"#A9A9A9",progressBarDefault:"#A9A9A9",progressBarAdvert:"#A9A9A9"},Fo={indicator:"#FF3131",progressBarDefault:"#FF3131",progressBarAdvert:"#FFDE00"};const Ho=new m.ErrorFactory(m.createSourceName("src/js/richmediaplayer/ui/UiAgent.js"));class Go extends S{constructor(e=""){super(),this._player=null,this._dialogScreen=null,this._container=document.createElement("div"),this._displayingDialog=!1,this._eventsMap=new Map,e&&this._container.classList.add(e)}getElement(){return this._container}isDialogActive(){return this._displayingDialog}setPlayer(e){this._player=e,this._container.appendChild(e.getElement())}setDialogScreen(e){const t=e.constructor;this._eventsMap=new Map([[t.EVENT_REPLAY_REQUEST,this._handleReplayRequest],[t.EVENT_VIDEO_CLICKTHROUGH,this._handleVideoClickthrough]]),this.bindAll(this._eventsMap),this.addListeners(e,this._eventsMap),this._dialogScreen=e,this._container.appendChild(e.getElement())}showDialog(e){if(!this._dialogScreen)throw Ho.createError(m.SETTING,"DialogScreen must be specified.");if(!e)throw Ho.createError(m.SETTING,"Argument options must be specified.");if("object"!=typeof e)throw Ho.createError(m.SETTING,"Argument options must be an object.");if(!this._dialogScreen.isLayoutSupported(e.kind))throw Ho.createError(m.SETTING,`Dialog kind "${e.kind}" isn't supported.`);this._player&&("stop"!==e.kind?(this._player.hide(),this._dialogScreen.show(e.kind,e),this._displayingDialog=!0):this._player.setContentEnded(!0))}hideDialog(){this._dialogScreen&&(this._dialogScreen.hideAll(),this._player&&this._player.show(),this._displayingDialog=!1,this._player.setContentEnded(!1))}_handleReplayRequest(){this.emit(Go.EVENT_REPLAY_REQUEST)}_handleVideoClickthrough(e){this.emit(Go.EVENT_VIDEO_CLICKTHROUGH,e)}}Go.EVENT_REPLAY_REQUEST="replayrequest",Go.EVENT_VIDEO_CLICKTHROUGH="videoclickthrough";var jo={REPLAY_REQUEST:"replay-request",VIDEO_CLICKTHROUGH:"video-clickthrough"};class qo extends fs{constructor(e){super(e),this._dom={root:null,refs:{articleBox:null}},this._component={article:null}}uiGetDeclaredProps(){return{displayed:"boolean",title:"string",content:"string"}}_onUiInit(e){this._component.article=new Kn(this.__getPropsForArticle(e))}_onUiBuild(e){this._dom.root=es("div",{className:"c-DialogScreen"}),this._dom.refs.articleBox=es("div",{className:"w-DialogArticle"}),ts(this._dom.root).append(ts(this._dom.refs.articleBox).append(this._component.article.uiGetElement())),this.__setDisplayed(e.displayed)}_onUiUpdate(e){this.__setDisplayed(e.displayed),this._component.article.uiUpdate(this.__getPropsForArticle(e))}_onUiDestroy(){}__setDisplayed(e){ts(this._dom.root).setDisplayed(e)}__getPropsForArticle(e){const{title:t,content:i}=e;return{title:t,content:i}}}const Qo={displayed:!1,title:"",content:""};class Yo extends to{constructor(){super(Qo)}}class zo extends fs{constructor(e){super(e),this._dom={root:null,refs:{iconContainer:null,icon:null,text:null}}}uiGetDeclaredProps(){return{indicator:"boolean",text:"string"}}uiGetDefaultProps(){return{indicator:!0,text:""}}_onUiBuild(e){this._dom.root=es("span",{className:"c-AdIconCaption"}),this._dom.refs.icon=Ns("play","#dadada"),this._dom.refs.iconContainer=es("span",{className:"c-AdIconCaption__icon"}),this._dom.refs.text=es("span",{className:"c-AdIconCaption__text"}),ts(this._dom.root).append(ts(this._dom.refs.iconContainer).append(this._dom.refs.icon),this._dom.refs.text),this.__setText(e.text)}_onUiUpdate(e){this._props.text!=e.text&&this.__setText(e.text)}__setText(e){this._dom.refs.text.innerHTML=e}}class Wo extends fs{constructor(e){super(e),this._dom={root:null,refs:{adWrapper:null,captionBox:null,content:null,replayWrapper:null,replayIconBox:null,replayTextBox:null}},this._component={caption:null,replayIconButton:null,replayTextButton:null},this._bind=["__onRelayButtonClick"]}uiGetDeclaredProps(){return{displayed:"boolean",type:"string",caption:"string",content:["string","object"],im:"object",textReplay:"string"}}_onUiInit(e){this._component.caption=new zo(this.__getPropsForAdIconCaption(e)),this._component.replayIconButton=new Os(this.__getPropsForReplayIconButton(e)),this._component.replayTextButton=new sn(this.__getPropsForReplayTextButton(e))}_onUiBuild(e){this._dom.root=es("div",{className:`c-AdScreen -${e.type}`}),this._dom.refs.adWrapper=es("div",{className:"w-AdScreenContainer"}),this._dom.refs.captionBox=es("div",{className:"w-AdScreenCaption"}),this._dom.refs.content=es("div",{className:"w-AdScreenContent"}),this._dom.refs.replayWrapper=es("div",{className:"w-AdScreenReplay"}),this._dom.refs.replayIconBox=es("div",{className:"w-AdScreenReplayIcon"}),this._dom.refs.replayTextBox=es("div",{className:"w-AdScreenReplayText"}),ts(this._dom.root).append(ts(this._dom.refs.adWrapper).append(ts(this._dom.refs.captionBox).append(this._component.caption.uiGetElement()),this._dom.refs.content),ts(this._dom.refs.replayWrapper).append(ts(this._dom.refs.replayIconBox).append(this._component.replayIconButton.uiGetElement()),ts(this._dom.refs.replayTextBox).append(this._component.replayTextButton.uiGetElement()))),this.__setContent(e),this.__setDisplayed(e.displayed)}_onUiUpdate(e){this.__setDisplayed(e.displayed),this._component.caption.uiUpdate(this.__getPropsForAdIconCaption(e)),this._component.replayIconButton.uiUpdate(this.__getPropsForReplayIconButton(e)),this._component.replayTextButton.uiUpdate(this.__getPropsForReplayTextButton(e)),this.__setContent(e)}_onUiDestroy(){}__setDisplayed(e){ts(this._dom.root).setDisplayed(e)}__setContent(e){if("object"==typeof e.content){this._dom.refs.adWrapper.classList.add("w-AdScreenIframe");let t=document.createElement("div");t.id="w-AdScreenIframeId",t.classList.add("w-AdScreenContainer"),this._dom.refs.content.appendChild(t),null!=e.im&&e.im.writeAd(e.content,{id:t.id})}else this._dom.refs.content.innerHTML=e.content}__getPropsForAdIconCaption(e){return{indicator:!0,text:e.caption}}__getPropsForReplayIconButton(e){return{displayed:!0,titleEnabled:e.textReplay,iconProps:{reload:{displayed:!0}},onClick:this.__onRelayButtonClick}}__getPropsForReplayTextButton(e){return{text:e.textReplay,onClick:this.__onRelayButtonClick}}__onRelayButtonClick(){this._uiEmitEvent(jo.REPLAY_REQUEST)}}const Ko={displayed:!1,type:"commercial-message",caption:"",content:"",textReplay:"Přehrát znovu"};class $o extends to{constructor(){super(Ko)}}var Xo={track(e,t){const i=Object.assign({CACHEBUSTING:String(Math.random()).slice(-8)},t);for(let t=e.length-1;t>=0;t--){const s=this.resolveUrlTemplate(e[t],i);(new Image).src=s}},resolveUrlTemplate(e,t){let i=e;for(const e of Object.keys(t)){const s=`[${e}]`;try{const n=encodeURIComponent(t[e]);i=i.replace(s,n)}catch(e){}}return i}};class Zo extends fs{constructor(e){super(e),this._dom={root:null,refs:{clickthroughContainer:null,posterWrapper:null,poster:null,replayWrapper:null,replayIconBox:null,replayTextBox:null}},this._component={clickthroughLink:null,actionArea:null,replayIconButton:null},this._bind=["__onClickThroughLinkClick","__onActionAreaClick","__onReplayButtonClick"]}uiGetDeclaredProps(){return{displayed:"boolean",currentTime:"number",currentSrc:"string",displayed:"boolean",poster:"string",textReplay:"string",textAdWeb:"string",clickthroughUrl:"string",clickthroughTarget:"string",clickthroughTracking:"object"}}_onUiInit(e){this._component.clickthroughLink=new Ms(this.__getPropsForClickthroughLink(e)),this._component.actionArea=new Ds(this.__getPropsForActionArea(e)),this._component.replayIconButton=new Os(this.__getPropsForReplayIconButton(e))}_onUiBuild(e){this._dom.root=es("div",{className:"c-AdStopScreen"}),this._dom.refs.clickthroughContainer=es("div",{className:"w-AdStopScreenClickthrough"}),this._dom.refs.poster=es("img",{className:"w-AdStopScreenPoster"}),this._dom.refs.replayWrapper=es("div",{className:"w-AdStopScreenReplay"}),this._dom.refs.replayIconBox=es("div",{className:"w-AdStopScreenReplay__icon"}),ts(this._dom.root).append(this._dom.refs.poster,this._component.actionArea.uiGetElement(),ts(this._dom.refs.clickthroughContainer).append(this._component.clickthroughLink.uiGetElement()),ts(this._dom.refs.replayWrapper).append(ts(this._dom.refs.replayIconBox).append(this._component.replayIconButton.uiGetElement()))),this.__setPoster(e.poster),this.__setDisplayed(e.displayed)}_onUiUpdate(e){this.__setDisplayed(e.displayed),this._component.clickthroughLink.uiUpdate(this.__getPropsForClickthroughLink(e)),this._component.actionArea.uiUpdate(this.__getPropsForActionArea(e)),this._component.replayIconButton.uiUpdate(this.__getPropsForReplayIconButton(e)),this.__setPoster(e.poster)}_onUiDestroy(){}__setDisplayed(e){ts(this._dom.root).setDisplayed(e)}__setPoster(e){e?(ts(this._dom.refs.poster).setDisplayed(!0),this._dom.refs.poster.src=e):ts(this._dom.refs.poster).setDisplayed(!1)}__getPropsForClickthroughLink(e){return{fullSizeLook:!0,displayed:!!e.clickthroughUrl,labelDisplayed:!0,href:e.clickthroughUrl,target:e.clickthroughTarget||"_blank",text:e.textAdWeb,onClick:this.__onClickThroughLinkClick}}__getPropsForActionArea(e){return{displayed:!0,onClick:this.__onActionAreaClick}}__getPropsForReplayIconButton(e){return{displayed:!0,titleEnabled:e.textReplay,iconProps:{reload:{displayed:!0}},onClick:this.__onReplayButtonClick}}__onClickThroughLinkClick(){const e=this._props.clickthroughTracking;e&&e.length&&Xo.track(e,{ASSETURI:this._props.currentSrc,CONTENTPLAYHEAD:zi.getFormattedTime(this._props.currentTime)}),this._uiEmitEvent(jo.CLICK_ON_CLICKTHROUGH_LINK)}__onActionAreaClick(){this._uiEmitEvent(jo.REPLAY_REQUEST)}__onReplayButtonClick(){this._uiEmitEvent(jo.REPLAY_REQUEST)}}const Jo={displayed:!1,poster:"",textReplay:"Přehrát znovu",textAdWeb:"Zjistit více",clickthroughUrl:"",clickthroughTarget:""};class er extends to{constructor(){super(Jo)}}class tr extends fs{constructor(e){super(e),this._dom={root:null,refs:{posterWrapper:null,poster:null,replayWrapper:null,replayIconBox:null,replayTextBox:null}},this._component={actionArea:null,replayIconButton:null},this._bind=["__onActionAreaClick","__onRelayButtonClick"]}uiGetDeclaredProps(){return{displayed:"boolean",poster:"string",textReplay:"string"}}_onUiInit(e){this._component.actionArea=new Ds(this.__getPropsForActionArea(e)),this._component.replayIconButton=new Os(this.__getPropsForReplayIconButton(e))}_onUiBuild(e){this._dom.root=es("div",{className:"sznp-stop-screen"}),this._dom.refs.posterWrapper=es("div",{className:"sznp-stop-screen-poster-wrapper sznp-arph"}),this._dom.refs.poster=es("img",{className:"sznp-stop-screen-poster sznp-bg-img"}),this._dom.refs.replayWrapper=es("div",{className:"sznp-stop-replay-wrapper"}),this._dom.refs.replayIconBox=es("div",{className:"sznp-ui-widget-box sznp-stop-replay-icon"}),ts(this._dom.root).append(ts(this._dom.refs.posterWrapper).append(this._dom.refs.poster),this._component.actionArea.uiGetElement(),ts(this._dom.refs.replayWrapper).append(ts(this._dom.refs.replayIconBox).append(this._component.replayIconButton.uiGetElement()))),this.__setPoster(e.poster),this.__setDisplayed(e.displayed)}_onUiUpdate(e){this.__setDisplayed(e.displayed),this._component.actionArea.uiUpdate(this.__getPropsForActionArea(e)),this._component.replayIconButton.uiUpdate(this.__getPropsForReplayIconButton(e)),this.__setPoster(e.poster)}_onUiDestroy(){}__setDisplayed(e){ts(this._dom.root).setDisplayed(e)}__setPoster(e){e?(ts(this._dom.refs.poster).setDisplayed(!0),this._dom.refs.poster.src=e):ts(this._dom.refs.poster).setDisplayed(!1)}__getPropsForActionArea(e){return{displayed:!0,onClick:this.__onActionAreaClick}}__getPropsForReplayIconButton(e){return{displayed:!0,titleEnabled:e.textReplay,iconProps:{reload:{displayed:!0}},onClick:this.__onRelayButtonClick}}__onActionAreaClick(){this._uiEmitEvent(jo.REPLAY_REQUEST)}__onRelayButtonClick(){this._uiEmitEvent(jo.REPLAY_REQUEST)}}const ir={displayed:!1,poster:"",textReplay:"Přehrát znovu"};class sr extends to{constructor(){super(ir)}}class nr extends fs{constructor(e){super(e),this._dom={root:null,refs:{articleBox:null,link:null}},this._component={article:null}}uiGetDeclaredProps(){return{displayed:"boolean",title:"string",content:"string",linkUrl:"string",linkTitle:"string",linkTarget:"string"}}_onUiInit(e){this._component.article=new Kn(this.__getPropsForArticle(e))}_onUiBuild(e){this._dom.root=es("div",{className:"c-PromoScreen"}),this._dom.refs.articleBox=es("div",{className:"w-PromoArticle"}),this._dom.refs.link=es("a",{className:"c-PromoArticleLink"}),ts(this._dom.root).append(ts(this._dom.refs.articleBox).append(this._component.article.uiGetElement(),this._dom.refs.link)),this.__setDisplayed(e.displayed),this.__setLinkHref(e),this.__setLinkTitle(e)}_onUiUpdate(e){this.__setDisplayed(e.displayed),this._props.linkUrl===e.linkUrl&&this._props.linkTarget===e.linkTarget||this.__setLinkHref(e),this._props.linkTitle!==e.linkTitle&&this.__setLinkTitle(e),this._component.article.uiUpdate(this.__getPropsForArticle(e))}_onUiDestroy(){}__setDisplayed(e){ts(this._dom.root).setDisplayed(e)}__setLinkHref(e){ts(this._dom.refs.link).setAttr({href:e.linkUrl,target:e.linkTarget})}__setLinkTitle(e){ts(this._dom.refs.link).setInnerHTML(e.linkTitle)}__getPropsForArticle(e){const{title:t,content:i}=e;return{title:t,content:i}}}const or={displayed:!1,title:"",content:"",linkUrl:"",linkTitle:"",linkTarget:"_blank"};class rr extends to{constructor(){super(or)}}let ar=new m.ErrorFactory(m.createSourceName("src/js/richmediaplayer/ui/dialogscreen/DialogScreen.js"));class lr extends S{constructor(){super(),this._dom={root:es("div",{className:"w-Dialog"})},this._uiState={},this._ui={},this._uiEventEmitter=new E,this._uiEventsMap=new Map([[jo.REPLAY_REQUEST,this.__onUiReplayRequest],[jo.VIDEO_CLICKTHROUGH,this.__onClickThroughLinkClick]]),this.bindAll(this._uiEventsMap),this.__setDisplayed(!1)}getElement(){return this._dom.root}isLayoutSupported(e){return e===lr.layout.AD||e===lr.layout.ALERT||e===lr.layout.ADSTOP||e===lr.layout.PROMO||e===lr.layout.STOP}show(e,t){if(!this.isLayoutSupported(e))throw ar.createError(m.SETTING,`There is'nt layout "${e}".`);this.hideAll(),this._ui[e]||(this.__createLayout(e),this.__buildUi(e)),t.displayed=!0,this.__setDisplayed(!0),this.__updateUiState(e,this.__getPropsForLayout(e,t))}hide(e){this.__updateUiState(e,{displayed:!1})}hideAll(){for(const e of Object.keys(this._ui))this.hide(e);this.__setDisplayed(!1)}destroy(){this.removeListeners(this._uiEventEmitter,this._uiEventsMap),this._ui.alert&&this._ui.alert.uiDestroy(),this._ui.ad&&this._ui.ad.uiDestroy(),this._ui.stop&&this._ui.stop.uiDestroy(),this._ui.adstop&&this._ui.adstop.uiDestroy(),this._ui.promo&&this._ui.promo.uiDestroy(),ts(this._dom.root).clear()}__setDisplayed(e){ts(this._dom.root).setDisplayed(e)}__createLayout(e){e===lr.layout.ALERT?(this._uiState.alert=new Yo,this._ui.alert=new qo(this._uiState.alert.get())):e===lr.layout.AD?(this._uiState.ad=new $o,this._ui.ad=new Wo(this._uiState.ad.get())):e===lr.layout.STOP?(this._uiState.stop=new sr,this._ui.stop=new tr(this._uiState.stop.get())):e===lr.layout.PROMO?(this._uiState.promo=new rr,this._ui.promo=new nr(this._uiState.promo.get())):e===lr.layout.ADSTOP&&(this._uiState.adStop=new er,this._ui.adStop=new Zo(this._uiState.adStop.get()))}__buildUi(e){this.addListeners(this._uiEventEmitter,this._uiEventsMap),this._ui[e].uiInit(),this._ui[e].uiSetEventEmitter(this._uiEventEmitter),this._ui[e].uiBuild(),ts(this._dom.root).append(this._ui[e].uiGetElement())}__updateUiState(e,t){this._uiState[e].update(t),this._ui[e].uiUpdate(this._uiState[e].get())}__getPropsForLayout(e,t){if(e===lr.layout.ALERT){const{displayed:e,title:i,content:s}=t;return{displayed:e,title:i,content:s}}if(e===lr.layout.AD){const{displayed:e,caption:i,content:s,im:n}=t;return{displayed:e,caption:i,content:s,im:n}}if(e===lr.layout.STOP){const{displayed:e,poster:i}=t;return{displayed:e,poster:i||""}}if(e===lr.layout.PROMO){const{displayed:e,title:i,content:s,linkUrl:n,linkTitle:o,linkTarget:r}=t;return{displayed:e,title:i,content:s,linkUrl:n||"",linkTitle:o||"",linkTarget:r||""}}if(e===lr.layout.ADSTOP){const{displayed:e,poster:i,currentSrc:s,currentTime:n,adUrl:o,adUrlTarget:r,adUrlTracking:a}=t;return{displayed:e,currentSrc:s,currentTime:n,poster:i||"",clickthroughUrl:o||"",clickthroughTarget:r||"_blank",clickthroughTracking:a||[]}}}__onClickThroughLinkClick(e){this.emit(lr.EVENT_VIDEO_CLICKTHROUGH,e)}__onUiReplayRequest(){this.emit(lr.EVENT_REPLAY_REQUEST)}}lr.layout={AD:"ad",ADSTOP:"adStop",ALERT:"alert",PROMO:"promo",STOP:"stop"},lr.EVENT_REPLAY_REQUEST="replayrequest",lr.EVENT_VIDEO_CLICKTHROUGH="videoclickthrough";new m.ErrorFactory(m.createSourceName("src/js/richmediaplayer/StrategyPlayer.js"));class hr extends X{static getTechName(){}static isSupported(){}static canPlayType(e){}static canPlaySource(e){}static _setDisplayed(e,t){t?e.classList.remove("-hidden"):e.classList.add("-hidden")}constructor(e,t,i,s){super(e,t,i,s),this._players={},this._strategy=null,this._strategyName=null,this._container=document.createElement("div"),this._eventsMap=new Map([[X.EVENT_ERROR,this._propEvent.bind(this,X.EVENT_ERROR)],[X.EVENT_WARNING,this._propEvent.bind(this,X.EVENT_WARNING)],[X.EVENT_READY,this._propEvent.bind(this,X.EVENT_READY)],[X.EVENT_SOURCE_SET,this._propEvent.bind(this,X.EVENT_SOURCE_SET)],[X.EVENT_SOURCE_READY,this._propEvent.bind(this,X.EVENT_SOURCE_READY)],[X.EVENT_LOAD_START,this._propEvent.bind(this,X.EVENT_LOAD_START)],[X.EVENT_LOADED_META,this._propEvent.bind(this,X.EVENT_LOADED_META)],[X.EVENT_LOADED_DATA,this._propEvent.bind(this,X.EVENT_LOADED_DATA)],[X.EVENT_LOADED_SEGMENT,this._propEvent.bind(this,X.EVENT_LOADED_SEGMENT)],[X.EVENT_DURATION_CHANGE,this._propEvent.bind(this,X.EVENT_DURATION_CHANGE)],[X.EVENT_CAN_PLAY,this._propEvent.bind(this,X.EVENT_CAN_PLAY)],[X.EVENT_PLAY,this._propEvent.bind(this,X.EVENT_PLAY)],[X.EVENT_PLAY_DENIED,this._propEvent.bind(this,X.EVENT_PLAY_DENIED)],[X.EVENT_PLAYING,this._propEvent.bind(this,X.EVENT_PLAYING)],[X.EVENT_PAUSED,this._propEvent.bind(this,X.EVENT_PAUSED)],[X.EVENT_ENDED,this._propEvent.bind(this,X.EVENT_ENDED)],[X.EVENT_TIMEUPDATE,this._propEvent.bind(this,X.EVENT_TIMEUPDATE)],[X.EVENT_PLAYBACK_PROGRESS,this._propEvent.bind(this,X.EVENT_PLAYBACK_PROGRESS)],[X.EVENT_SEEKSTART,this._propEvent.bind(this,X.EVENT_SEEKSTART)],[X.EVENT_SEEKING,this._propEvent.bind(this,X.EVENT_SEEKING)],[X.EVENT_SEEKED,this._propEvent.bind(this,X.EVENT_SEEKED)],[X.EVENT_TEXT_SOURCE_SET,this._propEvent.bind(this,X.EVENT_TEXT_SOURCE_SET)],[X.EVENT_TEXT_TRACK_SET,this._propEvent.bind(this,X.EVENT_TEXT_TRACK_SET)],[X.EVENT_QUALITY_SET,this._propEvent.bind(this,X.EVENT_QUALITY_SET)],[X.EVENT_UI_RESIZE,this._propEvent.bind(this,X.EVENT_UI_RESIZE)],[X.EVENT_QUALITY_CHANGE,this._propEvent.bind(this,X.EVENT_QUALITY_CHANGE)],[X.EVENT_TRACK_SET,this._propEvent.bind(this,X.EVENT_TRACK_SET)],[X.EVENT_VOLUME_CHANGE,this._propEvent.bind(this,X.EVENT_VOLUME_CHANGE)],[X.EVENT_FULLSCREEN_CHANGE,this._propEvent.bind(this,X.EVENT_FULLSCREEN_CHANGE)],[X.EVENT_PIP_CHANGE,this._propEvent.bind(this,X.EVENT_PIP_CHANGE)],[X.EVENT_CINEMA_CHANGE,this._propEvent.bind(this,X.EVENT_CINEMA_CHANGE)],[X.EVENT_AP_CHANGE,this._propEvent.bind(this,X.EVENT_AP_CHANGE)],[X.EVENT_CUE_CHANGE,this._propEvent.bind(this,X.EVENT_CUE_CHANGE)],[X.EVENT_LIVE_PLAYING_CHANGE,this._propEvent.bind(this,X.EVENT_LIVE_PLAYING_CHANGE)],[X.EVENT_LIVE_STREAMING_CHANGE,this._propEvent.bind(this,X.EVENT_LIVE_STREAMING_CHANGE)],[X.EVENT_ABORT,this._propEvent.bind(this,X.EVENT_ABORT)],[X.EVENT_PROGRESS,this._propEvent.bind(this,X.EVENT_PROGRESS)],[X.EVENT_LOADING_FAILED,this._propEvent.bind(this,X.EVENT_LOADING_FAILED)],[X.EVENT_BUFFER_EMPTY,this._propEvent.bind(this,X.EVENT_BUFFER_EMPTY)],[X.EVENT_SKIP_VIDEO_REQUEST,this._propEvent.bind(this,X.EVENT_SKIP_VIDEO_REQUEST)],[X.EVENT_CANCEL_AD_REQUEST,this._propEvent.bind(this,X.EVENT_CANCEL_AD_REQUEST)],[X.EVENT_VIDEO_CLICKTHROUGH,this._propEvent.bind(this,X.EVENT_VIDEO_CLICKTHROUGH)],[X.EVENT_ACTION_CLICKTHROUGH,this._propEvent.bind(this,X.EVENT_ACTION_CLICKTHROUGH)],[X.EVENT_ACTION_BACK,this._propEvent.bind(this,X.EVENT_ACTION_BACK)],[X.EVENT_ACTION_CONTENT_LINK,this._propEvent.bind(this,X.EVENT_ACTION_CONTENT_LINK)],[X.EVENT_VE_DISPLAYED,this._propEvent.bind(this,X.EVENT_VE_DISPLAYED)],[X.EVENT_VE_HIDDEN,this._propEvent.bind(this,X.EVENT_VE_HIDDEN)],[X.EVENT_VE_CLICK,this._propEvent.bind(this,X.EVENT_VE_CLICK)],[X.EVENT_VE_CLOSE,this._propEvent.bind(this,X.EVENT_VE_CLOSE)],[X.EVENT_VE_ERROR,this._propEvent.bind(this,X.EVENT_VE_ERROR)],[X.EVENT_USER_ACCEPT_INVITATION,this._propEvent.bind(this,X.EVENT_USER_ACCEPT_INVITATION)],[X.EVENT_USER_MINIMIZE,this._propEvent.bind(this,X.EVENT_USER_MINIMIZE)],[X.EVENT_USER_CLOSE,this._propEvent.bind(this,X.EVENT_USER_CLOSE)],[X.EVENT_IMPRESSION,this._propEvent.bind(this,X.EVENT_IMPRESSION)],[X.EVENT_SKIPPABLE_STATE_CHANGE,this._propEvent.bind(this,X.EVENT_SKIPPABLE_STATE_CHANGE)],[X.EVENT_DESTROYING,this._propEvent.bind(this,X.EVENT_DESTROYING)],[X.EVENT_REPLAY_REQUEST,this._propEvent.bind(this,X.EVENT_REPLAY_REQUEST)]]),this._container.classList.add("w-MediaPlayer")}registerStrategy(e,t){const i=t.getElement();this._players[e]=t,hr._setDisplayed(i,!1),this._container.appendChild(i)}switchStrategy(e){"vpaid"!==e&&this._strategy===this._players[e]||(this._strategy&&(this.removeListeners(this._strategy,this._eventsMap),hr._setDisplayed(this._strategy.getElement(),!1),this._strategy.reset()),this._syncPlayer(this._players[e]),this._strategy=this._players[e],this._strategyName=e,hr._setDisplayed(this._strategy.getElement(),!0),this.addListeners(this._strategy,this._eventsMap))}getStrategyName(){return this._strategyName}destroy(){this._strategy.destroy()}getElement(){return this._container}getPlayerId(){return this._strategy.getPlayerId()}getSource(){return this._strategy.getSource()}getResolvedSource(){return this._strategy.getResolvedSource()}getCurrentSrc(){return this._strategy.getCurrentSrc()}getCurrentAdaptiveSrc(){return this._strategy.getCurrentAdaptiveSrc()}getCurrentQualityItem(){return this._strategy.getCurrentQualityItem()}getTextSource(){return this._strategy.getTextSource()}getSupportedTextTracks(){return this._strategy.getSupportedTextTracks()}getTextTrack(){return this._strategy.getTextTrack()}getPoster(){return this._strategy.getPoster()}getQuality(){return this._strategy.getQuality()}getPreparedSource(e,t,i=null){return this._strategy.getPreparedSource(e,t,i)}getVideoWidth(){return this._strategy.getVideoWidth()}getVideoHeight(){return this._strategy.getVideoHeight()}getVideoDimensions(){return this._strategy.getVideoDimensions()}getElementDimensions(){return this._strategy.getElementDimensions()}getVolume(){return this._strategy.getVolume()}getCurrentTime(){return this._strategy.getCurrentTime()}getStartTime(){return this._strategy.getStartTime()}getDuration(){return this._strategy.getDuration()}getBuffered(e){return this._strategy.getBuffered(e)}getStatsHistory(){return this._strategy.getStatsHistory()}getTrack(e){return this._strategy.getTrack(e)}getCurrentFrame(e){return this._strategy.getCurrentFrame(e)}isCustomUiCapable(){return this._strategy.isCustomUiCapable()}isReady(){return this._strategy&&this._strategy.isReady()}isSourceReady(){return this._strategy.isSourceReady()}isAdaptiveSource(){return this._strategy.isAdaptiveSource()}isMuted(){return this._strategy.isMuted()}isPlaying(){return this._strategy.isPlaying()}isPaused(){return this._strategy.isPaused()}isEnded(){return this._strategy.isEnded()}isBufferEmpty(){return this._strategy.isBufferEmpty()}isLive(){return this._strategy.isLive()}isEvent(){return this._strategy.isEvent()}isLivePlaying(){return this._strategy.isLivePlaying()}isLiveStreaming(){return this._strategy.isLiveStreaming()}isFullscreen(){return this._strategy.isFullscreen()}isPipActive(){return this._strategy.isPipActive()}isCinemaActive(){return this._strategy.isCinemaActive()}isAirPlayActive(){return this._strategy.isAirPlayActive()}hasTextTrack(e){return this._strategy.hasTextTrack(e)}setSourcePreload(e){this._strategy.setSourcePreload(e)}setSource(e,t=null){this._strategy.setSource(e,t)}setTextSource(e){this._strategy.setTextSource(e)}setTextTrack(e=null){this._strategy.setTextTrack(e)}setLocalizedTexts(e){this._strategy.setLocalizedTexts(e)}setPoster(e){this._strategy.setPoster(e)}setQuality(e){this._strategy.setQuality(e)}setVolume(e){this._strategy.setVolume(e)}setMute(e){this._strategy.setMute(e)}setAdPoints(e){this._strategy.setAdPoints(e)}setAudioList(e){this._strategy.setAudioList(e)}addStats(e){this._strategy.addStats(e)}setContentEnded(e){this._strategy.setContentEnded(e)}showControls(e){this._strategy.showControls(e)}closeMenu(){return this._strategy.closeMenu()}play(){this._strategy.play()}pause(){this._strategy.pause()}seek(e){this._strategy.seek(e)}seekToLive(){this._strategy.seekToLive()}skip(){this._strategy.skip()}setViewMode(e){this._strategy.setViewMode(e)}resetSource(){this._strategy.resetSource()}reset(){this._strategy.reset()}show(){this._strategy.show()}hide(){this._strategy.hide()}setLogo(e){this._strategy.setLogo(e)}showLogo(){this._strategy.showLogo()}hideLogo(){this._strategy.hideLogo()}setActionArea(e){this._strategy.setActionArea(e)}setNoPauseOnClick(e){this._strategy.setNoPauseOnClick(e)}setDefaultLayout(e){this._strategy.setDefaultLayout(e)}setAdvertLayout(e){this._strategy.setAdvertLayout(e)}showPp(){this._strategy.showPp()}hidePp(){this._strategy.hidePp()}setControlsHidden(e){this._strategy.setControlsHidden(e)}setUiFollowing(e={}){this._strategy.setUiFollowing(e)}setUiEpisodes(e={}){this._strategy.setUiEpisodes(e)}setUiTvProgram(e={}){this._strategy.setUiTvProgram(e)}setVisibleUiElements(e={}){this._strategy.setVisibleUiElements(e)}resetVisibleUiElements(){this._strategy.resetVisibleUiElements()}setContentInfo(e={}){this._strategy.setContentInfo(e)}resetContentInfo(){this._strategy.resetContentInfo()}canRunVisualElementType(e,t=!1){return this._strategy.canRunVisualElementType(e,t)}getVisualElements(){return this._strategy.getVisualElements()}addVisualElement(e){this._strategy.addVisualElement(e)}removeVisualElement(e){this._strategy.removeVisualElement(e)}removeVisualElements(){this._strategy.removeVisualElements()}setVisualElementDefaultPosition(e,t){this._strategy.setVisualElementDefaultPosition(e,t)}isVisualElementShown(e){return this._strategy.isVisualElementShown(e)}showVisualElement(e){this._strategy.showVisualElement(e)}showVisualElementClose(e){this._strategy.showVisualElementClose(e)}hideVisualElement(e){this._strategy.hideVisualElement(e)}abortVisualElement(e){this._strategy.hideVisualElement(e)}canConfigureFullscreen(){return this._strategy.canConfigureFullscreen()}configureFullscreen(e){this._strategy.configureFullscreen(e)}enterFullscreen(){this._strategy.enterFullscreen()}exitFullscreen(){this._strategy.exitFullscreen()}enterCinema(){this._strategy.enterCinema()}exitCinema(){this._strategy.exitCinema()}showAirPlayTargetPicker(){this._strategy.showAirPlayTargetPicker()}focusPlayButton(){this._strategy.focusPlayButton()}_syncPlayer(e){if(!this._strategy)return;e.setViewMode(this._strategy.isFullscreen()?"fullscreen":"normal");const t=this._strategy.getStatsHistory();t.length&&e.addStats(t[t.length-1]);const i=this._strategy.getVolume(),s=this._strategy.isMuted(),n=this._strategy.getVisibleUiElements();e.setVolume(i),e.setMute(s),e.setVisibleUiElements(n)}_propEvent(e,t=null){this.emit(e,t)}}class _r{constructor(){this._currentTime=0,this._totalTime=0,this._wasInterrupted=!1,this._uninterruptedSince=0}start(e=null){this._currentTime=e||0,this._totalTime=0,this._uninterruptedSince=0,this._wasInterrupted=!1}update(e){this._wasInterrupted?(this._currentTime=e,this._uninterruptedSince=Math.ceil(this._currentTime),this._wasInterrupted=!1):(this._totalTime+=e-this._currentTime,this._currentTime=e)}reset(){this._wasInterrupted=!0}isFragmentComplete(e){return Math.floor(this._currentTime)%e==0&&this._currentTime-this._uninterruptedSince>=e}getCompleteRestFragmentLength(e){const t=this._currentTime%e;return this._currentTime-this._uninterruptedSince>=t?Math.round(t):0}getTotalLength(){return this._totalTime}}class dr{constructor(){this._currentProgress=null,this._progressHistory=[]}start(e=null){this._currentProgress={start:e||0,end:0},this._progressHistory=[],this._progressHistory.push(this._currentProgress)}update(e){if(this._currentProgress){if(e>this._currentProgress.end){let t=this._progressHistory.find(t=>e>=t.start&&e<=t.end);if(t){let e=this._progressHistory.indexOf(t);this._progressHistory.splice(e,1),this._currentProgress.end=t.end}else this._currentProgress.end=e}}else this._currentProgress=this._progressHistory.find(t=>e>=t.start&&e<=t.end),this._currentProgress||(this._currentProgress={start:e,end:e},this._progressHistory.push(this._currentProgress))}reset(){this._currentProgress=null}getHistory(){return this._progressHistory}getLength(){return this._progressHistory.reduce((e,t)=>e+(t.end-t.start),0)}getStart(){return this._progressHistory.length?this._progressHistory[0].start:null}}let ur=new m.ErrorFactory(m.createSourceName("src/js/mediaplayer/tech/Preloader.js"));class cr extends S{constructor(e,t,i,s){super(),this._env=e,this._utils=t,this._options=s,this._qualityListService=i,this._loader=null,this._loaderFactory=new zt(this._utils,{maxAttemps:this._options.loadAttemps||1},zt.PROFILE_SEGMENT),this._video=null,this._nativeStreamModel=new Zt({resolution:this._env.getScreenResolution(),isSmallScreen:this._env.isSmallScreen(),preferredBitrate:this._options.preferredBitrate,adaptResolutionToSize:this._options.adaptResolutionToSize}),this._adaptiveStreamModel=new Zt({resolution:this._env.getScreenResolution(),isSmallScreen:this._env.isSmallScreen(),adaptResolutionToSize:this._options.adaptResolutionToSize}),this._source=null,this._sourceSettings=null,this._statsHistory=[],this._preloaded=[]}getQualityListService(){return this._qualityListService}getStopBufferingOnPause(){return this._options.stopBufferingOnPause||!1}isSourceSet(){return!!this._source}setSource(e,t,i,s,n){if(this._source=e,this._sourceSettings=t,this._statsHistory=s?s.slice():[],this._sourceSettings&&void 0!==this._sourceSettings.bandwidth&&!this._statsHistory.length){const e=parseInt(this._sourceSettings.bandwidth,10);!isNaN(e)&&e>0&&this._statsHistory.push({bandwidth:e})}const o=this._sourceSettings&&void 0!==this._sourceSettings.qualityIdx?this._sourceSettings.qualityIdx:null;let r=this._getQualityIdx();const a=this._source.isAdaptive();a&&!Di.canPlayTypeNative(this._source.getAdaptiveType())?(this._adaptiveStreamModel.setQualityList(this._source),null===r&&(r=this._adaptiveStreamModel.getQuality(!0,!1,this._statsHistory,null,n,null,o,i)),-1!==r&&this._preloadAdaptive(r)):a||(this._nativeStreamModel.setQualityList(this._source),null===r&&(r=null===o?this._nativeStreamModel.getQuality(!0,!1,this._statsHistory,null,n,null):o),-1!==r&&this._preloadNonAdaptive(r))}getStats(){return this._preloaded}_getQualityIdx(){if(this._sourceSettings&&"function"==typeof this._sourceSettings.forcedQualityFunc)try{const e=this._sourceSettings.forcedQualityFunc(this._source);if(null===e&&this._source.isAdaptive()||null!==e&&this._source.getQualityItem(e))return e}catch(e){}else{if(this._sourceSettings&&void 0!==this._sourceSettings.forcedQualityIdx&&(null===this._sourceSettings.forcedQualityIdx&&this._source.isAdaptive()||null!==this._sourceSettings.forcedQualityIdx&&this._source.getQualityItem(this._sourceSettings.forcedQualityIdx)))return this._sourceSettings.forcedQualityIdx;if(this._sourceSettings&&void 0!==this._sourceSettings.storedQualityIdx&&null!==this._sourceSettings.storedQualityIdx&&this._source.getQualityItem(this._sourceSettings.storedQualityIdx))return this._sourceSettings.storedQualityIdx}return null}_getAudioTrackId(e){if(this._sourceSettings&&void 0!==this._sourceSettings.storedAudioTrack){const e=this._source.getTrackIdByName(this._sourceSettings.storedAudioTrack,C.TYPE_AUDIO);if(null!==e)return e}return e.getDefaultTrackId(C.TYPE_AUDIO)}_getVideoTrackId(e){if(this._sourceSettings&&void 0!==this._sourceSettings.storedVideoTrack){const e=this._source.getTrackIdByName(this._sourceSettings.storedVideoTrack,C.TYPE_VIDEO);if(null!==e)return e}return e.getDefaultTrackId(C.TYPE_VIDEO)}_preloadAdaptive(e){const t=this._source.getQualityItem(e),i=this._getAudioTrackId(t),s=this._getVideoTrackId(t),n=t.getTrackRelevantData(i,s,C.TYPE_VIDEO);n.useAudio&&n.useVideo?this._preloadAdaptiveTrack(e,C.TYPE_VIDEO,i,s):this._preloadAdaptiveTrack(e,C.TYPE_VIDEO,i,s).then(t=>{t&&this._preloadAdaptiveTrack(e,C.TYPE_AUDIO,i,s)}).catch(e=>{console.warn(e)})}_preloadAdaptiveTrack(e,t,i,s){const n=this._source.getQualityItem(e),o=t===C.TYPE_VIDEO?s:i,r=n.getTrack(o,t);let a=0;return this._qualityListService.fillTrack(r).then(r=>{const l=n.isLive(i,s),h=n.isEvent(i,s);if(l&&!h)return Promise.resolve(!1);const _=this._sourceSettings.startTime;if(null!==_){const e=n.getDuration(i,s,l&&h),t=_>e?e:_;r.getSegment(t)&&(a=t)}else if(l&&h){const e=n.getDuration(i,s,!0);if(e){const t=r.getSegment(e);t&&(a=t.start)}}const d=r.getSegment(a),u=Object.assign({qualityIdx:e,trackId:o,trackType:t},d);return d?this._preloadSegment(u).then(i=>{if(i){const i=r.getSegment(a+u.duration),s=Object.assign({qualityIdx:e,trackId:o,trackType:t},i);return!!i&&this._preloadSegment(s)}return!1}):Promise.resolve(!1)}).catch(e=>Promise.resolve(!1))}_preloadSegment(e){return this._loader=this._loaderFactory.create(),this._loader.load(e.url).then(t=>(this._preloaded.push(e),!0),t=>{if("abort"!==t.type){const t="An error occurred during video segment preload.",i=ur.createError(m.PRELOAD,t);i.src=e.url,this.emit(cr.EVENT_ERROR,i)}return!1})}_preloadNonAdaptive(e){this._video=window.document.createElement("video");const t=this._source.getQualityItem(e).getUrl();this._video.onerror=(e=>{const i=e.target.error;if(!i)return;if(i.code===i.MEDIA_ERR_SRC_NOT_SUPPORTED&&!this._video.src)return;const s=ur.createError(m.PRELOAD,"An error occurred during non-adaptive video preload.");s.code=i.code,s.src=t,this.emit(cr.EVENT_ERROR,s)}),this._video.onloadedmetadata=(t=>{this._preloaded.push({qualityIdx:e})}),this._video.setAttribute("preload","metadata"),this._video.src=t}_resetLoader(){this._loader&&(this._loader.abort(),this._loader=null),this._video&&(this._video.removeAttribute("src"),this._video.load(),this._video=null)}reset(){this._qualityListService.abortFill(),this._resetLoader(),this._source=null,this._sourceSettings=null,this._statsHistory=[],this._preloaded=[]}}cr.EVENT_ERROR="error";let pr=new m.ErrorFactory(m.createSourceName("src/js/richmediaplayer/PreloadProcessor.js"));class mr extends S{constructor(e){super(),this._preloader=e(),this._source=null,this._sourceSettings=null,this._sourceTime=null,this._isSourceError=!1,this._preloaderEventsMap=new Map([[cr.EVENT_ERROR,this._handleError]]),this.bindAll(this._preloaderEventsMap),this.addListeners(this._preloader,this._preloaderEventsMap)}start(e,t,i=null,s=null){this.reset(),this._player=e,this._source=t,this._sourceSettings=i,this._sourceTime=s}checkPreload(e){if(!this._source)return;const t=this._player.getDuration(),i=this._player.getBuffered(e),s=this._player.getStatsHistory(),n=this._player.getElementDimensions();this._isSourceError||this._player.isPaused()&&this._preloader.getStopBufferingOnPause()||this._preloader.isSourceSet()||!(this._sourceTime&&i.end-mr.BBPOINT_BUFFER_AFTER>=this._sourceTime&&this._sourceTime-e>mr.MIN_TIME_BEFORE||!this._sourceTime&&t&&!this._player.isLiveStreaming()&&i.end>=t&&t-e>mr.MIN_TIME_BEFORE)||this._player.getPreparedSource(this._preloader.getQualityListService(),this._source,this._sourceSettings).then(e=>{if(e&&e.getLength())this._preloader.setSource(e,this._sourceSettings,i,s,n);else{this._isSourceError=!0;const e=pr.createError(m.PRELOAD,"No playable sources found for preload.");this._handleError(e)}})}getStats(e){return this._source&&this._source===e?this._preloader.getStats():[]}reset(){this._preloader.reset(),this._source=null,this._sourceSettings=null,this._sourceTime=null,this._isSourceError=!1}_handleError(e){this.emit(mr.EVENT_ERROR,e)}}mr.MIN_TIME_BEFORE=5,mr.BBPOINT_BUFFER_AFTER=5,mr.EVENT_ERROR="error";class gr extends S{constructor(e,t,i=null,s="0px"){super(),this._observer="undefined"!=typeof IntersectionObserver?new IntersectionObserver(this._setVisibility.bind(this),{root:i,rootMargin:s,threshold:e}):null,this._visibilityDuration=0,this._timer=null,this._timerNow=null,this._threshold=e,this._duration=t,this._isObserving=!1}startObserve(e){this.reset(),this._observer?(this._isObserving=!0,this._observer.observe(e)):this.emit(gr.EVENT_VISIBILITY_UNDETERMINED)}reset(){this._observer&&(this._isObserving&&this.emit(gr.EVENT_NOT_VISIBLE),this._isObserving=!1,this._observer.disconnect(),this._clearTimer(),this._visibilityDuration=0)}_clearTimer(){this._timer&&(cancelAnimationFrame(this._timer),this._timer=null),this._timerNow=null}_setVisibility(e){if(1===e.length){const t=e[0];t.intersectionRatio>=this._threshold&&t.isIntersecting&&this._visibilityDuration<this._duration?(this._timerNow=o.getNow(),this._timer=requestAnimationFrame(()=>{this._checkVisibility()})):(this._timerNow&&this._checkVisibility(!1),this._clearTimer())}}_checkVisibility(e=!0){const t=o.getNow();this._visibilityDuration+=t-this._timerNow,this._visibilityDuration>=this._duration?(this._timerNow=null,this.emit(gr.EVENT_VISIBLE)):e&&(this._timerNow=t,this._timer=requestAnimationFrame(()=>{this._checkVisibility()}))}}gr.EVENT_VISIBLE="visible",gr.EVENT_NOT_VISIBLE="notvisible",gr.EVENT_VISIBILITY_UNDETERMINED="visiblityundetermined";let Er=new m.ErrorFactory(m.createSourceName("src/js/richmediaplayer/RichMediaPlayer.js"));const Tr="IDLE",fr="AD",yr="CONTENT";class vr extends S{constructor(e,t,i,s,n,o){super(),this._utils=e,this._env=t,this._uiMediaPlayerCreator=i,this._uiVpaidPlayerCreator=s,this._options=Object.assign({},o),this._mainPlayer=null,this._vpaidPlayer=null,this._uiMediaPlayer=null,this._dialogScreen=new lr,this._uiAgent=new Go("w-RichPlayer"),this._fsElement=this._uiAgent.getElement(),this._uiMediaPlayerReady=new Promise((e,t)=>{this._techReadyResolve=e,this._techReadyReject=t}),this._eventsMap=new Map([[X.EVENT_READY,this._handleReady],[X.EVENT_FULLSCREEN_CHANGE,this._handleFullscreenChange],[X.EVENT_CINEMA_CHANGE,this._handleCinemaChange],[X.EVENT_UI_RESIZE,this._handleUiResize],[X.EVENT_PIP_CHANGE,this._handlePipChange],[X.EVENT_AP_CHANGE,this._handleAirPlayChange],[X.EVENT_VOLUME_CHANGE,this._handleVolumeChange],[X.EVENT_QUALITY_SET,this._handleQualitySet],[X.EVENT_QUALITY_CHANGE,this._handleQualityChange],[X.EVENT_TRACK_SET,this._handleTrackSet],[X.EVENT_DURATION_CHANGE,this._handleDurationChange],[X.EVENT_LOADED_DATA,this._handleLoadedData],[X.EVENT_LOADED_SEGMENT,this._handleLoadedSegment],[X.EVENT_LOADED_META,this._handleLoadedMetadata],[X.EVENT_SOURCE_SET,this._handleSourceSet],[X.EVENT_TEXT_SOURCE_SET,this._handleTextSourceSet],[X.EVENT_TEXT_TRACK_SET,this._handleTextTrackSet],[X.EVENT_BUFFER_EMPTY,this._handleBufferEmpty],[X.EVENT_CAN_PLAY,this._handleCanPlay],[X.EVENT_PLAY,this._handlePlay],[X.EVENT_PLAY_DENIED,this._handlePlayDenied],[X.EVENT_PLAYING,this._handlePlaying],[X.EVENT_PAUSED,this._handlePaused],[X.EVENT_TIMEUPDATE,this._handleTimeUpdate],[X.EVENT_PLAYBACK_PROGRESS,this._handlePlaybackProgress],[X.EVENT_SEEKSTART,this._handleSeekstart],[X.EVENT_SEEKING,this._handleSeeking],[X.EVENT_SEEKED,this._handleSeeked],[X.EVENT_ENDED,this._handleEnded],[X.EVENT_ERROR,this._handleError],[X.EVENT_WARNING,this._handleWarning],[X.EVENT_VIDEO_CLICKTHROUGH,this._handleVideoClickthrough],[X.EVENT_ACTION_CLICKTHROUGH,this._handleActionClickthrough],[X.EVENT_ACTION_BACK,this._handleActionBack],[X.EVENT_ACTION_CONTENT_LINK,this._handleActionContentLink],[X.EVENT_VE_DISPLAYED,this._handleVEDisplayed],[X.EVENT_VE_HIDDEN,this._handleVEHidden],[X.EVENT_VE_CLICK,this._handleVEClick],[X.EVENT_VE_CLOSE,this._handleVEClose],[X.EVENT_VE_ERROR,this._handleVEError],[X.EVENT_SKIP_VIDEO_REQUEST,this.skip],[X.EVENT_CANCEL_AD_REQUEST,this.cancelAd],[X.EVENT_USER_ACCEPT_INVITATION,this._handleUserAcceptInvitation],[X.EVENT_USER_MINIMIZE,this._handleUserMinimize],[X.EVENT_USER_CLOSE,this._handleUserClose],[X.EVENT_IMPRESSION,this._handleImpression],[X.EVENT_REPLAY_REQUEST,this._handleReplayRequest]]),this._uiAgentEventsMap=new Map([[Go.EVENT_REPLAY_REQUEST,this._handleReplayRequest],[Go.EVENT_VIDEO_CLICKTHROUGH,this._handleVideoClickthrough]]),this._preloaderEventsMap=new Map([[mr.EVENT_ERROR,this._handlePreloaderError]]),this._viewportObserverEventsMap=new Map([[gr.EVENT_VISIBLE,this._handleAdVisible],[gr.EVENT_NOT_VISIBLE,this._handleAdNotVisible],[gr.EVENT_VISIBILITY_UNDETERMINED,this._handleAdVisibilityUndetermined]]),this._originalContent=null,this._content=null,this._currentLinearAd=null,this._logoSrc="",this._overlays=[],this._originalOverlays=[],this._actionCaption="",this._sponsors=[],this._promos=[],this._prerolls=[],this._adMidrollPoints=[],this._midrollsNow=[],this._postrolls=[],this._postrollsInfo=[],this._endAdScreen=null,this._mode=Tr,this._adsCount={},this._adsInRow=0,this._adsInRowTotal=0,this._adIndex=0,this._lastAdDuration=null,this._lastContentTime=null,this._contentStartTime=null,this._lastNearAdPointIdx=null,this._isContentEnded=!1,this._contentReady=!1,this._notPlayed=!0,this._contentStart=!0,this._wasPlaying=!1,this._isNearEnd=!1,this._isReplay=!1,this._wasContentAlreadySet=!1,this._stopPropagation={},this._colorProfile=Vo,this._adOnlyColorProfile=Bo,this._audioOnlyColorProfile=Fo,this._exactTimeTimer=null,this._controlsHidden=!1,this._noPauseOnClick=!1,this._adPoints=[],this._companionAdSlots=[],this._midrollSeekDistance=1,this._midrollCanCancel=!1,this._midrollsCanceled=!1,this._forceMidrolls=!0,this._adPointsShown=!0,this._isAutoplayAllowed=!1,this._viewportObserver=new gr(vr.AD_VISIBLE_THRESHOLD,vr.AD_VISIBLE_DURATION),this._fragmentors={AD:new _r,CONTENT:new _r},this._played={AD:new dr,CONTENT:new dr},this._preloader=new mr(n),this.bindAll(this._viewportObserverEventsMap),this.addListeners(this._viewportObserver,this._viewportObserverEventsMap),this.bindAll(this._uiAgentEventsMap),this.addListeners(this._uiAgent,this._uiAgentEventsMap),this.bindAll(this._preloaderEventsMap),this.addListeners(this._preloader,this._preloaderEventsMap),window.addEventListener("unload",()=>{this.emit(vr.EVENT_UNLOAD)}),this._options.id=this._options.id||this._utils.generateId("rmp"),this._uiAgent.setDialogScreen(this._dialogScreen);["_finishCancelStop","_finishStop","_finishSkip","_finishReplay"].forEach(e=>{this[e]=this[e].bind(this)},this)}destroy(){this.emit(vr.EVENT_DESTROYING),this._stopCheckingExactTime(),this._uiMediaPlayer&&this._uiMediaPlayer.destroy()}getPlayerId(){return this._options.id}getElement(){return this._uiAgent.getElement()}getTechName(){return this._mainPlayer?this._mainPlayer.constructor.getTechName():""}getLocalStoragePrefix(){return this._options.localStoragePrefix}getCurrentAd(){return this._currentLinearAd}getContent(){return this._originalContent}getResolvedContent(){if(!this._uiMediaPlayer||!this._content)return null;let e={};return this._mode===yr&&(e={source:this._uiMediaPlayer.getResolvedSource(),textSource:this._uiMediaPlayer.getTextSource()}),Object.assign({},this._content,e)}getCurrentSrc(){return this._uiMediaPlayer?this._uiMediaPlayer.getCurrentSrc():""}getCurrentAdaptiveSrc(){return this._uiMediaPlayer?this._uiMediaPlayer.getCurrentAdaptiveSrc():""}getQuality(){return this._uiMediaPlayer?this._uiMediaPlayer.getQuality():null}getSupportedTextTracks(){return this._uiMediaPlayer?this._uiMediaPlayer.getSupportedTextTracks():[]}getTextTrack(){return this._uiMediaPlayer?this._uiMediaPlayer.getTextTrack():null}getVideoWidth(){return this._uiMediaPlayer?this._uiMediaPlayer.getVideoWidth():0}getVideoHeight(){return this._uiMediaPlayer?this._uiMediaPlayer.getVideoHeight():0}getCodecs(){if(!this._uiMediaPlayer)return"";const e=this._uiMediaPlayer.getCurrentQualityItem();return e&&e.getCodecs()||""}getVolume(){return this._uiMediaPlayer?this._uiMediaPlayer.getVolume():1}getInitMute(){return!!this._options.muted}getTransitionWaitingTime(){return this._options.transitionWaitingTime}getCurrentTime(){return this._uiMediaPlayer?this._uiMediaPlayer.getCurrentTime():NaN}getStartTime(){return this._contentStartTime}getDuration(){return this._uiMediaPlayer?this._uiMediaPlayer.getDuration():NaN}getBuffered(e){return this._uiMediaPlayer?this._uiMediaPlayer.getBuffered(e):null}getProgressHistory(){return this._mode===Tr?null:this._uiMediaPlayer?this._played[this._mode].getHistory():null}getProgressStart(){return this._mode===Tr?null:this._uiMediaPlayer?this._played[this._mode].getStart():null}getProgressLength(){return this._mode===Tr?null:this._uiMediaPlayer?this._played[this._mode].getLength():null}getPlaybackLength(){return this._mode===Tr?null:this._uiMediaPlayer?this._fragmentors[this._mode].getTotalLength():null}getStatsHistory(){return this._uiMediaPlayer?this._uiMediaPlayer.getStatsHistory():null}getCompleteRestFragmentLength(e){return this._mode===Tr?null:this._uiMediaPlayer?this._fragmentors[this._mode].getCompleteRestFragmentLength(e):null}getVisualElements(){return this._uiMediaPlayer?this._uiMediaPlayer.getVisualElements():[]}getCurrentFrame(e){return this._uiMediaPlayer?this._uiMediaPlayer.getCurrentFrame(e):null}getOverlays(){return this._overlays}getAdsCount(e){return this._adsCount[e]||0}getLastMidrollTime(){return this._adMidrollPoints&&this._adMidrollPoints.length?this._adMidrollPoints[this._adMidrollPoints.length-1].time:null}hasPostrolls(){return!!this._postrollsInfo.length}isReady(){return this._uiMediaPlayer&&this._uiMediaPlayer.isReady()}isContentReady(){return!!this._uiMediaPlayer&&this._contentReady}isMuted(){return!!this._uiMediaPlayer&&this._uiMediaPlayer.isMuted()}isPlaying(){return!!this._uiMediaPlayer&&this._uiMediaPlayer.isPlaying()}isPaused(){return!this._uiMediaPlayer||this._uiMediaPlayer.isPaused()}isEnded(){return!!this._uiMediaPlayer&&this._uiMediaPlayer.isEnded()}isBufferEmpty(){return!this._uiMediaPlayer||this._uiMediaPlayer.isBufferEmpty()}isDisplayingAdScreen(){return this._endAdScreen&&this._uiAgent.isDialogActive()}isFullscreen(){return!!this._uiMediaPlayer&&this._uiMediaPlayer.isFullscreen()}isCinema(){return!!this._uiMediaPlayer&&this._uiMediaPlayer.isCinemaActive()}isPipActive(){return!!this._uiMediaPlayer&&this._uiMediaPlayer.isPipActive()}isAirPlayActive(){return!!this._uiMediaPlayer&&this._uiMediaPlayer.isAirPlayActive()}isAdaptive(){return!!this._uiMediaPlayer&&this._uiMediaPlayer.isAdaptiveSource()}isLive(){return!!this._uiMediaPlayer&&(this._uiMediaPlayer.isLive()||this._uiMediaPlayer.isEvent())}isEvent(){return!!this._uiMediaPlayer&&this._uiMediaPlayer.isEvent()}isLiveStreaming(){return!!this._uiMediaPlayer&&this._uiMediaPlayer.isLiveStreaming()}isAdMode(){return!!this._uiMediaPlayer&&this._mode===fr}isAdOnlyMode(){return!!this._options.adOnlyMode}isAudioOnlyMode(){return!!this._options.audioOnlyMode}isReplay(){return this._isReplay}isFragmentComplete(e){return this._mode===Tr?null:!!this._uiMediaPlayer&&this._fragmentors[this._mode].isFragmentComplete(e)}isVisualElementShown(e){return!!this._uiMediaPlayer&&this._uiMediaPlayer.isVisualElementShown(e)}isFeatureSupported(e){return"vpaid"===e.toLowerCase()?"html"===this._mainPlayer.constructor.getTechName()&&this._isAutoplayAllowed&&!p.isIPhone()&&!p.isIPad()&&!p.isIPod():"vast"===e.toLowerCase()}hasTextTrack(e){return!!this._uiMediaPlayer&&this._uiMediaPlayer.hasTextTrack(e)}canRunVisualElementType(e,t=!1){return!!this._uiMediaPlayer&&this._uiMediaPlayer.canRunVisualElementType(e,t)}canDisplayCompanionAds(e,t){if(!this._companionAdSlots.length)return"none"===t;if(e.length>this._companionAdSlots.length&&"all"===t)return!1;let i=this._companionAdSlots,s=!1;return s="all"===t?this._canDisplayAllCompanionAds(e,i):e.some(e=>{const t=this._getCompanionAdSlotIdx(e,i);return null!==t&&(null===e.adSlotID&&(e.adSlotID=i[t].adSlotID),!0)}),"none"===t||s}dispatchCompanionAdsReady(e){const t=e.filter(e=>null!==e.adSlotID);this.emit(vr.EVENT_COMPANION_ADS_READY,t)}_canDisplayAllCompanionAds(e,t){if(!e.length)return!0;const i=t.slice(),s=e.slice(),n=s.shift();let o=this._getCompanionAdSlotIdx(n,i);for(;null!=o&&i.length;){const e=i[o].adSlotID;if(this._canDisplayAllCompanionAds(s,t.filter(t=>t.adSlotID!=e)))return null===n.adSlotID&&(n.adSlotID=e),!0;i.splice(o,1),o=this._getCompanionAdSlotIdx(n,i)}return!1}_getCompanionAdSlotIdx(e,t){const i=t.find(t=>{const i=e.width<=t.width&&e.height<=t.height,s=!e.adSlotID||e.adSlotID===t.adSlotID;let n=!0;if(void 0!==t.resourceType&&"ALL"!==t.resourceType)switch(t.resourceType){case"HTML":n=!!e.htmlResources.length;break;case"IFRAME":n=!!e.iframeResources.length;break;case"STATIC":n=!!e.staticResources.length}let o=!0;return(!e.iframeResources.length&&!e.htmlResources.length||void 0!==t.resourceType&&"STATIC"===t.resourceType)&&(o=void 0!==t.creativeType&&Array.isArray(t.creativeType)?e.staticResources.some(e=>-1!==t.creativeType.indexOf(e.type)):!!e.staticResources.length&&e.staticResources.some(e=>0===e.type.indexOf("image"))),s&&n&&o&&i});return i?t.indexOf(i):null}init(e={}){if(!this._uiMediaPlayer){e&&e.fsElement&&(this._fsElement=e.fsElement);try{this._mainPlayer=this._uiMediaPlayerCreator(this._options),this._uiMediaPlayer=new hr({},{},{},this._options),this._uiMediaPlayer.registerStrategy("main",this._mainPlayer),this._uiMediaPlayer.switchStrategy("main")}catch(e){return void this._handleError(e)}this._uiAgent.setPlayer(this._uiMediaPlayer),this._mainPlayer.canConfigureFullscreen()&&this._mainPlayer.configureFullscreen({element:this._fsElement}),this._mainPlayer.canConfigureCinema()&&this._mainPlayer.configureCinema({element:this._fsElement}),this._mainPlayer.canConfigurePip()&&this._mainPlayer.configurePip(),this._mainPlayer.canConfigureAirPlay()&&this._mainPlayer.configureAirPlay(),this.bindAll(this._eventsMap),this.addListeners(this._uiMediaPlayer,this._eventsMap),this._uiMediaPlayer.isReady()&&this._techReadyResolve()}}setColorProfile(e){this._colorProfile=e}getColorProfile(){return this._colorProfile}setLogo(e){this._logoSrc=e,this._mode===yr&&(this._uiMediaPlayer.setLogo(this._logoSrc),this._uiMediaPlayer.showLogo())}setCompanionAdSlots(e){this._companionAdSlots=e&&Array.isArray(e)?e:[]}setActionArea(e){this._actionCaption=e,this._mode===yr&&this._uiMediaPlayer.setActionArea(this._actionCaption)}setPauseOnClick(e){this._noPauseOnClick=!e,this._uiMediaPlayer&&this._uiMediaPlayer.setNoPauseOnClick(this._noPauseOnClick)}setLocalizedTexts(e){this._uiMediaPlayerReady.then(()=>{this._uiMediaPlayer.setLocalizedTexts(e)})}setSourcePreload(e){this._uiMediaPlayerReady.then(()=>{this._uiMediaPlayer.setSourcePreload(e)})}setVolume(e){this._uiMediaPlayerReady.then(()=>{this._uiMediaPlayer.setVolume(e)})}setMute(e){this._uiMediaPlayerReady.then(()=>{this._uiMediaPlayer.setMute(e)})}setContent(e,t){const i=this.isAdOnlyMode();if(i&&e.source){const e=Er.createError(m.SETTING,"Content cannot be specified in ad-only mode.");return Promise.reject(e)}if(!i&&!e.id){const e=Er.createError(m.SETTING,"Content ID must be specified.");return Promise.reject(e)}if(!i&&"string"!=typeof e.id){const e=Er.createError(m.SETTING,"Content ID must be a string.");return Promise.reject(e)}if(!i&&!e.source){const e=Er.createError(m.SETTING,"Content source must be specified.");return Promise.reject(e)}return this.reset(),this._isAutoplayAllowed=t,this._originalContent=e,this._content=Object.assign({},e,{source:X.copySource(e.source),textSource:X.copySource(e.textSource)}),this.emit(vr.EVENT_CONTENT_SET,{content:e}),this.emit(vr.EVENT_PROGRAMME_BEGIN,{content:e}),this._uiMediaPlayerReady.then(()=>this._setAndPlayNext())}setAudioList(e){this._uiMediaPlayerReady.then(()=>{this._uiMediaPlayer.setAudioList(e)})}setMidrollSeekDistance(e){this._midrollSeekDistance=e}setMidrollCanCancel(e){this._midrollCanCancel=e&&(void 0===this._options.skipAllAdsAllowed||!!this._options.skipAllAdsAllowed)}getMidrollsCanceled(){return this._midrollsCanceled}enableMidrollForcing(){this._forceMidrolls=!0}disableMidrollForcing(){this._forceMidrolls=!1}setSponsor(e){const t=Array.isArray(e)?e:[e];this._sponsors.push(...t),this._adsCount[vr.adRole.SPONSOR]=this._sponsors.length}setPromo(e){const t=Array.isArray(e)?e:[e];this._promos.push(...t),this._adsCount[vr.adRole.PROMO]=this._promos.length}setPreroll(e){const t=Array.isArray(e)?e:[e];this._prerolls.push(...t),this._adsCount[vr.adRole.PREROLL]=this._prerolls.length}setMidroll(e){const t=Array.isArray(e)?e:[e];this._midrollsNow.push(...t),this._adsCount[vr.adRole.MIDROLL]=this._midrollsNow.length}tryStartPlayingMidrolls(){this._midrollsNow.length&&this._uiMediaPlayer.isPlaying()&&this._tryStartPlayingMidrolls()}addMidrollPoint(e,t=!0){let i=Array.isArray(e)?e:[e];(this._uiMediaPlayer.isPipActive()||this._uiMediaPlayer.isAirPlayActive())&&(i=i.filter(e=>!e.linearAd||!e.linearAd.sourceVpaid||!this.isFeatureSupported("vpaid"))),this._adMidrollPoints.forEach(e=>{this._removeAdPoint({time:e.time})}),this._adMidrollPoints=t?[...i]:this._adMidrollPoints.concat(i),this._adMidrollPoints.sort((e,t)=>e.time-t.time),this._adMidrollPoints=this._adMidrollPoints.filter((e,t,i)=>{const s=t>0?i[t-1]:{};return e.isVpaid=!!(e.linearAd&&e.linearAd.sourceVpaid&&this.isFeatureSupported("vpaid")),e.time===s.time?(e.isVpaid&&!s.isVpaid&&(s.isVpaid=!0),!e.isSuccessful||s.isSuccessful||e.disabled||(s.isSuccessful=!0,s.linearAd=e.linearAd,s.errors=e.errors,this._addAdPoint({time:e.time,cancelable:e.cancelable})),"condition"in e&&(s.condition=e.condition),"keywords"in e&&(s.keywords="keywords"in s?`${s.keywords} ${e.keywords}`:e.keywords),!1):(e.isSuccessful&&!e.disabled&&this._addAdPoint({time:e.time,cancelable:e.cancelable}),!0)}),this._preloadNextContent()}addPostrollInfo(e,t=!0){const i=Array.isArray(e)?e:[e];this._postrollsInfo=t?[...i]:this._postrollsInfo.concat(i),this._postrollsInfo=this._postrollsInfo.filter((e,t,i)=>e.isSuccessful),this._preloadNextContent()}setPostroll(e){const t=Array.isArray(e)?e:[e];this._postrolls.push(...t),this._adsCount[vr.adRole.POSTROLL]=this._postrolls.length}setEndAdScreen(e){this._endAdScreen=e}setQuality(e){this._uiMediaPlayerReady.then(()=>{this._uiMediaPlayer.setQuality(e)})}setTextTrack(e=null){this._uiMediaPlayerReady.then(()=>{this._uiMediaPlayer.setTextTrack(e)})}setControlsHidden(e){this._controlsHidden=e,this._uiMediaPlayer&&this._uiMediaPlayer.setControlsHidden(e)}showControls(e){this._uiMediaPlayerReady.then(()=>{this._uiMediaPlayer.showControls(e)})}closeMenu(){return this._uiMediaPlayerReady.then(()=>this._uiMediaPlayer.closeMenu())}setUiFollowing(e){this._uiMediaPlayerReady.then(()=>{this._uiMediaPlayer.setUiFollowing(e)})}setUiEpisodes(e){this._uiMediaPlayerReady.then(()=>{this._uiMediaPlayer.setUiEpisodes(e)})}setUiTvProgram(e){this._uiMediaPlayerReady.then(()=>{this._uiMediaPlayer.setUiTvProgram(e)})}setVisibleUiElements(e={}){this._uiMediaPlayerReady.then(()=>{this._uiMediaPlayer.setVisibleUiElements(e)})}resetVisibleUiElements(){this._uiMediaPlayerReady.then(()=>{this._uiMediaPlayer.resetVisibleUiElements()})}setContentInfo(e={}){this._uiMediaPlayerReady.then(()=>{this._uiMediaPlayer.setContentInfo(e)})}resetContentInfo(){this._uiMediaPlayerReady.then(()=>{this._uiMediaPlayer.resetContentInfo()})}setOverlays(e,t){if(!e||!Array.isArray(e))throw Er.createError(m.SETTING,"Overlays must be an Array.");const i=this._processOverlays(e,t),s=e.length!==i.length;return this._originalOverlays=s?[]:i,this._mode===yr&&this._setOverlays(this._originalOverlays),!s}addVisualElement(e){this._uiMediaPlayerReady.then(()=>{this._uiMediaPlayer.addVisualElement(e)})}showVisualElement(e){this._uiMediaPlayerReady.then(()=>{this._uiMediaPlayer.showVisualElement(e)})}showVisualElementClose(e){this._uiMediaPlayerReady.then(()=>{this._uiMediaPlayer.showVisualElementClose(e)})}hideVisualElement(e){this._uiMediaPlayerReady.then(()=>{this._uiMediaPlayer.hideVisualElement(e)})}abortVisualElement(e){this._uiMediaPlayerReady.then(()=>{this._uiMediaPlayer.abortVisualElement(e)})}removeVisualElement(e){this._uiMediaPlayerReady.then(()=>{this._uiMediaPlayer.removeVisualElement(e)})}removeVisualElements(){this._uiMediaPlayerReady.then(()=>{this._uiMediaPlayer.removeVisualElements()})}setVisualElementDefaultPosition(e,t){this._uiMediaPlayerReady.then(()=>{this._uiMediaPlayer.setVisualElementDefaultPosition(e,t)})}_addAdPoint(e){this._adPoints.push(e),this._adPointsShown&&this._updateAdPoints(this._adPoints)}_removeAdPoint(e){this._adPoints=this._adPoints.filter(t=>t.time!==e.time),this._adPointsShown&&this._updateAdPoints(this._adPoints)}_resetAdPoints(){this._adMidrollPoints=[],this._adPoints=[],this._adPointsShown=!0,this._updateAdPoints(this._adPoints)}_showAdPoints(){this._adPointsShown=!0,this._updateAdPoints(this._adPoints)}_hideAdPoints(){this._adPointsShown=!1,this._updateAdPoints([])}_updateAdPoints(e){this._uiMediaPlayerReady.then(()=>{this._uiMediaPlayer.setAdPoints(e)})}play(e=!1){if(e&&this._uiMediaPlayer&&this._uiMediaPlayer.isReady())return this._cancelStop(),this._wasPlaying=!0,void this._uiMediaPlayer.play();this._uiMediaPlayerReady.then(()=>{this._cancelStop(),this._wasPlaying=!0,this._uiMediaPlayer.play()})}pause(){this._uiMediaPlayerReady.then(()=>{this._uiMediaPlayer.pause()})}stop(){this._uiMediaPlayer&&this._uiMediaPlayerReady.then(()=>{if(this._stopPropagation[X.EVENT_PAUSED]=!0,this._uiMediaPlayer.once(X.EVENT_PAUSED,this._finishStop),this.registerPendingEvent(this._uiMediaPlayer,X.EVENT_PAUSED,this._finishStop),this._uiMediaPlayer.pause(),this._restoreContent().then(()=>{this._isStopped=!0},e=>{const t=this.getErrorIfIsReason(e);t&&this._handleError(t)}),this.emit(vr.EVENT_STOPPED),this.isAdOnlyMode()){const e=this.getCurrentAd();e&&this.showDialog({kind:lr.layout.ADSTOP,poster:this._content.poster,currentSrc:this.getCurrentSrc(),currentTime:this.getCurrentTime(),adUrl:e.clickthrough||"",adUrlTarget:e.clickthroughTarget||"_blank",adUrlTracking:e.videoClicks.clickTrackings||[]})}else this.showDialog({kind:lr.layout.STOP,poster:this._content.poster})})}replay(){this._uiMediaPlayer&&this._uiMediaPlayerReady.then(()=>{this._stopPropagation[X.EVENT_PAUSED]=!0,this._uiMediaPlayer.once(X.EVENT_PAUSED,this._finishReplay),this.registerPendingEvent(this._uiMediaPlayer,X.EVENT_PAUSED,this._finishReplay);const e=this.isAdOnlyMode();this._uiMediaPlayer.pause(),this._restoreContent(e?null:{time:0}).then(()=>{e?(this._isReplay=!0,this._setAndPlayNext()):(this._isReplay=!0,this._uiMediaPlayer.play())},e=>{const t=this.getErrorIfIsReason(e);t&&this._handleError(t)})})}seek(e){this._uiMediaPlayerReady.then(()=>{this._isStopped=!1,this._uiMediaPlayer.seek(e)})}seekToLive(){this._uiMediaPlayerReady.then(()=>{this.isLiveStreaming()&&(this._isStopped=!1,this._uiMediaPlayer.seekToLive())})}skip(e=null){this._uiMediaPlayer&&(this.emit(vr.EVENT_SKIP,{time:this._uiMediaPlayer.getCurrentTime()}),this._stopPropagation[X.EVENT_PAUSED]=!0,this._uiMediaPlayer.once(X.EVENT_PAUSED,this._finishSkip),this.registerPendingEvent(this._uiMediaPlayer,X.EVENT_PAUSED,this._finishSkip),this._uiMediaPlayer.pause(),this._uiMediaPlayer.skip(),this._mode===fr&&(e&&e.skipAllAds&&this._midrollCanCancel&&(this._midrollsCanceled=!0,this._adMidrollPoints.map(e=>e.disabled=!0),this._resetAdPoints(),this._midrollsNow=[]),this._shiftToNextAd(),e&&e.skipToNonVpaid&&this._shiftToNextNonVpaidAd()),this._setAndPlayNext())}cancelAd(e=null){if(!this._uiMediaPlayer||!e||void 0===e.time)return;const t=this._adMidrollPoints.find(t=>t.time===e.time&&!t.disabled);t&&(t.disabled=!0,this._removeAdPoint({time:t.time}))}showPp(){this._uiMediaPlayerReady.then(()=>{this._uiMediaPlayer.showPp()})}hidePp(){this._uiMediaPlayerReady.then(()=>{this._uiMediaPlayer.hidePp()})}showDialog(e){if("object"!=typeof e||!e)throw Er.createError(m.SETTING,"Invalid argument options.");const t=Object.assign({},e);this._uiAgent.showDialog(t),this.emit(vr.EVENT_ENDSCREEN_SHOWN,{kind:t.kind})}hideDialog(){this._uiAgent.hideDialog()}enterFullscreen(){this._uiMediaPlayer&&!this.isAdOnlyMode()&&this._uiMediaPlayer.enterFullscreen()}exitFullscreen(){this._uiMediaPlayer&&!this.isAdOnlyMode()&&this._uiMediaPlayer.exitFullscreen()}enterCinema(){this._uiMediaPlayer&&!this.isAdOnlyMode()&&this._uiMediaPlayer.enterCinema()}exitCinema(){this._uiMediaPlayer&&!this.isAdOnlyMode()&&this._uiMediaPlayer.exitCinema()}showAirPlayTargetPicker(){this._uiMediaPlayer&&!this.isAdOnlyMode()&&this._uiMediaPlayer.showAirPlayTargetPicker()}reset(){this._viewportObserver.reset(),this._mode!==Tr&&this.emit(vr[`EVENT_${this._mode}_END`]),this._stopCheckingExactTime(),this.abortPending(),this._resetAdPoints(),this._removeOverlayVisualElements(),this._uiAgent.hideDialog(),this._isStopped=!1,this._uiMediaPlayer&&this._uiMediaPlayer.isReady()&&this._uiMediaPlayer.reset(),this._preloader.reset(),this._currentlyPreloading=null,this._mode=Tr,this._adsCount={},this._adsInRow=0,this._adsInRowTotal=0,this._adIndex=0,this._lastAdDuration=null,this._originalContent=null,this._content=null,this._currentLinearAd=null,this._originalOverlays=[],this._sponsors=[],this._promos=[],this._prerolls=[],this._midrollsNow=[],this._postrolls=[],this._postrollsInfo=[],this._endAdScreen=null,this._lastNearAdPointIdx=null,this._lastContentTime=null,this._contentStartTime=null,this._isContentEnded=!1,this._isNearEnd=!1,this._contentReady=!1,this._notPlayed=!0,this._contentStart=!0,this._wasPlaying=!1,this._wasContentAlreadySet=!1,this._isReplay=!1,this._stopPropagation={},this._midrollSeekDistance=1,this._midrollCanCancel=!1,this._midrollsCanceled=!1,this._forceMidrolls=!0,this._isAutoplayAllowed=!1}focusPlay(e){("userAction"in e?e.userAction:"setPlayFocus"in this._options&&this._options.setPlayFocus)&&this._uiMediaPlayer.focusPlayButton()}_processOverlays(e,t){let i=[];return e.forEach(e=>{const s=this._getCreativeIdx(e,t);if(null!==s){const t=e.creatives[s],n={};t.position&&t.position.x&&(n.x={origin:t.position.x.origin,center:!!t.position.x.center,value:this._utils.formatPx(t.position.x.value)}),t.position&&t.position.y&&(n.y={origin:t.position.y.origin,center:!!t.position.y.center,value:this._utils.formatPx(t.position.y.value)});const o=Object.assign({id:e.id,start:e.start,duration:e.duration},t,{width:this._utils.formatPx(t.width),maxWidth:this._utils.formatPx(t.maxWidth),height:this._utils.formatPx(t.height),maxHeight:this._utils.formatPx(t.maxHeight),position:n});this._validateOverlay(o,i)&&i.push(o)}}),i}_setOverlays(e){this._overlays.forEach(t=>{e.find(e=>e.id===t.id)||this.removeVisualElement(t.id)}),e.forEach(e=>{this._overlays.find(t=>t.id===e.id)||this.addVisualElement(this._getVisualElementFromOverlay(e))}),this._overlays=e}_validateOverlay(e,t){if(!e.id){const e=Er.createError(m.SETTING,"Visual element ID must be specified.");return this._handleError(e),!1}if(t.some(t=>t.id==e.id)){const t=Er.createError(m.SETTING,`Visual element ID "${e.id}" is already defined.`);return this._handleError(t),!1}if(!e.start||"atTime"!==e.start.type&&"afterStart"!==e.start.type&&"beforeEnd"!==e.start.type){const e=Er.createError(m.SETTING,"Visual element start is not defined.");return this._handleError(e),!1}if(!e.duration){const e=Er.createError(m.SETTING,"Visual element duration must be specified.");return this._handleError(e),!1}if(!(e.position&&e.position.x&&e.position.y)){const e=Er.createError(m.SETTING,"Visual element position is not defined.");return this._handleError(e),!1}if("left"!==e.position.x.origin&&"right"!==e.position.x.origin){const t=Er.createError(m.SETTING,"Unknown visual element x-origin: "+`"${e.position.x.origin}".`);return this._handleError(t),!1}if("top"!==e.position.y.origin&&"bottom"!==e.position.y.origin){const t=Er.createError(m.SETTING,"Unknown visual element y-origin: "+`"${e.position.y.origin}".`);return this._handleError(t),!1}if(e.click&&!Array.isArray(e.click)){const e=Er.createError(m.SETTING,"Visual element click actions must be an array.");return this._handleError(e),!1}if(e.animation){if(!e.animation.params){const e=Er.createError(m.SETTING,"Visual element animation params must be defined");return this._handleError(e),!1}if(!e.animation.params.duration){const e=Er.createError(m.SETTING,"Visual element animation duration must be defined");return this._handleError(e),!1}if("top"!==e.animation.params.direction&&"bottom"!==e.animation.params.direction&&"left"!==e.animation.params.direction&&"right"!==e.animation.params.direction){const e=Er.createError(m.SETTING,"Visual element animation direction must be defined");return this._handleError(e),!1}}return!0}_getCreativeIdx(e,t){for(let i=0;i<e.creatives.length;i++){const s=e.creatives[i];if(this.canRunVisualElementType(s.type,t))return i}return null}_getVisualElementFromOverlay(e){const t=e.click&&e.click.find(e=>"clickthrough"===e.command&&e.params&&e.params.uri);return{id:e.id,start:e.start,src:e.src||"",bgcolor:e.bgcolor||"",content:e.content||"",type:e.type,width:e.width,maxWidth:e.maxWidth,height:e.height,maxHeight:e.maxHeight,position:e.position,animation:e.animation||null,clickActions:e.click||[],clickthrough:t?t.params.uri:""}}_removeOverlayVisualElements(){this._overlays.forEach(e=>{this.removeVisualElement(e.id)}),this._overlays=[]}_restoreContent(e=null){if(this._uiMediaPlayer.isPlaying()){const e=Er.createError(m.GENERAL,"Player must be paused.");return Promise.reject(e)}let t=null;if(this._viewportObserver.reset(),this._mode===fr&&(this.emit(vr.EVENT_SKIP,{time:this._uiMediaPlayer.getCurrentTime()}),this.emit(vr.EVENT_AD_END),this._mode=Tr),this._mode===yr&&(this.emit(vr.EVENT_CONTENT_END),this._mode=Tr),this.abortPending(),this._resetAdPoints(),this._preloader.reset(),this._currentlyPreloading=null,this._uiAgent.hideDialog(),this._adsCount={},this._adsInRow=0,this._adsInRowTotal=0,this._adIndex=0,this._lastAdDuration=null,this._sponsors=[],this._promos=[],this._prerolls=[],this._midrollsNow=[],this._postrolls=[],this._postrollsInfo=[],this._endAdScreen=null,this._lastNearAdPointIdx=null,this._lastContentTime=e&&void 0!==e.time?e.time:null,this._isContentEnded=!1,this._isNearEnd=!1,this._isStopped=!1,this._mode!==yr){if(this.emit(vr.EVENT_CONTENT_SET,{content:this._originalContent}),this.isAdOnlyMode())return Promise.resolve();this.emit(vr.EVENT_PROGRAMME_BEGIN,{content:this._originalContent}),this._setContent(this._content).catch(e=>{const t=this.getErrorIfIsReason(e);t&&this._handleError(t)})}return t=this._contentReady?Promise.resolve():new Promise((e,t)=>{this._uiMediaPlayer.once(X.EVENT_SOURCE_READY,()=>{e()}),this.registerPendingPromise(t)})}_setAd(e,t){this._adsInRow||(this._adsInRowTotal=t===vr.adRole.PREROLL?this.getAdsCount(vr.adRole.PROMO)+this.getAdsCount(vr.adRole.SPONSOR)+this.getAdsCount(vr.adRole.PREROLL):this.getAdsCount(t),t===vr.adRole.MIDROLL&&this._adIndex++),this._adsInRow++,this._isStopped=!1,this._lastAdDuration=e.duration||null,this._uiMediaPlayer.reset(),this._mode=fr;const i=e.sourceVpaid&&this.isFeatureSupported("vpaid");if(i)this._vpaidPlayer=this._vpaidPlayer||(()=>{const e=this._uiVpaidPlayerCreator(this._options);return e.configureFullscreen({element:this._fsElement}),e.configureCinema({element:this._fsElement}),e.configurePip(),e.configureAirPlay(),this._uiMediaPlayer.registerStrategy("vpaid",e),e})(),this._uiMediaPlayer.switchStrategy("vpaid");else{if(!e.source){const t=Er.createError(m.AD,"No supported linear-ad found."),i=e.sourceVpaid&&!this._isAutoplayAllowed?900:403;return t.hitData={ERRORCODE:i},t.material=e,e.errors&&Xo.track(e.errors,t.hitData),this._handleError(t),Promise.resolve()}this._uiMediaPlayer.switchStrategy("main")}this._wasPlaying&&this._uiMediaPlayer.setSourcePreload(!0),this.emit(vr.EVENT_AD_BEGIN,Object.assign({isVpaid:i,role:t,material:e,sequenceLength:this._adsInRowTotal,sequencePosition:this._adsInRow},t===vr.adRole.MIDROLL?{sequenceIndex:this._adIndex,sequenceCount:this._adMidrollPoints.length}:{})),this._viewportObserver.startObserve(this._fsElement),this._fragmentors[fr].start(),this._played[fr].start();let s=null;const n=new Promise((e,t)=>{s=e,this.registerPendingPromise(t)}),o=()=>{s()};this._uiMediaPlayer.once(X.EVENT_SOURCE_READY,o),this.registerPendingEvent(this._uiMediaPlayer,X.EVENT_SOURCE_READY,o);try{this._uiMediaPlayer.setSource(i?e.sourceVpaid:e.source,{disableAdaptive:this._content.disableAdaptive,forcedQualityIdx:this._content.forcedQualityIdx,forcedQualityFunc:this._content.forcedQualityFunc,storedQualityIdx:this._content.storedQualityIdx,bandwidth:this._content.bandwidth,preloadedStats:i?[]:this._preloader.getStats(e.source)})}catch(e){return e.hitData||(e.hitData={ERRORCODE:400}),this._handleError(e),n}const r=!!this._options.countAds||!1;return this._uiMediaPlayer.setAdvertLayout({seekingEnabled:!1,settingsEnabled:!1,qualityEnabled:!1,subtitlesEnabled:!1,fullscreenEnabled:!0,pipEnabled:!i,cinemaEnabled:!0,airPlayEnabled:!i,videoSkippableAfter:e.skipOffset||-1,videoCountCurrent:r?this._adsInRow:0,videoCountTotal:r?this._adsInRowTotal:0,adLayout:e.layout||"default",adCanceled:this._midrollCanCancel,adUrl:e.clickthrough||"",adUrlTarget:e.clickthroughTarget||"_blank",colors:{progressBar:this.isAdOnlyMode()?this._adOnlyColorProfile.progressBarAdvert:this.isAudioOnlyMode()?this._audioOnlyColorProfile.progressBarAdvert:this._colorProfile.progressBarAdvert,indicator:this.isAdOnlyMode()?this._adOnlyColorProfile.indicator:this.isAudioOnlyMode()?this._audioOnlyColorProfile.indicator:this._colorProfile.indicator},ppInContent:!1}),this._preloadNextContent(),this._uiMediaPlayer.hideLogo(),this._hideAdPoints(),this._controlsHidden&&this._uiMediaPlayer.setControlsHidden(this._controlsHidden),this._noPauseOnClick&&this._uiMediaPlayer.setNoPauseOnClick(this._noPauseOnClick),this._removeOverlayVisualElements(),this._notPlayed=!0,this._contentStart=!0,this._currentLinearAd=e,e.textSource&&this._uiMediaPlayer.setTextSource(e.textSource),n}_setContent(e,t){this._adsInRow=0,this._adsInRowTotal=0,this._isStopped=!1,this._uiMediaPlayer.reset(),this._mode=yr,this._uiMediaPlayer.switchStrategy("main"),this._wasPlaying&&this._uiMediaPlayer.setSourcePreload(!0),t?this.emit(vr.EVENT_CONTENT_RESTORE,{material:this._originalContent}):(this.emit(vr.EVENT_CONTENT_BEGIN,{material:this._originalContent}),this._fragmentors[yr].start(e.startTime),this._played[yr].start(e.startTime)),this._contentReady=!1;let i=null;const s=new Promise((e,t)=>{i=e,this.registerPendingPromise(t)}),n=()=>{this._contentReady=!0,this.emit(vr.EVENT_CONTENT_READY,{content:this.getResolvedContent()}),i()};this._uiMediaPlayer.once(X.EVENT_SOURCE_READY,n),this.registerPendingEvent(this._uiMediaPlayer,X.EVENT_SOURCE_READY,n),this._contentStartTime=e.startTime||0,this._uiMediaPlayer.setSource(e.source,{startTime:null!==this._lastContentTime?Math.max(null!==this._lastAdDuration?this._lastContentTime+this._lastAdDuration:this._lastContentTime-vr.MIDROLL_SEEK_BACK_TIME,0):e.startTime,alreadySet:t,streamingType:e.streamingType,disableAdaptive:e.disableAdaptive,forcedQualityIdx:e.forcedQualityIdx,forcedQualityFunc:e.forcedQualityFunc,storedQualityIdx:e.storedQualityIdx,storedAudioTrack:e.storedAudioTrack,storedVideoTrack:e.storedVideoTrack,bandwidth:e.bandwidth,preloadedStats:this._preloader.getStats(e.source)});const o=Object.assign({videoPoster:e&&e.poster?e.poster:"",videoPosterSrcset:e&&e.posterSrcSet?e.posterSrcSet:"",videoPosterSizes:e&&e.posterSizes?e.posterSizes:"",videoTitle:e&&e.title?e.title:"",videoSubtitle:e&&e.subtitle?e.subtitle:"",videoDuration:e&&e.duration?e.duration:0},e.contentInfo);return this._uiMediaPlayer.setDefaultLayout({videoCountdownBefore:this._options.countdownBeforeAd||0,tvMode:this._options.tvMode||!1,settingsEnabled:!0,qualityEnabled:!0,subtitlesEnabled:!0,additionalEnabled:!0,fullscreenEnabled:!0,pipEnabled:!0,cinemaEnabled:!0,airPlayEnabled:!0,colors:{progressBar:this.isAudioOnlyMode()?this._audioOnlyColorProfile.progressBarDefault:this._colorProfile.progressBarDefault,indicator:this.isAudioOnlyMode()?this._audioOnlyColorProfile.indicator:this._colorProfile.indicator},seekSource:e.seekSource||null,chapters:e.chapters,contentInfo:o,ppInContent:e.pp||!1}),this._preloadNextContent(),this._uiMediaPlayer.setLogo(this._logoSrc),this._uiMediaPlayer.showLogo(),this._uiMediaPlayer.setActionArea(this._actionCaption),this._showAdPoints(),this._controlsHidden&&this._uiMediaPlayer.setControlsHidden(this._controlsHidden),this._noPauseOnClick&&this._uiMediaPlayer.setNoPauseOnClick(this._noPauseOnClick),this._originalOverlays.length&&this._setOverlays(this._originalOverlays),this._notPlayed=!t,this._contentStart=!0,this._wasContentAlreadySet=!0,this._currentLinearAd=null,e.textSource&&this._uiMediaPlayer.setTextSource(e.textSource),s}_getAdPoint(e){const t=this._adMidrollPoints.filter(t=>t.time<e&&!t.disabled);if(t.length){const i=t.pop(),s=this._forceMidrolls?this._midrollSeekDistance:1;if(e-i.time<s)return i}return null}_tryStartPlayingMidrolls(){this._mode!==fr&&this._midrollsNow.length&&(this._uiMediaPlayer.pause(),this._setAd(this._midrollsNow[0],vr.adRole.MIDROLL).then(()=>{this._uiMediaPlayer.play()}).catch(e=>{const t=this.getErrorIfIsReason(e);t&&(t.hitData||(t.hitData={ERRORCODE:400}),this._handleError(t))}))}_cancelStop(){this._isStopped&&this._mode!==Tr&&(this._isStopped=!1,this._stopPropagation[X.EVENT_SEEKSTART]=this._stopPropagation[X.EVENT_SEEKING]=this._stopPropagation[X.EVENT_SEEKED]=!0,this._uiMediaPlayer.once(X.EVENT_SEEKED,this._finishCancelStop),this.registerPendingEvent(this._uiMediaPlayer,X.EVENT_SEEKED,this._finishCancelStop),this._uiMediaPlayer.seek(0))}_handleReplayRequest(){this._isReplay=!0,this._mode===yr?this.play():this.replay(),this.emit(vr.EVENT_REPLAY_REQUEST)}_handlePreloaderError(e){if(this._currentlyPreloading&&this._currentlyPreloading.time){const t=this._currentlyPreloading.time,i=this._adMidrollPoints.find(e=>e.time===t&&e.isSuccessful);if(i){i.disabled=!0,this._removeAdPoint({time:t});const s=this._currentlyPreloading.errors;s&&(e.hitData={ERRORCODE:400},Xo.track(s,e.hitData)),e.isAdMode=!0,e.material=i,this.emit(vr.EVENT_ERROR,e),this._preloadNextContent()}}}_startCheckingExactTime(){this._exactTimeTimer||(this._exactTimeTimer=requestAnimationFrame(()=>this._checkExactTime()))}_stopCheckingExactTime(){this._exactTimeTimer&&(cancelAnimationFrame(this._exactTimeTimer),this._exactTimeTimer=null)}_checkExactTime(){if(this._mode===yr){const e=this.getCurrentTime();isNaN(e)||(this._lastContentTime=e,this._evaluateAdPoints(e))}this._exactTimeTimer=requestAnimationFrame(()=>this._checkExactTime())}_evaluateAdPoints(e){const t=Math.round(100*e)/100,i=this._getAdPoint(t);i&&(i.disabled=!0,this._removeAdPoint({time:i.time}),this.emit(vr.EVENT_ADPOINT,i))}_removeVpaidMidrollPoints(){this._adMidrollPoints.forEach(e=>{e.isVpaid&&!e.disabled&&(e.disabled=!0,this._removeAdPoint({time:e.time}))})}_handleReady(){this._techReadyResolve(),this.emit(vr.EVENT_READY)}_handleFullscreenChange(e){this.emit(vr.EVENT_FULLSCREEN_CHANGE,e)}_handlePipChange(e){e.isPip&&this._removeVpaidMidrollPoints(),this.emit(vr.EVENT_PIP_CHANGE,e)}_handleCinemaChange(e){this.emit(vr.EVENT_CINEMA_CHANGE,e)}_handleAirPlayChange(e){this.emit(vr.EVENT_AP_CHANGE,e)}_handleVolumeChange(e){this.emit(vr.EVENT_VOLUME_CHANGE,e)}_handleUiResize(e){this.emit(vr.EVENT_UI_RESIZE,e)}_handleQualitySet(e){e.autoset||(this._content.storedQualityIdx=e.qualityIdx),this.emit(vr.EVENT_QUALITY_SET,e)}_handleTrackSet(e){e.isUserAction&&(e.trackType==C.TYPE_AUDIO?this._content.storedAudioTrack=e.trackName:this._content.storedVideoTrack=e.trackName),this.emit(vr.EVENT_TRACK_SET,e)}_handleQualityChange(e){this.emit(vr.EVENT_QUALITY_CHANGE,e)}_handleDurationChange(e){this.emit(vr[`EVENT_${this._mode}_DURATION_CHANGE`],e)}_handleLoadedMetadata(e){let t=Object.assign({isLive:this.isLive()},e);this.emit(vr[`EVENT_${this._mode}_LOADED_METADATA`],t)}_handleSourceSet(e){this.emit(vr[`EVENT_${this._mode}_SOURCE_SET`],e)}_handleTextSourceSet(e){this.emit(vr[`EVENT_${this._mode}_TEXT_SOURCE_SET`],e)}_handleTextTrackSet(e){this.emit(vr.EVENT_TEXT_TRACK_SET,e)}_handleLoadedData(e){this.emit(vr[`EVENT_${this._mode}_LOADED_DATA`])}_handleLoadedSegment(e){this.emit(vr[`EVENT_${this._mode}_LOADED_SEGMENT`],e)}_handleBufferEmpty(e){this.emit(vr.EVENT_BUFFER_EMPTY,e)}_handleCanPlay(e){this.emit(vr[`EVENT_${this._mode}_CAN_PLAY`],e)}_handlePlay(e){this._startCheckingExactTime()}_handlePlayDenied(e){this.emit(vr.EVENT_PLAY_DENIED)}_handlePlaying(e){this.emit(vr.EVENT_PLAYING,Object.assign(e,{mode:this._mode,first:this._notPlayed,start:this._contentStart})),this._notPlayed=!1,this._contentStart=!1,this._wasPlaying=!0,this._tryStartPlayingMidrolls()}_handlePaused(e){this._stopCheckingExactTime(),this._stopPropagation[X.EVENT_PAUSED]||this.emit(vr.EVENT_PAUSED,Object.assign(e,{mode:this._mode}))}_handleTimeUpdate(e){const t=e.time;if(this._mode===Tr)return;this._fragmentors[this._mode].update(t),this._played[this._mode].update(t);const i=this._uiMediaPlayer.getDuration();if(i){const e=this._played[this._mode].getLength(),t=e/i*100;this.emit(vr.EVENT_PLAYBACK_PROGRESS,{time:e,percent:t})}this._preloader.checkPreload(t),this._mode===yr&&(this._lastContentTime=t,this.isPlaying()&&(!this._isNearEnd&&!this._uiMediaPlayer.isLiveStreaming()&&t+vr.NEAR_TIME>=this._uiMediaPlayer.getDuration()&&(this._isNearEnd=!0,this.emit(vr.EVENT_NEAR_END,{})),this._evaluateAdPoints(t))),this.emit(vr.EVENT_TIMEUPDATE,e)}_handlePlaybackProgress(e){this.emit(vr.EVENT_PLAYBACK_PROGRESS,e)}_handleSeekstart(e){this._fragmentors[this._mode].reset(),this._played[this._mode].reset(),this._stopPropagation[X.EVENT_SEEKSTART]||this.emit(vr.EVENT_SEEKSTART,e)}_handleSeeking(e){this._fragmentors[this._mode].reset(),this._played[this._mode].reset(),this._stopPropagation[X.EVENT_SEEKING]||this.emit(vr.EVENT_SEEKING,e)}_handleSeeked(e){this._preloadNextContent(),this._stopPropagation[X.EVENT_SEEKED]||this.emit(vr.EVENT_SEEKED,e)}_handleEnded(){this._fragmentors[this._mode].update(this._uiMediaPlayer.getDuration()),this._played[this._mode].update(this._uiMediaPlayer.getDuration()),this._mode!==yr||this._isNearEnd||(this._isNearEnd=!0,this.emit(vr.EVENT_NEAR_END,{})),this.emit(vr.EVENT_ENDED,{mode:this._mode}),this._mode===fr?(this._shiftToNextAd(),this._setAndPlayNext()):this._mode===yr&&(this._isContentEnded=!0,this._setAndPlayNext())}_handleVideoClickthrough(e){const t=this.isEnded();this.isAdOnlyMode()?t||this.setMute(!0):t||this.pause(),this.emit(vr.EVENT_VIDEO_CLICKTHROUGH,e)}_handleActionClickthrough(e){this.emit(vr.EVENT_ACTION_CLICKTHROUGH,e)}_handleActionBack(e){this.emit(vr.EVENT_ACTION_BACK,e)}_handleActionContentLink(e){this.emit(vr.EVENT_ACTION_CONTENT_LINK,e)}_handleVEDisplayed(e){this.emit(vr.EVENT_VE_DISPLAYED,e)}_handleVEHidden(e){this.emit(vr.EVENT_VE_HIDDEN,e)}_handleVEClick(e){this.pause(),this.emit(vr.EVENT_VE_CLICK,e)}_handleVEClose(e){this.emit(vr.EVENT_VE_CLOSE,e)}_handleVEError(e){const t=Er.createError(m.SETTING,`Visual element with id "${e.id}" threw the following`+` error: ${e.error}.`);this.emit(vr.EVENT_ERROR,t)}_handleUserAcceptInvitation(e){this.emit(vr.EVENT_USER_ACCEPT_INVITATION,e)}_handleUserMinimize(e){this.emit(vr.EVENT_USER_MINIMIZE,e)}_handleUserClose(e){this.emit(vr.EVENT_USER_CLOSE,e)}_handleImpression(e){this.emit(vr.EVENT_IMPRESSION,e)}_handleAdVisible(){this.emit(vr.EVENT_AD_VISIBLE)}_handleAdNotVisible(){this.emit(vr.EVENT_AD_NOT_VISIBLE)}_handleAdVisibilityUndetermined(){this.emit(vr.EVENT_AD_VISIBILITY_UNDETERMINED)}_getNextSource(){const e=null===this._lastContentTime,t=this._adMidrollPoints.filter(e=>!e.disabled&&e.isSuccessful&&e.time>this._lastContentTime);return e&&this._prerolls.length>1?this._prerolls[1]:e&&this._prerolls.length&&this._promos.length?this._promos[0]:e&&this._promos.length>1?this._promos[1]:e&&(this._prerolls.length||this._promos.length)&&this._sponsors.length?this._sponsors[0]:e&&this._sponsors.length>1?this._sponsors[1]:!e&&!this._isContentEnded&&this._midrollsNow.length>1?this._midrollsNow[1]:e||this._isContentEnded||!t.length||this._mode!==yr?e||this._isContentEnded||t.length||!this._postrollsInfo.length||this._mode!==yr?!e&&this._isContentEnded&&this._postrolls.length>1?this._postrolls[1]:this._isContentEnded||this._mode===yr?null:this._content:this._postrollsInfo[0].linearAd:Object.assign({time:t[0].time,errors:t[0].errors},t[0].linearAd)}_preloadNextContent(){if(this._preloader.reset(),this._currentlyPreloading=null,"main"!==this._uiMediaPlayer.getStrategyName()||"html"!==this.getTechName())return;const e=this._getNextSource();if(e&&e.source){const t={startTime:"startTime"in e?null!==this._lastContentTime?Math.max(this._lastContentTime-vr.MIDROLL_SEEK_BACK_TIME,0):this._content.startTime:null,streamingType:this._content.streamingType,disableAdaptive:this._content.disableAdaptive,forcedQualityIdx:this._content.forcedQualityIdx,forcedQualityFunc:this._content.forcedQualityFunc,storedQualityIdx:this._content.storedQualityIdx,storedAudioTrack:this._content.storedAudioTrack,storedVideoTrack:this._content.storedVideoTrack,bandwidth:this._content.bandwidth};this._preloader.start(this._uiMediaPlayer,e.source,t,e.time||null),this._currentlyPreloading=e}}_setAndPlayNext(){const e=null===this._lastContentTime;this._viewportObserver.reset(),this._mode===fr&&(this.emit(vr.EVENT_AD_END),this._mode=Tr),(this._uiMediaPlayer.isPipActive()||this._uiMediaPlayer.isAirPlayActive())&&this._shiftToNextNonVpaidAd();let t=null;if(e&&this._prerolls.length)t=this._setAd(this._prerolls[0],vr.adRole.PREROLL);else if(e&&this._promos.length)t=this._setAd(this._promos[0],vr.adRole.PROMO);else if(e&&this._sponsors.length)t=this._setAd(this._sponsors[0],vr.adRole.SPONSOR);else if(e||this._isContentEnded||!this._midrollsNow.length){if(!e&&this._isContentEnded&&this._postrolls.length)this.emit(vr.EVENT_CONTENT_END),this._mode=Tr,t=this._setAd(this._postrolls[0],vr.adRole.POSTROLL);else if(this._isContentEnded){if(this.emit(vr.EVENT_CONTENT_END),this._mode=Tr,this.emit(vr.EVENT_ENDADSCREEN_POINT),this._endAdScreen)return this.exitFullscreen(),this.showDialog({kind:lr.layout.AD,caption:this._endAdScreen.caption,content:this._endAdScreen.content,im:this._endAdScreen.im||null}),this.emit(vr.EVENT_PROGRAMME_END),Promise.resolve();this.emit(vr.EVENT_PROGRAMME_END)}else if(!this._isContentEnded){if(this.isAdOnlyMode())return this.emit(vr.EVENT_PROGRAMME_END),this.stop(),Promise.resolve();t=this._setContent(this._content,!e)}}else t=this._setAd(this._midrollsNow[0],vr.adRole.MIDROLL);return null!==t?t.then(()=>{this._wasPlaying&&this._uiMediaPlayer.play()}).catch(e=>{const t=this.getErrorIfIsReason(e);t&&this._handleError(t)}):(this.stop(),Promise.resolve())}_shiftToNextAd(){null===this._lastContentTime?this._prerolls.length?this._prerolls.shift():this._promos.length?this._promos.shift():this._sponsors.shift():this._isContentEnded?this._postrolls.shift():this._midrollsNow.shift()}_shiftToNextNonVpaidAd(){const e=null===this._lastContentTime;let t=null;e&&this._prerolls.length?t=this._prerolls[0]:e&&this._promos.length?t=this._promos[0]:e&&this._sponsors.length?t=this._sponsors[0]:e||this._isContentEnded||!this._midrollsNow.length?!e&&this._isContentEnded&&this._postrolls.length&&(t=this._postrolls[0]):t=this._midrollsNow[0],t&&t.sourceVpaid&&this.isFeatureSupported("vpaid")&&(this._shiftToNextAd(),this._shiftToNextNonVpaidAd())}_finishCancelStop(){this._stopPropagation[X.EVENT_SEEKSTART]=this._stopPropagation[X.EVENT_SEEKING]=this._stopPropagation[X.EVENT_SEEKED]=!1}_finishStop(){this._stopPropagation[X.EVENT_PAUSED]=!1}_finishSkip(){this._stopPropagation[X.EVENT_PAUSED]=!1}_finishReplay(){this._stopPropagation[X.EVENT_PAUSED]=!1}_handleError(e){this.abortPending(),this.emit(vr.EVENT_ERROR,e),this._mode===fr&&(this._shiftToNextAd(),this._setAndPlayNext())}_handleWarning(e){this.emit(vr.EVENT_WARNING,e)}}vr.adRole={PREROLL:"preroll",MIDROLL:"midroll",POSTROLL:"postroll",SPONSOR:"sponsor",PROMO:"promo"},vr.MODE_IDLE=Tr,vr.MODE_CONTENT=yr,vr.MODE_AD=fr,vr.NEAR_TIME=10,vr.MIDROLL_SEEK_PERCENTAGE=15,vr.MIDROLL_SEEK_BACK_TIME=3,vr.AD_VISIBLE_DURATION=2e3,vr.AD_VISIBLE_THRESHOLD=.5,vr.EVENT_AD_VISIBLE="advisible",vr.EVENT_AD_NOT_VISIBLE="adnotvisible",vr.EVENT_AD_VISIBILITY_UNDETERMINED="advisiblityundetermined",vr.EVENT_READY="ready",vr.EVENT_COMPANION_ADS_READY="companionadsready",vr.EVENT_ERROR="error",vr.EVENT_WARNING="warning",vr.EVENT_FULLSCREEN_CHANGE="fullscreenchange",vr.EVENT_PIP_CHANGE="pipchange",vr.EVENT_CINEMA_CHANGE="cinemachange",vr.EVENT_AP_CHANGE="airplaychange",vr.EVENT_VOLUME_CHANGE="volumechange",vr.EVENT_UI_RESIZE="ui-resize",vr.EVENT_QUALITY_SET="qualityset",vr.EVENT_TRACK_SET="trackset",vr.EVENT_QUALITY_CHANGE="qualitychange",vr.EVENT_TEXT_TRACK_SET="texttrackset",vr.EVENT_BUFFER_EMPTY="bufferempty",vr.EVENT_PLAYING="playing",vr.EVENT_PLAY_DENIED="playdenied",vr.EVENT_PAUSED="paused",vr.EVENT_STOPPED="stopped",vr.EVENT_TIMEUPDATE="timeupdate",vr.EVENT_SEEKSTART="seekstart",vr.EVENT_SEEKING="seeking",vr.EVENT_SEEKED="seeked",vr.EVENT_NEAR_END="nearend",vr.EVENT_ENDED="ended",vr.EVENT_SKIP="skip",vr.EVENT_REPLAY_REQUEST="replayrequest",vr.EVENT_VIDEO_CLICKTHROUGH="videoclickthrough",vr.EVENT_ACTION_CLICKTHROUGH="actionclickthrough",vr.EVENT_ACTION_BACK="actionback",vr.EVENT_ACTION_CONTENT_LINK="actioncontentlink",vr.EVENT_VE_DISPLAYED="visualelement-displayed",vr.EVENT_VE_HIDDEN="visualelement-hidden",vr.EVENT_VE_CLICK="visualelement-click",vr.EVENT_VE_CLOSE="visualelement-close",vr.EVENT_USER_ACCEPT_INVITATION="user-acceptinvitation",vr.EVENT_USER_MINIMIZE="user-minimize",vr.EVENT_USER_CLOSE="user-close",vr.EVENT_IMPRESSION="impression",vr.EVENT_PROGRAMME_BEGIN="programme-begin",vr.EVENT_PROGRAMME_END="programme-end",vr.EVENT_ENDSCREEN_SHOWN="endscreen-shown",vr.EVENT_CONTENT_BEGIN="content-begin",vr.EVENT_CONTENT_RESTORE="content-restore",vr.EVENT_CONTENT_SET="content-set",vr.EVENT_CONTENT_SOURCE_SET="content-sourceset",vr.EVENT_CONTENT_READY="content-ready",vr.EVENT_CONTENT_TEXT_SOURCE_SET="content-textsourceset",vr.EVENT_CONTENT_DURATION_CHANGE="content-durationchange",vr.EVENT_CONTENT_LOADED_DATA="content-loadeddata",vr.EVENT_CONTENT_LOADED_SEGMENT="content-loadedsegment",vr.EVENT_CONTENT_LOADED_METADATA="content-loadedmetadata",vr.EVENT_CONTENT_CAN_PLAY="content-canplay",vr.EVENT_CONTENT_END="content-end",vr.EVENT_AD_BEGIN="ad-begin",vr.EVENT_AD_SOURCE_SET="ad-sourceset",vr.EVENT_AD_TEXT_SOURCE_SET="ad-textsourceset",vr.EVENT_AD_DURATION_CHANGE="ad-durationchange",vr.EVENT_AD_LOADED_DATA="ad-loadeddata",vr.EVENT_AD_LOADED_SEGMENT="ad-loadedsegment",vr.EVENT_AD_LOADED_METADATA="ad-loadedmetadata",vr.EVENT_AD_CAN_PLAY="ad-canplay",vr.EVENT_AD_END="ad-end",vr.EVENT_ADPOINT="adpoint",vr.EVENT_ENDADSCREEN_POINT="endadscreenpoint",vr.EVENT_DESTROYING="destroying",vr.EVENT_UNLOAD="EVENT_UNLOAD";const Ar={CREATIVE:"An Error occured inside the VPAID creative.",TIMEOUT:"Timeout occured on VPAID event."},Sr={mode:"normal",sourceReady:!1,started:!1,playing:!1,ending:!1,ended:!1,remainingTime:-2,duration:0,skippable:!1,volume:1,previousVolume:1,muted:!1};let br=new m.ErrorFactory(m.createSourceName("src/js/richmediaplayer/VpaidPlayer.js"));class Cr extends X{static getTechName(){return"vpaid_html"}static isSupported(){return!!window.document.createElement("video").canPlayType}static canPlayType(e){return"application/javascript"===e}static canPlaySource(e){return e&&"application/javascript"===e.type}constructor(e,t,i){super(e,t,{},{id:i.id||"vpaidplayer",timeout:i.timeout}),this._container=document.createElement("div"),this._iframe=null,this._source=null,this._flags=Object.assign({},Sr),this._vastAd=null,this._statsHistory=[],this._sessionId=null,this._queue=[],this._timers=[],this._creativeEventsMap={AdLoaded:this._handleLoaded,AdStarted:this._handleStarted,AdStopped:this._handleStopped,AdSkipped:this._handleSkipped,AdSkippableStateChange:this._handleSkippableStateChange,AdSizeChange:this._handleSizeChange,AdLinearChange:this._handleLinearChange,AdDurationChange:this._handleDurationChange,AdExpandedChange:this._handleExpandedChange,AdRemainingTimeChange:this._handleRemainingTimeChange,AdVolumeChange:this._handleVolumeChange,AdImpression:this._handleImpression,AdVideoStart:this._handleStart,AdVideoFirstQuartile:this._handleFirstQuartile,AdVideoMidpoint:this._handleMidpoint,AdVideoThirdQuartile:this._handleThirdQuartile,AdVideoComplete:this._handleComplete,AdClickThru:this._handleClick,AdInteraction:this._handleInteraction,AdUserAcceptInvitation:this._handleUserAcceptInvitation,AdUserMinimize:this._handleUserMinimize,AdUserClose:this._handleUserClose,AdPaused:this._handlePaused,AdPlaying:this._handlePlaying,AdLog:this._handleLog,AdError:this._handleCreativeError,sznVpaid_iframeReady:this._handleReady},this._container.classList.add("c-VpaidPlayer"),window.addEventListener("message",this._receiveMessage.bind(this),!1)}destroy(){this.resetSource(),this._queue_clean(),this._flags=null,this._container=null,this._creativeEventsMap=null,this._options=null}getElement(){return this._container}getPlayerId(){return this._options.id}getSource(){return this._source}getResolvedSource(){return this._source}getCurrentSrc(){return this._source?this._source.src:""}getCurrentAdaptiveSrc(){return""}getTextSource(){return""}getSupportedTextTracks(){return[]}getTextTrack(){return null}getPoster(){return""}getQuality(){return null}getVideoWidth(){return null}getVideoHeight(){return null}getVideoDimensions(){return null}getElementDimensions(){return null}getVolume(){if(!this._iframe)return this._flags.volume;if(this.isMuted())return this._flags.previousVolume;{const e=this._flags.volume;return e>-1?e:1}}getCurrentTime(){if(!this._iframe)return 0;const e=this._flags.remainingTime,t=this.getDuration();return e>-1&&t>0&&t>=e?t-e:0}getStartTime(){return null}getDuration(){const e=this._flags.duration;return e>0?e:this._source.options&&this._source.options.vastDuration||0}getBuffered(e){return{}}getStatsHistory(){return this._statsHistory}getCurrentFrame(e){return null}isCustomUiCapable(){return!0}isReady(){return!0}isSourceReady(){return this._flags.sourceReady}isAdaptiveSource(){return!1}isNative(){return!1}getCurrentQualityItem(){return null}isMuted(){return this._flags.muted}isPlaying(){return this._flags.playing}isPaused(){return!this._flags.playing}isEnded(){return this._flags.ended}isBufferEmpty(){return!this._flags.sourceReady}isLive(){return!1}isEvent(){return!1}isLivePlaying(){return!1}isLiveStreaming(){return!1}hasTextTrack(e){return!1}setSourcePreload(e){}setSource(e,t={}){if(!e||"object"!=typeof e)throw br.createError(m.AD_VPAID_SOURCE,"Source must be an object.");if(!Cr.canPlayType(e.type))throw br.createError(m.AD_VPAID_SOURCE,`Type "${e.type}" is not supported.`);this.reset(),this._source=e,this._createStage(),this.emit(X.EVENT_BUFFER_EMPTY)}setTextSource(e){}setTextTrack(e=null){}setLocalizedTexts(e){}setPoster(e){}setQuality(e){}setVolume(e){this._flags.volume=e,this._flags.previousVolume=e,this._flags.sourceReady?this._sendMessage({function:"setAdVolume",args:[e]}):this._queue_add("setVolume",[e])}setMute(e){if(this._flags.muted=e,!this._flags.sourceReady)return void this._queue_add("setMute",[e]);const t=e?0:this._flags.previousVolume;this._sendMessage({function:"setAdVolume",args:[t]})}setAdPoints(e){}addStats(e){this._statsHistory.push(e)}play(){if(this._flags.sourceReady){if(this._flags.started){if(this._flags.playing)return;this._startTimer("AdPlaying",()=>{const e=br.createError(m.AD_VPAID_SOURCE,"Event AdPlaying timeouted.");e.genericMessage=Ar.TIMEOUT,this._handleError(e)},this._options.timeout),this._sendMessage({function:"resumeAd"})}else this._startTimer("AdStarted",()=>{const e=br.createError(m.AD_VPAID_SOURCE,"Event AdStarted timeouted.");e.genericMessage=Ar.TIMEOUT,this._handleError(e)},this._options.timeout),this._sendMessage({function:"startAd"});this._flags.playing=!0}else this._queue_add("play")}pause(){this._flags.sourceReady?this._flags.playing&&(this._startTimer("AdPaused",()=>{const e=br.createError(m.AD_VPAID_SOURCE,"Event AdPaused timeouted.");e.genericMessage=Ar.TIMEOUT,this._handleError(e)},this._options.timeout),this._sendMessage({function:"pauseAd"}),this._flags.playing=!1):this._queue_add("pause")}seek(e){this._flags.sourceReady?this._sendMessage({function:"seek",args:[e]}):this._queue_add("seek",[e])}seekToLive(){}skip(){if(this._flags.playing=!1,this._flags.sourceReady=!1,this._flags.ended=!0,!this._flags.skippable)return this._startTimer("AdStopped",()=>{const e=br.createError(m.AD_VPAID_SOURCE,"Event AdStopped timeouted.");e.genericMessage=Ar.TIMEOUT,this._handleError(e)},this._options.timeout),void this._sendMessage({function:"stopAd"});this._startTimer("AdSkipped",()=>{const e=br.createError(m.AD_VPAID_SOURCE,"Event AdSkipped timeouted.");e.genericMessage=Ar.TIMEOUT,this._handleError(e)},this._options.timeout),this._sendMessage({function:"skipAd"})}setViewMode(e){"normal"!==e&&"fullscreen"!==e&&"thumbnail"!==e||this._source&&setTimeout(()=>{this._flags.mode=e,this._sendMessage({function:"resizeAd",args:[this._container.clientWidth,this._container.clientHeight,e]})},0)}resetSource(){this._flags.started&&this._flags.sourceReady&&this._sendMessage({function:"stopAd"}),this._clearStage(),this._clearTimers(),this._source=null,this._vastAd=null,this._sessionId=null,this._flags=Object.assign({},Sr,{volume:this._flags.volume,previousVolume:this._flags.previousVolume,muted:this._flags.muted})}reset(){this.resetSource()}_sendMessage(e){if(this._iframe)e.sessionId=this._sessionId,this._iframe.contentWindow.postMessage(e,"*");else{const e=br.createError(m.AD_VPAID_SOURCE,"Unable to send a message to an un-initialized iframe");this._handleError(e)}}_receiveMessage(e){const t=e.data;if(void 0!==t.type&&void 0!==t.value&&(t.sessionId&&t.sessionId===this._sessionId||"event"===t.type&&"sznVpaid_iframeReady"===t.value)){if("error"===t.type){const e=br.createError(m.AD_VPAID_SOURCE,t.value);return e.genericMessage=Ar.CREATIVE,void this._handleError(e)}if("event"===t.type){if(t.args){if(!(t.args instanceof Array)){const e=br.createError(m.AD_VPAID_SOURCE,'Event data from iframe contains a non-Array "args" property.');return void this._handleError(e)}}else t.args=[];if(void 0===this._creativeEventsMap[t.value]){const e=br.createError(m.AD_VPAID_SOURCE,'Event data from iframe contains a "value" property with an unsupported value.');return void this._handleError(e)}this._creativeEventsMap[t.value].apply(this,t.args)}}}_createStage(){let e=null,t=null;const i=new Promise((i,s)=>{e=i,t=s});return this._iframe=document.createElement("iframe"),this._iframe.onload=(()=>{e(this._iframe)}),this._iframe.onerror=(()=>{t(br.createError(m.AD_VPAID_SOURCE,"Loading iframe failed."))}),this._startTimer("iframeReady",()=>{const e=br.createError(m.AD_VPAID_SOURCE,"Loading iframe timeouted.");this._handleError(e)},this._options.timeout),this._iframe.src=Cr.IFRAME_CONTENT_SRC,this._iframe.allow="autoplay; fullscreen",this._iframe.scrolling="no",this._iframe.classList.add("w-Vpaid"),this._iframe.style.visibility="hidden",this._container.appendChild(this._iframe),i}_clearStage(){this._iframe&&this._container.removeChild(this._iframe),this._iframe=null}_startTimer(e,t,i){this._clearTimer(e),this._timers[e]=setTimeout(t,i)}_clearTimer(e){this._timers[e]&&(clearTimeout(this._timers[e]),this._timers[e]=null)}_clearTimers(){for(let e of Object.keys(this._timers))this._timers[e]&&(clearTimeout(this._timers[e]),this._timers[e]=null)}_evaluateEnd(){if(this._flags.ending||this._flags.ended||!this._flags.playing||!this._flags.sourceReady)return;const e=this._flags.remainingTime,t=this.getDuration();!e&&t>0&&(this._startTimer("AdStopped",()=>{const e=br.createError(m.AD_VPAID_SOURCE,"Event AdStopped timeouted.");e.genericMessage=Ar.TIMEOUT,this._handleError(e)},this._options.timeout),this._flags.ending=!0,this._sendMessage({function:"stopAd"}))}_initCreative(e,t){const i=this._container.clientWidth,s=this._container.clientHeight,n=this._flags.mode,o=this._statsHistory,r=o.length?Math.round(o[o.length-1].bandwidth/1e3):1200,a={AdParameters:this._source.options?this._source.options.adParameters:"",AdClickThru:this._source.options?this._source.options.videoClicks:{}};this._vastAd=this._source.options?this._source.options.vastAd:null,this._sessionId=this._utils.generateId("sznVpaid_"),this._startTimer("AdLoaded",()=>{const e=br.createError(m.AD_VPAID_SOURCE,"Event AdLoaded timeouted.");e.genericMessage=Ar.TIMEOUT,this._handleError(e)},this._options.timeout),this._sendMessage({function:"initCreative",args:[e,i,s,n,r,a,!0,this._flags.muted?0:this._flags.volume]})}_handleReady(){this._clearTimer("iframeReady"),this._initCreative(this._source.src,this._options.timeout)}_handleLoaded(){this._clearTimer("AdLoaded"),this._flags.sourceReady=!0,this._iframe.style.visibility="visible",this._queue_process(),this.emit(X.EVENT_SOURCE_READY,{source:this._source}),this.emit(X.EVENT_CAN_PLAY)}_handleStarted(){this._clearTimer("AdStarted"),this._flags.started=!0,this._flags.playing=!0,this._flags.ending=!1,this._flags.ended=!1,this.emit(X.EVENT_PLAY),this.emit(X.EVENT_PLAYING,{first:!0,time:0})}_handleStopped(){const e=this._flags.ended;this._clearTimer("AdStopped"),this._flags.playing=!1,this._flags.sourceReady=!1,this._flags.ended=!0,e||this.emit(X.EVENT_ENDED)}_handleSkipped(){const e=this._flags.ended;this._clearTimer("AdSkipped"),this._flags.playing=!1,this._flags.sourceReady=!1,this._flags.ended=!0,e||this.emit(X.EVENT_ENDED)}_handleSkippableStateChange(e){this._flags.skippable=e,this.emit(X.EVENT_SKIPPABLE_STATE_CHANGE,{isSkippable:this._flags.skippable})}_handleSizeChange(){0}_handleLinearChange(){0}_handleExpandedChange(){0}_handleDurationChange(e,t){isNaN(t)||(this._flags.remainingTime=t),this._flags.duration=e,this._evaluateEnd(),this.emit(X.EVENT_DURATION_CHANGE,{duration:this.getDuration()})}_handleRemainingTimeChange(e,t){isNaN(e)||(this._flags.remainingTime=e),t>0&&this._flags.duration!=t?(this._flags.duration=t,this._evaluateEnd(),this.emit(X.EVENT_DURATION_CHANGE,{duration:t})):this._evaluateEnd()}_handleVolumeChange(e){this._flags.volume=e,this._flags.muted=this.isMuted(),this._flags.previousVolume=this.getVolume(),this.emit(X.EVENT_VOLUME_CHANGE,{muted:this._flags.muted,level:this._flags.previousVolume})}_handleImpression(){this.emit(X.EVENT_IMPRESSION)}_handleStart(){this.emit(X.EVENT_PLAYBACK_PROGRESS,{percent:0});const e=this.getDuration();e>0&&this.emit(X.EVENT_DURATION_CHANGE,{duration:e})}_handleFirstQuartile(){this.emit(X.EVENT_PLAYBACK_PROGRESS,{percent:25})}_handleMidpoint(){this.emit(X.EVENT_PLAYBACK_PROGRESS,{percent:50})}_handleThirdQuartile(){this.emit(X.EVENT_PLAYBACK_PROGRESS,{percent:75})}_handleComplete(){this.emit(X.EVENT_PLAYBACK_PROGRESS,{percent:100})}_handleClick(e,t,i){this.emit(X.EVENT_VIDEO_CLICKTHROUGH)}_handleInteraction(){0}_handleUserAcceptInvitation(){this.emit(X.EVENT_USER_ACCEPT_INVITATION)}_handleUserMinimize(){this.emit(X.EVENT_USER_MINIMIZE)}_handleUserClose(){this.emit(X.EVENT_USER_CLOSE)}_handlePaused(){this._clearTimer("AdPaused"),this._flags.playing=!1,this.emit(X.EVENT_PAUSED,{ended:!1})}_handlePlaying(){this._clearTimer("AdPlaying"),this._flags.playing=!0,this._flags.ending=!1,this._flags.ended=!1,this.emit(X.EVENT_PLAY),this.emit(X.EVENT_PLAYING,{time:this.getCurrentTime()})}_handleLog(){0}_handleCreativeError(e=""){const t=br.createError(m.AD_VPAID_SOURCE,e);t.genericMessage=Ar.CREATIVE,this._handleError(t)}_handleError(e){e.hitData={ERRORCODE:901},this.emit(X.EVENT_ERROR,e)}_queue_add(e,t=null){this._queue.push({method:e,params:t})}_queue_process(){let e=null;for(;e=this._queue.shift();)Array.isArray(e.params)?this[e.method].apply(this,e.params):this[e.method].apply(this)}_queue_clean(){this._queue=[]}}function Pr(e={}){const t={timeout:e.timeout||U.vpaidResponseTimeout},i=new Cr(p,o,t),s=i.getElement();return i.MP_ORIGIN=Symbol("MediaPlayerOrigin"),o.decorate(i,Ro,i.MP_ORIGIN),i.initUi(s,{cmode:"transparent",adOnlyMode:!!e.adOnlyMode,customCinemaMode:!!e.customCinemaMode}),i.addStats({bandwidth:U.preferredBitrate}),i}Cr.IFRAME_CONTENT_SRC="//d53-a.sdn.szn.cz/d_53/"+parseInt("11.2.8",10)+"/11.2.8/vpaid-iframe-content.min.html";new m.ErrorFactory(m.createSourceName("src/js/mediaplayer/createPreloader.js"));function kr(e={}){let t=Object.assign(e,{preferredBitrate:e.preferredBitrate||U.preferredBitrate,adaptResolutionToSize:e.adaptResolutionToSize||U.adaptResolutionToSize}),i={maxAttemps:U.loadAttemps,timeout:U.requestTimeout},s=new Vi(new zt(o,i,zt.PROFILE_PLAYLIST),new $i(Ct)),n=new Ui(s,new zt(o,i,zt.PROFILE_SEGMENT),new R(U.qualityDict,t));return new cr(p,o,n,t)}function Ir(e={}){return new vr(o,p,Uo,Pr,kr,e)}class wr{newContent(e,t="",i=0,s=0,n=null,o=null){}break(){}restore(){}finish(){}setDuration(e){}track(e,t){}}let Nr=new m.ErrorFactory(m.createSourceName("src/js/richmediaplayer/tracking/TrackerController.js"));const Lr="IDLE",xr="AD",Mr="CONTENT";class Dr{constructor(e){this._player=e,this._sessions={AD:!1,CONTENT:!1},this._trackers={IDLE:[],AD:[],CONTENT:[]},this._opened={IDLE:[],AD:[],CONTENT:[]},this._flags={contentAlreadyBroke:!1};const t=this._player.constructor,i={READY:this._handleEvent,ERROR:this._handleEvent,QUALITY_SET:this._handleEvent,QUALITY_CHANGE:this._handleEvent,FULLSCREEN_CHANGE:this._handleEvent,VOLUME_CHANGE:this._handleEvent,TEXT_TRACK_SET:this._handleEvent,CONTENT_READY:this._handleEvent,BUFFER_EMPTY:this._handleEvent,PLAYING:this._handleEvent,PAUSED:this._handleEvent,STOPPED:this._handleEvent,TIMEUPDATE:this._handleEvent,PLAYBACK_PROGRESS:this._handleEvent,SEEKSTART:this._handleEvent,SEEKING:this._handleEvent,SEEKED:this._handleEvent,ENDED:this._handleEvent,SKIP:this._handleEvent,VIDEO_CLICKTHROUGH:this._handleEvent,VE_DISPLAYED:this._handleEvent,VE_HIDDEN:this._handleEvent,VE_CLICK:this._handleEvent,VE_CLOSE:this._handleEvent,USER_ACCEPT_INVITATION:this._handleEvent,USER_MINIMIZE:this._handleEvent,USER_CLOSE:this._handleEvent,IMPRESSION:this._handleEvent,AD_VISIBLE:this._handleEvent,AD_NOT_VISIBLE:this._handleEvent,AD_VISIBILITY_UNDETERMINED:this._handleEvent},s={SET:this._handleEvent,SOURCE_SET:this._handleEvent,LOADED_METADATA:this._handleEvent,DURATION_CHANGE:this._handleEvent,CAN_PLAY:this._handleEvent};for(let e of Object.keys(s)){const t=`AD_${e}`;i[`CONTENT_${e}`]=i[t]=s[e]}this._player.on(t.EVENT_CONTENT_BEGIN,this._openSession.bind(this,Mr)),this._player.on(t.EVENT_CONTENT_RESTORE,this._restoreSession.bind(this,Mr)),this._player.on(t.EVENT_AD_BEGIN,this._openSession.bind(this,xr)),this._player.on(t.EVENT_CONTENT_END,this._closeSession.bind(this,Mr)),this._player.on(t.EVENT_AD_END,this._closeSession.bind(this,xr)),this._player.on(t.EVENT_DESTROYING,this._closeAll.bind(this,xr)),this._player.on(t.EVENT_UNLOAD,this._closeAll.bind(this,xr));for(let e of Object.keys(i)){const s=t[`EVENT_${e}`];this._player.on(s,i[e].bind(this,e))}}addTracker(e,t){if(!o.hasInterface(t,wr))throw Nr.createError(m.SETTING,"Second argument must be instance of Tracker.");const i=this._trackers[e];i&&i.push(t)}removeTracker(e,t){const i=this._trackers[e],s=this._opened[e].indexOf(t);if(i){const e=i.indexOf(t);e>-1&&i.splice(e,1)}s>-1&&this._opened[e].splice(s,1)}_openSession(e,t){this._sessions[e]&&this._closeSession(e);const i=void 0!==t.sequenceLength?t.sequenceLength:1,s=void 0!==t.sequencePosition?t.sequencePosition:1,n=void 0!==t.sequenceIndex?t.sequenceIndex:null,o=void 0!==t.sequenceCount?t.sequenceCount:null,r=this._trackers[e];e===xr&&this._sessions[Mr]&&!this._flags.contentAlreadyBroke&&(this._trackers[Mr].forEach(e=>{e.break()}),this._flags.contentAlreadyBroke=!0),r.forEach(e=>{e.newContent(t.material,t.role,i,s,o,n)}),this._sessions[e]=!0}_restoreSession(e,t){this._trackers[e].forEach(e=>{e.restore()}),this._sessions[e]=!0}_closeSession(e){if(!this._sessions[e])return void 0;this._trackers[e].forEach(t=>{t.finish();const i=this._opened[e].indexOf(t);i>-1&&this._opened[e].splice(i,1)}),this._sessions[e]=!1,e===Mr&&(this._flags.contentAlreadyBroke=!1)}_closeAll(){const e=[xr,Mr,Lr];let t="";for(;t=e.shift();){this._trackers[t].forEach(e=>{this._opened[t].indexOf(e)>-1&&e.finish()}),this._sessions[t]=!1}this._opened={IDLE:[],AD:[],CONTENT:[]}}_handleEvent(e,t){const i=this._getMode(),s=this._trackers[i];if(s.length)if(e.indexOf("DURATION_CHANGE")>-1)s.forEach(e=>{e.setDuration(t.duration)});else if(e.indexOf("CONTENT_READY")>-1){if(t.content.source){const e=this._player.getDuration();e&&s.forEach(t=>{t.setDuration(e)})}}else s.forEach(i=>{i.track(e,t)})}_getMode(){return this._sessions[xr]?xr:this._sessions[Mr]?Mr:Lr}}class Or{constructor(){this._promise=Promise.resolve(),this._done=!1,this._canceled=!1,this._cancelResolve=null,this._cancelPromise=new Promise(e=>{this._cancelResolve=e})}then(e,t){if(!this._done)return this._promise=this._promise.then(t=>this._canceled?(this._done=!0,void this._cancelResolve()):e?e(t):void 0,e=>this._canceled?(this._done=!0,void this._cancelResolve()):t?t(e):void 0),this}catch(e){return this._promise=this._promise.catch(t=>this._canceled?(this._done=!0,void this._cancelResolve()):e?e(t):void 0),this}cancel(){return this._canceled=!0,this.then(),this._cancelPromise}}class Rr{setRange(e){}setAudioList(e){}setAds(e){}moveTo(e){}getAudioList(){}getCurrent(){}getCurrentOverlays(){}getOverlayConfig(){}getVariablePrerollConfig(){}getPrerollConfig(){}getSponsorConfig(){}getMidrollConfig(e,t){}getPostrollConfig(){}getCMConfig(){}getCompanionConfig(){}getFollowing(){}}const Ur={checkAdsConfig(e){if(!e)return Ur._invalid("AdsConfig must be specified.");if("object"!=typeof e)return Ur._invalid("AdsConfig must be an object.");if(e.sponsor){const t=Ur.checkSponsorConfig(e.sponsor);if(!t.valid)return t}if(e.variablePreroll){const t=Ur.checkVariablePrerollConfig(e.variablePreroll);if(!t.valid)return t}if(e.preroll){const t=Ur.checkPrerollConfig(e.preroll);if(!t.valid)return t}if(e.midroll){const t=Ur.checkMidrollConfig(e.midroll);if(!t.valid)return t}if(e.postroll){const t=Ur.checkPostrollConfig(e.postroll);if(!t.valid)return t}if(e.cm){const t=Ur.checkCMConfig(e.cm);if(!t.valid)return t}if(e.companions){const t=Ur.checkCompanionsConfig(e.companions);if(!t.valid)return t}return Ur._valid()},checkCompanionsConfig(e){if(!(e instanceof Array))return Ur._invalid("CompanionConfig must be an Array.");const t=[];for(let i=0;i<e.length;i++){const s=e[i];if("object"!=typeof s)return Ur._invalid("Companion must be an object.");if("string"!=typeof s.adSlotID)return Ur._invalid("Companion adSlotID must be a string.");if("number"!=typeof s.width)return Ur._invalid("Companion width must be a number.");if("number"!=typeof s.height)return Ur._invalid("Companion height must be a number.");if(t.includes(s.adSlotID))return Ur._invalid("Some companions have the same ID.");t.push(s.adSlotID),void 0===s.creativeType||s.creativeType instanceof Array||(s.creativeType=[s.creativeType])}return Ur._valid()},checkSponsorConfig:e=>"object"!=typeof e?Ur._invalid("SponsorConfig must be an object."):"object"!=typeof e.spec?Ur._invalid("SponsorConfig.spec must be an object."):Ur.isVpaidAllowedValid(e.vpaidAllowed)?Ur._valid():Ur._invalid("SponsorConfig.vpaidAllowed must be a booleanor an array of booleans."),checkVariablePrerollConfig:e=>Ur.checkPrerollConfig(e),checkPrerollConfig:e=>"object"!=typeof e?Ur._invalid("PrerollConfig must be an object."):"object"!=typeof e.spec?Ur._invalid("PrerollConfig.spec must be an object."):Ur.isSkipOffsetValid(e.skipOffset)?Ur.isVpaidAllowedValid(e.vpaidAllowed)?Ur._valid():Ur._invalid("PrerollConfig.vpaidAllowed must be a booleanor an array of booleans."):Ur._invalid("PrerollConfig.skipOffset must be a number or an array of numbers."),checkMidrollConfig(e){if("object"!=typeof e)return Ur._invalid("MidrollConfig must be an object.");if("object"!=typeof e.spec)return Ur._invalid("MidrollConfig.spec must be an object.");if(!Ur.isSkipOffsetValid(e.skipOffset))return Ur._invalid("MidrollConfig.skipOffset must be a number or an array of numbers.");if(!Ur.isVpaidAllowedValid(e.vpaidAllowed))return Ur._invalid("MidrollConfig.vpaidAllowed must be a booleanor an array of booleans.");let t=null;if(t=Array.isArray(e.point)?e.point:[e.point],Array.isArray(e.spec)&&e.spec.length&&t.length>e.spec.length)return Ur._invalid("MidrollConfig.point array cannot have more elements than spec array.");if(t.length>1&&t.some(e=>e.timeType===Ur.timeTypes.AFTER_START_REPEAT||e.timeType===Ur.timeTypes.AFTER_START))return Ur._invalid("There can be only one AdPoint when AdPoint with timeType afterStart or afterStartRepeat is set.");for(let e=t.length-1;e>=0;e--){const i=Ur.checkAdPoint(t[e]);if(!i.valid)return i}return Ur._valid()},checkPostrollConfig:e=>"object"!=typeof e?Ur._invalid("PostrollConfig must be an object."):"object"!=typeof e.spec?Ur._invalid("PostrollConfig.spec must be an object."):Ur.isSkipOffsetValid(e.skipOffset)?Ur.isVpaidAllowedValid(e.vpaidAllowed)?Ur._valid():Ur._invalid("PostrollConfig.vpaidAllowed must be a booleanor an array of booleans."):Ur._invalid("PostrollConfig.skipOffset must be a number or an array of numbers."),checkCMConfig:e=>"object"!=typeof e?Ur._invalid("CMConfig must be an object."):"object"!=typeof e.spec?Ur._invalid("CMConfig.spec must be an object."):Ur._valid(),checkAdPoint(e){if(!e)return Ur._invalid("AdPoint must be specified.");if("object"!=typeof e)return Ur._invalid("AdPoint must be an object.");if("number"!=typeof e.time&&("string"!=typeof e.time||!/^\d+(\.\d+)?%$/.test(e.time)))return Ur._invalid('AdPoint.time must be a number or a string matching the "\\d+%" pattern, '+e.time+" was provided");const t=Object.values(Ur.timeTypes);return void 0!==e.timeType&&"string"!=typeof e.timeType?Ur._invalid("AdPoint.timeType must be a string"):void 0===e.timeType||t.includes(e.timeType)?void 0!==e.maxRepeat&&"number"!=typeof e.maxRepeat?Ur._invalid("AdPoint.maxRepeat must be a number, "+typeof e.maxRepeat+" was provided"):Ur._valid():Ur._invalid(e.timeType+"is not one of the expected values of AdPoint.timeType. AdPoint.timeType must be one of the following values: "+t.toString())},isSkipOffsetValid:e=>Array.isArray(e)?e.every(e=>"number"==typeof e):"number"==typeof e,isVpaidAllowedValid:e=>void 0===e||(Array.isArray(e)?e.every(e=>"boolean"==typeof e):"boolean"==typeof e),_valid:()=>({valid:!0}),_invalid:e=>({message:e,valid:!1})};Ur.timeTypes={AT_TIME:"atTime",AFTER_START:"afterStart",AFTER_START_REPEAT:"afterStartRepeat",BEFORE_END:"beforeEnd"};let Vr=new m.ErrorFactory(m.createSourceName("src/js/sznplayer/ad/im/ImRequest.js"));const Br="AD",Fr="IM";class Hr{constructor(e,t={}){this._im=e,this._settings={timeout:t.timeout||3e3},this._state=Hr._NEW,this._timeout=0,this._ads=[],this._adCount={AD:0,IM:0},this._promise=null,this._resolve=null,this._reject=null,this._loaderFactory=new zt(o,{maxAttemps:1,timeout:this._settings.timeout},zt.PROFILE_AD)}send(e){if(this._state!==Hr._NEW)throw Vr.createError(m.AD,"Request already sent.");this._state=Hr._SENT,this._promise=new Promise((e,t)=>{this._resolve=e,this._reject=t}),this._startTimeout();let t=0;for(let i=0,s=e.length;i<s;i++)void 0===e[i].adContent&&void 0===e[i].adUrl&&t++;const i=[];for(let s=0,n=e.length;s<n;s++){const o=Object.assign({},e[s]);void 0!==e[s].adContent?this._processAdResponse(s,n,t,Br,e[s].adContent):void 0!==e[s].adUrl?this._getAd(e[s].adUrl).then(e=>{this._processAdResponse(s,n,t,Br,e)}):(o.callback=this._processAdResponse.bind(this,s,n,t,Fr),i.push(o))}return i.length&&this._im.getAds(i),this._promise}abort(){this._state===Hr._SENT&&(this._state=Request._ABORTED,this._abortTimeout(),this._reject(Vr.createError(m.AD,"Im request aborted.")))}_getAd(e){return this._loaderFactory.create().load(e).then(e=>e.data,({type:e,url:t,status:i=0})=>{const s=`Request to ${t} was rejected.`+` Reason: ${e}, status: ${i}.`;this._state=Hr._FAILED;let n=Vr.createError(m.AD,s);n.genericMessage="Request to Ad url was rejected",this._reject(n)})}_processAdResponse(e,t,i,s,n,o){this._state===Hr._SENT&&(this._ads[e]=n,this._adCount[s]++,this._adCount[Fr]===i&&this._abortTimeout(),this._adCount[Br]+this._adCount[Fr]===t&&this._done())}_processTimeout(){this._state===Hr._SENT&&(this._state=Hr._TIMEOUT,this._reject(Vr.createError(m.AD_IM_REQUEST,"Im request timeouted.")))}_done(){this._state=Hr._DONE,this._resolve(this._ads)}_startTimeout(){this._timeout=setTimeout(()=>this._processTimeout(),this._settings.timeout)}_abortTimeout(){this._timeout&&(clearTimeout(this._timeout),this._timeout=0)}}Hr._NEW=0,Hr._SENT=1,Hr._DONE=2,Hr._ABORTED=3,Hr._TIMEOUT=4,Hr._FAILED=5;let Gr=new m.ErrorFactory(m.createSourceName("src/js/sznplayer/ad/im/ImRequestTest.js"));class jr{constructor(e){console.warn("Testování VASTu"),this._im=im,this._state=jr._NEW,this._ads=[],this._adCount=0,this._promise=null,this._resolve=null,this._reject=null,this._loaderFactory=new zt(o,{maxAttemps:1,timeout:5e3},zt.PROFILE_VAST),this._imResponseType=e.imResponse||this._getRandomImResponseType(),this._vastResponseTypes=null,this._vastResponseType=e.vastResponse||null,this._skipOffset=e.skipOffset||null}send(e){if(this._state!==jr._NEW)throw Gr.createError(m.AD,"Request already sent.");const t=[];for(let i=0,s=e.length;i<s;i++){const n=Object.assign({},e[i]);n.callback=this._processImResponse.bind(this,i,s),t.push(n)}return this._promise=new Promise((e,t)=>{this._resolve=e,this._reject=t}),this._state=jr._SENT,this._loaderFactory.create().load(jr.MAIN_URL).then(e=>{try{this._vastResponseTypes=JSON.parse(e.data),this._getAds(t)}catch(e){this._reject(e)}},({type:e,url:t,status:i=0})=>{let s=Gr.createError(m.AD,`Request to ${t} was rejected.`+` Reason: ${e}, status: ${i}.`);this._reject(s)}),this._promise}_getRandomImResponseType(){let e=[jr.IM_VAST,jr.IM_VAST_IN_CONTENT,jr.IM_VAST_IN_CONTENT_DATA];return e[Math.floor(Math.random()*e.length)]}_getRandomVastResponseType(){const e=Object.keys(this._vastResponseTypes);return e[Math.floor(Math.random()*e.length)]}_processImResponse(e,t,i){this._ads[e]=i,this._adCount++,this._adCount===t&&this._done()}_removeXmlTag(e){return e.replace(/<\?xml\s[^(\?>)]*\?>\s*/g,"")}_getAds(e){this._vastResponseType||(this._vastResponseType=this._getRandomVastResponseType()),console.warn("IM response is type: "+this._imResponseType),console.warn("VAST response is type: "+this._vastResponseType),e.forEach(e=>{const t=this._vastResponseTypes[this._vastResponseType];this._loaderFactory.create().load(t).then(t=>{let i=null;i=this._imResponseType===jr.IM_VAST_IN_CONTENT?{impress:!0,miss:"",spots:[{content:"\x3c!-- spir.czMonS[4_1070412___2218614] --\x3e"+this._removeXmlTag(t.data)+"\x3c!-- spir.czMonE --\x3e",height:0,iframe:!1,width:0}]}:this._imResponseType===jr.IM_VAST_IN_CONTENT_DATA?{impress:!0,miss:"",spots:[{content:'\x3c!-- spir.czMonS[4_1070412___2218614] --\x3e{\r\n    "data": '+JSON.stringify(this._removeXmlTag(t.data))+',\r\n    "impress": "",\r\n    "miss": "",\r\n    "skippable_after": '+this._skipOffset+"\r\n}\x3c!-- spir.czMonE --\x3e",height:0,iframe:!1,width:0}]}:this._imResponseType===jr.IM_NO_VAST?JSON.parse(t.data):t.data,console.log(i),e.callback(i)},({type:e,url:t,status:i=0})=>{let s=Gr.createError(m.AD,`Request to ${t} was rejected.`+` Reason: ${e}, status: ${i}.`);this._reject(s)})})}_done(){this._state=jr._DONE,this._resolve(this._ads)}}jr._NEW=0,jr._SENT=1,jr._DONE=2,jr._FAILED=3,jr.MAIN_URL="http://player.dev.dszn.cz/vast/index.json",jr.IM_VAST="vast",jr.IM_VAST_IN_CONTENT="vastInContent",jr.IM_VAST_IN_CONTENT_DATA="vastInContentData",jr.IM_NO_VAST="noVast";const qr=/^[^\{]*<vast/i;var Qr={isVast:e=>qr.test(e),getSrcValueFromTag(e,t){const i=new RegExp("<"+t+"\\s*src\\s*=\\s*(['\"])(.*?)\\1[^>]*\\/?>"),s=e.match(i);return s&&s[2]?s[2]:""},getUrlFromImg(e){return this.resolveBasicHtmlEntities(this.getSrcValueFromTag(e,"img"))},getSpotIdFromUrl(e){if(!e)return"";const t=e.match(/\?.*spotid=([0-9]+)/i);return t&&t[1]?t[1]:""},pickOutJsonString(e){if(!e||"string"!=typeof e)return"";const t=e.match(/\{[\s\S]*\}/);return t&&t[0]?t[0]:""},removeSpir:e=>e.replace(/<!--\sspir\.[^(-->)]*-->/g,""),resolveBasicHtmlEntities:e=>e.replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"').replace(/&apos;/g,"'")};class Yr extends S{getAd(){throw new Error('[AdStore] Method "getAd" is not implemented.')}getReplacementAd(){throw new Error('[AdStore] Method "getReplacementAd" is not implemented.')}getExternalImpressions(){throw new Error('[AdStore] Method "getExternalImpressions" is not implemented.')}getExternalMiss(){throw new Error('[AdStore] Method "getExternalMiss" is not implemented.')}getExternalSkipOffset(){throw new Error('[AdStore] Method "getExternalSkipOffset" is not implemented.')}getSpecIndex(){throw new Error('[AdStore] Method "getSpecIndex" is not implemented.')}setSpecIndex(e){throw new Error('[AdStore] Method "setSpecIndex" is not implemented.')}setExternalImpressions(e){throw new Error('[AdStore] Method "setExternalImpressions" is not implemented.')}setExternalMiss(e){throw new Error('[AdStore] Method "setExternalMiss" is not implemented.')}setExternalSkipOffset(e){throw new Error('[AdStore] Method "setExternalSkipOffset" is not implemented.')}}Yr.EVENT_ERROR="error";class zr{hasLinear(){throw new Error('[Ad] Method "hasLinear" is not implemented.')}hasNonLinear(){throw new Error('[Ad] Method "hasNonLinear" is not implemented.')}getId(){throw new Error('[Ad] Method "getId" is not implemented.')}getType(){throw new Error('[Ad] Method "getType" is not implemented.')}getLinear(){throw new Error('[Ad] Method "getLinear" is not implemented.')}getNonLinear(){throw new Error('[Ad] Method "getNonLinear" is not implemented.')}getImpressions(){throw new Error('[Ad] Method "getImpressions" is not implemented.')}getTrackingEvents(){throw new Error('[Ad] Method "getTrackingEvents" is not implemented.')}getViewableImpression(){throw new Error('[Ad] Method "getViewableImpression" is not implemented.')}getVideoClicks(){throw new Error('[Ad] Method "getVideoClicks" is not implemented.')}getIcons(){throw new Error('[Ad] Method "getIcons" is not implemented.')}getErrors(){throw new Error('[Ad] Method "getErrors" is not implemented.')}getCompanionAds(){throw new Error('[Ad] Method "getCompanionAds" is not implemented.')}getCompanionAdsRequired(){throw new Error('[Ad] Method "getCompanionAdsRequired" is not implemented.')}getSpecIndex(){throw new Error('[Ad] Method "getSpecIndex" is not implemented.')}setSpecIndex(e){throw new Error('[Ad] Method "setSpecIndex" is not implemented.')}setVpaidAllowed(e){throw new Error('[Ad] Method "setVpaidAllowed" is not implemented.')}addExternalImpressions(e){throw new Error('[Ad] Method "addExternalImpressions" is not implemented.')}addExternalSkipOffset(e){throw new Error('[Ad] Method "addExternalSkipOffset" is not implemented.')}}class Wr extends zr{static _createHtmlSpot(e){return'<a class="w-AdCommercialMessageItem"'+` href="${e.content.clickthru}" target="_blank">`+'<span class="w-AdCommercialMessageItem__img">'+`<img src="${e.content.image_str}">`+'</span><span class="w-AdCommercialMessageItem__text">'+`${e.content.text_str}`+"</span></a>"}constructor(e,t=null){super(),this._spots=e,this._response=t,this._id=e.map((e,t)=>e.id||t).join("_"),this._impressions=e.map(e=>e.content.impress),this._specIndex=null}hasLinear(){return!1}hasNonLinear(){return!0}getId(){return this._id}getType(){return null}getLinear(){return null}getNonLinear(){return this._response&&this._response.spots.some(e=>!!e.iframe)?1===this._response.spots.length?this._response:null:this._spots.map(Wr._createHtmlSpot).join("")}getImpressions(){return this._impressions}getTrackingEvents(){return null}getVideoClicks(){return null}getIcons(){return null}getErrors(){return null}getSpecIndex(){return this._specIndex}getCompanionAds(){return null}getCompanionAdsRequired(){return null}getViewableImpression(){return null}setSpecIndex(e){this._specIndex=e}setVpaidAllowed(e){}addExternalImpressions(e){this._impressions=e.concat(this._impressions)}addExternalSkipOffset(e){throw new Error('[ImAdNonLinear] Method "addExternalSkipOffset" is not supposed to be used here.')}}const Kr={"144p":2e5,"240p":4e5,"360p":8e5,"480p":12e5,"576p":16e5,"720p":24e5,"1080p":44e5};class $r extends zr{constructor(e,t=null){super(),this._spot=e[0],this._spl=t,this._id=this._spot.id||o.generateId(),this._impressions=this._getImpressions(),this._trackingEvents=this._getTrackingEvents(),this._videoClicks=this._getVideoClicks(),this._specIndex=null}hasLinear(){return!0}hasNonLinear(){return!1}getId(){return this._id}getType(){return this._spot.content.type?this._spot.content.type:null}getLinear(e={}){let t=null,i=NaN;if(this._spl){const e=ms.getMp4Duration(this._spl);t=ms.createSource(this._spl),i=e?e/1e3:NaN}else{const e=Array.isArray(this._spot.content.data)?this._spot.content.data:[],s=e.filter(e=>"url"in e&&"mp4"===e.url.toLowerCase()).map(e=>({name:e.quality,source:[{src:e.url,type:`video/${e.format}`,bitrate:void 0!==Kr[e.quality]?Kr[e.quality]:null}]})),n=e.find(e=>!!e.duration);if(!s.length)return null;t=new N(s),i=n?n.duration/1e3:NaN}return Object.assign(e,{id:this.getId(),source:t,clickthrough:this._spot.content.click,duration:i},this._spot.content.skippable_after?{skipOffset:this._spot.content.skippable_after}:{},"sponsor"===e.layout||"promo"===e.layout?{skipOffset:-1}:{})}getNonLinear(){return null}getImpressions(){return this._impressions}getTrackingEvents(e){return"linear"===e?this._trackingEvents:null}getVideoClicks(){return this._videoClicks}getIcons(){return null}getErrors(){return null}getSpecIndex(){return this._specIndex}getCompanionAds(){return null}getCompanionAdsRequired(){return null}getViewableImpression(){return null}setSpecIndex(e){this._specIndex=e}setVpaidAllowed(e){}addExternalImpressions(e){this._impressions=e.concat(this._impressions)}addExternalSkipOffset(e){throw new Error('[ImAdLinear] Method "addExternalSkipOffset" is not supposed to be used here.')}_getImpressions(){let e=[this._spot.content.impress];return this._spot.content.externHit&&e.push(this._spot.content.externHit),e}_getTrackingEvents(){let e=[];if(this._spot.content.action&&e.push(this._spot.content.action),this._spot.content.externHitSkip&&e.push(this._spot.content.externHitSkip),this._spot.content.richmedia){const t=`${this._spot.content.richmedia}&type=skip&value=[PERCENT]`;e.push(t)}let t=[];if(this._spot.content.externHitEnd&&t.push(this._spot.content.externHitEnd),e.length||t.length){let i={};return e.length&&(i.skip=e),t.length&&(i.complete=t),i}return null}_getVideoClicks(){return this._spot.content.click?{clickThrough:this._spot.content.click}:null}}class Xr extends Yr{constructor(e,t=[],i="",s=null){super(),this._miss=e,this._spots=t,this._character=i,this._response=s,this._splResource=null,this._specIndex=null}getAd(){let e=null;if(this._miss)e=Promise.resolve(null);else if("nonlinear"===this._character)e=Promise.resolve(new Wr(this._spots,this._response));else{if("linear"!==this._character)throw errorFactory.createError(m.SETTING,`Invalid ad character "${this._character}".`);{const t=this._getSplUrl(this._spots);t?(this._splResource=this._splResource||gs(),e=this._splResource.resolveAndGet(t).then(e=>new $r(this._spots,e))):e=Promise.resolve(new $r(this._spots))}}return e}getReplacementAd(){return Promise.resolve(null)}getExternalImpressions(){return null}getExternalMiss(){return this._miss}getExternalSkipOffset(){return null}getSpecIndex(){return this._specIndex}setSpecIndex(e){this._specIndex=e}setExternalImpressions(e){throw new Error('[ImAdStore] Method "setExternalImpressions" is not supposed to be used here.')}setExternalMiss(e){throw new Error('[ImAdStore] Method "setExternalMiss" is not supposed to be used here.')}setExternalSkipOffset(e){throw new Error('[ImAdStore] Method "setExternalSkipOffset" is not supposed to be used here.')}_getSplUrl(e){const t=e[0],i=Array.isArray(t.content.data)?t.content.data:[];for(var s=0,n=i.length;s<n;s++)if("spl"===i[s].format)return i[s].url;return""}}let Zr=new m.ErrorFactory(m.createSourceName("src/js/sznplayer/ad/vast/VastParser.js"));class Jr{static parseVast(e){let t=zi.stringToXml(e),i={adPod:[],ads:[],errors:[]},s=null;try{let e=zi.stringToXml("<").getElementsByTagName("parsererror");s=e.length?e[0].namespaceURI:null}catch(e){}if(!t.documentElement||"VAST"!==t.documentElement.nodeName||s&&t.getElementsByTagNameNS(s,"parsererror").length){let e=Zr.createError(m.AD,"Specified string is not a valid VAST document.");throw e.code=100,e}{let e=t.documentElement;i.version=e.getAttribute("version"),zi.getChildrenByName(e,"Error").forEach(e=>{i.errors.push(zi.getText(e))}),zi.getChildrenByName(e,"Ad").forEach(e=>{let t=Jr._parseAd(e);if(!t){let e=Zr.createError(m.AD,"Invalid ad data found in specified VAST document.");throw e.code=101,e}t.sequence?i.adPod.push(t):i.ads.push(t)}),i.adPod.length&&i.ads.forEach(e=>{e.isAdBuffet=!0}),i.adPod.sort((e,t)=>e.sequence-e.sequence)}return i}static mergeWrappedAd(e,t){t.sequence&&(e.sequence=t.sequence),t.isAdBuffet&&(e.isAdBuffet=t.isAdBuffet),e.errors=t.errors.concat(e.errors),e.impressions=t.impressions.concat(e.impressions),e.wrapperUrls=t.wrapperUrls,e.wrapperUrls.push(t.loadNextUrl);let i=null,s=null,n=null;t.creatives.forEach(e=>{"linear"!==e.type&&"nonlinear"!==e.type||e.trackingEvents&&(i||(i={}),i[e.type]=e.trackingEvents),"linear"===e.type&&(e.videoClicks&&(s=e.videoClicks),e.icons&&(n=e.icons))}),i&&e.creatives.forEach(e=>{if(i[e.type]){e.trackingEvents||(e.trackingEvents={}),Object.keys(i[e.type]).forEach(t=>{e.trackingEvents[t]||(e.trackingEvents[t]=[]),e.trackingEvents[t]=e.trackingEvents[t].concat(i[e.type][t])})}}),s&&e.creatives.forEach(e=>{"linear"===e.type&&(!e.videoClicks&&(s.clickThrough||s.clickTrackings.length||s.customClicks.length)&&(e.videoClicks={clickTrackings:[],customClicks:[]}),s.clickThrough&&!e.videoClicks.clickThrough&&(e.videoClicks.clickThrough=s.clickThrough),s.clickTrackings.length&&(e.videoClicks.clickTrackings=e.videoClicks.clickTrackings.concat(s.clickTrackings)),s.customClicks.length&&(e.videoClicks.customClicks=e.videoClicks.customClicks.concat(s.customClicks)))}),n&&n.length&&e.creatives.forEach(e=>{"linear"===e.type&&(e.icons||(e.icons=[]),e.icons=e.icons.concat(n))}),e.creatives.length||(e.creatives=t.creatives)}static _parseAd(e){let t={id:e.getAttribute("id")||null,sequence:e.getAttribute("sequence")||null,conditionalAd:zi.getBoolean(e.getAttribute("conditionalAd")||null)},i=zi.getChildByName(e,"InLine");if(i)return Object.assign(Jr._parseInLine(i),t);let s=zi.getChildByName(e,"Wrapper");return s?Object.assign(Jr._parseWrapper(s),t):null}static _parseInLine(e){let t={impressions:[],creatives:[],categories:[],errors:[],wrapperUrls:[],isWrapper:!1};if("InLine"===e.nodeName&&!zi.getChildrenByName(e,"Impression").length){const e=Zr.createError(m.AD,"No impressions found in ad.");throw e.code=101,e}if("InLine"===e.nodeName&&1!==zi.getChildrenByName(e,"Creatives").length){const e=Zr.createError(m.AD,"No creatives found in ad.");throw e.code=101,e}let i=e.childNodes;for(let s=0;s<i.length;s++){let n=i[s];switch(n.nodeName){case"AdSystem":t.adSystem={name:zi.getText(n),version:n.getAttribute("version")||null};break;case"AdTitle":t.adTitle=zi.getText(n);break;case"Impression":t.impressions.push(zi.xmlStringDecode(zi.getText(n)));break;case"ViewableImpression":{const e=n.getAttribute("id"),i=zi.getChildByName(n,"Viewable"),s=zi.getChildByName(n,"NotViewable"),o=zi.getChildByName(n,"ViewUndetermined"),r=i?zi.xmlStringDecode(zi.getText(i)):null,a=s?zi.xmlStringDecode(zi.getText(s)):null,l=o?zi.xmlStringDecode(zi.getText(o)):null;t.viewableImpression={id:e,viewable:r,notViewable:a,viewUndetermined:l};break}case"Category":t.categories.push({name:zi.getText(n),authority:n.getAttribute("authority")||null});break;case"Description":t.description=zi.getText(n);break;case"Advertiser":t.advertiser=zi.getText(n);break;case"Pricing":t.pricing={name:zi.getText(n),model:n.getAttribute("model")||null,currency:n.getAttribute("currency")||null};break;case"Survey":t.survey=zi.getText(n);break;case"Error":t.errors.push(zi.xmlStringDecode(zi.getText(n)));break;case"Creatives":zi.getChildrenByName(n,"Creative").forEach(i=>{const s=zi.getChildByName(i,"UniversalAdId");let n={id:i.getAttribute("id")||null,adId:i.getAttribute("adId")||null,sequence:i.getAttribute("sequence")||null,apiFramework:i.getAttribute("apiFramework")||null,universalAdId:s?zi.getText(s):null};const o=zi.getChildByName(i,"CompanionAds");if(o){let e=Jr._parseCompanionAds(o);e&&t.creatives.push(Object.assign(e,n))}const r=zi.getChildByName(i,"Linear");if(r){let i=Jr._parseLinearCreative(r);if("InLine"===e.nodeName&&!i.mediaFiles.length){const e=Zr.createError(m.AD,"No media files found in creative.");throw e.code=101,e}if("Wrapper"===e.nodeName&&i.mediaFiles.length){const e=Zr.createError(m.AD,"Media files found in wrapper.");throw e.code=101,e}t.creatives.push(Object.assign(i,n))}const a=zi.getChildByName(i,"NonLinearAds");if(a){let e=Jr._parseNonLinearCreative(a);t.creatives.push(Object.assign(e,n))}});break;case"Extensions":{const e=zi.getChildByName(n,"Type");if(e)t.extensions||(t.extensions={}),t.extensions.type=zi.getText(e);else{zi.getChildrenByName(n,"Extension").forEach(e=>{const i=zi.getChildByName(e,"Type");i&&(t.extensions||(t.extensions={}),t.extensions.type=zi.getText(i))})}break}}}return t}static _parseWrapper(e){let t=zi.getChildByName(e,"VASTAdTagURI"),i=Jr._parseInLine(e);if(!t){const e=Zr.createError(m.AD,"No URI found in wrapper.");throw e.code=101,e}i.loadNextUrl=zi.xmlStringDecode(zi.getText(t)),i.isWrapper=!0;let s=e.getAttribute("followAdditionalWrappers");i.followAdditionalWrappers=!s||zi.getBoolean(s);let n=e.getAttribute("allowMultipleAds");i.allowMultipleAds=!!n&&zi.getBoolean(n);let o=e.getAttribute("fallbackOnNoAd");return i.fallbackOnNoAd=o?zi.getBoolean(o):null,i}static _parseCompanionAds(e){let t=zi.getChildrenByName(e,"Companion");if(!t.length)return null;let i={type:"companionAds",required:e.getAttribute("required")||"none",companionAds:[]};return t.forEach(e=>{const t=Jr._parseCompanion(e);if(null===t.width||null===t.height){const e=Zr.createError(m.AD,"Companion missing some of the required attributes.");throw e.code=600,e}i.companionAds.push(t)}),i}static _parseCompanion(e){let t={width:parseInt(e.getAttribute("width"),10)||null,height:parseInt(e.getAttribute("height"),10)||null,id:parseInt(e.getAttribute("id"),10)||null,assetWidth:parseInt(e.getAttribute("assetWidth"),10)||null,assetHeight:parseInt(e.getAttribute("assetHeight"),10)||null,expandedWidth:parseInt(e.getAttribute("expandedWidth"),10)||null,expandedHeight:parseInt(e.getAttribute("expandedHeight"),10)||null,apiFramework:e.getAttribute("apiFramework")||null,adSlotID:e.getAttribute("adSlotID")||null,pxratio:parseInt(e.getAttribute("pxratio"),10)||null,staticResources:[],iframeResources:[],htmlResources:[]};zi.getChildrenByName(e,"StaticResource").forEach(e=>{t.staticResources.push({type:e.getAttribute("creativeType"),url:zi.xmlStringDecode(zi.getText(e))})}),zi.getChildrenByName(e,"IFrameResource").forEach(e=>{t.iframeResources.push(zi.xmlStringDecode(zi.getText(e)))}),zi.getChildrenByName(e,"HTMLResource").forEach(e=>{t.htmlResources.push(zi.xmlStringDecode(zi.getText(e)))});let i=zi.getChildByName(e,"TrackingEvents");i&&(t.trackingEvents=Jr._parseTrackingEvents(i));let s=zi.getChildByName(e,"AdParameters");s&&(t.adParameters=Jr._parseAdParameters(s));let n=zi.getChildByName(e,"AltText");n&&(t.altText=zi.xmlStringDecode(zi.getText(n)));let o=zi.getChildByName(e,"CompanionClickThrough");o&&(t.clickThrough=zi.xmlStringDecode(zi.getText(o)));let r=zi.getChildByName(e,"CompanionClickTracking");return r&&(t.clickTracking={id:r.getAttribute("id")||null,url:zi.xmlStringDecode(zi.getText(r))}),t}static _parseLinearCreative(e){let t={type:"linear",skipOffset:null,mediaFiles:[]},i=e.childNodes;for(let s=0;s<i.length;s++){let n=i[s];switch(n.nodeName){case"Duration":{t.duration=zi.getTime(zi.getText(n));let i=e.getAttribute("skipoffset");i&&("%"===i.charAt(i.length-1)?t.skipOffset=t.duration*(parseInt(i,10)/100):t.skipOffset=zi.getTime(i));break}case"MediaFiles":t.mediaFiles=Jr._parseMediaFiles(n);break;case"AdParameters":t.adParameters=Jr._parseAdParameters(n);break;case"TrackingEvents":t.trackingEvents=Jr._parseTrackingEvents(n);break;case"VideoClicks":t.videoClicks=Jr._parseVideoClicks(n);break;case"Icons":t.icons=Jr._parseIcons(n)}}return t}static _parseNonLinearCreative(e){let t={type:"nonlinear",nonLinears:[]};zi.getChildrenByName(e,"NonLinear").forEach(e=>{let i={id:o.generateId("ni"),width:parseInt(e.getAttribute("width"),10)||0,height:parseInt(e.getAttribute("height"),10)||0,expandedWidth:parseInt(e.getAttribute("expandedWidth"),10)||0,expandedHeight:parseInt(e.getAttribute("expandedHeight"),10)||0,scalable:zi.getBoolean(e.getAttribute("scalable")),maintainAspectRatio:zi.getBoolean(e.getAttribute("maintainAspectRatio")),minSuggestedDuration:zi.getTime(e.getAttribute("minSuggestedDuration"))||0,apiFramework:e.getAttribute("apiFramework"),clickTrackings:[],staticResources:[],iframeResources:[],htmlResources:[]},s=zi.getChildByName(e,"AdParameters");s&&(i.adParameters=Jr._parseAdParameters(s));let n=zi.getChildByName(e,"NonLinearClickThrough");n&&(i.clickThrough=zi.xmlStringDecode(zi.getText(n))),zi.getChildrenByName(e,"NonLinearClickTracking").forEach(e=>{i.clickTrackings.push(zi.xmlStringDecode(zi.getText(e)))}),zi.getChildrenByName(e,"StaticResource").forEach(e=>{i.staticResources.push({type:e.getAttribute("creativeType"),url:zi.xmlStringDecode(zi.getText(e))})}),zi.getChildrenByName(e,"IFrameResource").forEach(e=>{i.iframeResources.push(zi.xmlStringDecode(zi.getText(e)))}),zi.getChildrenByName(e,"HTMLResource").forEach(e=>{i.htmlResources.push(zi.xmlStringDecode(zi.getText(e)))}),t.nonLinears.push(i)});let i=zi.getChildByName(e,"TrackingEvents");return i&&(t.trackingEvents=Jr._parseTrackingEvents(i)),t}static _parseAdParameters(e){if(e.getAttribute("xmlEncoded")){let e="",t=zi.stringToXml(zi.xmlStringDecode(zi.getText(node))).documentElement.childNodes;for(let i=0;i<t.length;i++)e+=(""===e?"":"&")+t[i].nodeName+"="+zi.getText(t[i]);return e}return zi.getText(e)}static _parseMediaFiles(e){let t=[];return zi.getChildrenByName(e,"MediaFile").forEach(e=>{const i=zi.xmlStringDecode(zi.getText(e));if(""!==i){let s={id:e.getAttribute("id"),url:i,delivery:e.getAttribute("delivery"),codec:e.getAttribute("codec"),type:e.getAttribute("type"),apiFramework:e.getAttribute("apiFramework"),bitrate:parseInt(e.getAttribute("bitrate"),10)||0,minBitrate:parseInt(e.getAttribute("minBitrate"),10)||0,maxBitrate:parseInt(e.getAttribute("maxBitrate"),10)||0,width:parseInt(e.getAttribute("width"),10)||0,height:parseInt(e.getAttribute("height"),10)||0,scalable:zi.getBoolean(e.getAttribute("scalable")),maintainAspectRatio:zi.getBoolean(e.getAttribute("maintainAspectRatio"))};t.push(s)}}),zi.getChildrenByName(e,"InteractiveCreativeFile").forEach(e=>{let i={id:o.generateId("ii"),url:zi.xmlStringDecode(zi.getText(e)),type:e.getAttribute("type"),apiFramework:e.getAttribute("apiFramework")};t.push(i)}),t}static _parseIcons(e){let t=[];return zi.getChildrenByName(e,"Icon").forEach(e=>{let i={id:o.generateId("vi"),program:e.getAttribute("program")||"",width:parseInt(e.getAttribute("width"),10)||0,height:parseInt(e.getAttribute("height"),10)||0,xPosition:e.getAttribute("xPosition"),yPosition:e.getAttribute("yPosition"),offset:zi.getTime(e.getAttribute("offset"))||0,duration:zi.getTime(e.getAttribute("duration"))||0,apiFramework:e.getAttribute("apiFramework"),pxratio:e.getAttribute("pxratio"),viewTrackings:[],clickTrackings:[],staticResources:[],iframeResources:[],htmlResources:[]};zi.getChildrenByName(e,"IconViewTracking").forEach(e=>{i.viewTrackings.push(zi.xmlStringDecode(zi.getText(e)))});let s=zi.getChildByName(e,"IconClicks");if(s){let e=zi.getChildByName(s,"IconClickThrough");e&&(i.clickThrough=zi.xmlStringDecode(zi.getText(e))),zi.getChildrenByName(s,"IconClickTracking").forEach(e=>{i.clickTrackings.push(zi.xmlStringDecode(zi.getText(e)))})}zi.getChildrenByName(e,"StaticResource").forEach(e=>{i.staticResources.push({type:e.getAttribute("creativeType"),url:zi.xmlStringDecode(zi.getText(e))})}),zi.getChildrenByName(e,"IFrameResource").forEach(e=>{i.iframeResources.push(zi.xmlStringDecode(zi.getText(e)))}),zi.getChildrenByName(e,"HTMLResource").forEach(e=>{i.htmlResources.push(zi.xmlStringDecode(zi.getText(e)))}),t.push(i)}),t}static _parseTrackingEvents(e){let t={};return zi.getChildrenByName(e,"Tracking").forEach(e=>{let i=e.getAttribute("event"),s=zi.xmlStringDecode(zi.getText(e));if(i&&""!==s){let n=s;if("progress"===i||"timeSpentViewing"===i){let t=e.getAttribute("offset");n={url:s,offset:t&&"%"===t.charAt(t.length-1)?t:zi.getTime(t)}}t[i]||(t[i]=[]),t[i].push(n)}}),t}static _parseVideoClicks(e){let t={clickTrackings:[],customClicks:[]},i=zi.getChildByName(e,"ClickThrough");return i&&(t.clickThrough=zi.xmlStringDecode(zi.getText(i))),zi.getChildrenByName(e,"ClickTracking").forEach(e=>{t.clickTrackings.push(zi.xmlStringDecode(zi.getText(e)))}),zi.getChildrenByName(e,"CustomClick").forEach(e=>{t.customClicks.push({id:e.getAttribute("id"),url:zi.xmlStringDecode(zi.getText(e))})}),t}}new m.ErrorFactory(m.createSourceName("src/js/sznplayer/ad/vast/VastAd.js"));class ea extends zr{constructor(e){super(),this._duration=null,this._skipOffset=null,this._externalSkipOffset=null,this._specIndex=null,this._vpaidAllowed=!0,this._mediaFiles=null,this._nonLinears=null,this._trackingEvents=null,this._videoClicks=null,this._icons=null,this._companionAdsRequired=null,this._companionAds=null,this._adParameters="";let t="",i="";e.creatives.forEach(e=>{"linear"===e.type&&(e.duration&&(this._duration=e.duration),e.skipOffset&&(this._skipOffset=e.skipOffset),e.mediaFiles&&e.mediaFiles.length&&(this._mediaFiles=e.mediaFiles),e.trackingEvents&&(this._trackingEvents||(this._trackingEvents={}),this._trackingEvents[e.type]=e.trackingEvents),e.videoClicks&&(this._videoClicks=e.videoClicks),e.icons&&(this._icons=e.icons),e.universalAdId&&(t=e.universalAdId),e.adId&&(i=e.adId),e.adParameters&&(this._adParameters=e.adParameters)),"nonlinear"===e.type&&(e.nonLinears&&e.nonLinears.length&&(this._nonLinears=e.nonLinears),e.trackingEvents&&(this._trackingEvents||(this._trackingEvents={}),this._trackingEvents[e.type]=e.trackingEvents)),"companionAds"===e.type&&(this._companionAdsRequired=e.required,this._companionAds=e.companionAds)}),this._id=t||i||o.generateId("va"),this._linear=this._mediaFiles?this._createLinearAd(e):null,this._nonLinear=this._nonLinears?this._createNonLinearAd(e):null,this._viewableImpression=e.viewableImpression||null,this._impressions=e.impressions,this._extensions=e.extensions,this._errors=e.errors}hasLinear(){return!(!this._linear||!this._linear.source&&!this._vpaidAllowed)}hasNonLinear(){return!!this._nonLinear}getId(){return this._id}getType(){return this._extensions&&this._extensions.type?this._extensions.type:null}getLinear(e={}){return this._linear?Object.assign({},e,this._linear,this._externalSkipOffset?{skipOffset:this._externalSkipOffset}:{},"sponsor"===e.layout||"promo"===e.layout?{skipOffset:-1}:{},this._vpaidAllowed?{}:{sourceVpaid:null}):null}getNonLinear(e={}){return this._nonLinear?Object.assign({},e,this._nonLinear):null}getImpressions(){return this._impressions}getErrors(){return this._errors}getTrackingEvents(e){return this._trackingEvents&&this._trackingEvents[e]?this._trackingEvents[e]:null}getViewableImpression(){return this._viewableImpression}getVideoClicks(){return this._videoClicks}getIcons(){return this._icons}getSpecIndex(){return this._specIndex}getCompanionAds(){return this._companionAds}getCompanionAdsRequired(){return this._companionAdsRequired}setSpecIndex(e){this._specIndex=e}setVpaidAllowed(e){this._vpaidAllowed=e}addExternalImpressions(e){this._impressions=e.concat(this._impressions)}addExternalSkipOffset(e){this._externalSkipOffset=e}_createLinearAd(e){const t=this._createSource(),i=this._getVpaidSource(this._mediaFiles);return t||i?{id:this.getId(),source:t,sourceVpaid:i,skipOffset:this._skipOffset?this._skipOffset:-1,clickthrough:this._videoClicks?this._videoClicks.clickThrough:null,duration:this._duration,title:e.adTitle||""}:null}_getVpaidSource(e){for(var t=0,i=e.length;t<i;t++)if(e[t].apiFramework&&"VPAID"===e[t].apiFramework.toUpperCase()&&e[t].type&&"application/javascript"===e[t].type.toLowerCase())return{src:e[t].url,type:e[t].type,apiFramework:"VPAID",options:{adParameters:this._adParameters,vastDuration:this._duration,videoClicks:this._videoClicks}};return null}_createNonLinearAd(e){return{id:this.getId(),creatives:this._nonLinears}}_createSource(){let e=this._mediaFiles.filter(e=>!e.apiFramework).map(e=>({name:"",source:[{src:e.url,type:e.type,bitrate:e.bitrate,codecs:e.codec,resolution:{width:e.width,height:e.height}}]}));return e.length?new N(e):null}}const ta=900;let ia=new m.ErrorFactory(m.createSourceName("src/js/sznplayer/ad/vast/VastAdManager.js"));class sa extends Yr{constructor(e={}){super(),this._xml=null,this._externalHits=null,this._externalSkipOffset=null,this._specIndex=null,this._vastResponse=null,this._replacementAd=null,this._settings={maxNestLevel:e.maxNestLevel||sa.MAX_NEST_LEVEL,timeout:e.timeout||sa.TIMEOUT},this._loaderFactory=new zt(o,{maxAttemps:1,timeout:this._settings.timeout},zt.PROFILE_VAST)}destroy(){let e=Object.keys(this);for(let t of e)this[t]=null}setVastString(e){this._externalHits=null,this._externalSkipOffset=null,this._xml=e}setVastUrl(e){return this._externalHits=null,this._externalSkipOffset=null,this._xml=null,new Promise((t,i)=>{this._load(e).then(e=>{this._xml=e.data,t(this._xml)},({type:e,url:t,status:s=0})=>{const n=`Request to ${t} was rejected.`+` Reason: ${e}, status: ${s}.`;let o=ia.createError(m.AD,n);o.genericMessage="Request to VastAd url was rejected",i(o)})})}setSpecIndex(e){this._specIndex=e}setExternalImpressions(e){this._externalHits||(this._externalHits={}),this._externalHits.impressions=e}setExternalMiss(e){this._externalHits||(this._externalHits={}),this._externalHits.miss=e}setExternalSkipOffset(e){this._externalSkipOffset=e}getSpecIndex(){return this._specIndex}getExternalImpressions(){return this._externalHits?this._externalHits.impressions:null}getExternalMiss(){return this._externalHits?this._externalHits.miss:null}getExternalSkipOffset(){return this._externalSkipOffset}getAd(){return this._resolveNextAd().then(e=>{if(e){if(e.ads){let t=[];return e.ads.forEach(e=>{e.isWrapper&&e.isIrreplaceable||t.push(e.isWrapper?null:new ea(e))}),t}return e.ad.isWrapper?null:new ea(e.ad)}return null})}_resolveNextAd(){if(!this._xml){const e=ia.createError(m.AD,"No VAST content set.");return Promise.reject(e)}if(this._replacementAd=null,this._vastResponse&&!this._vastResponse.nextResponse&&(!this._vastResponse.parentResponse||!this._vastResponse.parentResponse.nextResponse))return Promise.resolve(null);if(this._vastResponse)this._vastResponse=this._vastResponse.nextResponse?this._vastResponse.nextResponse:this._vastResponse.parentResponse.nextResponse;else{let e=null;try{e=Jr.parseVast(this._xml)}catch(e){return Promise.reject(e)}if(this._vastResponse=this._createResponseObject(e),!this._vastResponse)return Promise.resolve(null)}return this._resolveAd()}getReplacementAd(){return this._resolveNextReplacementAd().then(e=>e?new ea(e):null)}_resolveNextReplacementAd(){if(!this._vastResponse.replacementAds){const e=ia.createError(m.AD,"No replacement ad for non-Ad Pod ad possible.");return Promise.reject(e)}if(!this._vastResponse.replacementAds.length)return Promise.resolve(null);if(this._replacementAd){let e=this._vastResponse.replacementAds.indexOf(this._replacementAd);if(!(this._vastResponse.replacementAds.length>e+1))return Promise.resolve(null);this._replacementAd=this._vastResponse.replacementAds[e+1]}else this._replacementAd=this._vastResponse.replacementAds[0];return this._resolveReplacementAd()}_createResponseObject(e,t=null){if(e.adPod.length)return{version:e.version,ads:e.adPod,replacementAds:e.ads,nextResponse:null,parentResponse:t};{let i=null;for(let s=e.ads.length-1;s>=0;s--)i={version:e.version,ad:e.ads[s],nextResponse:i,parentResponse:t};return i}}_resolveAd(){return new Promise((e,t)=>{let i=this._vastResponse.ads?this._vastResponse.ads:[this._vastResponse.ad];this._resolveWrappedAds(i).then(i=>{i?e(this._vastResponse):this._resolveNextAd().then(()=>{e(this._vastResponse)}).catch(e=>{t(e)})}).catch(e=>{t(e)})})}_resolveReplacementAd(){return new Promise((e,t)=>{this._resolveWrappedAds([this._replacementAd]).then(i=>{i?e(this._replacementAd):this._resolveNextReplacementAd().then(()=>{e(this._replacementAd)}).catch(e=>{t(e)})}).catch(e=>{t(e)})})}_resolveWrappedAds(e){return new Promise((t,i)=>{let s=[];e.forEach(e=>{e.loadNextUrl&&s.push(this._loadAndParse(e))}),s.length?Promise.all(s).then(e=>{let i=e.some(e=>!!e);t(i)}).catch(e=>{i(e)}):t(!0)})}_load(e){return this._loaderFactory.create().load(e)}_loadAndParse(e){return new Promise((t,i)=>{if(e.followAdditionalWrappers){if(e.wrapperUrls.length>=this._settings.maxNestLevel||e.wrapperUrls.indexOf(e.loadNextUrl)>=0){let i=ia.createError(m.AD,"Too many wrapper responses.");return this._trackError(i,302,e.errors),void t(!1)}this._load(e.loadNextUrl).then(s=>{let n=null;try{n=Jr.parseVast(s.data)}catch(i){return this._trackError(i,i.code,e.errors),void t(!1)}if(!n.ads.length&&!n.adPod.length){!1===e.fallbackOnNoAd&&(e.isIrreplaceable=!0);let i=ia.createError(m.AD,"No VAST response after one or more wrappers.");return this._trackError(i,303,n.errors),void t(!1)}e.allowMultipleAds||(n.ads.length?(n.ads=[n.ads[0]],n.adPod=[]):n.adPod=n.adPod.slice(0,1));let o=null;try{o=this._mergeWrappedAds(e,n)}catch(i){return this._trackError(i,300,e.errors),void t(!1)}this._resolveWrappedAds(o).then(e=>{t(e)}).catch(e=>{i(e)})},({type:i,url:s,status:n=0})=>{let o=ia.createError(m.AD,`Request to ${s} was rejected.`+` Reason: ${i}, status: ${n}.`);o.genericMessage="Request to VastAd url was rejected",this._trackError(o,301,e.errors),t(!1)})}else t(!1)})}_mergeWrappedAds(e,t){if(e.isAdBuffet){let i=this._vastResponse.replacementAds.indexOf(e);this._vastResponse.replacementAds.splice(i,1);let s=t.ads.length?t.ads:t.adPod;return this._replacementAd=null,s.forEach(t=>{Jr.mergeWrappedAd(t,e),this._replacementAd||(this._replacementAd=t),this._vastResponse.replacementAds.splice(i++,0,t)}),[this._replacementAd]}if(e.sequence){let i=this._vastResponse.ads.indexOf(e);return this._vastResponse.ads.splice(i,1),t.adPod.forEach(t=>{Jr.mergeWrappedAd(t,e),this._vastResponse.ads.splice(i++,0,t)}),t.ads.forEach(s=>{Jr.mergeWrappedAd(s,e),t.adPod.length?this._vastResponse.replacementAds.push(s):this._vastResponse.ads.splice(i++,0,s)}),this._vastResponse.ads}return t.adPod.forEach(t=>{Jr.mergeWrappedAd(t,e)}),t.ads.forEach(t=>{Jr.mergeWrappedAd(t,e)}),this._vastResponse=this._createResponseObject(t,this._vastResponse),this._vastResponse.ads?this._vastResponse.ads:[this._vastResponse.ad]}_trackError(e,t,i=null){void 0===e.category&&(e.category=m.AD),this.emit(Yr.EVENT_ERROR,{error:e,urlTemplates:i,data:{ERRORCODE:t||ta}})}}sa.MAX_NEST_LEVEL=5,sa.TIMEOUT=1e4;let na=new m.ErrorFactory(m.createSourceName("src/js/sznplayer/ad/im/ImResource.js"));class oa{constructor(e){if(!(!!e&&"object"==typeof e&&"function"==typeof e.getAds))throw na.createError(m.SETTING,"IM object you passed through options is not valid.");this._im=e}loadAds(e,t=[]){let i=[];for(let s=0,n=e.length;s<n;s++)i.push(t[s]?t[s]:oa.character.LINEAR);return(this._im.conf&&this._im.conf.vastDebug?new jr(this._im.conf.vastDebug):new Hr(this._im)).send(e).then(e=>{try{return this._processImResponses(e,i)}catch(t){return t.category=t.category||m.AD_IM,t.responses=e,Promise.reject(t)}})}getIm(){return this._im}_processImResponses(e,t){const i=[];for(let s=0,n=e.length;s<n;s++){const n=e[s];if(Qr.isVast(n)){const e=this._createAdStoreFromVast(n);e.setSpecIndex(s),i.push(e)}else if(n.impress){if(n.spots.length)if(t[s]===oa.character.LINEAR){const e=this._processSpot(n.spots[0],Qr.getUrlFromImg(n.miss));e.setSpecIndex(s),i.push(e)}else{const e=[];for(let t=0,i=n.spots.length;t<i;t++){const i=n.spots[t];if(void 0===i.iframe||!i.iframe){const t=Qr.removeSpir(i.content),s=Qr.resolveBasicHtmlEntities(Qr.pickOutJsonString(t));let n=null;try{n=JSON.parse(s)}catch(e){throw na.createError(m.AD_IM,"Advert JSON format is not valid.")}i.content=n,i.id=Qr.getSpotIdFromUrl(n.impress),e.push(i)}}let t=null;(t=new Xr("",e,oa.character.NONLINEAR,n)).setSpecIndex(s),i.push(t)}}else{if(!n.miss)throw na.createError(m.AD_IM,"IM response is not valid.");const e=new Xr(Qr.getUrlFromImg(n.miss));e.setSpecIndex(s),i.push(e)}}return i}_processSpot(e,t){const i=Qr.removeSpir(e.content);if(Qr.isVast(i))return this._createAdStoreFromVast(i,t);const s=Qr.resolveBasicHtmlEntities(Qr.pickOutJsonString(i));if(!s)throw na.createError(m.AD_IM,"Advert spot must be JSON (or VAST).");let n=null;try{n=JSON.parse(s)}catch(e){throw na.createError(m.AD_IM,"Advert JSON format is not valid.")}return Qr.isVast(n.data)?this._createAdStoreFromVast(n.data,t,n):(e.content=n,e.id=Qr.getSpotIdFromUrl(n.impress),new Xr("",[e],oa.character.LINEAR))}_createAdStoreFromVast(e,t=null,i={}){const s=new sa;s.setVastString(e),t&&s.setExternalMiss(t);let n=[];return i.impress&&n.push(i.impress),i.externHit&&n.push(i.externHit),n.length&&s.setExternalImpressions(n),i.skippable_after&&s.setExternalSkipOffset(i.skippable_after),s}}oa.character={LINEAR:"linear",NONLINEAR:"nonlinear"};class ra extends wr{constructor(e){super(),this._player=e,this._icons={},this._currentAdId="",this._currentIcons=null}newContent(e){this._currentAdId=e.id,this._currentIcons=this._getIcons(e.id)}finish(){this._icons[this._currentAdId]=null,this._currentAdId="",this._currentIcons=null,this._player.removeVisualElements()}track(e,t){if(this._currentIcons)if("PLAYING"===e&&t.first){const e={};this._currentIcons.forEach(t=>{if(!e[t.program]){const i=this._buildVisualElement(t);i&&(this._player.addVisualElement(i),e[t.program]=!0)}})}else if("TIMEUPDATE"===e){const e=this._player.getVisualElements(),t=this._player.getCurrentTime();e.forEach(e=>{const i=this._getIcon(e);if(i){i.offset<=t&&(!i.duration||i.offset+i.duration>=t)?this._player.showVisualElement(i.id):this._player.hideVisualElement(i.id)}})}}register(e,t){this._icons[e]=t}_getIcons(e){return this._icons[e]?this._icons[e]:null}_getIcon(e){if(!this._currentIcons)return null;for(let t=0;t<this._currentIcons.length;t++)if(this._currentIcons[t].id===e)return this._currentIcons[t];return null}_buildVisualElement(e){for(let t=0;t<e.staticResources.length;t++){const i=e.staticResources[t];if(this._player.canRunVisualElementType(i.type)){const t={};return"right"===e.xPosition?t.x={origin:"right",center:!1,value:"0px"}:t.x={origin:"left",center:!1,value:o.formatPx("left"===e.xPosition?0:parseInt(e.xPosition,10)||0)},"bottom"===e.yPosition?t.y={origin:"bottom",center:!1,value:"0px"}:t.y={origin:"top",center:!1,value:o.formatPx("top"===e.yPosition?0:parseInt(e.yPosition,10)||0)},{id:e.id,src:i.url,type:i.type,width:o.formatPx(e.width),height:o.formatPx(e.height),position:t,clickthrough:e.clickThrough||null}}}return null}}class aa extends wr{constructor(e){super(),this._player=e,this._companionAds={},this._currentAdId="",this._currentCompanionAds=null}newContent(e){this._currentAdId=e.id,this._currentCompanionAds=this._companionAds[e.id]?this._companionAds[e.id]:null}finish(){this._companionAds[this._currentAdId]=null,this._currentAdId="",this._currentCompanionAds=null}track(e,t){this._currentCompanionAds&&"PLAYING"===e&&t.first&&this._player.dispatchCompanionAdsReady(this._currentCompanionAds)}register(e,t){this._companionAds[e]=t}}class la extends wr{constructor(e){super(),this._player=e,this._currentContentId="",this._ads={}}newContent(e){this._currentContentId=e.id}finish(){this._ads[this._currentContentId]&&(this._ads[this._currentContentId]=void 0),this._currentContentId=""}track(e,t){if(this._ads[this._currentContentId])if("PLAYING"===e&&t.first)for(let e=0;e<this._ads[this._currentContentId].length;e++){const t=this._ads[this._currentContentId][e],i=this._buildVisualElement(t);if(i){this._player.addVisualElement(i);break}}else if("TIMEUPDATE"===e){const e=this._player.getVisualElements(),t=this._player.getCurrentTime();e.forEach(e=>{const i=this._getCreative(e);if(i){i.startOffset<=t&&(!i.minSuggestedDuration||i.startOffset+i.minSuggestedDuration>=t)?this._player.showVisualElement(i.id):this._player.hideVisualElement(i.id),-1!==i.closeOffset&&i.closeOffset<=t&&this._player.showVisualElementClose(i.id)}})}else if("VE_CLOSE"===e)this._player.removeVisualElement(t.id);else if("TEXT_TRACK_SET"===e){const e=null!==this._player.getTextTrack()?"top":"bottom";this._player.getVisualElements().forEach(t=>{const i=this._getCreative(t);i&&this._player.setVisualElementDefaultPosition(i.id,e)})}}register(e,t){this._ads[e]=this._ads[e]||[],this._ads[e].push(t)}_getCreative(e){if(!this._ads[this._currentContentId])return null;for(let t=0;t<this._ads[this._currentContentId].length;t++){const i=this._ads[this._currentContentId][t],s=i.creatives;for(let t=0;t<s.length;t++)if(s[t].id===e)return Object.assign({},s[t],{startOffset:i.startOffset,closeOffset:i.closeOffset})}return null}_buildVisualElement(e){for(let t=0;t<e.creatives.length;t++){const i=e.creatives[t];for(let e=0;e<i.staticResources.length;e++){const t=i.staticResources[e];if(this._player.canRunVisualElementType(t.type))return{id:i.id,src:t.url,type:t.type,defaultPosition:null!==this._player.getTextTrack()?"top":"bottom",clickActions:i.clickTrackings||[],clickthrough:i.clickThrough||null}}}return null}}class ha extends wr{constructor(e){super(),this._ads=[],this._currentAd=null,this._duration=NaN,this._player=e,this._sentEvents={},this._lastTime=null,this._isMuted=null}newContent(e){this._currentAd=this._getAd(e.id),e.duration&&this.setDuration(e.duration),this._isMuted=this._player.isMuted()}finish(){const e=this._ads.indexOf(this._currentAd);e>-1&&this._ads.splice(e,1),this._currentAd=null,this._duration=NaN,this._sentEvents={},this._lastTime=null,this._isMuted=null,this._player.removeVisualElements()}setDuration(e){this._duration=e}track(e,t){if(!this._currentAd)return;const i=this._currentAd.getTrackingEvents(oa.character.LINEAR)||{};if("IMPRESSION"===e&&(this._sentEvents.impression||(this._sentEvents.impression=!0,Xo.track(this._currentAd.getImpressions()))),"PLAYING"===e&&(t.start?(i.creativeView&&Xo.track(i.creativeView),this._sentEvents.impression||(this._sentEvents.impression=!0,Xo.track(this._currentAd.getImpressions()))):i.resume&&Xo.track(i.resume)),"PAUSED"===e&&i.pause&&Xo.track(i.pause),"TIMEUPDATE"===e&&(this._lastTime=t.time),"PLAYBACK_PROGRESS"===e&&(i.progress&&null!==t.time&&i.progress.forEach(e=>{let i=!1,s="";null===e.offset?(i=!0,s=parseInt(t.time,10)):"string"==typeof e.offset&&"%"===e.offset.charAt(e.offset.length-1)?(i=t.percent>=parseInt(e.offset,10),s="p"+parseInt(e.offset,10)):(i=t.time>=e.offset,s="t"+e.offset),i&&!this._sentEvents["progress"+s]&&(this._sentEvents["progress"+s]=!0,Xo.track([e.url]))}),i.timeSpentViewing&&null!==t.time&&i.timeSpentViewing.forEach(e=>{let t=!1,i="",s=this._player.getPlaybackLength();if(null===e.offset)t=!0,i=parseInt(s,10);else if("string"==typeof e.offset&&"%"===e.offset.charAt(e.offset.length-1)){const n=parseInt(e.offset,10);if(this._duration){t=s/this._duration*100>=n,i="p"+n}}else t=s>=e.offset,i="t"+e.offset;t&&!this._sentEvents["timeSpentViewing"+i]&&(this._sentEvents["timeSpentViewing"+i]=!0,Xo.track([e.url],{VIEWED_SECONDS:parseInt(s,10)}))}),i.start&&!this._sentEvents.start&&(this._sentEvents.start=!0,Xo.track(i.start)),i.firstQuartile&&!this._sentEvents.firstQuartile&&t.percent>=25&&(this._sentEvents.firstQuartile=!0,Xo.track(i.firstQuartile)),i.midpoint&&!this._sentEvents.midpoint&&t.percent>=50&&(this._sentEvents.midpoint=!0,Xo.track(i.midpoint)),i.thirdQuartile&&!this._sentEvents.thirdQuartile&&t.percent>=75&&(this._sentEvents.thirdQuartile=!0,Xo.track(i.thirdQuartile)),i.complete&&!this._sentEvents.complete&&t.percent>99&&(this._sentEvents.complete=!0,Xo.track(i.complete))),"ENDED"===e&&i.complete&&!this._sentEvents.complete&&(this._sentEvents.complete=!0,Xo.track(i.complete)),"SEEKING"===e&&this._lastTime&&t.time<this._lastTime&&i.rewind&&(this._lastTime=t.time,Xo.track(i.rewind)),"SKIP"===e&&i.skip){const e=t.time/this._duration,s=isFinite(e)?Math.round(100*e):25;Xo.track(i.skip,{PERCENT:s})}if("VOLUME_CHANGE"===e&&(i.mute&&t.muted&&!this._isMuted&&(this._isMuted=!0,Xo.track(i.mute)),i.unmute&&!t.muted&&this._isMuted&&(this._isMuted=!1,Xo.track(i.unmute))),"AD_VISIBLE"===e){const e=this._currentAd.getViewableImpression();!e||!e.viewable||this._sentEvents.viewUndetermined||this._sentEvents.viewable||this._sentEvents.notViewable||(this._sentEvents.viewable=!0,Xo.track([e.viewable]))}if("AD_NOT_VISIBLE"===e){const e=this._currentAd.getViewableImpression();!e||!e.notViewable||this._sentEvents.viewUndetermined||this._sentEvents.viewable||this._sentEvents.notViewable||(this._sentEvents.notViewable=!0,Xo.track([e.notViewable]))}if("AD_VISIBILITY_UNDETERMINED"===e){const e=this._currentAd.getViewableImpression();!e||!e.viewUndetermined||this._sentEvents.viewUndetermined||this._sentEvents.viewable||this._sentEvents.notViewable||(this._sentEvents.viewUndetermined=!0,Xo.track([e.viewUndetermined]))}if("FULLSCREEN_CHANGE"===e&&(t.isFullscreen?i.playerExpand?Xo.track(i.playerExpand):i.fullscreen&&Xo.track(i.fullscreen):i.playerCollapse?Xo.track(i.playerCollapse):i.exitFullscreen&&Xo.track(i.exitFullscreen)),"VIDEO_CLICKTHROUGH"===e){const e=this._currentAd.getVideoClicks();e&&e.clickTrackings&&e.clickTrackings.length&&Xo.track(e.clickTrackings,{ASSETURI:this._player.getCurrentSrc(),CONTENTPLAYHEAD:zi.getFormattedTime(this._player.getCurrentTime())})}if("VE_DISPLAYED"===e){const e=this._getIcon(t.id);e&&e.viewTrackings&&e.viewTrackings.length&&Xo.track(e.viewTrackings)}if("VE_CLICK"===e){const e=this._getIcon(t.id);e&&e.clickTrackings&&e.clickTrackings.length&&Xo.track(e.clickTrackings)}if("USER_ACCEPT_INVITATION"===e&&i.acceptInvitationLinear&&Xo.track(i.acceptInvitationLinear),"USER_MINIMIZE"===e&&i.collapse&&Xo.track(i.collapse),"USER_CLOSE"===e&&i.closeLinear&&Xo.track(i.closeLinear),"ERROR"===e){if(t.category&&t.category===m.PRELOAD)return;const e=this._currentAd.getErrors();t.hitData&&e&&Xo.track(e,t.hitData)}}register(e){this._ads.push(e)}_getAd(e){for(let t=0,i=this._ads.length;t<i;t++)if(this._ads[t].getId()===e)return this._ads[t];return null}_getIcon(e){const t=this._currentAd.getIcons();if(!t)return null;for(let i=0;i<t.length;i++)if(t[i].id===e)return t[i];return null}}class _a extends wr{constructor(e){super(),this._currentContentId="",this._ads={},this._player=e}newContent(e){this._currentContentId=e.id}finish(){this._ads[this._currentContentId]&&(this._ads[this._currentContentId]=void 0),this._currentContentId=""}track(e,t){if(this._ads[this._currentContentId])for(let i=0;i<this._ads[this._currentContentId].length;i++){const s=this._ads[this._currentContentId][i],n=s.ad.getTrackingEvents(oa.character.NONLINEAR)||{};if("VE_DISPLAYED"===e&&(s.sentEvents.impress||(s.sentEvents.impress=!0,Xo.track(s.ad.getImpressions())),n.creativeView&&!s.sentEvents.creativeView&&(s.sentEvents.creativeView=!0,Xo.track(n.creativeView))),"VE_CLICK"===e){const e=this._getCreative(s.nonLinear,t.id);e&&e.clickTrackings&&e.clickTrackings.length&&Xo.track(e.clickTrackings)}if("VE_CLOSE"===e){this._getCreative(s.nonLinear,t.id)&&n.close&&Xo.track(n.close)}}}register(e,t,i){this._ads[e]=this._ads[e]||[],this._ads[e].push({ad:t,nonLinear:i,sentEvents:{}})}_getCreative(e,t){for(let i=0;i<e.creatives.length;i++)if(e.creatives[i].id===t)return e.creatives[i];return null}}class da extends wr{constructor(){super(),this._currentContentId="",this._misses={}}newContent(e){this._currentContentId=e.id}finish(){this._clearMisses(),this._currentContentId=""}track(e,t){"PLAYING"!==e&&"TIMEUPDATE"!==e||!this._misses[this._currentContentId]||(Xo.track(this._misses[this._currentContentId]),this._clearMisses())}register(e,t){this._misses[e]=this._misses[e]||[],this._misses[e].push(t)}_clearMisses(){this._misses[this._currentContentId]&&(this._misses[this._currentContentId]=void 0)}}let ua=new m.ErrorFactory(m.createSourceName("src/js/sznplayer/ad/AdsManager.js"));class ca extends S{constructor(e,t){super(),this._richPlayer=e,this._trackerCtrl=t,this._iconsManager=null,this._companionAdsManager=null,this._linearAdTracker=null,this._nonLinearAdTracker=null,this._nonLinearAdsManager=null,this._missTracker=null,this._imResource=null,this._overlays=null,this._sponsors=null,this._variablePrerolls=null,this._prerolls=null,this._currentSponsors=null,this._currentVariablePrerolls=null,this._currentPrerolls=null,this._adPoints=[],this._midrolls=null,this._postrolls=null,this._overStartOffset=-1,this._overCloseOffset=-1,this._vpreSkipOffset=-1,this._preSkipOffset=-1,this._midSkipOffset=-1,this._postSkipOffset=-1,this._cm=null,this._cmImpresses=null,this._cmMiss="",this._ppShow=!1,this._ppShown=!1,this._ppOffset=null,this._ppTime=null,this._repeatSettings=null,this._eventsMap=new Map([[vr.EVENT_CONTENT_SET,this._handleContentSet],[vr.EVENT_CONTENT_BEGIN,this._handleContentBegin],[vr.EVENT_CONTENT_RESTORE,this._handleContentRestore],[vr.EVENT_ADPOINT,this._handleAdPoint],[vr.EVENT_NEAR_END,this._handleNearEnd],[vr.EVENT_ENDED,this._handleEnded],[vr.EVENT_ENDADSCREEN_POINT,this._handleAdScreen],[vr.EVENT_TIMEUPDATE,this._handleTimeupdate],[vr.EVENT_SEEKED,this._handleSeeked],[vr.EVENT_REPLAY_REQUEST,this._handleReplay],[vr.EVENT_CONTENT_DURATION_CHANGE,this._handleDurationChange]])}init(e){this._imResource||(this._imResource=new oa(e),this._iconsManager=new ra(this._richPlayer),this._companionAdsManager=new aa(this._richPlayer),this._linearAdTracker=new ha(this._richPlayer),this._nonLinearAdTracker=new _a(this._richPlayer),this._nonLinearAdsManager=new la(this._richPlayer),this._missTracker=new da,this._trackerCtrl.addTracker(vr.MODE_AD,this._iconsManager),this._trackerCtrl.addTracker(vr.MODE_AD,this._linearAdTracker),this._trackerCtrl.addTracker(vr.MODE_AD,this._companionAdsManager),this._trackerCtrl.addTracker(vr.MODE_CONTENT,this._nonLinearAdTracker),this._trackerCtrl.addTracker(vr.MODE_CONTENT,this._nonLinearAdsManager),this._trackerCtrl.addTracker(vr.MODE_CONTENT,this._missTracker),this.bindAll(this._eventsMap),this.addListeners(this._richPlayer,this._eventsMap))}isInited(){return!!this._imResource}_concatAds(e,t=!0){let i=[];return e.forEach(e=>{if(e){const s=(Array.isArray(e)?e:[e]).filter(e=>{if(e.error||!Array.isArray(t))return!0;const i=e.getSpecIndex(),s=t[i];return e.setVpaidAllowed(s),e.hasLinear()});i.push(...s)}}),i.length?i:null}servePp(e){this._ppShow=e}setCompanionAdSlots(e){this._richPlayer.setCompanionAdSlots(e)}provideOverlays(e){if(!this._imResource||!e||!Ur.checkSponsorConfig(e).valid||Array.isArray(e.spec)&&!e.spec.length)return Promise.resolve();this._overStartOffset=e.startOffset,this._overCloseOffset=e.closeOffset;const t=Array.isArray(e.spec)?e.spec:[e.spec];let i=null;return i=this._imResource.loadAds(t).then(e=>{const t=e.map(e=>this._getRelevantAdData(e));return Promise.all(t)},e=>{this._handleAdError(e)}).then(e=>{e&&(this._overlays=this._concatAds(e))})}provideSponsors(e){if(!this._imResource||!e||!Ur.checkSponsorConfig(e).valid||Array.isArray(e.spec)&&!e.spec.length)return Promise.resolve();const t=Array.isArray(e.spec)?e.spec:[e.spec],i=void 0!==e.vpaidAllowed?Array.isArray(e.vpaidAllowed)?e.vpaidAllowed:[e.vpaidAllowed]:[!0];t.forEach((e,t)=>{void 0===i[t]&&(i[t]=i[t-1])}),t.forEach(e=>{this._adjustSpec(e)});let s=null;return s=this._imResource.loadAds(t).then(e=>{const t=e.map(e=>this._getRelevantAdData(e));return Promise.all(t)},e=>{this._handleAdError(e)}).then(e=>{e&&(this._sponsors=this._concatAds(e,i),this._currentSponsors=this._sponsors?[...this._sponsors]:null)})}provideVariablePrerolls(e){if(!this._imResource||!e||!Ur.checkVariablePrerollConfig(e).valid||Array.isArray(e.spec)&&!e.spec.length)return Promise.resolve();const t=Array.isArray(e.spec)?e.spec:[e.spec],i=Array.isArray(e.skipOffset)?e.skipOffset:[e.skipOffset],s=void 0!==e.vpaidAllowed?Array.isArray(e.vpaidAllowed)?e.vpaidAllowed:[e.vpaidAllowed]:[!0];t.forEach((e,t)=>{i[t]||(i[t]=i[t-1]),void 0===s[t]&&(s[t]=s[t-1])}),this._vpreSkipOffset=i,t.forEach(e=>{this._adjustSpec(e)});let n=null;return n=this._imResource.loadAds(t).then(e=>{const t=e.map(e=>this._getRelevantAdData(e));return Promise.all(t)},e=>{this._handleAdError(e)}).then(e=>{e&&(this._variablePrerolls=this._concatAds(e,s),this._currentVariablePrerolls=this._variablePrerolls?[...this._variablePrerolls]:null)})}providePrerolls(e){if(!this._imResource||!e||!Ur.checkPrerollConfig(e).valid||Array.isArray(e.spec)&&!e.spec.length)return Promise.resolve();const t=Array.isArray(e.spec)?e.spec:[e.spec],i=Array.isArray(e.skipOffset)?e.skipOffset:[e.skipOffset],s=void 0!==e.vpaidAllowed?Array.isArray(e.vpaidAllowed)?e.vpaidAllowed:[e.vpaidAllowed]:[!0];t.forEach((e,t)=>{i[t]||(i[t]=i[t-1]),void 0===s[t]&&(s[t]=s[t-1])}),this._preSkipOffset=i,t.forEach(e=>{this._adjustSpec(e,"preroll")});let n=null;return n=this._imResource.loadAds(t).then(e=>{const t=e.map(e=>this._getRelevantAdData(e));return Promise.all(t)},e=>{this._handleAdError(e)}).then(e=>{e&&(this._prerolls=this._concatAds(e,s),this._currentPrerolls=this._prerolls?[...this._prerolls]:null)})}provideMidrolls(e){if(e||this._richPlayer.addMidrollPoint([]),!this._imResource||!e||!Ur.checkMidrollConfig(e).valid||Array.isArray(e.spec)&&!e.spec.length)return Promise.resolve();let t=Array.isArray(e.point)?o.clone(e.point):[o.clone(e.point)];const i=this._richPlayer.getDuration(),s=this._richPlayer.isLiveStreaming(),n=this._richPlayer.getStartTime(),r=void 0!==e.cancelable&&e.cancelable;this._richPlayer.setMidrollCanCancel(r);for(const e of t){if(void 0===e.timeType&&(e.timeType=Ur.timeTypes.AT_TIME),void 0===e.cancelable&&(e.cancelable=r),/^\d+(\.\d+)?%$/.test(e.time)){if(!i)return this._handleAdError(ua.createError(m.AD,"Either the provideMidrolls has been called before the media source has been resolved, or the media's duration cannot be determined and relative time points therefore cannot be used.")),Promise.resolve();if(e.timeType!==Ur.timeTypes.AT_TIME)return this._handleAdError(ua.createError(m.AD,"Relative time points cannot be used in combinationwith types other than atTime.")),Promise.resolve();e.time=parseFloat(e.time)/100*i}if(!i&&(!s&&e.timeType===Ur.timeTypes.AFTER_START||e.timeType===Ur.timeTypes.BEFORE_END))return this._handleAdError(ua.createError(m.AD,"Either the provideMidrolls has been called before the media source has been resolved, or the media's duration cannot be determined and time point "+`of type '${e.timeType}' therefore could not be used.`)),Promise.resolve();if(i&&!s&&e.timeType===Ur.timeTypes.AT_TIME&&i-e.time<ca.MIDROLL_TIME_BEFORE_END)return this._handleAdError(ua.createError(m.AD,"Time, at which midroll should be played, is set to a value greater than the media's duration or too close to it.")),Promise.resolve();if(e.timeType===Ur.timeTypes.AFTER_START&&!s){const t=n+e.time;if(i<t)return this._handleAdError(ua.createError(m.AD,"Time set for midroll with type 'afterStart' is set to a value greater than the media's duration.")),Promise.resolve();e.time=t,e.timeType=Ur.timeTypes.AT_TIME}if(e.timeType===Ur.timeTypes.BEFORE_END){if(i<e.time)return this._handleAdError(ua.createError(m.AD,"Time set for midroll with type 'beforeEnd' is set to a value greater than the media's duration.")),Promise.resolve();e.time=i-e.time,e.timeType=Ur.timeTypes.AT_TIME}}let a=Array.isArray(e.spec)?e.spec:[e.spec],l=Array.isArray(e.skipOffset)?e.skipOffset:[e.skipOffset],h=void 0!==e.vpaidAllowed?Array.isArray(e.vpaidAllowed)?e.vpaidAllowed:[e.vpaidAllowed]:[!0];const _=1===t.length;if(a.forEach((e,i)=>{t[i]||(t[i]=t[i-1]),l[i]||(l[i]=l[i-1]),void 0===h[i]&&(h[i]=h[i-1])}),_&&t[0].timeType===Ur.timeTypes.AFTER_START_REPEAT){const e=t[0];s&&(this._repeatSettings={time:e.time,specs:[...a],skipOffsets:[...l],vpaidAllowed:[...h],wasFirstAdded:!1,repeatOnce:!1,cancelable:e.cancelable});const n=e.maxRepeat?e.maxRepeat:ca.MIDROLL_MAX_REPEAT_DEFAULT,o=i/e.time>n?i/(n+1):e.time;this._richPlayer.setMidrollSeekDistance(e.time),this._richPlayer.disableMidrollForcing();const r=[],_=[],d=[],u=[];for(let t=o;t<i;t+=o)a.forEach((i,s)=>{_.push(Object.assign({},i)),r.push({time:t,timeType:Ur.timeTypes.AT_TIME,cancelable:e.cancelable}),d.push(l[s]),u.push(h[s])});t=r,a=_,l=d,h=u}else if(_&&t[0].timeType===Ur.timeTypes.AFTER_START&&s)return this._repeatSettings={time:t[0].time,specs:a,skipOffsets:l,vpaidAllowed:h,wasFirstAdded:!1,cancelable:t[0].cancelable,repeatOnce:!0},this._midrolls=[],this._adPoints=[],this._midSkipOffset=[],Promise.resolve();if(this._adPoints=t,this._midSkipOffset=l,a.forEach(e=>{this._adjustSpec(e,"midroll")}),!a.length)return Promise.resolve();let d=null;return d=this._imResource.loadAds(a).then(e=>{const t=e.map(e=>this._getRelevantAdData(e));return Promise.all(t)},e=>{this._handleAdError(e)}).then(e=>{if(e){this._midrolls=this._concatAds(e,h)||[];let t=[];for(let e=0;e<this._midrolls.length;e++)t.push(this._processMidroll(this._midrolls[e],this._adPoints));this._richPlayer.addMidrollPoint(t)}})}providePostrolls(e){if(e||(this._postrolls=null,this._richPlayer.addPostrollInfo([])),!this._imResource||!e||!Ur.checkPostrollConfig(e).valid||Array.isArray(e.spec)&&!e.spec.length)return Promise.resolve();const t=Array.isArray(e.spec)?e.spec:[e.spec],i=Array.isArray(e.skipOffset)?e.skipOffset:[e.skipOffset],s=void 0!==e.vpaidAllowed?Array.isArray(e.vpaidAllowed)?e.vpaidAllowed:[e.vpaidAllowed]:[!0];t.forEach((e,t)=>{i[t]||(i[t]=i[t-1]),void 0===s[t]&&(s[t]=s[t-1])}),this._postSkipOffset=i,t.forEach(e=>{this._adjustSpec(e,"postroll")});let n=null;return n=this._imResource.loadAds(t).then(e=>{const t=e.map(e=>this._getRelevantAdData(e));return Promise.all(t)},e=>{this._handleAdError(e)}).then(e=>{if(e){this._postrolls=this._concatAds(e,s)||[];let t=[];for(let e=0;e<this._postrolls.length;e++){const i=this._postrolls[e],s=i.error?null:this._getLinearAd(i),n=s&&void 0!==s.linearAd?s.linearAd:null;t.push({isSuccessful:!!n,linearAd:n})}this._richPlayer.addPostrollInfo(t,!1)}})}provideCM(e){if(!this._imResource||!e)return this._cm=null,Promise.resolve();const t=Array.isArray(e.spec)?e.spec:[e.spec],i=t.map(e=>oa.character.NONLINEAR);let s=null;return s=this._imResource.loadAds(t,i).then(e=>{const t=e.map(e=>this._getRelevantAdData(e));return Promise.all(t)},e=>{this._handleAdError(e)}).then(e=>{e&&(this._cm=e[0])})}isCMAvailable(){return!!this._cm}_adjustSpec(e,t=null){const i=[];e.collocation&&i.push(e.collocation),t&&i.push(t),i.length&&(e.collocation=i.join(" "));const s=[],n=this._richPlayer.isFeatureSupported("vast");return e.flag&&s.push(e.flag),n&&s.push("~vast"),s.length&&(e.flag=s.join(" ")),e}_getRelevantAdData(e){return e.addListener(Yr.EVENT_ERROR,({error:e,urlTemplates:t,data:i})=>{t&&t.length&&Xo.track(t,i),this._handleAdError(e)}),e.getAd().then(t=>{if(t)return Array.isArray(t)?this._getAdPodData(t,e):(this._addExternalParams(t,e),t);{const t=e.getExternalMiss();return t?{error:t,specIndex:e.getSpecIndex()}:null}}).catch(e=>{this._handleAdError(e)})}_getAdPodData(e,t){const i=e.map(e=>e?(this._addExternalParams(e,t),Promise.resolve(e)):t.getReplacementAd().then(e=>{if(e)return this._addExternalParams(e,t),e;{const e=t.getExternalMiss();return e?{error:e,specIndex:t.getSpecIndex()}:null}}).catch(e=>{Promise.reject(e)}));return Promise.all(i).then(e=>e.filter(e=>!!e))}_addExternalParams(e,t){const i=t.getSpecIndex();null!==i&&e.setSpecIndex(i);let s=t.getExternalImpressions();s&&(e.addExternalImpressions(s),t.setExternalImpressions(null));let n=t.getExternalSkipOffset();n&&e.addExternalSkipOffset(n)}_processMidroll(e,t){const i=e.error?e.specIndex:e.getSpecIndex(),s=e.error?null:this._getLinearAd(e),n=s&&void 0!==s.linearAd?s.linearAd:null;return Object.assign({isSuccessful:!!n,linearAd:n,errors:n?e.getErrors():null},t[i])}reset(){this._overlays=null,this._sponsors=null,this._variablePrerolls=null,this._prerolls=null,this._currentSponsors=null,this._currentVariablePrerolls=null,this._currentPrerolls=null,this._midrolls=null,this._postrolls=null,this._overStartOffset=-1,this._overCloseOffset=-1,this._vpreSkipOffset=-1,this._preSkipOffset=-1,this._midSkipOffset=-1,this._postSkipOffset=-1,this._cm=null,this._cmImpresses=null,this._cmMiss="",this._ppShow=!1,this._ppShown=!1,this._ppOffset=null,this._ppTime=null,this._repeatSettings=null}_getLinearAd(e,t={}){const i=e.getLinear(t),s=e.getVideoClicks();if(!i){const e=ua.createError(m.AD,"No linear-ad found.");return e.hitData={ERRORCODE:403},{error:e}}const n=e.getCompanionAds();if(n&&!this._richPlayer.canDisplayCompanionAds(n,e.getCompanionAdsRequired())){const e=ua.createError(m.AD,"Unable to display required companionAd.");return e.hitData={ERRORCODE:602},{error:e}}return Object.assign(i,{videoClicks:s,errors:e.getErrors()}),{linearAd:i}}_handleContentSet({content:e}){if(this._prerolls){for(let t=0,i=this._prerolls.length;t<i;t++){const i=this._prerolls[t];if(i.error){this._missTracker.register(e.id,i.error);continue}const s=i.getSpecIndex(),n=Array.isArray(this._preSkipOffset)?this._preSkipOffset[s]:this._preSkipOffset,o=this._getLinearAd(i,{skipOffset:n}),r=void 0!==o.linearAd?o.linearAd:null;if(r){this._linearAdTracker.register(i);const e=i.getIcons();e&&this._iconsManager.register(r.id,e);const t=i.getCompanionAds();t&&this._companionAdsManager.register(r.id,t),this._richPlayer.setPreroll(r)}else this._handleAdError(o.error)}this._prerolls=null}if(this._variablePrerolls){for(let t=0,i=this._variablePrerolls.length;t<i;t++){const i=this._variablePrerolls[t];if(i.error){this._missTracker.register(e.id,i.error);continue}const s=i.getSpecIndex(),n=Array.isArray(this._vpreSkipOffset)?this._vpreSkipOffset[s]:this._vpreSkipOffset,o={},r=i.getType();r===vr.adRole.SPONSOR?o.layout="sponsor":r===vr.adRole.PROMO?o.layout="promo":o.skipOffset=n;const a=this._getLinearAd(i,o),l=void 0!==a.linearAd?a.linearAd:null;if(l){this._linearAdTracker.register(i);const e=i.getIcons();e&&this._iconsManager.register(l.id,e);const t=i.getCompanionAds();t&&this._companionAdsManager.register(l.id,t),r===vr.adRole.SPONSOR?this._richPlayer.setSponsor(l):r===vr.adRole.PROMO?this._richPlayer.setPromo(l):this._richPlayer.setPreroll(l)}else this._handleAdError(a.error)}this._variablePrerolls=null}if(this._sponsors){for(let t=0,i=this._sponsors.length;t<i;t++){const i=this._sponsors[t];if(i.error){this._missTracker.register(e.id,i.error);continue}const s=this._getLinearAd(i,{layout:"sponsor"}),n=void 0!==s.linearAd?s.linearAd:null;if(n){this._linearAdTracker.register(i);const e=i.getIcons();e&&this._iconsManager.register(n.id,e);const t=i.getCompanionAds();t&&this._companionAdsManager.register(n.id,t),this._richPlayer.setSponsor(n)}else this._handleAdError(s.error)}this._sponsors=null}if(this._overlays){for(let t=0,i=this._overlays.length;t<i;t++){const i=this._overlays[t],s=(Array.isArray(this._overStartOffset)?this._overStartOffset[t]:this._overStartOffset)||10;let n=Array.isArray(this._overCloseOffset)?this._overCloseOffset[t]:this._overCloseOffset;if(void 0===n&&(n=10),i.error){this._missTracker.register(e.id,i.error);continue}const o=i.getNonLinear({startOffset:s,closeOffset:n});if(o)this._nonLinearAdTracker.register(e.id,i,o),this._nonLinearAdsManager.register(e.id,o);else{const e=ua.createError(m.AD,"No non-linear-ad found.");e.hitData={ERRORCODE:503},this._handleAdError(e)}}this._overlays=null}}_handleContentBegin(){this._richPlayer.isAdMode()||(this._ppOffset=ca.PP_OFFSET_BEGIN)}_handleContentRestore(){this._richPlayer.isAdMode()||(this._ppOffset=ca.PP_OFFSET_RESTORE)}_handleAdPoint(e){if(this._midrolls)for(let t=0,i=this._midrolls.length;t<i;t++){const i=this._midrolls[t],s=i.error?i.specIndex:i.getSpecIndex();if(this._adPoints[s].time!==e.time)continue;if(i.error){const e=this._richPlayer.getContent();this._missTracker.register(e.id,i.error);continue}const n=Array.isArray(this._midSkipOffset)?this._midSkipOffset[s]:this._midSkipOffset,o=this._getLinearAd(i,{skipOffset:n}),r=void 0!==o.linearAd?o.linearAd:null;if(r){this._linearAdTracker.register(i);const e=i.getIcons();e&&this._iconsManager.register(r.id,e);const t=i.getCompanionAds();t&&this._companionAdsManager.register(r.id,t),this._richPlayer.setMidroll(Object.assign(r,{duration:this._adPoints[s].duration||null}))}else this._handleAdError(o.error)}this._richPlayer.tryStartPlayingMidrolls()}_handleNearEnd(){this._richPlayer.isAdMode()||(this._ppOffset=0)}_handleDurationChange(e){if(!e.duration||this._richPlayer.isLiveStreaming()||this._richPlayer.isAdMode()||this._richPlayer.setMidrollSeekDistance(e.duration/100*ca.MIDROLL_SEEK_PERCENTAGE),!this._repeatSettings||!e.duration||this._repeatSettings.wasFirstAdded&&this._repeatSettings.repeatOnce||this._richPlayer.getMidrollsCanceled())return;void 0===this._repeatSettings.duration&&(this._repeatSettings.duration=e.duration);const t=e.realDuration,i=this._repeatSettings.wasFirstAdded?this._richPlayer.getLastMidrollTime():this._repeatSettings.duration;if(t-i>this._repeatSettings.time){let e=o.clone(this._repeatSettings.specs),i=this._repeatSettings.skipOffsets,s=this._repeatSettings.vpaidAllowed;const n=this._adPoints.length;e.forEach((e,s)=>{this._adPoints.push({time:t,cancelable:this._repeatSettings.cancelable}),this._midSkipOffset[this._adPoints.length-1]=i[s],this._adjustSpec(e,"midroll")}),this._imResource.loadAds(e).then(e=>{const t=e.map(e=>this._getRelevantAdData(e));return Promise.all(t)},e=>{this._handleAdError(e)}).then(e=>{if(e){const t=this._concatAds(e,s)||[];this._midrolls=Array.isArray(this._midrolls)?this._midrolls.concat(t):t;let i=[];for(let e=0;e<t.length;e++){const s=t[e],o=s.error?s.specIndex:s.getSpecIndex(),r=n+o;s.error?s.specIndex=r:s.setSpecIndex(r),i.push(this._processMidroll(s,this._adPoints))}this._richPlayer.addMidrollPoint(i,!1),this._repeatSettings.wasFirstAdded=!!i.length}})}}_handleEnded(){if(!this._richPlayer.isAdMode()){if(this._postrolls){for(let e=0,t=this._postrolls.length;e<t;e++){const t=this._postrolls[e];if(t.error){Xo.track([t.error]);continue}const i=t.getSpecIndex(),s=Array.isArray(this._postSkipOffset)?this._postSkipOffset[i]:this._postSkipOffset,n=this._getLinearAd(t,{skipOffset:s}),o=void 0!==n.linearAd?n.linearAd:null;if(o){this._linearAdTracker.register(t);const e=t.getIcons();e&&this._iconsManager.register(o.id,e);const i=t.getCompanionAds();i&&this._companionAdsManager.register(o.id,i),this._richPlayer.setPostroll(o)}else this._handleAdError(n.error)}this._postrolls=null}this._cm&&(this._cm.error?this._cmMiss=this._cm.error:(this._cmImpresses=this._cm.getImpressions(),this._richPlayer.setEndAdScreen({id:this._cm.getId(),content:this._cm.getNonLinear(),caption:"Komerční sdělení",im:this._imResource.getIm()})),this._cm=null)}}_handleAdScreen(){this._cmImpresses&&this._cmImpresses.length&&Xo.track(this._cmImpresses),this._cmMiss&&Xo.track([this._cmMiss]),this._cmImpresses=null,this._cmMiss=null}_handleTimeupdate(e){if(!this._ppShow||this._richPlayer.isAdMode()||null===this._ppOffset&&null===this._ppTime)return;const t=e.time;null!==this._ppOffset&&(this._ppTime=this._ppOffset+t,this._ppOffset=null),this._ppTime<=t&&this._ppTime+ca.PP_DURATION>=t?(this._richPlayer.showPp(),this._ppShown=!0):this._ppShown&&(this._richPlayer.hidePp(),this._ppShown=!1)}_handleSeeked(){this._richPlayer.enableMidrollForcing()}_handleReplay(){this._richPlayer.isAdOnlyMode()&&(this._prerolls=this._currentPrerolls,this._variablePrerolls=this._currentVariablePrerolls,this._sponsors=this._currentSponsors)}_handleAdError(e){this.emit(ca.EVENT_ERROR,e)}}ca.EVENT_ERROR="error",ca.MIDROLL_MAX_REPEAT_DEFAULT=4,ca.MIDROLL_TIME_BEFORE_END=10,ca.PP_OFFSET_BEGIN=10,ca.PP_OFFSET_RESTORE=5,ca.PP_DURATION=5,ca.MIDROLL_SEEK_PERCENTAGE=15;class pa extends wr{constructor(e,t){if(!t||"object"!=typeof t)throw new Error('[analytics/SznTracker] Argument "settings" must be specified.');super(),this._dot=null,this._dotBuffer=[],this._player=e,this._settings={partLength:t.partLength,playerVersion:t.playerVersion||"",actionPrefix:t.actionPrefix||"",ad:"boolean"==typeof t.ad&&t.ad,adBlock:"boolean"==typeof t.adBlock&&t.adBlock},this._content=null,this._data=null,this._role="",this._sequenceLength=0,this._sequencePosition=0,this._sequenceCount=0,this._sequenceIndex=0,this._duration=NaN,this._prevContentId="",this._lastFragmentTime=0}newContent(e,t="",i=1,s=1,n=null,o=null){this._resetContentData(),this._content=e,this._data=e.analyticsData||{},this._role=t,this._sequenceLength=i,this._sequencePosition=s,this._sequenceCount=n,this._sequenceIndex=o,e.duration&&this.setDuration(e.duration)}finish(){this._prevContentId=this._content?this._content.id:"",this._content=null,this._data=null,this._role=""}setDuration(e){this._duration=Math.round(e)}setDot(e,t={}){if(!e||"object"!=typeof e||"function"!=typeof e.hit)throw new Error("[analytics/SznTracker] DOT must be specified.");this._dot=e,this._dotBuffer.forEach(e=>{this._dot.hit("event",e)}),this._dotBuffer=[],void 0!==t.partLength&&(this._settings.partLength=t.partLength)}setDotData(e){let t=this._content.dotData||{};Object.keys(e).forEach(i=>{void 0===t[i]&&(t[i]={}),Object.assign(t[i],e[i])})}track(e,t){if("PLAYING"===e){const i=this._player.getVideoHeight(),s=i?`${i}p`:"",n=this._getPlayData(t.time,s,t.first);this._processHit(n,e,t)}else if("TIMEUPDATE"===e){const i=this._getPartData(t.time);i&&this._processHit(i,e,t)}else if("SEEKING"===e)this._lastFragmentTime=0;else if("ENDED"===e){const i=this._duration,s=this._getRestPartData(i);s&&this._processHit(s,e,t);const n=this._getCommonData("finished",i);this._processHit(n,e,t)}}_getCommonData(e,t){const i={action:`${this._settings.actionPrefix}${e}`,time:Math.round(t),videoid:this._content.id,duration:this._duration,live:this._player.isLive(),replay:this._player.isReplay(),fullscreen:this._player.isFullscreen(),cinema:this._player.isCinema(),pip:this._player.isPipActive(),subtitles:null!=this._player.getTextTrack(),playerversion:this._settings.playerVersion,playertech:this._player.getTechName(),service:"service"in this._data?this._data.service:""};return this._data.contextId&&(i.contextid=this._data.contextId),this._data.embed&&(i.embed=this._data.embed),i}_getPlayData(e,t,i){const s=this._getCommonData("play",e);if(s.quality=t,s.videoname="materialName"in this._data?this._data.materialName:"",s.sectionname="sectionName"in this._data?this._data.sectionName:"","materialType"in this._data?s.videotype=this._data.materialType:this._role&&(s.videotype=this._role),this._settings.ad){const e=this._player.constructor.adRole;this._role===e.PREROLL||this._role===e.SPONSOR||this._role===e.PROMO?s.adtype="preroll":this._role===e.MIDROLL?s.adtype="midroll":this._role===e.POSTROLL&&(s.adtype="postroll"),s.adsequencelength=this._sequenceLength,s.adsequenceposition=this._sequencePosition,s.adblock=this._settings.adBlock,null!==this._sequenceCount&&(s.adsequencecount=this._sequenceCount),null!==this._sequenceIndex&&(s.adsequenceindex=this._sequenceIndex)}return"context"in this._data&&(s.context=this._data.context),!s.videoname&&this._content.mediaName&&(s.videoname=this._content.mediaName),i&&("cause"in this._data?s.cause=this._data.cause:s.cause=this._prevContentId?"playlist":"start",this._prevContentId&&(s.prevvideoid=this._prevContentId)),s}_getPartData(e){const t=Math.floor(e);let i=null;return this._player.isFragmentComplete(this._settings.partLength)&&this._lastFragmentTime!==t&&(this._lastFragmentTime=t,(i=this._getCommonData("part",t)).part=this._settings.partLength),i}_getRestPartData(e){const t=this._player.getCompleteRestFragmentLength(this._settings.partLength);let i=null;return t&&((i=this._getCommonData("part",e)).part=t),i}_processHit(e,t,i){const s=e.action;this._content.dotData&&this._content.dotData["*"]&&(e=Object.assign(e,this._content.dotData["*"])),this._content.dotData&&this._content.dotData[s]&&(e=Object.assign(e,this._content.dotData[s])),this._dot?this._dot.hit("event",{d:e}):this._dotBuffer.push({d:e})}_resetContentData(){this._content=null,this._data=null,this._duration=NaN,this._lastFragmentTime=0}}const ma="//cdn-player.szn.cz:443",ga=5,Ea=2,Ta={SEEKING:"seek",QUALITY_CHANGE:"quality_change",START:"start",BUFFER_EMPTY:"empty"},fa={PLAY:"play",PART:"part",VOLUME_CHANGE:"volume_change",BUFFERING:"buffering",FINISHED:"finished",ERROR:"error",WARNING:"warning"};class ya extends wr{constructor(e,t){super(),this._player=e,this._settings={playerVersion:t.playerVersion||"",ad:"boolean"==typeof t.ad&&t.ad,adBlock:"boolean"==typeof t.adBlock&&t.adBlock},this._content=null,this._domain=null,this._role="",this._firstPlay=!0,this._prevContentId="",this._bufferHitInterval=null,this._qualityChangeTimeout=null,this._bufferingStartTime=null,this._bufferEmptyCause=Ta.BUFFER_EMPTY,this._lastFragmentTime=0,this._qualityChangeCount=0}newContent(e,t=""){this._resetContentData(),this._content=e,this._firstPlay=!0,this._qualityChangeCount=0,this._role=t}finish(){this._clearBufferHitInterval(),this._clearQualityChangeTimeout(),this._bufferingStartTime=null,this._prevContentId=this._content?this._content.id:"",this._bufferEmptyCause=Ta.BUFFER_EMPTY,this._content=null,this._domain=null,this._role="",this._firstPlay=!0,this._qualityChangeCount=0}track(e,t){switch(e){case"AD_SOURCE_SET":case"CONTENT_SOURCE_SET":this._clearQualityChangeTimeout(),this._firstPlay?this._bufferEmptyCause=Ta.START:this._bufferEmptyCause=Ta.SEEKING;break;case"PLAYING":{const e=this._getPlayData(t.first);this._firstPlay=!1,this._processHit(e);break}case"BUFFER_EMPTY":this._clearQualityChangeTimeout(),this._createBufferHitInterval();break;case"QUALITY_CHANGE":this._qualityChangeCount++;break;case"QUALITY_SET":this._clearQualityChangeTimeout(),this._firstPlay||(this._bufferEmptyCause=Ta.QUALITY_CHANGE);break;case"VOLUME_CHANGE":break;case"SKIP":this._clearQualityChangeTimeout(),this._bufferEmptyCause=Ta.SEEKING;break;case"SEEKED":case"AD_CAN_PLAY":case"CONTENT_CAN_PLAY":this._bufferHitInterval&&(this._clearBufferHitInterval(),this._processHit(this._getBufferingData()),this._bufferEmptyCause===Ta.QUALITY_CHANGE?this._createQualityChangeTimeout():this._bufferEmptyCause=Ta.BUFFER_EMPTY);break;case"TIMEUPDATE":{const e=this._getPartData(t.time);e&&(this._qualityChangeCount=0,this._processHit(e));break}case"SEEKSTART":this._clearQualityChangeTimeout(),this._bufferEmptyCause=Ta.SEEKING;break;case"SEEKING":this._lastFragmentTime=0,this._qualityChangeCount=0;break;case"ENDED":{const e=this._getLastPartData();e&&this._processHit(e);const t=this._getFinishedData();this._processHit(t),this._qualityChangeCount=0;break}}}handleError(e){const t=this._getErrorData(e);this._processHit(t)}handleWarning(e){const t=this._getWarningData(e);this._processHit(t)}_getCommonData(e={}){null===this._domain&&(this._domain=this._getDomain());const t=this._player.getVideoHeight(),i=t?`${t}p`:"",s=this._player.getQuality(),n=this._player.getCodecs(),o=this._player.getStatsHistory(),r=Math.floor(100*this._player.getPlaybackLength())/100,a=null!=this._player.getTextTrack(),l={version:this._settings.playerVersion,tech:this._player.getTechName(),adaptive:this._player.isAdaptive(),live:this._player.isLive(),playbackLength:r,domain:this._domain,autoQuality:null===s,quality:i,codecs:n,subtitles:a,qualityCodecs:i+"; "+n,bandwidth:o[o.length-1]?o[o.length-1].bandwidth:0,ad:!!this._settings.ad,service:window.location.hostname};if(this._settings.ad){const e=this._player.constructor.adRole;this._role===e.PREROLL||this._role===e.SPONSOR||this._role===e.PROMO?l.adtype="preroll":this._role===e.MIDROLL?l.adtype="midroll":this._role===e.POSTROLL&&(l.adtype="postroll"),l.adBlock=this._settings.adBlock,l.adOnlyMode=this._player.isAdOnlyMode()}return Object.assign(l,e),l}_getPlayData(e){return this._getCommonData({action:fa.PLAY,first:e})}_getPartData(e){const t=Math.floor(e);let i=null;return this._player.isFragmentComplete(ga)&&this._lastFragmentTime!==t&&(this._lastFragmentTime=t,i=this._getCommonData({action:fa.PART,part:ga,qualityChanges:this._qualityChangeCount})),i}_getLastPartData(){const e=this._player.getCompleteRestFragmentLength(ga);let t=null;return e&&(t=this._getCommonData({action:fa.PART,part:e,qualityChanges:this._qualityChangeCount})),t}_getBufferingData(){const e=Math.floor((o.getNow()-this._bufferingStartTime)/1e3*100)/100;return this._getCommonData({action:fa.BUFFERING,buffering_cause:this._bufferEmptyCause,part:Math.max(0,Math.min(ga,e))})}_getVolumeData(e){return this._getCommonData({action:fa.VOLUME_CHANGE,level:e.level,muted:e.muted,time:this._player.getCurrentTime()})}_getFinishedData(){return this._getCommonData({action:fa.FINISHED})}_getErrorData(e){return this._getCommonData({action:fa.ERROR,fatal:e.fatal,code:e.code||e.hitData&&e.hitData.ERRORCODE,category:e.category,src:e.src,first:this._firstPlay})}_getWarningData(e){return this._getCommonData({action:fa.WARNING,category:e.category,src:e.src})}_getDomain(e){const t=document.createElement("a");let i="";i=this._player.isAdaptive()?this._player.getCurrentAdaptiveSrc():this._player.getCurrentSrc(),t.href=i;const s=t.hostname.match(/[^.]*\.[^.]{2,3}(?:\.[^.]{2,3})?$/);return s?s[0]:t.hostname}_processHit(e){try{const t={message:e};new Qt(o,{method:"POST"}).send(ma,JSON.stringify(t)).catch(e=>{0})}catch(e){0}}_createBufferHitInterval(){this._clearBufferHitInterval(),this._bufferingStartTime=o.getNow(),this._bufferHitInterval=setInterval(()=>{const e=this._getBufferingData();this._bufferingStartTime=o.getNow(),this._processHit(e)},1e3*ga)}_clearBufferHitInterval(){this._bufferHitInterval&&(clearInterval(this._bufferHitInterval),this._bufferHitInterval=null)}_createQualityChangeTimeout(){this._clearQualityChangeTimeout(),this._qualityChangeTimeout=setTimeout(()=>{this._qualityChangeTimeout=null,this._bufferEmptyCause=Ta.BUFFER_EMPTY},1e3*Ea)}_clearQualityChangeTimeout(){this._qualityChangeTimeout&&(clearTimeout(this._qualityChangeTimeout),this._qualityChangeTimeout=null)}_resetContentData(){this._domain=null,this._content=null,this._lastFragmentTime=0}}class va extends wr{constructor(e){super(),this._player=e}track(e,t){if("TIMEUPDATE"===e){const e=this._player.getOverlays(),t=this._player.getCurrentTime(),i=this._player.getStartTime()||0,s=this._player.isLiveStreaming()?null:this._player.getDuration();e.forEach(e=>{let n=null;"atTime"===e.start.type?n=e.start.time:"afterStart"===e.start.type?n=i+e.start.time:"beforeEnd"===e.start.type&&s&&(n=s-e.start.time),null!==n&&n<=t&&n+e.duration>=t?this._player.showVisualElement(e.id):this._player.hideVisualElement(e.id)})}}}const Aa=.05,Sa=5,ba=10,Ca={QUALITY:".sznp-ui-widget-box.sznp-ui-quality button:not(:disabled)",SUBTITLES:".sznp-ui-widget-box.sznp-ui-subtitles button:not(:disabled)"},Pa="keyup",ka="keydown",Ia="mousedown",wa="focusout",Na=350,La=350,xa=200,Ma="tab",Da="u+0009",Oa="escape",Ra="esc",Ua="u+001b",Va="m",Ba="u+004d",Fa="arrowup",Ha="up",Ga="arrowdown",ja="down",qa="f",Qa="u+0046",Ya="c",za="u+0043",Wa=" ",Ka="spacebar",$a="u+0020",Xa="j",Za="u+004a",Ja="k",el="u+004b",tl="l",il="u+004c",sl="arrowleft",nl="left",ol="arrowright",rl="right",al="mediaplay",ll="mediapause",hl="mediaplaypause",_l="mediafastforward",dl="mediarewind",ul="home",cl="end",pl="0",ml="u+0030",gl="1",El="u+0031",Tl="2",fl="u+0032",yl="3",vl="u+0033",Al="4",Sl="u+0034",bl="5",Cl="u+0035",Pl="6",kl="u+0036",Il="7",wl="u+0037",Nl="8",Ll="u+0038",xl="9",Ml="u+0039";class Dl extends S{constructor(e,t,i){super(),this._player=e,this._globalAllowed=i,this._playerElement=t,this._eventElement=this._globalAllowed?document:this._playerElement,this._spaceTimer=null,this._seekTimer=null,this._volumeTimer=null,this._focusTimer=null,this._lastTextTrack=null,this._longControlPanelTimeout=!1,this._eventKeyMap=new Map([[Pa,this._handleKeyUp],[ka,this._handleKeyDown]]),this._eventPlayerElementMap=new Map([[wa,this._handleFocusOut]]),this._eventGlobalMap=new Map([[Ia,this._handleMouseDown],[ka,this._handleGlobalKeyDown]]),this.bindAll(this._eventKeyMap),this.bindAll(this._eventGlobalMap),this.bindAll(this._eventPlayerElementMap),this.addEventListeners(this._eventElement,this._eventKeyMap),this.addEventListeners(this._playerElement,this._eventPlayerElementMap),this.addEventListeners(document,this._eventGlobalMap)}destroy(){this.removeEventListeners(this._eventElement,this._eventKeyMap),this.removeEventListeners(this._playerElement,this._eventPlayerElementMap),this.removeEventListeners(document,this._eventGlobalMap),this._clearTimers(),this._globalAllowed=!1,this._lastTextTrack=null,this._eventElement=null,this._playerElement=null,this._player=null}_clearTimers(){this._spaceTimer&&(clearTimeout(this._spaceTimer),this._spaceTimer=null),this._volumeTimer&&(clearTimeout(this._volumeTimer),this._volumeTimer=null),this._seekTimer&&(clearTimeout(this._seekTimer),this._seekTimer=null),this._focusTimer&&(clearTimeout(this._focusTimer),this._focusTimer=null)}_handleKeyUp(e){if(!e.key&&!e.keyIdentifier||this._isModifierKey(e)||this._isTargetInputElement(e))return;const t=this._isPlayerFocused(e),i=this._player.isPaused(),s=(e.key||e.keyIdentifier).toLowerCase();switch(s){case Ma:case Da:t&&this._setControlsVisible();break;case Oa:case Ra:case Ua:t&&(e.preventDefault(),this._closeMenu(e));break;case Ja:case el:case hl:this._handlePlay();break;case al:i&&this._player.play();break;case ll:i||this._player.pause();break;case qa:case Qa:this._player.isFullscreen()?this._player.exitFullscreen():(this._player.enterFullscreen(),this._setControlsVisible());break;case Ya:case za:if(t)if(this._setControlsVisible(),null===this._player.getTextTrack()){const e=this._player.getSupportedTextTracks();if(!e.length)return;this._lastTextTrack=this._lastTextTrack||e[0].id,this._player.setTextTrack(this._lastTextTrack)}else this._lastTextTrack=this._player.getTextTrack(),this._player.setTextTrack();break;case Va:case Ba:this._setControlsVisible(),this._player.setMute(!this._player.isMuted());break;case pl:case ml:case gl:case El:case Tl:case fl:case yl:case vl:case Al:case Sl:case bl:case Cl:case Pl:case kl:case Il:case wl:case Nl:case Ll:case xl:case Ml:{const e=parseInt(s.slice(-1),10);isNaN(e)||this._seekTo(this._player.getDuration()*(e/10));break}}}_handleKeyDown(e){if(!e.key&&!e.keyIdentifier||this._isModifierKey(e)||this._isTargetInputElement(e))return;const t=this._isPlayerFocused(e),i=this._isTargetVolumeBar(e),s=this._isTargetPopupMenuItem(e),n=this._player.isLiveStreaming(),o=this._player.isEvent();switch((e.key||e.keyIdentifier).toLowerCase()){case Wa:case Ka:case $a:if(t){if(this._isTargetClickable(e))return;e.preventDefault(),this._spaceTimer||(this._handlePlay(),this._setEventTimeout("_spaceTimer",Na)),this._setControlsVisible()}break;case cl:t&&(e.preventDefault(),n&&o?this._player.seekToLive():this._seekTo(this._player.getDuration()));break;case ul:t&&(e.preventDefault(),this._seekTo(0));break;case Xa:case Za:case dl:this._seekTo(this._player.getCurrentTime()-ba);break;case sl:case nl:t&&(e.preventDefault(),i?this._setVolume(this._player.getVolume()-Aa):this._seekTo(this._player.getCurrentTime()-Sa));break;case tl:case il:case _l:this._seekTo(this._player.getCurrentTime()+ba);break;case ol:case rl:t&&(e.preventDefault(),i?this._setVolume(this._player.getVolume()+Aa):this._seekTo(this._player.getCurrentTime()+Sa));break;case Fa:case Ha:t&&(e.preventDefault(),s?this._moveInMenu(e,!0):this._setVolume(this._player.getVolume()+Aa));break;case Ga:case ja:t&&(e.preventDefault(),s?this._moveInMenu(e,!1):this._setVolume(this._player.getVolume()-Aa))}}_handleMouseDown(){this._setKeyboardAccessibility(!1)}_handleGlobalKeyDown(e){if(!e.key&&!e.keyIdentifier||this._isModifierKey(e))return;const t=(e.key||e.keyIdentifier).toLowerCase();t!==Ma&&t!==Da||this._setKeyboardAccessibility(!0)}_handleFocusOut(e){if(this._player.isFullscreen()){const t=e.relatedTarget;if(null===t||this._playerElement.contains(t))return;this._setEventTimeout("_focusTimer",0,()=>{this._playerElement.focus()})}}_setKeyboardAccessibility(e){ts(this._playerElement).cssClasses({"-keyboard-accessible":e}),this._longControlPanelTimeout=e}_seekTo(e){const t=this._player.isAdMode(),i=this._player.isLive(),s=this._player.isEvent();if(!(t||i&&!s)){if(!this._seekTimer){const t=this._player.getDuration();this._player.seek(Math.min(Math.max(e,0),t)),this._setEventTimeout("_seekTimer",La)}this._setControlsVisible()}}_setVolume(e){this._volumeTimer||(this._player.setMute(!1),this._player.setVolume(Math.min(Math.max(e,0),1)),this._setEventTimeout("_volumeTimer",xa)),this._setControlsVisible()}_handlePlay(){this._player.isPaused()?this._player.play():this._player.pause()}_moveInMenu(e,t){const i=e.target;this._setKeyboardAccessibility(!0),t?null!==i.previousSibling&&i.previousSibling.focus():null!==i.nextSibling&&i.nextSibling.focus()}_setEventTimeout(e,t,i=null){this[e]||(this[e]=setTimeout(()=>{"function"==typeof i&&i(),this[e]=null},t))}_isPlayerFocused(e){return!!this._playerElement.contains(e.target)}_isTargetClickable(e){const t=e.target;return!!/(BUTTON|INPUT|SELECT|A)/.exec(t.tagName)}_isTargetVolumeBar(e){return e.target.classList.contains("c-VolumeBar")}_isTargetPopupMenuItem(e){return e.target.classList.contains("sznp-ui-popup-menu-item")}_isTargetInputElement(e){const t=e.target;return!!/(INPUT|TEXTAREA|SELECT)/.exec(t.tagName)}_isModifierKey(e){const t=t=>void 0!==e.getModifierState&&e.getModifierState(t),i=t("Control")||e.ctrlKey,s=t("Alt")||e.altKey,n=t("AltGraph")||e.altGraphKey||e.altKey;return i||s||n}_setControlsVisible(){this._player.showControls(this._longControlPanelTimeout)}_closeMenu(e){this._player.closeMenu().then(t=>{if(null!==t&&this._isTargetPopupMenuItem(e)){const e=this._playerElement.querySelector(Ca[t]);e&&e.focus()}})}}let Ol=new m.ErrorFactory(m.createSourceName("src/js/sznplayer/analytics/GemiusStreamTracker.js"));class Rl extends wr{constructor(e,t,i){if(!e||"object"!=typeof e||"function"!=typeof e.newStream)throw Ol.createError(m.SETTING,"Argument gemiusStream must be specified.");if(!i||"object"!=typeof i)throw Ol.createError(m.SETTING,"Argument settings must be specified (and be an object).");if(!i.identifier||"string"!=typeof i.identifier)throw Ol.createError(m.SETTING,"Option settings.identifier must be an string).");super(),this._gs=e,this._player=t,this._variables={identifier:i.identifier,hitcollector:i.hitcollector||"https://scz.hit.gemius.pl",playerId:i.playerId||t.getPlayerId()},this._queue=[],this._content=null,this._duration=NaN,this._completed=!1,this._wasBuffering=!1}newContent(e){this._queue_add("_newContent",[e]),this.setDuration(e.duration)}finish(){if(this._duration&&!this._completed){const e=this._getRightTime(this._player.getCurrentTime());this._gs.closeStream(this._variables.playerId,this._content.id,e)}this._duration=NaN,this._completed=!1,this._wasBuffering=!1,this._queue_clean()}setDuration(e){this._player.isLive()?this._duration=-1:this._duration=Math.round(e),this._duration&&this._queue_process()}track(e,t){if(!this._duration)return void this._queue_add("track",[e,t]);const i=this._getRightTime(t&&t.time||this._player.getCurrentTime());"PLAYING"===e?(this._event(i,"playing"),this._wasBuffering=!1):"PAUSED"===e?this._event(i,"paused"):"STOPPED"===e?this._event(i,"stopped"):"SEEKSTART"===e?this._event(i,"seekingStarted"):"SEEKED"!==e||this._player.isPaused()?"ENDED"===e?(this._event(i,"complete"),this._completed=!0):"BUFFER_EMPTY"===e?(this._event(i,"buffering"),this._wasBuffering=!0):"TIMEUPDATE"===e&&this._wasBuffering&&!this._player.isPaused()&&(this._event(i,"playing"),this._wasBuffering=!1):this._event(i,"playing")}_newContent(e){this._content=e,this._gs.newStream(this._variables.playerId,this._content.id,this._duration,this._getCustomPackage(this._content),[],this._variables.identifier,this._variables.hitcollector,this._getTreeId(this._content))}_event(e,t){this._gs.event(this._variables.playerId,this._content.id,e,t)}_getCustomPackage(e){return[{name:"CNAME",value:(e.analyticsData||{}).materialName||e.title||""},{name:"TYPE",value:-1===this._duration?"LIVE":"VOD"}]}_getTreeId(e){return[]}_getRightTime(e){const t=Math.round(e);return-1===this._duration?t:Math.min(t,this._duration)}_queue_add(e,t=null){this._queue.push({method:e,params:t})}_queue_process(){let e=null;for(;e=this._queue.shift();)Array.isArray(e.params)?this[e.method].apply(this,e.params):this[e.method].apply(this)}_queue_clean(){this._queue=[]}}const Ul=-1;let Vl=new m.ErrorFactory(m.createSourceName("src/js/sznplayer/analytics/GemiusPrismTracker.js"));class Bl extends wr{constructor(e,t,i){if(!e||"function"!=typeof e)throw Vl.createError(m.SETTING,"Argument gemiusConstructor must be specified and valid.");if(!i||"object"!=typeof i)throw Vl.createError(m.SETTING,"Argument settings must be specified (and be an object).");if(!i.accountId||"string"!=typeof i.accountId)throw Vl.createError(m.SETTING,"Option settings.accountId must be a non-empty string.");super(),this._gemiusCtor=e,this._player=t,this._settings=i,this._gemius=null,this._content=null,this._duration=NaN,this._offset=NaN,this._close=!1}track(e,t){"READY"===e?this._gemius||(this._gemius=this._createGemius()):"CONTENT_SET"===e&&(this._gemius||(this._gemius=this._createGemius()),this._duration=NaN,this._offset=0,this._close=!1,this._player.isLive()?this._duration=Ul:t.content.duration&&(this._duration=t.content.duration),this._content=t.content,this._newProgram(this._content,this._duration))}programEvent(e,t,i=null){this._close||(this._offset=e,this._programEvent(this._content,e,t,i))}programClose(e,t=!1){if(this._close)return;const i=t?"complete":"close",s=t?this._duration:e;this._offset=e,this._programEvent(this._content,s,i),this._close=!0}newAd(e,t){this._newAd(e,t,e.duration)}adEvent(e,t,i=null){this._adEvent(this._content.id,e,this._offset,t,i)}adClose(e,t=!1){const i=t?"complete":"close";this._adEvent(this._content.id,e,this._offset,i)}_createGemius(){const e=this._player.getElement(),t=this._player.isMuted(),i=this._player.getVolume();return new this._gemiusCtor(this._settings.playerId||this._player.getPlayerId(),this._settings.accountId,{currentDomain:this._settings.currentDomain||window.document.location.hostname,volume:t?-1:Math.round(100*i),resolution:`${e.clientWidth}x${e.clientHeight}`})}_newProgram(e,t){const i=e.analyticsData||{},s={programDuration:Math.round(t),programType:"Video",programName:i.materialName||e.title};i.sectionName&&(s.series=i.sectionName),i.publicationDate&&i.publicationDate instanceof Date&&(s.premiereDate=i.publicationDate.toISOString().slice(0,10).replace(/-/g,"")),this._gemius.newProgram(e.id,s)}_programEvent(e,t,i,s=null){this._gemius&&e&&this._gemius.programEvent(e.id,Math.round(t),i,s)}_newAd(e,t,i){const s={adDuration:Math.round(i),adType:"sponsor"===t?"sponsor":"promo"===t?"promo":"spot"};e.title&&(s.adName=e.title),this._gemius.newAd(e.id,s)}_adEvent(e,t,i,s,n=null){this._gemius.adEvent(e,t,Math.round(i),s,n)}}class Fl extends wr{constructor(e,t){super(),this._player=e,this._mainTracker=t,this._partId=1,this._currentTime=0,this._wasInterrupted=!1,this._needToHitPlayAfterBuffer=!1,this._hasToBeAutoPlay=!1}newContent(e){this._partId=1,this._currentTime=0,this._wasInterrupted=!1,this._hasToBeAutoPlay=!0,this._needToHitPlayAfterBuffer=!1}setDuration(e){}track(e,t){if("PLAYING"===e)this._mainTracker.programEvent(t.time,"play",{autoPlay:this._hasToBeAutoPlay,partID:this._partId}),this._wasInterrupted=!1,this._hasToBeAutoPlay=!1,this._needToHitPlayAfterBuffer=!1;else if("STOPPED"===e)this._mainTracker.programEvent(this._currentTime,"stop");else if("PAUSED"===e)this._mainTracker.programEvent(this._currentTime,"pause");else if("BUFFER_EMPTY"===e)this._mainTracker.programEvent(this._currentTime,"buffer"),this._needToHitPlayAfterBuffer=!0;else if("CONTENT_CAN_PLAY"===e)this._needToHitPlayAfterBuffer&&this._player.isPlaying()&&(this._mainTracker.programEvent(this._currentTime,"play",{autoPlay:!0,partID:this._partId}),this._needToHitPlayAfterBuffer=!1);else if("SEEKSTART"===e)this._mainTracker.programEvent(this._currentTime,"seek"),this._wasInterrupted=!0;else if("ENDED"===e)this._mainTracker.programClose(this._currentTime,!0);else if("VOLUME_CHANGE"===e)this._mainTracker.programEvent(this._currentTime,"chngVol",{volume:t.muted?-1:Math.round(100*t.level)});else if("QUALITY_SET"===e){const e=t.qualityIdx;let i=-1;if(t.autoset)i=!1;else if(null!==e){const t=this._player.getResolvedContent();if(t&&t.source){const s=t.source.getQualityItem(e),n=s.getResolution(e);i=n?`${n.width}x${n.height}`:s.getName()}}i&&this._mainTracker.programEvent(this._currentTime,"chngQual",{quality:i})}else"TIMEUPDATE"===e&&(this._currentTime=t.time,this._wasInterrupted&&this._player.isPlaying()&&(this._mainTracker.programEvent(t.time,"play",{autoPlay:!0,partID:this._partId}),this._wasInterrupted=!1))}break(){this._mainTracker.programEvent(this._currentTime,"break")}restore(){this._partId++,this._hasToBeAutoPlay=!0,this._wasInterrupted=!1,this._needToHitPlayAfterBuffer=!1}finish(){this._mainTracker.programClose(this._currentTime,!1)}}class Hl extends wr{constructor(e,t){super(),this._player=e,this._mainTracker=t,this._ad=null,this._role="",this._breakSize=0,this._position=0,this._hasToBeAutoPlay=!1,this._finishedByEnded=!1,this._skipped=!1}newContent(e,t,i,s,n,o){this._hasToBeAutoPlay=!0,this._finishedByEnded=!1,this._skipped=!1,this._breakSize=i,this._position=s,this._ad=e,this._role=t,this._mainTracker.newAd(e,t)}track(e,t){if("PLAYING"===e)this._mainTracker.adEvent(this._ad.id,"play",{autoPlay:this._hasToBeAutoPlay,adPosition:this._position,breakSize:this._breakSize}),this._hasToBeAutoPlay=!1;else if("STOPPED"===e)this._mainTracker.adEvent(this._ad.id,"stop");else if("PAUSED"===e)this._mainTracker.adEvent(this._ad.id,"pause");else if("BUFFER_EMPTY"===e)this._mainTracker.adEvent(this._ad.id,"buffer");else if("SEEKSTART"===e)this._mainTracker.adEvent(this._ad.id,"seek");else if("SKIP"===e)this._mainTracker.adEvent(this._ad.id,"skip"),this._skipped=!0;else if("ENDED"===e)this._finishedByEnded=!0;else if("VOLUME_CHANGE"===e)this._mainTracker.adEvent(this._ad.id,"chngVol",{volume:t.muted?-1:Math.round(100*t.level)});else if("QUALITY_SET"===e){const e=t.qualityIdx;let i=-1;t.autoset?i=!1:null!==e&&this._ad.source instanceof ResolvedQualityList&&(i=this._getQuality(this._ad.source,e)),i&&this._mainTracker.adEvent(this._ad.id,"chngQual",{quality:i})}}finish(){this._skipped||this._mainTracker.adClose(this._ad.id,this._finishedByEnded)}_getBreakSize(e){return"sponsor"===e||"promo"===e||"preroll"===e?this._player.getAdsCount("sponsor")+this._player.getAdsCount("promo")+this._player.getAdsCount("preroll"):this._player.getAdsCount(e)}_getQuality(e,t){if(!(e instanceof ResolvedQualityList))return"";const i=this._ad.source.getQualityItem(t),s=i.getResolution(t);return s?`${s.width}x${s.height}`:i.getName()}}const Gl="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",jl="click";class ql extends S{constructor(e,t){super(),this._options=e,this._setup=t,this._id=o.generateId("sznp_splash_"),this._flags={splashActive:!0,splashInfoActive:!1},this._uiResizeController=new Do,this._texts=Object.assign({play:"Přehrát",playTitle:"Spustit přehrávání",defaultLinkLabel:"Číst více",topScenesTitle:"Přehrát to nej",topScenesAll:"Všechny zajímavé momenty"},t.localization),this._visibleElements=Object.assign({contentInfo:!0,contentInfoTitle:!0,contentInfoDescription:!0,contentInfoDuration:!0,contentInfoPp:!1,contentInfoShare:!1,contentInfoLink:!0,contentInfoAuthor:!0},t.visibleElements),this._dom={root:es("div",{className:"c-SplashScreen -width-0"}),refs:{poster:es("img",{className:"c-Poster -arph",alt:this._texts.play}),playContainer:es("div",{className:"c-SplashScreen__play"})}},this._component={iconButton:this._createIconButton(),contentInfo:this._createContentInfo(),contentPicker:null},this._splashEventMap=new Map([[jl,this._onPlayClick]]),this._resizeEventMap=new Map([[Do.EVENT_UI_RESIZE,this._onUiResize]]),ts(this._dom.root).append(this._dom.refs.poster,ts(this._dom.refs.playContainer).append(this._component.iconButton.uiGetElement()),this._component.contentInfo.uiGetElement()),this._uiResizeController.addElement(this._dom.root,Mo.ROOT),this.bindAll(this._splashEventMap),this.bindAll(this._resizeEventMap),this.addListeners(this._uiResizeController,this._resizeEventMap),this.addEventListeners(this._dom.root,this._splashEventMap),this.setContent(e)}reset(){this.setContent()}getNameAndVersion(){return`szn_${t}`}getSplashId(){return this._id}getElement(){return this._dom.root}isShown(){return this._flags.splashActive}setVisible(e){this._flags.splashActive=e,ts(this._dom.root).setDisplayed(e)}setVisibleUiElements(e){this._visibleElements=Object.assign({},this._visibleElements,e),this._component.contentInfo.uiUpdate({displayed:this._visibleElements.contentInfo,visibleElements:this._visibleElements})}resetVisibleUiElements(){this._visibleElements={contentInfo:!0,contentInfoTitle:!0,contentInfoDescription:!0,contentInfoDuration:!0,contentInfoPp:!1,contentInfoShare:!1,contentInfoLink:!0,contentInfoAuthor:!0},this._component.contentInfo.uiUpdate({displayed:this._visibleElements.contentInfo,visibleElements:this._visibleElements})}setBackground(e={}){ts(this._dom.refs.poster).setAttr({src:e.videoPoster||Gl,srcset:e.videoPosterSrcset||"",sizes:e.videoPosterSizes||""}).setDisplayed(!!e.videoPoster||!!e.videoPosterSrcset||!!e.videoPosterSizes)}setContent(e={}){const t=Object.assign({visibleElements:this._visibleElements},e);this.setBackground(t),this._component.contentInfo.uiUpdate(this._getPropForContentInfo(t))}_createIconButton(){const e=new Os,t={titleEnabled:this._texts.playTitle,iconProps:{play:{displayed:!0}},ariaProps:{"aria-label":this._texts.playTitle}};return e.uiInit(),e.uiSetEventEmitter(new E),e.uiBuild(),e.uiUpdate(t),e}_createContentInfo(){const e=new _n(this._getPropForContentInfo({visibleElements:this._visibleElements}));return e.uiInit(),e.uiSetEventEmitter(new E),e.uiBuild(),e}_getPropForContentInfo(e){return{displayed:e.visibleElements.contentInfo,isSplashScreen:!0,videoTitle:e.videoTitle?e.videoTitle:"",videoSubtitle:e.videoSubtitle?e.videoSubtitle:"",videoAuthor:e.videoAuthor?e.videoAuthor:"",videoDescription:e.videoDescription?e.videoDescription:"",videoDuration:e.videoDuration?e.videoDuration:0,linkUrl:e.linkUrl?e.linkUrl:"",linkLabel:e.linkLabel?e.linkLabel:this._texts.defaultLinkLabel,linkTarget:e.linkTarget?e.linkTarget:"_blank",channelSubscribe:"",visibleElements:{contentInfo:e.visibleElements.contentInfo,contentInfoTitle:e.visibleElements.contentInfoTitle,contentInfoDescription:e.visibleElements.contentInfoDescription,contentInfoDuration:e.visibleElements.contentInfoDuration,contentInfoPp:e.visibleElements.contentInfoPp,contentInfoShare:!1,contentInfoLink:e.visibleElements.contentInfoLink,contentInfoAuthor:e.visibleElements.contentInfoAuthor},onLinkClick:this._onLinkClick.bind(this)}}_onPlayClick(e){this._flags.splashInfoActive?this._component.splashInfo.close(e):this.emit(ql.EVENT_PLAY_REQUEST,{userAction:!0})}_onLinkClick(e){this.emit(ql.EVENT_ACTION_CONTENT_LINK,e)}_onUiResize(e){const t=e.target,i=t.className.split(" ").filter(e=>-1===e.lastIndexOf(Mo.PREFIX));t.className=i.join(" ").trim(),t.classList.add(e.className)}}ql.EVENT_PLAY_REQUEST="play-request",ql.EVENT_ACTION_CONTENT_LINK="actioncontentlink";class Ql extends S{constructor(e,t,i={}){super(),this._utils=e,this._player=t,this._settings={transitionEnabled:!("transitionEnabled"in i)||i.transitionEnabled,transitionPreviewEnabled:!("transitionPreviewEnabled"in i)||i.transitionPreviewEnabled,waitingTime:"waitingTime"in i?i.waitingTime:1e4,nextItemTime:"nextItemTime"in i?i.nextItemTime:1e3*vr.NEAR_TIME},this._transitonActive=!1,this._previewInited=!1,this._previewVisible=!1,this._previewSwitched=!1,this._originalWaitingTime=this._settings.waitingTime,this._originalNextItemTime=this._settings.nextItemTime,this._teasers=[],this._originalTeasers=[],this._startTime=null,this._timerTime=null,this._timerShown=!1,this._timerCanceled=!1,this._timerInterval=null,this._seekTimeout=null,this._playerEventMap=new Map([[vr.EVENT_PLAYING,this._handlePlaying],[vr.EVENT_PAUSED,this._handlePaused],[vr.EVENT_TIMEUPDATE,this._handleTimeupdate],[vr.EVENT_SEEKING,this._handleSeeking]]),this.bindAll(this._playerEventMap),this.addListeners(this._player,this._playerEventMap),this.setTransitionEnabled(this._settings.transitionEnabled),this.setTransitionPreviewEnabled(this._settings.transitionPreviewEnabled),this.deactivate()}setTransitionEnabled(e){this._settings.transitionEnabled=!!e,this._settings.waitingTime=e?this._originalWaitingTime:0,this._setUiFollowing()}setTransitionPreviewEnabled(e){this._settings.transitionPreviewEnabled=!!e,this._settings.nextItemTime=e?this._originalNextItemTime:0,this._setUiFollowing()}setTransitionNextItemTime(e){this._settings.nextItemTime=void 0!==e?e:this._originalNextItemTime}resetFollowing(){this._teasers=[],this._originalTeasers=[],this._setUiFollowing()}setFollowing(e){this.resetFollowing(),e.forEach((e,t)=>{const i={id:e.id||"",poster:e.poster||"",title:e.title||"",label:"",duration:e.duration||0,onClick:this._onTeaserClick.bind(this,t),previewSource:e.previewSource||null,source:e.source||null};this._originalTeasers.push(e),this._teasers.push(i)}),this._setUiFollowing()}getNextItem(){if(!this._teasers.length)return null;return this._teasers[0]}isFollowing(){return!!this._teasers.length}isActive(){return this._transitonActive}isPreviewSwitched(){return this._previewSwitched}initPreview(){this._previewInited=!0,this._previewShouldBeShown()&&this._startTimer()}activate(){const e=this._previewSwitched;this._timerShown=!this._timerCanceled,this._transitonActive=!0,this._previewSwitched=!1,this._previewVisible=!1,this._setUiFollowing(),this._timerInterval||e||this._createTimerInterval(0)}deactivate(){this._transitonActive=!1,this._previewSwitched=!1,this._previewVisible=!1,this._timerShown=!1,this._timerCanceled=!1,this._timerTime=Math.max((this._settings.waitingTime+this._settings.nextItemTime)/1e3,1),this._setUiFollowing(),this._clearTimerInterval(),this._clearSeekTimeout()}_setUiFollowing(e={}){const t=Object.assign({followingTeasers:this._teasers,followingPreviewShown:this._previewVisible,transitionEnabled:this._settings.transitionEnabled,transitionPreviewEnabled:this._settings.transitionPreviewEnabled,transitionTimerShown:this._timerShown,timerCanceled:this._timerCanceled,onTimerCancelClick:this._onCancelClick.bind(this)},e);this._player.setUiFollowing(t)}_setUiTimer(){const e=this._settings.waitingTime,t=this._settings.nextItemTime,i=Math.max((e+t)/1e3,1),s={followingTimerTime:this._timerTime,followingTimerProgress:100-this._timerTime/i*100};this._player.setUiFollowing(s)}_createTimerInterval(e){this._timerCanceled||this._player.isAdMode()||(this._clearTimerInterval(),this._timerInterval=requestAnimationFrame(()=>this._checkTime(e)))}_checkTime(e){null===this._startTime&&(this._startTime=p.getNow());const t=this._startTime+e+this._settings.waitingTime,i=p.getNow();this._timerTime=Math.ceil(t-i)/1e3,i<t?(this._setUiTimer(),this._timerInterval=requestAnimationFrame(()=>this._checkTime(e))):this._onTimerEnd()}_clearTimerInterval(){cancelAnimationFrame(this._timerInterval),this._timerInterval=null,this._startTime=null,this._timerTime=0}_createSeekTimeout(){this._seekTimeout=requestAnimationFrame(()=>{this._clearTimerInterval(),this._clearSeekTimeout()})}_clearSeekTimeout(){cancelAnimationFrame(this._seekTimeout),clearTimeout(this._seekTimeout),this._seekTimeout=null}_getTimerStartTime(){const e=this._player.isLiveStreaming()?null:this._player.getDuration(),t=this._player.getCurrentTime(),i=this._settings.nextItemTime;return null!==e?Math.max(i-(i-1e3*(e-t)),0):null}_startTimer(){const e=this._getTimerStartTime();null!==e&&this._createTimerInterval(e)}_previewShouldBeShown(){const e=this._player.getCurrentTime(),t=this._player.isLiveStreaming()?null:this._player.getDuration(),i=t?t-this._settings.nextItemTime/1e3:null;return null!==i&&!this._previewSwitched&&i<=e&&this._settings.transitionPreviewEnabled&&!this._player.isAdMode()&&this._teasers.length}_showPreview(){this._previewVisible=!0,this._timerShown=!0,this._setUiFollowing()}_hidePreview(){this._previewVisible=!1,this._timerShown=!1,this._setUiFollowing()}_handlePlaying(e){this._previewShouldBeShown()&&this._startTimer()}_handlePaused(e){e.ended||this._clearTimerInterval()}_handleSeeking(){this._previewSwitched=!1,this._clearSeekTimeout(),this._clearTimerInterval(),this._previewShouldBeShown()?(this._startTimer(),this._player.isPaused()&&this._createSeekTimeout()):this._hidePreview()}_handleTimeupdate(){!this._transitonActive&&this._previewInited&&(this._previewShouldBeShown()?(this._timerInterval||this._player.isPaused()||this._startTimer(),this._previewVisible||this._timerCanceled||this._showPreview()):(this._timerCanceled=!1,this._hidePreview()))}_onCancelClick(){this._timerCanceled=!0,this._timerTime=Math.max((this._settings.waitingTime+this._settings.nextItemTime)/1e3,1),this._hidePreview(),this._setUiFollowing(),this._setUiTimer(),this._clearTimerInterval(),this.emit(Ql.EVENT_COUNTDOWN_CANCEL)}_onTimerEnd(){this.deactivate(),this._teasers.length&&this._dispatchNextRequest(0,{timerEnd:!0})}_onTeaserClick(e){this.deactivate(),this.emit(Ql.EVENT_TEASER_CLICK,{content:this._originalTeasers[e]}),this._dispatchNextRequest(e)}_dispatchNextRequest(e,t={}){this._clearTimerInterval(),this._previewSwitched=!0,this.emit(Ql.EVENT_CONTENT_SWITCH,Object.assign(t,{content:this._originalTeasers[e]}))}}Ql.EVENT_CONTENT_SWITCH="playcontent",Ql.EVENT_REPLAY_REQUEST="replayrequest",Ql.EVENT_COUNTDOWN_CANCEL="countdowncancel",Ql.EVENT_TEASER_CLICK="teaserclick";const Yl={EPISODE:"episode",SHOW:"show",NONE:""};class zl extends S{constructor(e,t){super(),this._utils=e,this._player=t,this._seriesData=null,this._series=[],this._episodes=[],this._originalEpisodes=[],this._currentSeriesIdx=0}getCurrentSeriesIdx(){return this._currentSeriesIdx}resetSeriesData(){this._currentSeriesIdx=0,this._seriesData=null,this._series=[],this._episodes=[],this._originalEpisodes=[]}setSeriesData(e=[]){e.length>0&&(this._seriesData=e,this._processData(),this._setUiEpisodes())}_processData(){const e=this._player.getContent();let t=0;this._seriesData.forEach((i,s)=>{this._episodes[s]=[],this._originalEpisodes[s]=[],i.items.forEach((i,n)=>{let o=!1,r=null;i.type&&i.type===Yl.SHOW?r=Object.assign({},i,{onClick:this._onShowClick.bind(this,n)}):(i.id===e.id&&(t=s,o=!0),r=Object.assign({},i,{type:Yl.EPISODE,active:o,onClick:this._onEpisodeClick.bind(this,n)})),this._episodes[s].push(r),this._originalEpisodes[s].push(i)}),this._series.push({title:i.name,imgSrc:i.imgSrc,onClick:this._onSerieClick.bind(this,s)})}),this._updateActiveSeries(t)}_setUiEpisodes(e={}){const t=Object.assign({},{selectData:this._series,listData:this._episodes[this._currentSeriesIdx]},e);this._player.setUiEpisodes(t)}_updateActiveSeries(e){this._series=this._series.map((t,i)=>Object.assign({},t,{selected:i===e})),this._currentSeriesIdx=e}_onSerieClick(e){this._updateActiveSeries(e),this._setUiEpisodes()}_onEpisodeClick(e){this._dispatchSwitchRequest(e)}_onShowClick(e){this._dispatchSwitchRequest(e)}_dispatchSwitchRequest(e){this.emit(zl.EVENT_CONTENT_SWITCH,{content:this._originalEpisodes[this._currentSeriesIdx][e]})}}zl.EVENT_CONTENT_SWITCH="playcontent";class Wl extends S{constructor(e,t){super(),this._utils=e,this._player=t,this._dateRanges=null,this._dates=[],this._program=[],this._originalProgram=[],this._currentDateIdx=0}getCurrentDateIdx(){return this._currentDateIdx}getCurrentDateRange(){return this._dateRanges&&this._dateRanges.length>0?this._dateRanges[this._currentDateIdx]:null}resetTvProgram(){this._dateRanges=null,this._dates=[],this._program=[],this._originalProgram=[],this._currentDateIdx=0,this._setUiTvProgram()}setTvProgramRanges(e=[]){e.length>0&&(this._dateRanges=e,this._processDateRanges())}setTvProgramData(e=[],t=null){const i=t||this.getCurrentDateRange();e.length>0&&(this._processData(i,e),this._setUiTvProgram())}_processDateRanges(){this._dateRanges.forEach((e,t)=>{const i=new Date,s=new Date(1e3*e.from),n=new Date(i);n.setDate(i.getDate()-1);let o="";o=i.toDateString()===s.toDateString()?"Dnes":n.toDateString()===s.toDateString()?"Včera":`${s.getDate()}. ${s.getMonth()+1}.`,e.default&&(this._currentDateIdx=t),this._dates.push({title:o,selected:e.default,onClick:this._onDateClick.bind(this,t)}),this._program.push({range:e,data:[]}),this._originalProgram.push({data:[]})})}_processData(e,t){const i=this._dateRanges.findIndex(t=>JSON.stringify(t)===JSON.stringify(e));this._program[i].data=[],this._originalProgram[i].data=[],t.forEach((e,t)=>{this._program[i].data.push(Object.assign({},e,{onButtonClick:this._dispatchSwitchRequest.bind(this,t)})),this._originalProgram[i].data.push(e)})}_setUiTvProgram(e={}){const t=Object.assign({},{selectData:this._dates,listData:this._program[this._currentDateIdx]&&this._program[this._currentDateIdx].data},e);this._player.setUiTvProgram(t)}_updateActiveDate(e){this._dates=this._dates.map((t,i)=>Object.assign({},t,{selected:i===e})),this._currentDateIdx=e}_onDateClick(e){this._currentDateIdx!==e&&(this._updateActiveDate(e),this._dispatchDataRequest(this._dateRanges[e]))}_dispatchDataRequest(e){this.emit(Wl.EVENT_DATA_SET,e)}_dispatchSwitchRequest(e){this.emit(Wl.EVENT_CONTENT_SWITCH,{content:this._originalProgram[this._currentDateIdx].data[e]})}}Wl.EVENT_DATA_SET="tvdataset",Wl.EVENT_CONTENT_SWITCH="playcontent";class Kl{constructor(e=""){this._prefix=e,this._storage=(()=>{try{const e=window.localStorage;return e?(e.setItem("_SZNPLAYER_CONDITION_TEST",1),e.removeItem("_SZNPLAYER_CONDITION_TEST"),e):null}catch(e){return null}})(),this._config={read:!0,write:!0}}get(e){if(!this._storage||!this._config.read)return null;const t=`${this._prefix}${e}`,i=this._storage.getItem(t);let s=null;if(!i)return null;try{s=JSON.parse(i)}catch(e){0}return s?s.expiration&&Date.now()>s.expiration?(this._storage.removeItem(t),null):s.data:null}set(e,t,i=null){if(!this._storage||!this._config.write)return;const s=`${this._prefix}${e}`,n=Date.now(),o={data:t,creation:n,expiration:i?n+i:null};let r="";try{r=JSON.stringify(o)}catch(e){0}r&&this._storage.setItem(s,r)}remove(e){if(!this._storage||!this._config.write)return;const t=`${this._prefix}${e}`;this._storage.removeItem(t)}setConfig(e){this._config=Object.assign(this._config,e)}}const $l="SznPlayer.SentryLogger",Xl=7,Zl="https://sentry.sklik.cz/api/81/store/",Jl="f3488c029c8d40c6833d5d89f557cada",eh="POST",th="javascript",ih="error",sh="?";class nh{constructor(){this._sdk={name:"SznPlayerSentry-js",version:"1.0.0"}}hit(e){const t=new Qt(o,{method:eh}),i=new Date,s=i.getTime(),n=i.toISOString(),r=e.log,a=e.error;t.setHeaders({"Content-Type":"application/json","X-Sentry-Auth":`Sentry sentry_version=${Xl}, sentry_timestamp=${s}, sentry_key=${Jl}`});const l=void 0!==a.genericMessage?a.genericMessage:a.message,h={level:ih,timestamp:n,server_name:e.service,platform:th,logger:$l,sdk:this.getSDK(),tags:this._getTags(r),exception:this._getExceptionData(a),fingerprint:["Category: "+a.category,"Message: "+l],release:r.playerversion,extra:this._getExtraData(r,a),request:this._getRequestData()};t.send(Zl,JSON.stringify(h)).catch(e=>{0})}getSDK(){return this._sdk}_getRequestData(){const e=window.location.href,t=navigator.userAgent;return{url:e,method:eh,headers:{"Content-Type":"application/json","User-Agent":t}}}_getExceptionData(e){return{values:[{type:e.name,value:e.message,stacktrace:{frames:this._getStackFrames(e.stack)}}]}}_getStackFrames(e){const t=[];if("string"==typeof e){e.split(/\n/gm).forEach(e=>{if(!e.length)return;const i=this._createStackFrame(e);null!==i&&t.push(i)})}return t.reverse()}_getExtraData(e,t){return{buffered:e.buffered,current_time:e.currenttime,current_src:e.currentsrc,material_id:e.materialid,source:e.source,im_responses:e.imresponses,mode:e.mode,player_tech:e.playertech,player_version:e.playerversion,category:t.category,message:t.message,fatal:t.fatal}}_getTags(e){return{mode:e.mode,player_version:e.playerversion}}_createStackFrame(e){const t=/(\S+) line (\d+)(?: > eval line \d+)* > eval/i,i=/\((\S*)(?::(\d+))(?::(\d+))\)/;let s=null,n=null,o=null;if(n=/^\s*at (?:(.*?) ?\()?((?:file|https?|blob|chrome-extension|native|eval|webpack|<anonymous>|[a-z]:|\/).*?)(?::(\d+))?(?::(\d+))?\)?\s*$/i.exec(e)){const e=n[2]&&0===n[2].indexOf("native");n[2]&&0===n[2].indexOf("eval")&&(o=i.exec(n[2]))&&(n[2]=o[1],n[3]=o[2],n[4]=o[3]),s={abs_path:e?null:n[2],function:n[1]||sh,vars:e?[n[2]]:[],lineno:n[3]?n[3]:null,colno:n[4]?n[4]:null}}else if(n=/^\s*(.*?)(?:\((.*?)\))?(?:^|@)((?:file|https?|blob|chrome|webpack|resource|moz-extension).*?:\/.*?|\[native code\]|[^@]*bundle)(?::(\d+))?(?::(\d+))?\s*$/i.exec(e)){n[3]&&n[3].indexOf(" > eval")>-1&&(o=t.exec(n[3]))&&(n[3]=o[1],n[4]=o[2],n[5]=null),s={abs_path:n[3],function:n[1]||sh,vars:n[2]?n[2].split(","):[],lineno:n[4]?n[4]:null,colno:n[5]?n[5]:null}}else(n=/^\s*at (?:((?:\[object object\])?.+) )?\(?((?:file|ms-appx(?:-web)|https?|webpack|blob):.*?):(\d+)(?::(\d+))?\)?\s*$/i.exec(e))&&(s={abs_path:n[2],function:n[1]||sh,vars:[],lineno:n[3],colno:n[4]?n[4]:null});return s}}class oh extends wr{constructor(e=!1){super(),this._debugMode=e,this._sdkInstance=NOLBUNDLE.nlsQ(this._debugMode?oh.APP_ID_DEBUG:oh.APP_ID,oh.INSTANCE_NAME,this._debugMode?oh.DEBUG_MODE:null),this._content=null,this._previousTime=null,this._ads=[],this._duration=0,this._currentAdIndex=-1,this._isLive=!1,this._contentMetadataLoaded=!1}setDuration(e){this._duration=e}newContent(e){e.nielsen&&(this._content=e.nielsen,void 0!==this._content.ads&&Array.isArray(this._content.ads)&&this._content.ads.length&&!this._content.isAd?this._ads=this._resolveAds(this._content.ads):this._ads=[])}_resolveAds(e){return e.filter(e=>void 0!==e.assetId&&void 0!==e.episodeName&&void 0!==e.start&&void 0!==e.end&&e.start<e.end)}track(e,t){if(this._content)if("CONTENT_LOADED_METADATA"===e)this._isLive=t.isLive;else if("TIMEUPDATE"===e){const e=this._ads.findIndex(e=>e.start<=t.time&&t.time<=e.end);let i=null;if(-1!==e){if(e!==this._currentAdIndex){null!==this._previousTime&&this._sdkInstance.ggPM("stop",this._previousTime),this._currentAdIndex=e,this._previousTime=null;const t=this._contentMetadataLoaded;this._contentMetadataLoaded||(this._sdkInstance.ggPM("loadMetadata",this._getMetadataObject({duration:this._getContentDuration(this._duration),isLive:this._isLive})),this._contentMetadataLoaded=!0),this._sdkInstance.ggPM("loadMetadata",this._getAdMetadaObject({duration:this._ads[e].end-this._ads[e].start,type:t?"midroll":"preroll"}))}i=t.time-this._ads[this._currentAdIndex].start}else-1===this._currentAdIndex&&null!==this._previousTime||(-1!==this._currentAdIndex&&this._sdkInstance.ggPM("stop",this._previousTime),this._currentAdIndex=-1,this._previousTime=null,this._sdkInstance.ggPM("loadMetadata",this._getMetadataObject(this._content.isAd?{duration:0,isLive:!0}:{duration:this._getContentDuration(this._duration),isLive:this._isLive})),this._contentMetadataLoaded=!0,this._content.isAd&&this._sdkInstance.ggPM("loadMetadata",this._getAdMetadaObject({duration:this._duration,type:"preroll"}))),i=(this._isLive&&!this._content.isAd?t.time:this._getContentTime(t.time))+(this._isLive&&!this._content.isAd&&this._content.start||0);(null===this._previousTime||Math.abs(i-this._previousTime)>=1)&&(this._previousTime=Math.floor(i),this._sdkInstance.ggPM("setPlayheadPosition",this._previousTime))}else"PAUSED"===e&&null!==this._previousTime&&t&&!t.ended&&this._sdkInstance.ggPM("stop",this._previousTime)}_getMetadataObject(e){let t=this._content.isAd?this._content.content||{}:this._content,i={assetid:t.assetId,program:t.programName,title:t.episodeName,length:e.duration?Math.floor(e.duration).toString():0,airdate:t.airdate,isfullepisode:t.isFullEpisode,crossId1:t.sourceId,nol_c1:"p1,",nol_c2:"p2,",type:"content",mediaURL:"",segB:t.programType,segC:"",adloadtype:oh.AD_DYNAMIC_LOAD,hasAds:this._ads.length||this._content.isAd?oh.AD_TRUE:oh.AD_FALSE};return e.isLive&&(i.nol_c1+=t.isLiveTV?oh.SZN_TV_CODE:oh.UNKNOWN_TV_CODE,i.length=oh.LIVE_DURATION,i.crossId1="",i.title=i.program,i.isfullepisode=oh.FULL_EPISODE,i.segB=""),i}_getAdMetadaObject(e){let t={assetid:"",type:e.type,title:"",length:e.duration?Math.floor(e.duration).toString():0,nol_c4:"",nol_c5:"p5,04",nol_c6:"p6,"+e.type};return this._content.isAd?(t.assetid=this._content.assetId,t.title=this._content.episodeName):-1!==this._currentAdIndex&&(t.assetid=this._ads[this._currentAdIndex].assetId,t.title=this._ads[this._currentAdIndex].episodeName),t}_getContentDuration(e){return e-this._ads.reduce((e,t)=>e+(t.end-t.start),0)}_getContentTime(e){return e-this._ads.reduce((t,i)=>t+(e>i.end?i.end-i.start:0),0)}finish(){this._content&&null!==this._previousTime&&(-1!==this._currentAdIndex||this._content.isAd?this._sdkInstance.ggPM("stop",this._previousTime):this._sdkInstance.ggPM("end",this._previousTime)),this._ads=[],this._currentAdIndex=-1,this._content=null,this._previousTime=null,this._isLive=!1,this._duration=0,this._contentMetadataLoaded=!1}restore(){}break(){}}oh.APP_ID="PDD927AD8-4CBC-4372-AEAC-0AD6650662A5",oh.APP_ID_DEBUG="PDA91E2F7-078D-47EC-ACA4-2677EE94E1D1",oh.INSTANCE_NAME="sznPlayer",oh.DEBUG_MODE={nol_sdkDebug:"debug"},oh.AD_LINEAR_LOAD="1",oh.AD_DYNAMIC_LOAD="2",oh.FULL_EPISODE="y",oh.NOT_FULL_EPISODE="n",oh.AD_TRUE="1",oh.AD_FALSE="0",oh.AD_MAYBE="2",oh.SZN_TV_CODE="65",oh.UNKNOWN_TV_CODE="9999",oh.LIVE_DURATION="86400";const rh={TITLE:"Upozornění",DESCRIPTION:"Ve Vašem prohlížeči není možné tento obsah přehrát. Stáhněte si některý z moderních prohlížečů, třeba chytrý prohlížeč od Seznamu.",URL:"https://www.seznam.cz/prohlizec",LABEL:"Stáhnout",TARGET:"_blank"},ah=1e4,lh=6;let hh=new m.ErrorFactory(m.createSourceName("src/js/sznplayer/SznRichMediaPlayer.js"));class _h extends S{constructor(e,t={}){super(),this._richPlayer=e,this._options={transitionEnabled:void 0===t.transitionEnabled||t.transitionEnabled,transitionPreviewEnabled:void 0===t.transitionPreviewEnabled||t.transitionPreviewEnabled,transitionWaitingTime:void 0!==t.transitionWaitingTime?t.transitionWaitingTime:void 0!==this._richPlayer.getTransitionWaitingTime()?this._richPlayer.getTransitionWaitingTime():1e4,transitionNextItemTime:void 0!==t.transitionNextItemTime?t.transitionNextItemTime:5e3,transitionItemsCount:void 0!==t.transitionItemsCount?t.transitionItemsCount:0,globalKeyboardShortcuts:void 0!==t.globalKeyboardShortcuts&&t.globalKeyboardShortcuts,autoContentSwitch:void 0!==t.autoContentSwitch&&t.autoContentSwitch,disableSplashScreen:void 0!==t.disableSplashScreen&&t.disableSplashScreen,nielsenDebugMode:void 0!==t.nielsenDebugMode&&!!t.nielsenDebugMode},this._playbackChain=new Or,this._transitionChain=new Or,this._episodesChain=new Or,this._tvProgramChain=new Or,this._playlist=null,this._audioList=[],this._splResource=null,this._splTeaserResource=null,this._sentryLogger=new nh,this._trackerCtrl=new Dr(this._richPlayer),this._adsManager=new ca(this._richPlayer,this._trackerCtrl),this._overlaysManager=new va(this._richPlayer),this._shortcutManager=null,this._transition=new Ql(o,this._richPlayer,{transitionEnabled:this._options.transitionEnabled,transitionPreviewEnabled:this._options.transitionPreviewEnabled,waitingTime:this._options.transitionWaitingTime,nextItemTime:this._options.transitionNextItemTime}),this._episodes=new zl(o,this._richPlayer),this._tvProgram=new Wl(o,this._richPlayer);const i=this._richPlayer.getLocalStoragePrefix();this._storage=new Kl("sznplayer_"+(void 0!==i?i+"_":"")),this._wrapper=document.createElement("div"),this._adBlockElement=document.createElement("div"),this._dot=null,this._originalContent=null,this._content=null,this._isContentSet=!1,this._isLoadingDialogShown=!1,this._isLogErrorPending=!1,this._logErrorCount=0,this._wasPlayed=!1,this._overlaysTimer=null;const s=this.getNameAndVersion();this._sznContentTracker=new pa(this._richPlayer,{playerVersion:s,partLength:10}),this._sznAdTracker=new pa(this._richPlayer,{playerVersion:s,actionPrefix:"mregg-",partLength:5,ad:!0,adBlock:"1"==o.getCookie("adb")}),this._playerBackendTracker=new ya(this._richPlayer,{playerVersion:s}),this._playerBackendAdTracker=new ya(this._richPlayer,{playerVersion:s,ad:!0,adBlock:"1"==o.getCookie("adb")}),this._nielsenAdmosphereTracker="undefined"!=typeof NOLBUNDLE?new oh(this._options.nielsenDebugMode):null,this._eventsMap=new Map([[vr.EVENT_READY,this._dispatchTechReady],[vr.EVENT_CONTENT_READY,this._handleContentReady],[vr.EVENT_CONTENT_SET,this._handleContentSet],[vr.EVENT_PLAYING,this._handlePlaying],[vr.EVENT_PLAY_DENIED,this._handlePlayDenied],[vr.EVENT_PAUSED,this._dispatchPaused],[vr.EVENT_STOPPED,this._dispatchStopped],[vr.EVENT_ENDED,this._dispatchEnded],[vr.EVENT_SKIP,this._handleSkip],[vr.EVENT_SEEKED,this._dispatchSeeked],[vr.EVENT_TIMEUPDATE,this._dispatchTimeupdate],[vr.EVENT_FULLSCREEN_CHANGE,this._dispatchFSChange],[vr.EVENT_CINEMA_CHANGE,this._dispatchCinemaChange],[vr.EVENT_VOLUME_CHANGE,this._handleVolumeChange],[vr.EVENT_QUALITY_SET,this._handleQualitySet],[vr.EVENT_QUALITY_CHANGE,this._handleQualityChange],[vr.EVENT_TRACK_SET,this._handleTrackSet],[vr.EVENT_CONTENT_TEXT_SOURCE_SET,this._handleContentTextSourceSet],[vr.EVENT_TEXT_TRACK_SET,this._handleTextTrackSet],[vr.EVENT_NEAR_END,this._handleNearEnd],[vr.EVENT_CONTENT_LOADED_SEGMENT,this._handleSegmentLoaded],[vr.EVENT_AD_LOADED_SEGMENT,this._handleSegmentLoaded],[vr.EVENT_AD_BEGIN,this._dispatchAdBegin],[vr.EVENT_AD_END,this._dispatchAdEnd],[vr.EVENT_PROGRAMME_BEGIN,this._handleProgrammeBegin],[vr.EVENT_PROGRAMME_END,this._handleProgrammeEnd],[vr.EVENT_ENDSCREEN_SHOWN,this._handleEndScreenShown],[vr.EVENT_AD_LOADED_METADATA,this._handleAdReady],[vr.EVENT_ACTION_CLICKTHROUGH,this._dispatchActionClick],[vr.EVENT_ACTION_BACK,this._dispatchActionBack],[vr.EVENT_ACTION_CONTENT_LINK,this._dispatchActionContentLink],[vr.EVENT_REPLAY_REQUEST,this._handleReplayRequest],[vr.EVENT_VE_CLICK,this._handleVEClick],[vr.EVENT_ERROR,this._handleError],[vr.EVENT_WARNING,this._handleWarning],[vr.EVENT_COMPANION_ADS_READY,this._handleCompanionAds],[vr.EVENT_UI_RESIZE,this._handleUiResize]]),this._eventsMapSplash=new Map([[ql.EVENT_PLAY_REQUEST,this.play],[ql.EVENT_ACTION_CONTENT_LINK,this._dispatchActionContentLink]]),this._eventsMapTransition=new Map([[Ql.EVENT_CONTENT_SWITCH,this._dispatchPlayContent],[Ql.EVENT_REPLAY_REQUEST,this._handleReplayRequest],[Ql.EVENT_COUNTDOWN_CANCEL,this._handleCountdownCancel],[Ql.EVENT_TEASER_CLICK,this._handleTeaserClick]]),this._eventsMapEpisodes=new Map([[zl.EVENT_CONTENT_SWITCH,this._dispatchPlayContent]]),this._eventsMapTvProgram=new Map([[Wl.EVENT_DATA_SET,this.getTvData],[Wl.EVENT_CONTENT_SWITCH,this._dispatchPlayContent]]),this._eventsMapAds=new Map([[ca.EVENT_ERROR,this._handleError]]),this._splash=this._createSplashScreen(),this._wrapper.classList.add("sznp"),this._wrapper.setAttribute("tabindex",-1),this._wrapper.appendChild(this._richPlayer.getElement()),this._splash&&this._wrapper.appendChild(this._splash.getElement()),this._adBlockElement.classList.add("ad-content"),this._wrapper.appendChild(this._adBlockElement),this.bindAll(this._eventsMap),this.bindAll(this._eventsMapTransition),this.bindAll(this._eventsMapEpisodes),this.bindAll(this._eventsMapTvProgram),this.bindAll(this._eventsMapAds),this.addListeners(this._richPlayer,this._eventsMap),this.addListeners(this._transition,this._eventsMapTransition),this.addListeners(this._episodes,this._eventsMapEpisodes),this.addListeners(this._tvProgram,this._eventsMapTvProgram),this.addListeners(this._adsManager,this._eventsMapAds),this._trackerCtrl.addTracker(vr.MODE_CONTENT,this._overlaysManager),this._trackerCtrl.addTracker(vr.MODE_CONTENT,this._sznContentTracker),this._trackerCtrl.addTracker(vr.MODE_AD,this._sznAdTracker),this._trackerCtrl.addTracker(vr.MODE_CONTENT,this._playerBackendTracker),this._trackerCtrl.addTracker(vr.MODE_AD,this._playerBackendAdTracker),this._nielsenAdmosphereTracker&&this._trackerCtrl.addTracker(vr.MODE_CONTENT,this._nielsenAdmosphereTracker),this._shortcutManager=new Dl(this._richPlayer,this.getElement(),this._options.globalKeyboardShortcuts)}getNameAndVersion(){return`szn_${t}`}getTechName(){return this._richPlayer.getTechName()}getPlayerId(){return this._richPlayer.getPlayerId()}getElement(){return this._wrapper}getCurrentContent(){return this._originalContent}getResolvedContent(){return this._richPlayer.getResolvedContent()}getSupportedTextTracks(){return this._richPlayer.getSupportedTextTracks()}getTextTrack(){return this._richPlayer.getTextTrack()}getVideoWidth(){return this._richPlayer.getVideoWidth()}getVideoHeight(){return this._richPlayer.getVideoHeight()}getVolume(){return this._richPlayer.getVolume()}getCurrentTime(){return this._richPlayer.getCurrentTime()}getDuration(){return this._richPlayer.getDuration()}getCurrentFrame(e=null){return this._richPlayer.getCurrentFrame(e)}isReady(){return this._richPlayer.isReady()}isAutoplayAllowed(e=null){return p.isAutoplayAllowed(e)}isMuted(){return this._richPlayer.isMuted()}isPlaying(){return this._richPlayer.isPlaying()}isPaused(){return this._richPlayer.isPaused()}isFullscreen(){return this._richPlayer.isFullscreen()}isCinema(){return this._richPlayer.isCinema()}isAdMode(){return this._richPlayer.isAdMode()}isTransitionActive(){return this._transition.isActive()}hasTextTrack(e){return this._richPlayer.hasTextTrack(e)}setLocalStorageUsage(e={}){this._storage.setConfig(e)}setLogo(e){if("string"!=typeof e)throw hh.createError(m.SETTING,"Argument must be a string.");this._richPlayer.setLogo(e)}setActionArea(e=""){if("string"!=typeof e)throw hh.createError(m.SETTING,"Action area caption must be a string.");this._richPlayer.setActionArea(e)}setPauseOnClick(e){this._richPlayer.setPauseOnClick(e)}setColorProfile(e){if(!e)throw hh.createError(m.SETTING,"Argument must be specified.");if("object"!=typeof e)throw hh.createError(m.SETTING,"Argument must be an object.");this._richPlayer.setColorProfile(e)}setDot(e,t={}){const i=Object.assign({partLength:10},t.content),s=Object.assign({partLength:5},t.ad);this._sznContentTracker.setDot(e,i),this._sznAdTracker.setDot(e,s),this._dot=e}setAds(e){if(!this._adsManager.isInited())throw hh.createError(m.AD,"IM object must be defined to set AdsConfig.");if(this._richPlayer.isAdMode())throw hh.createError(m.AD,"Cannot set AdsConfig while ad is playing.");if("function"!=typeof this._playlist.setAds)throw hh.createError(m.AD,"Playlist must define setAds method.");this._playlist.setAds(e),this._obtainMidroll(),this._obtainPostroll(),this._obtainCM()}setGemiusStream(e,t){const i=new Rl(e,this._richPlayer,t);this._trackerCtrl.addTracker(vr.MODE_CONTENT,i)}setGemiusPrism(e,t){const i=new Bl(e,this._richPlayer,t),s=new Fl(this._richPlayer,i),n=new Hl(this._richPlayer,i);this._trackerCtrl.addTracker(vr.MODE_IDLE,i),this._trackerCtrl.addTracker(vr.MODE_CONTENT,s),this._trackerCtrl.addTracker(vr.MODE_AD,n)}setIm(e){this._adsManager.init(e)}setDotData(e){this._sznContentTracker.setDotData(e)}setPlaylist(e){if(!o.hasInterface(e,Rr))throw hh.createError(m.SETTING,"Argument must be an instance of Playlist.");this.reset(),this._playbackChain.then(()=>{this._playlist=e;const t=this._options.transitionItemsCount;return t>0&&this._playlist.setRange(t),this._prepareCurrentItem()}).then(()=>{if(this._wasPlayed)return this._launchContent();this._richPlayer.isAudioOnlyMode()&&(this.init(),this.disableKeyboardShortcuts(),this.__createAudioList())},e=>{const t=this.getErrorIfIsReason(e);t&&this._handleError(t)})}setQuality(e){this._playbackChain.then(()=>{this._richPlayer.setQuality(e)})}setVolume(e){if("number"!=typeof e||isNaN(e))throw hh.createError(m.SETTING,"Argument must be a number.");if(e<0||e>1)throw hh.createError(m.SETTING,"Argument must be between 0 and 1.");this._richPlayer.setVolume(e)}setMute(e){if("boolean"!=typeof e)throw hh.createError(m.SETTING,"Argument must be a boolean.");this._richPlayer.setMute(e)}hideSplashTitles(e){this._splash.hideSplashTitles(e)}disableKeyboardShortcuts(){this._shortcutManager&&(this._shortcutManager.destroy(),this._shortcutManager=null)}enableKeyboardShortcuts(){this._shortcutManager||(this._shortcutManager=new Dl(this._richPlayer,this.getElement()))}setTextTrack(e=null){this._richPlayer.setTextTrack(e)}setControlsHidden(e){this._richPlayer.setControlsHidden(e)}addTracker(e,t){if(!_h.mode[e])throw m.createError(m.SETTING,`Invalid mode "${e}".`);this._trackerCtrl.addTracker(e,t)}removeTracker(e,t){if(!_h.mode[e])throw m.createError(m.SETTING,`Invalid mode "${e}".`);this._trackerCtrl.removeTracker(e,t)}setVisibleUiElements(e={}){this._splash&&this._splash.setVisibleUiElements(e),this._richPlayer.setVisibleUiElements(e)}resetVisibleUiElements(){this._splash&&this._splash.resetVisibleUiElements(),this._richPlayer.resetVisibleUiElements()}setContentInfo(e={}){let t=Object.assign({videoPoster:this._content&&this._content.poster?this._content.poster:"",videoPosterSrcset:this._content&&this._content.posterSrcSet?this._content.posterSrcSet:"",videoPosterSizes:this._content&&this._content.posterSizes?this._content.posterSizes:"",videoTitle:this._content&&this._content.title?this._content.title:"",videoSubtitle:this._content&&this._content.subtitle?this._content.subtitle:"",videoDuration:this._content&&this._content.duration?this._content.duration:0});this._content&&this._content.contentInfo&&(t=Object.assign(t,this._content.contentInfo)),t=Object.assign(t,e),this._splash&&this._splash.isShown()&&this._splash.setContent(t),this._richPlayer.setContentInfo(t)}resetContentInfo(){this._splash&&this._splash.isShown()&&this._splash.setContent(null),this._richPlayer.resetContentInfo()}setTransitionEnabled(e){this._options.transitionEnabled=!!e,this._transition.setTransitionEnabled(e)}setTransitionPreviewEnabled(e){this._options.transitionPreviewEnabled=!!e,this._transition.setTransitionPreviewEnabled(e)}init(){return this._richPlayer.isReady()?(this._splash&&this._splash.isShown()&&this._splash.setVisible(!1),this._playbackChain.then(()=>Promise.resolve())):(this._initRichMediaPlayer(),this._playbackChain.then(()=>this._getRichMediaPlayerReadyPromise().then(()=>this._launchContent().then(()=>{this._wasPlayed=!0}))))}play(e={}){this.init().then(()=>{this._richPlayer.play(),this._richPlayer.focusPlay(e)})}pause(){this._playbackChain.then(()=>{this._richPlayer.pause()})}stop(){this._playbackChain.then(()=>{this._richPlayer.stop()})}seek(e){this._playbackChain.then(()=>{this._richPlayer.seek(e)})}enterFullscreen(){this._richPlayer.enterFullscreen()}exitFullscreen(){this._richPlayer.exitFullscreen()}enterCinema(){this._richPlayer.enterCinema()}exitCinema(){this._richPlayer.exitCinema()}getTvDataRanges(){this._tvProgram.resetTvProgram(),this._tvProgramChain.then(()=>void 0!==this._playlist.getTvDataRanges?this._playlist.getTvDataRanges():[]).then(()=>{const e=tvDataRanges.filter(e=>e.default);return this._tvProgram.setTvProgramRanges(tvDataRanges),void 0!==this._playlist.getTvData?this._playlist.getTvData(...e):[]}).then(e=>{this._tvProgram.setTvProgramData(e)})}getTvData(e=null){const t=e;this._tvProgramChain.then(()=>void 0!==this._playlist.getTvData?this._playlist.getTvData(t):[]).then(e=>{this._tvProgram.setTvProgramData(e,t)})}reset(e=!1){const t=this._transitionChain,i=this._playbackChain,s=this._episodesChain,n=this._tvProgramChain;let o=null;const r=new Promise((e,t)=>{o=e});return this._transition.deactivate(),this._adsManager.reset(),this._splResource&&this._splResource.reset(),this._splTeaserResource&&this._splTeaserResource.reset(),this._clearOverlaysTimer(),this._splash&&(this._splash.reset(),e&&!this._splash.isShown()&&(this._splash.setVisible(!0),this._transition.deactivate())),this._transitionChain=new Or,this._transitionChain.then(()=>t.cancel()),this._playbackChain=new Or,this._playbackChain.then(()=>i.cancel()).then(()=>this._richPlayer.reset()).then(()=>{this._originalContent=this._content=null,this._playlist=null,this._audioList=[],this._isLoadingDialogShown=!1,this._isContentSet=!1,this._isLogErrorPending=!1,o()}),this._episodesChain=new Or,this._episodesChain.then(()=>s.cancel()),this._tvProgramChain=new Or,this._tvProgramChain.then(()=>n.cancel()),r}destroy(){this._clearOverlaysTimer(),this._playbackChain.then(()=>{this.emit(X.EVENT_DESTROYING),this._richPlayer.destroy(),this._playlist=null})}__createAudioList(){const e=Object.assign({},this._content);this._audioList=[],this._playlist.getAudioList().then(t=>{this._audioList.push(Object.assign({},e,{active:!0,onClick:()=>this._dispatchPlayContent({content:e})})),t.forEach(e=>{this._audioList.push(Object.assign({},e,{active:!1,onClick:()=>this._dispatchPlayContent({content:e})}))}),this._richPlayer.setAudioList(this._audioList)})}__updateAudioList(e){this._audioList=this._audioList.map(t=>Object.assign({},t,{active:e===t.id})),this._richPlayer.setAudioList(this._audioList)}_initRichMediaPlayer(){const e=this._richPlayer.isAdOnlyMode(),t=!e&&this._storage.get("muted")||this._richPlayer.getInitMute(),i=e?1:this._storage.get("volume");this._splash&&this._splash.setVisible(!1),this._richPlayer.setSourcePreload(!0),this._richPlayer.init({fsElement:this._wrapper}),this._richPlayer.play(!0),"number"==typeof i&&!isNaN(i)&&i>=0&&i<=1&&this._richPlayer.setVolume(i),null!==t&&this._richPlayer.setMute(!!t)}_getRichMediaPlayerReadyPromise(){if(this._richPlayer.isReady())return Promise.resolve();{let e=null;const t=new Promise((t,i)=>{e=t}),i=this._richPlayer.constructor.EVENT_READY;return this._richPlayer.once(i,()=>{e()}),t}}moveTo(e){if(!this._playlist){const e=hh.createError(m.SETTING,"No playlist set.");return Promise.reject(e)}return this._playlist.getFollowing().then(t=>{let i=null;if(t&&t.length&&(i=t.find(t=>t.id===e)),!i)throw hh.createError(m.SETTING,`Content with ID "${e}" was not found.`);{this._transition.deactivate(),this._richPlayer.hideDialog(),this._splResource&&this._splResource.reset(),this._splTeaserResource&&this._splTeaserResource.reset();const e=this._transitionChain;this._transitionChain=new Or,this._transitionChain.then(()=>e.cancel()),this._playbackChain.then(()=>(this._setContent(i),this._playlist.moveTo(i.id),this._wasPlayed?this._launchContent().then(()=>i):i));const t=this._episodesChain;this._episodesChain=new Or,this._episodesChain.then(()=>t.cancel());const s=this._tvProgramChain;this._tvProgramChain=new Or,this._tvProgramChain.then(()=>s.cancel())}})}isVpaidAd(){if(this.isAdMode()){const e=this._richPlayer.getCurrentAd();return!!(e&&e.sourceVpaid&&this._richPlayer.isFeatureSupported("vpaid"))}return!1}skipAd(e={}){this._richPlayer.isAdMode()&&this._richPlayer.skip(e)}_createSplashScreen(){if(this._options.disableSplashScreen||this._richPlayer.isAudioOnlyMode())return null;{const e=new ql({},{});return this.bindAll(this._eventsMapSplash),this.addListeners(e,this._eventsMapSplash),e}}_prepareCurrentItem(){return this._playlist.getCurrent().then(e=>this._setContent(e))}_setContent(e){const t=this._richPlayer.isAdOnlyMode();if("object"!=typeof e||!e)throw hh.createError(m.SETTING,"Content must be of type 'object'.");if(t&&e.source)throw hh.createError(m.SETTING,"Content cannot be specified in ad-only mode.");if(!t&&!e.id)throw hh.createError(m.SETTING,"Content ID must be specified.");if(!t&&"string"!=typeof e.id)throw hh.createError(m.SETTING,"Content ID must be a string.");if(!t&&!e.source)throw hh.createError(m.SETTING,"Content source must be specified.");const i=e.streamingType||(!t&&e.source.options&&e.source.options.type?e.source.options.type.toLowerCase():"vod"),s="disableAdaptive"in e?e.disableAdaptive:!(t||!e.source.options)&&!!e.source.options.disableAdaptive,n=e.transitionNextItemTime;let o,r;void 0!==e.forcedQualityIdx&&(o=e.forcedQualityIdx),"function"==typeof e.forcedQualityFunc&&(r=e.forcedQualityFunc);const a=e.startTime,l=this._storage.get("qualityIdx"),h=this._storage.get("audioTrack"),_=this._storage.get("videoTrack"),d=this._storage.get("bandwidth"),u=Object.assign({},e,{source:X.copySource(e.source),textSource:X.copySource(e.textSource),streamingType:i,disableAdaptive:s,startTime:a,forcedQualityIdx:o,forcedQualityFunc:r,storedQualityIdx:l,bandwidth:d,storedAudioTrack:h,storedVideoTrack:_});this._originalContent=e,this._content=u,this.setContentInfo(),this._transition.setTransitionNextItemTime(n),this.emit(_h.EVENT_CONTENT_SET,{content:e})}_launchContent(){return this._resolveAndSetContent(this._content)}_resolveAndSetContent(e){const t=this.isAutoplayAllowed(),s=o.clone(this._playlist.getOverlayConfig()),n=this._adsManager.provideOverlays(s),r=o.clone(this._playlist.getSponsorConfig()),a=this._adsManager.provideSponsors(r),l=o.clone(this._playlist.getVariablePrerollConfig()),h=this._adsManager.provideVariablePrerolls(l),_=o.clone(this._playlist.getPrerollConfig()),d=this._adsManager.providePrerolls(_),u=o.clone(this._playlist.getCompanionConfig());this._adsManager.setCompanionAdSlots(u),this._adsManager.servePp(e.pp||!1);const c=e.source,p=c&&c.type&&c.type===i?this._resolveSpl(e):Promise.resolve(e);return Promise.all([p,t,d,h,a,n]).then(([e,t,i,s,n,o])=>null!==c&&null===e?null:this._serveContent(e,t,i,s,n,o)).catch(e=>{const t=this.getErrorIfIsReason(e);t&&this._handleError(t)})}_resolveSpl(e){this._splResource||(this._splResource=gs()),this._isLoadingDialogShown=!1;const t=e.source.src,i=e.source.options||{},s=i.scheme||o.getUrlScheme(t),n=i.type?i.type.toUpperCase():"",r="number"==typeof i.cutFrom&&i.cutFrom,a="number"==typeof i.cutTo&&i.cutTo;return this._splResource.resolveAndGet(t,{cutFrom:r,cutTo:a,scheme:s,type:n,reloadCallback:()=>{this._showLoadingDialog()}}).then(t=>{if(null===t)return null;const i=ms.createSource(t),s=ms.createSeekSource(t);if(e.source=i,e.seekSource=s,void 0===e.textSource){const i=ms.getSubtitlesTracks(t);e.textSource=i}const n=ms.createPreviewSource(t);n&&(e.previewSource=n);const o=ms.createChapters(t);return e.chapters=o,e})}_resolveNextTeaser(e){if(!e||!e.length)return Promise.resolve(null);const t=e[0];return(t.source.type&&t.source.type===i?this._resolveTeaserSpl(t):Promise.resolve(t)).then(t=>null===t?null:e)}_resolveTeaserSpl(e){this._splTeaserResource||(this._splTeaserResource=gs());const t=e.source.src,i=(e.source.options||{}).scheme||o.getUrlScheme(t);return this._splTeaserResource.resolveAndGet(t,{scheme:i}).then(t=>{if(null===t)return null;const i=ms.createPreviewSource(t);return i&&(e.previewSource=i),e})}_showLoadingDialog(){this._isLoadingDialogShown||(this._isLoadingDialogShown=!0,this._richPlayer.showDialog({kind:"alert",title:"",content:"Přenos bude za okamžik zahájen."}))}_clearOverlaysTimer(){this._overlaysTimer&&(clearTimeout(this._overlaysTimer),this._overlaysTimer=null)}_setOverlays(e,t){this._clearOverlaysTimer(),e&&this._playlist&&Promise.all([this._playlist.getCurrentOverlays()]).then(([i])=>{const s=this._richPlayer.getContent();if(s&&s.id===e){const s=i?i.slice():[];this._richPlayer.setOverlays(s,t),this._overlaysTimer=setTimeout(()=>{this._setOverlays(e,t)},ah)}})}_serveContent(e,t){return this._richPlayer.setContent(e,t).then(()=>{this.isAutoplayAllowed({muted:!0}).then(t=>{this._setOverlays(e.id,t)})})}_obtainMidroll(){const e=o.clone(this._playlist.getMidrollConfig());this._adsManager.provideMidrolls(e)}_obtainPostroll(){const e=o.clone(this._playlist.getPostrollConfig());this._adsManager.providePostrolls(e)}_obtainCM(){const e=o.clone(this._playlist.getCMConfig());this._adsManager.provideCM(e)}_handleVolumeChange(e){const t=e.muted,i=e.level;this._isContentSet&&!this._richPlayer.isAdOnlyMode()&&(this._storage.set("muted",t),this._storage.set("volume",i)),this.emit(_h.EVENT_VOLUME_CHANGE,e)}_handleQualitySet(e){if(e.autoset)return;const t=e.qualityIdx;this._storage.set("qualityIdx",t),this.emit(_h.EVENT_QUALITY_SET,e)}_handleTrackSet(e){if(!e.isUserAction)return;const t=e.trackType===C.TYPE_VIDEO?"videoTrack":"audioTrack";this._storage.set(t,e.trackName),this.emit(_h.EVENT_TRACK_SET,e)}_handleQualityChange(e){this.emit(_h.EVENT_QUALITY_CHANGE,e)}_handleContentTextSourceSet(e){this.emit(_h.EVENT_CONTENT_TEXT_SOURCE_SET,e)}_handleTextTrackSet(e){const t=e.textTrackIdx;let i=null;if(null!==t){const e=this._richPlayer.getSupportedTextTracks().find(e=>e.id===t);i=e?e.srclang:null}this._storage.set("textTrackLang",i),this.emit(_h.EVENT_TEXT_TRACK_SET,e)}_handlePlaying(e){e.first&&this._transition.deactivate(),this._richPlayer.hideDialog(),this._dispatchPlaying(e),e.first&&!this._richPlayer.isAdMode()&&(this._obtainPostroll(),this._obtainMidroll(),this._obtainCM())}_handlePlayDenied(e){this.isAutoplayAllowed().then(e=>{this.emit(_h.EVENT_PLAY_DENIED,{autoplayAllowed:e})})}_handleReplayRequest(){this._transition.deactivate(),this._richPlayer.hideDialog()}_handleCountdownCancel(){this.emit(_h.EVENT_CONTENT_COUNTDOWN_CANCEL)}_handleTeaserClick(e){this.emit(_h.EVENT_CONTENT_TEASER_CLICK,e)}_handleVEClick(e){const t=e.clickActions&&e.clickActions.find(e=>"switch"===e.command&&e.params&&e.params.id);t&&this.moveTo(t.params.id).then(()=>{this.play()})}_handleNearEnd(){!this._richPlayer.hasPostrolls()&&this._transition.isFollowing()&&!this._adsManager.isCMAvailable()&&this._options.transitionPreviewEnabled&&this._transition.initPreview()}_handleProgrammeBegin(){this.emit(_h.EVENT_PROGRAMME_BEGIN)}_handleProgrammeEnd(){this.emit(_h.EVENT_PROGRAMME_END),this._richPlayer.isDisplayingAdScreen()?this.emit(_h.EVENT_PLAYBACK_END):this._transitionChain.then(()=>{const e=this._richPlayer.isPipActive();let t=this._transition.getNextItem();if(t&&t.id&&this._options.transitionEnabled&&!e)this._transition.activate();else{const i=this._transition.isPreviewSwitched();this._transition.deactivate(),t&&t.id?(i||!e&&!this._options.autoContentSwitch||this.moveTo(t.id).then(()=>{this.play()}),i||e||this.emit(_h.EVENT_CONTENT_SWITCH,{content:t})):this.emit(_h.EVENT_PLAYBACK_END)}})}_handleSegmentLoaded(e){const t=e.bandwidth;t&&this._storage.set("bandwidth",t)}_handleContentReady(e){this._handleItemReady(),this._transition.resetFollowing(),this._transitionChain.then(()=>this._playlist.getFollowing()).then(e=>this._resolveNextTeaser(e)).then(e=>{if(null===e)return null;this._transition.setFollowing(e)}),this._episodes.resetSeriesData(),this._episodesChain.then(()=>void 0!==this._playlist.getSeriesData?this._playlist.getSeriesData():[]).then(e=>{this._episodes.setSeriesData(e)}),this._tvProgram.resetTvProgram(),this._tvProgramChain.then(()=>void 0!==this._playlist.getTvDataRanges?this._playlist.getTvDataRanges():[]).then(e=>{const t=e.filter(e=>e.default);return this._tvProgram.setTvProgramRanges(e),void 0!==this._playlist.getTvData?this._playlist.getTvData(...t):[]}).then(e=>{this._tvProgram.setTvProgramData(e)}),this.emit(_h.EVENT_CONTENT_READY,e)}_handleContentSet(e){this._isContentSet=!0}_handleAdReady(e){this._handleItemReady()}_handleItemReady(){const e=this._storage.get("textTrackLang");const t=this._richPlayer.getSupportedTextTracks().find(t=>t.srclang===e);t&&this._richPlayer.setTextTrack(t.id)}_handleCompanionAds(e){this.emit(_h.EVENT_COMPANION_ADS_READY,e)}_handleUiResize(e){this.emit(_h.EVENT_UI_RESIZE,e)}_handleEndScreenShown(e){this.emit(_h.EVENT_ENDSCREEN_SHOWN,e)}_handleError(e){void 0===e.category&&(e.category=m.UNSPECIFIED);const t=e.category===m.PRELOAD?!e.isAdMode:!this._richPlayer.isAdMode(),i=e.category===m.PRELOAD?e.material:t?this._richPlayer.getContent():this._richPlayer.getCurrentAd()||e.material;if(e.fatal=!!this._isFatalError(e,t),e.category!==m.AD_IM_REQUEST||!this._isAdBlockDetected()){this._logError(e,t,i);try{t?this._playerBackendTracker.handleError(e):this._playerBackendAdTracker.handleError(e),this.emit(_h.EVENT_ERROR,e)}catch(e){}}e.fatal&&this.reset().then(()=>{if(this._splash&&this._splash.isShown()&&this._splash.setVisible(!1),this._richPlayer.exitFullscreen(),p.isSznBrowser()||e.category!==m.SOURCE_UNPLAYABLE){const t=void 0!==e.status&&void 0!==m.STRINGS["STATUS_"+e.status]?m.STRINGS["STATUS_"+e.status]:e.category===m.SOURCE_TECH?m.STRINGS.TECH:m.STRINGS.DEFAULT;this._richPlayer.showDialog({kind:"alert",title:"",content:t})}else this._richPlayer.showDialog({kind:"promo",title:rh.TITLE,content:rh.DESCRIPTION,linkUrl:rh.URL,linkTitle:rh.LABEL,linkTarget:rh.TARGET})})}_handleWarning(e){void 0===e.category&&(e.category=m.UNSPECIFIED);const t=!this._richPlayer.isAdMode();try{t?this._playerBackendTracker.handleWarning(e):this._playerBackendAdTracker.handleWarning(e)}catch(e){}}_isAdBlockDetected(){return!this._adBlockElement.offsetWidth}_isFatalError(e=null,t=!0){return t&&e.category!==m.SETTING&&e.category!==m.TEXTSOURCE&&e.category!==m.PRELOAD&&-1===e.category.indexOf(m.AD)}_logError(e,t,i){if(this._logErrorCount++,this._logErrorCount>lh)return;if(this._dot){const s={action:"player-error",playerversion:this.getNameAndVersion(),playertech:this._richPlayer.getTechName(),category:e.category,mode:t?"content":"ad",code:e.code||e.hitData&&e.hitData.ERRORCODE};this._content&&(s.videoid=this._content.id),!t&&i&&(s.adid=i.id),this._dot.hit("event",{d:s})}const s=this._isLogErrorPending;this._isLogErrorPending=!0;try{const n=()=>this._dot&&this._dot._cfg&&this._dot._cfg.service?this._dot._cfg.service:window.location.hostname,o=()=>i?i.id:"",r=()=>{const e=this._richPlayer.getCurrentTime(),t=this._richPlayer.getBuffered(e);return t?`start:${t.start},end:${t.end},length:${t.length}`:""},a={$type:"Player:error",log:Object.assign({playerversion:this.getNameAndVersion(),playertech:this._richPlayer.getTechName(),category:e.category,source:e.source,mode:t?"content":"ad",message:e.message,materialid:o(),imresponses:e.responses||[],stack:e.stack||""},s?{}:{buffered:r(),currentsrc:this._richPlayer.getCurrentSrc(),currenttime:this._richPlayer.getCurrentTime()}),service:n(),error:e};this._sentryLogger.hit(a)}catch(e){0}this._isLogErrorPending=!1}_dispatchTechReady(){this.emit(_h.EVENT_TECH_READY)}_dispatchPlaying(e){this.emit(_h.EVENT_PLAYING,e)}_dispatchPaused(e){this.emit(_h.EVENT_PAUSED,e)}_dispatchStopped(e){this.emit(_h.EVENT_STOPPED,e)}_dispatchEnded(e){this.emit(_h.EVENT_ENDED,e)}_handleSkip(e){this._wrapper.focus()}_dispatchAdBegin(e){this.emit(_h.EVENT_AD_BEGIN,e)}_dispatchAdEnd(e){this.emit(_h.EVENT_AD_END,e)}_dispatchSeeked(e){this.emit(_h.EVENT_SEEKED,e)}_dispatchTimeupdate(e){this.emit(_h.EVENT_TIMEUPDATE,e)}_dispatchFSChange(e){this._wrapper.focus(),this.emit(_h.EVENT_FULLSCREEN_CHANGE,e)}_dispatchCinemaChange(e){this.emit(_h.EVENT_CINEMA_CHANGE,e)}_dispatchPlayContent(e){const t=this._richPlayer.isPipActive();this._richPlayer.isAudioOnlyMode()?this._options.autoContentSwitch&&e&&e.content&&e.content.id&&(this._setContent(e.content),this.__updateAudioList(e.content.id),this._launchContent().then(()=>{this.play()})):(this._options.autoContentSwitch||t)&&e&&e.content&&e.content.id&&this.moveTo(e.content.id).then(()=>{this.play()}),t||this.emit(_h.EVENT_CONTENT_SWITCH,e)}_dispatchActionClick(e){this.emit(_h.EVENT_ACTION_CLICKTHROUGH,e)}_dispatchActionBack(e){this.emit(_h.EVENT_ACTION_BACK,e)}_dispatchActionContentLink(e){this.emit(_h.EVENT_ACTION_CONTENT_LINK,e)}}function dh(e,t=null){const i=Ir(e),s=new _h(i,t||{});return t&&(t.dot&&s.setDot(t.dot,t.dotSettings),t.im&&s.setIm(t.im),t.playlist&&s.setPlaylist(t.playlist)),s}_h.mode={AD:vr.MODE_AD,CONTENT:vr.MODE_CONTENT},_h.EVENT_TECH_READY="techready",_h.EVENT_PROGRAMME_BEGIN="programme-begin",_h.EVENT_PROGRAMME_END="programme-end",_h.EVENT_PLAYBACK_END="playback-end",_h.EVENT_ENDSCREEN_SHOWN="endscreen-shown",_h.EVENT_CONTENT_SET="content-set",_h.EVENT_CONTENT_READY="content-ready",_h.EVENT_PLAYING="playing",_h.EVENT_PLAY_DENIED="playdenied",_h.EVENT_PAUSED="paused",_h.EVENT_STOPPED="stopped",_h.EVENT_ENDED="ended",_h.EVENT_SEEKED="seeked",_h.EVENT_TIMEUPDATE="timeupdate",_h.EVENT_QUALITY_SET="qualityset",_h.EVENT_TRACK_SET="trackset",_h.EVENT_QUALITY_CHANGE="qualitychange",_h.EVENT_VOLUME_CHANGE="volumechange",_h.EVENT_FULLSCREEN_CHANGE="fullscreenchange",_h.EVENT_CINEMA_CHANGE="cinemachange",_h.EVENT_TEXT_TRACK_SET="texttrackset",_h.EVENT_CONTENT_SWITCH="contentswitch",_h.EVENT_CONTENT_COUNTDOWN_CANCEL="contentcountdowncancel",_h.EVENT_CONTENT_TEASER_CLICK="contentteaserclick",_h.EVENT_ACTION_CLICKTHROUGH="actionclickthrough",_h.EVENT_ACTION_BACK="actionback",_h.EVENT_ACTION_CONTENT_LINK="actioncontentlink",_h.EVENT_COMPANION_ADS_READY="companionadsready",_h.EVENT_UI_RESIZE="ui-resize",_h.EVENT_AD_BEGIN="ad-begin",_h.EVENT_AD_END="ad-end",_h.EVENT_ERROR="error",_h.EVENT_DESTROYING="destroying";class uh extends Rr{constructor(e,t=null,i=null){super(),this._playlist=e,this._position=0,this._range=null,this._adsConfig=null,this._overlays={},this._seriesData=null,this._audioList=null,t&&this.setAds(t),i&&this.setSeriesData(i)}setAds(e){const t=Ur.checkAdsConfig(e);if(!t.valid)throw new Error(`[StandardPlaylist] ${t.message}`);this._adsConfig=e}setOverlays(e,t){const i=this._playlist.findIndex(t=>t.id===e);i>=0&&(this._overlays[i]=t)}setSeriesData(e){Array.isArray(e)&&(this._seriesData=e)}setRange(e){this._range=e}setAudioList(e){Array.isArray(e)&&(this._audioList=e)}moveTo(e){this._position=this._playlist.findIndex(t=>t.id===e)}getAudioList(){return Promise.resolve(this._audioList?this._audioList:[])}getCurrent(){return Promise.resolve(this._playlist[this._position])}getCurrentOverlays(){return Promise.resolve(this._overlays[this._position]||null)}getOverlayConfig(){return this._adsConfig?this._adsConfig.overlay:null}getSponsorConfig(){return this._adsConfig?this._adsConfig.sponsor:null}getVariablePrerollConfig(){return this._adsConfig?this._adsConfig.variablePreroll:null}getPrerollConfig(){return this._adsConfig?this._adsConfig.preroll:null}getMidrollConfig(){return this._adsConfig?this._adsConfig.midroll:null}getPostrollConfig(){return this._adsConfig?this._adsConfig.postroll:null}getCMConfig(){return this._adsConfig?this._adsConfig.cm:null}getCompanionConfig(){return this._adsConfig&&void 0!==this._adsConfig.companions?this._adsConfig.companions:null}getFollowing(){const e=this._position+1;return Promise.resolve(this._playlist.slice(e,this._range?e+(this._range-1):void 0))}getSeriesData(){return Promise.resolve(this._seriesData?this._seriesData:[])}getTvDataRanges(){return Promise.resolve([])}getTvData(e){return Promise.resolve([])}}const ch=Symbol("originSetSource");let ph=null;function mh(e){return ph||(ph=new ms(new zt(o,{maxAttemps:2},zt.PROFILE_PLAYLIST))),ph.get(e).then(e=>ms.createSource(e))}var gh={addSplSupport(e){let t=null;e[ch]=e.setSource,e.setSource=((i,s)=>{const n=decodeURI(i);(t="string"==typeof i&&/\?.*\|spl/.test(n)?mh(n):Promise.resolve(i)).then(t=>{e[ch](t,s)})})}};return e.MediaPlayer=X,e.Playlist=Rr,e.QualityList=N,e.QualityListFactory=R,e.RichMediaPlayer=vr,e.SplExtension=gh,e.SplResource=ms,e.StandardPlaylist=uh,e.StrategyPlayer=hr,e.SznRichMediaPlayer=_h,e.Tracker=wr,e.TrackerController=Dr,e.VpaidPlayer=Cr,e.config=U,e.createMediaPlayer=Xi,e.createRichMediaPlayer=Ir,e.createSplResource=gs,e.createSznRichMediaPlayer=dh,e.createUiMediaPlayer=Uo,e.env=p,e.radioContentSetup=function(e,t={},i={}){const s=Array.isArray(e)?e:[e],n=Object.assign({},t,{audioOnlyMode:!0}),o=s.shift(),r=dh(n,{autoContentSwitch:!0}),a=new uh([o]);return s.length&&a.setAudioList(s),i.dot&&r.setDot(i.dot,i.dotSettings),i.gemiusStream&&r.setGemiusStream(i.gemiusStream,i.gemiusStreamSettings),i.gemiusPlayer&&r.setGemiusPrism(i.gemiusPlayer,i.gemiusPrismSettings),r.setPlaylist(a),r},e.singleContentSetup=function(e,t={},i={}){const s=dh(t),n=new uh([e]);return i.logo&&s.setLogo(i.logo),i.dot&&s.setDot(i.dot,i.dotSettings),i.gemiusStream&&s.setGemiusStream(i.gemiusStream,i.gemiusStreamSettings),i.gemiusPlayer&&s.setGemiusPrism(i.gemiusPlayer,i.gemiusPrismSettings),!i.im&&t.adOnlyMode&&i.ads&&i.ads.preroll&&i.ads.preroll.spec&&Array.isArray(i.ads.preroll.spec)&&i.ads.preroll.spec.length&&(i.ads.preroll.spec.some(e=>!e.adUrl&&!e.adContent)||(i.im={getAds:function(){}})),i.im&&s.setIm(i.im),i.ads&&n.setAds(i.ads),i.overlays&&n.setOverlays(e.id,i.overlays),s.setPlaylist(n),s},e.utils=o,e.version=t,e}({});